al_authority_monthly_update_effect = {
	
	# DEBUG: proof-of-life tick counter (increments when monthly update effect runs)
	if = {
		limit = { NOT = { has_variable = authority_tick_count } }
		set_variable = { name = authority_tick_count value = 0 }
	}
	set_variable = { name = authority_tick_count value = { value = var:authority_tick_count add = 1 } }
if = {
		limit = { NOT = { has_variable = tr } }
		set_variable = { name = tr value = 0 }
	}
	if = {
		limit = { NOT = { has_variable = ta } }
	if = { limit = { NOT = { has_variable = ta } } set_variable = { name = ta value = 0 } }
	}

	set_variable = { name = al_capital_base value = 0 }
	set_variable = { name = al_local_base value = 0 }

	# CLEANUP REMOVED: al_la_locations may not exist at game start; list_size on missing list can abort the effect.

	every_owned_location = {
		if = {
			limit = { province = root.capital.province }
			change_variable = { name = al_capital_base add = al_base_loc }
			remove_variable = al_la_value
		}
		else = {
			change_variable = { name = al_local_base add = al_base_loc }
			set_variable = { name = al_la_value value = al_base_loc }
			add_to_list = al_la_locations
		}
	}

	set_variable = {
		name = al_govp_norm
		value = al_govp_norm_value
	}
	set_variable = {
		name = al_stab_norm
		value = al_stab_norm_value
	}
	set_variable = {
		name = al_state_score
		value = {
			value = var:al_govp_norm
			add = var:al_stab_norm
			divide = 2
		}
	}
	set_variable = {
		name = al_state_mult
		value = {
			value = al_ca_state_min
			add = {
				value = 1
				subtract = al_ca_state_min
				multiply = var:al_state_score
			}
		}
	}
	set_variable = {
		name = al_tr_mult
		value = {
			value = 1
			add = {
				value = al_ca_tr_coeff
				multiply = var:tr
			}
		}
	}

	set_variable = { name = la value = var:al_local_base }
	set_variable = {
		name = ca
		value = {
			value = var:al_capital_base
			multiply = var:al_state_mult
			multiply = var:al_tr_mult
			ceiling = yes
		}
	}
	set_variable = { name = la value = var:la }
	set_variable = { name = ca value = var:ca }
	set_variable = { name = LA value = var:la }
	set_variable = { name = CA value = var:ca }
	set_variable = {
		name = na
		value = {
			value = var:ca
			subtract = var:la
		}
	}
	change_variable = { name = ta add = var:na }
	set_variable = { name = ta value = var:ta }
	set_variable = { name = TA value = var:ta }

	set_variable = { name = al_tr_candidate value = 0 }
	if = {
		limit = { var:ta >= al_tr_threshold_15 is_independent_or_autonomous_subject = yes }
		set_variable = { name = al_tr_candidate value = 15 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_14 is_independent_or_autonomous_subject = yes }
		set_variable = { name = al_tr_candidate value = 14 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_13 is_independent_or_autonomous_subject = yes }
		set_variable = { name = al_tr_candidate value = 13 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_12 is_independent_or_autonomous_subject = yes }
		set_variable = { name = al_tr_candidate value = 12 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_11 is_independent_or_autonomous_subject = yes }
		set_variable = { name = al_tr_candidate value = 11 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_10 }
		set_variable = { name = al_tr_candidate value = 10 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_9 }
		set_variable = { name = al_tr_candidate value = 9 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_8 }
		set_variable = { name = al_tr_candidate value = 8 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_7 }
		set_variable = { name = al_tr_candidate value = 7 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_6 }
		set_variable = { name = al_tr_candidate value = 6 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_5 }
		set_variable = { name = al_tr_candidate value = 5 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_4 }
		set_variable = { name = al_tr_candidate value = 4 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_3 }
		set_variable = { name = al_tr_candidate value = 3 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_2 }
		set_variable = { name = al_tr_candidate value = 2 }
	}
	else_if = {
		limit = { var:ta >= al_tr_threshold_1 }
		set_variable = { name = al_tr_candidate value = 1 }
	}

	if = {
		limit = { var:al_tr_candidate > var:tr }
		set_variable = { name = tr value = var:al_tr_candidate }
	}
	else = {
		if = {
			limit = { var:tr = 15 var:ta < al_tr_demote_15 }
			set_variable = { name = tr value = 14 }
		}
		else_if = {
			limit = { var:tr = 14 var:ta < al_tr_demote_14 }
			set_variable = { name = tr value = 13 }
		}
		else_if = {
			limit = { var:tr = 13 var:ta < al_tr_demote_13 }
			set_variable = { name = tr value = 12 }
		}
		else_if = {
			limit = { var:tr = 12 var:ta < al_tr_demote_12 }
			set_variable = { name = tr value = 11 }
		}
		else_if = {
			limit = { var:tr = 11 var:ta < al_tr_demote_11 }
			set_variable = { name = tr value = 10 }
		}
		else_if = {
			limit = { var:tr = 10 var:ta < al_tr_demote_10 }
			set_variable = { name = tr value = 9 }
		}
		else_if = {
			limit = { var:tr = 9 var:ta < al_tr_demote_9 }
			set_variable = { name = tr value = 8 }
		}
		else_if = {
			limit = { var:tr = 8 var:ta < al_tr_demote_8 }
			set_variable = { name = tr value = 7 }
		}
		else_if = {
			limit = { var:tr = 7 var:ta < al_tr_demote_7 }
			set_variable = { name = tr value = 6 }
		}
		else_if = {
			limit = { var:tr = 6 var:ta < al_tr_demote_6 }
			set_variable = { name = tr value = 5 }
		}
		else_if = {
			limit = { var:tr = 5 var:ta < al_tr_demote_5 }
			set_variable = { name = tr value = 4 }
		}
		else_if = {
			limit = { var:tr = 4 var:ta < al_tr_demote_4 }
			set_variable = { name = tr value = 3 }
		}
		else_if = {
			limit = { var:tr = 3 var:ta < al_tr_demote_3 }
			set_variable = { name = tr value = 2 }
		}
		else_if = {
			limit = { var:tr = 2 var:ta < al_tr_demote_2 }
			set_variable = { name = tr value = 1 }
		}
		else_if = {
			limit = { var:tr = 1 var:ta < al_tr_demote_1 }
			set_variable = { name = tr value = 0 }
		}
	}

	if = {
		limit = { NOT = { is_independent_or_autonomous_subject = yes } var:tr > 10 }
		set_variable = { name = tr value = 10 }
	}
}