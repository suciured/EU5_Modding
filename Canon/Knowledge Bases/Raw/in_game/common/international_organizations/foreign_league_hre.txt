foreign_league_hre = {
	has_target = no
	unique = yes
	show_on_diplomatic_map = yes
	expel_members_who_are_targets_of_other_members = yes
	expel_members_who_are_attackers_at_war_with_other_members = yes
	expel_members_who_are_defenders_at_war_with_other_members = yes

	leader_color = define:NMapColors|INTERNATIONAL_ORGANIZATION_LEADER_COLOR
	#member_color = rgb { 188 213 188 }

	has_leader_country = yes
	leader_type = country
	disband_if_no_leader = yes
	land_ownership_rule = italian_wars_land_ownership
	non_leader_modifier = {
		block_from_change_to_empire_rank = yes
	}

	on_creation = {
		add_to_global_variable_list = {
			name = iw_foreign_leagues_list
			target = root 
		}
	}

	on_disband = {   
		remove_list_global_variable = { name = iw_foreign_leagues_list target = root }
	}
	
	#Yes. but you will be removed from the League
	can_declare_war = {
		trigger_if = {
			limit = { scope:attacker ?= { is_member_of_international_organization = scope:recipient } }
			scope:defender ?= { NOT = { is_member_of_international_organization = scope:recipient } }
		}
		trigger_else = {
			always = yes
		}
	}
	
	has_military_access = {
		scope:recipient ?= {
			is_member_of_international_organization = root
		}
		scope:actor ?= {
			is_member_of_international_organization = root
		}
	}

	#Even if the leader is not an Empire, they will have access to these actions
	leader_modifier = {
		allowed_intervene_in_war = yes
		allowed_enforce_peace = yes
	}
	
	create_visible_trigger = {
		always = no
	}

	invite_visible_trigger = {
		always = yes
	}

	can_join_trigger = {
		NOR = {
			is_leader_of_international_organization = international_organization:italian_league_1
			is_leader_of_international_organization = international_organization:foreign_league_france
			is_leader_of_international_organization = international_organization:foreign_league_iberia
			is_leader_of_international_organization = international_organization:italian_league_3
			is_leader_of_international_organization = international_organization:italian_league_2
		}
		at_war = no
		is_rebel_country = no
		religion.group = religion_group:christian
		trigger_if = {
			limit = {
				NOT = { tag = PAP }
			}
			capital.region = region:italy_region
			country_rank_level < 4
		}
		trigger_if = {
			limit = { is_subject = no }
			NOT = { has_cooldown = join_a_league }	
		}
		trigger_else = {
			scope:recipient ?= {
				any_international_organization_member = {
					root = { is_subject_or_below_of = prev }
				}
			}
		}
	}

	on_joined = {
		if = {
			limit = { is_member_of_international_organization = international_organization:foreign_league_france }
			international_organization:foreign_league_france = {
				remove_country_from_international_organization = root
			}
		}
		if = {
			limit = { is_member_of_international_organization = international_organization:foreign_league_iberia }
			international_organization:foreign_league_iberia = {
				remove_country_from_international_organization = root
			}
		}
		if = {
			limit = { is_member_of_international_organization = international_organization:italian_league_1 }
			international_organization:italian_league_1 = {
				remove_country_from_international_organization = root
			}
		}
		if = {
			limit = { is_member_of_international_organization = international_organization:italian_league_2 }
			international_organization:italian_league_2 = {
				remove_country_from_international_organization = root
			}
		}
		if = {
			limit = { is_member_of_international_organization = international_organization:italian_league_3 }
			international_organization:italian_league_3 = {
				remove_country_from_international_organization = root
			}
		}
		
		every_owned_location = {
			limit = { region = region:italy_region }
			scope:recipient = {
				add_location_to_international_organization = prev
			}
		}
		add_cooldown = {
			type = join_a_league
			years = 2
		}
	}

	on_left = {
		every_owned_location = {
			limit = { region = region:italy_region }
			scope:recipient = {
				remove_location_from_international_organization = prev
			}
		}
	}
	
	#You cannot leave it while locked in a war next to a fellow League member
	can_leave_trigger = {
		OR = {
			NOT = { is_subject_of = scope:recipient.leader_country }
			AND = {
				is_subject = yes
				subject_loyalty < 50
			}
		}
	}
	
	auto_leave_trigger = {
		OR = {
			is_at_war_with = scope:recipient.leader_country
			AND = {
				is_subject = yes 
				exists = top_overlord
				NOT = { 
					top_overlord = { is_member_of_international_organization = scope:recipient }
				}
			}
		}
	}
	
	auto_disband_trigger = {
		total_members < 1
	}
	
	monthly_effect = {
		#auto-join anyone who becomes subject or tributary of China
		every_international_organization_member = {
			limit = {
				any_subject = {
					NOT = { is_member_of_international_organization = root }
					can_join_international_organization = root
					subject_loyalty >= 50
				}
			}
			every_subject = {
				limit = {
					NOT = { is_member_of_international_organization = root }
					can_join_international_organization = root
					subject_loyalty >= 50
				}
				if = {
					limit = { is_member_of_international_organization = international_organization:foreign_league_france }
					international_organization:foreign_league_france = {
						remove_country_from_international_organization = prev
					}
				}
				if = {
					limit = { is_member_of_international_organization = international_organization:foreign_league_iberia }
					international_organization:foreign_league_iberia = {
						remove_country_from_international_organization = prev
					}
				}
				if = {
					limit = { is_member_of_international_organization = international_organization:italian_league_1 }
					international_organization:italian_league_1 = {
						remove_country_from_international_organization = prev
					}
				}
				if = {
					limit = { is_member_of_international_organization = international_organization:italian_league_2 }
					international_organization:italian_league_2 = {
						remove_country_from_international_organization = prev
					}
				}
				if = {
					limit = { is_member_of_international_organization = international_organization:italian_league_3 }
					international_organization:italian_league_3 = {
						remove_country_from_international_organization = prev
					}
				}
				
				every_owned_location = {
					limit = { region = region:italy_region }
					root = {
						add_location_to_international_organization = prev
					}
				}
				add_cooldown = {
					type = join_a_league
					years = 2
				}
				root = { add_country_to_international_organization = prev }
			}
		}
	}

	ai_desire_to_join = {
		
		add = {
			desc = "OPINION_OF_FRANCE_LEADER"
			value = {
				scope:actor = {
					root = {
						value = this_opinion_of_prev
						multiply = 0.4
					}
				}
			}
		}
		add = {
			desc = "IO_LEADER_DIP_REP"
			scope:recipient = {
				value = scope:actor.modifier:diplomatic_reputation
				multiply = 5
			}
		}
		if = {
			limit = {
				scope:recipient = {
					OR = {
						this = international_organization:foreign_league_france
						this = international_organization:foreign_league_iberia
						this = international_organization:foreign_league_hre
					}
				}
			}
			add = {
				value = -25
				desc = "FOREIGN_LEAGUE"
			}
			add = {
				desc = "IW_BALANCE_OF_POWER"
				value = scope:recipient.total_members
				multiply = -5
			}
		}
		scope:recipient = {
			if = {
				limit = {
					any_international_organization_member = {
						giving_scripted_relation = {
							type = relation_type:alliance
							target = root
						}
					}
				}
				every_international_organization_member = {
					limit = {
						giving_scripted_relation = {
							type = relation_type:alliance
							target = root
						}
					}
					add = {
						value = 5
						desc = "IO_HOSTS_FRIENDS"
					}
				}
			}
			if = {
				limit = {
					OR = {
						is_rival_of = root
						is_enemy_of = root
					}
				}
				every_international_organization_member = {
					limit = {
						OR = {
							is_rival_of = root
							is_enemy_of = root
						}
					}
					add = {
						value = -20
						desc = "IO_HOSTS_ENEMIES_OR_RIVALS"
					}
				}
			}
		}
		subtract = {
			desc = "IO_LEADER_ANTAGONISM"
			scope:actor = {
				root = {
					value = this_antagonism_towards_prev
					multiply = 2
				}
			}
		}
		add = {
			value = -10
			desc = "FOREIGN_LEAGUE"
		}
		add = {
			desc = "IW_BALANCE_OF_POWER"
			value = scope:recipient.total_members
			multiply = -5
		}
		if = {
			limit = {
				any_international_organizations_member_of = {
					OR = {
						this = international_organization:italian_league_1
						this = international_organization:italian_league_2
						this = international_organization:italian_league_3
						this = international_organization:foreign_league_france
						this = international_organization:foreign_league_iberia
					}
				}
			}
			subtract = {
				value = 10
				desc = "ALREADY_MEMBER_OF_LEAGUE"
			}
			if = {
				limit = { is_member_of_international_organization = international_organization:italian_league_1 }
				international_organization:italian_league_1 = {
					leader_country = {
						subtract = {
							desc = "CURRENT_LEAGUE_LEADER_OPINION"
							root = {
								value = "opinion(prev)"
							}
						}
						subtract = {
							value = modifier:diplomatic_reputation
							multiply = 5
							desc = "CURRENT_LEAGUE_LEADER_DIP_REP"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							giving_scripted_relation = {
								type = relation_type:alliance
								target = root
							}
						}
						subtract = {
							value = 5
							desc = "CURRENT_IO_HOSTS_FRIENDS"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							OR = {
								is_rival_of = root
								is_enemy_of = root
							}
						}
						add = {
							value = 20
							desc = "CURRENTIO_HOSTS_ENEMIES_OR_RIVALS"
						}
					}
				}
			}
			else_if = {
				limit = { is_member_of_international_organization = international_organization:italian_league_2 }
				international_organization:italian_league_2 = {
					leader_country = {
						subtract = {
							desc = "CURRENT_LEAGUE_LEADER_OPINION"
							root = {
								value = "opinion(prev)"
							}
						}
						subtract = {
							value = modifier:diplomatic_reputation
							multiply = 5
							desc = "CURRENT_LEAGUE_LEADER_DIP_REP"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							giving_scripted_relation = {
								type = relation_type:alliance
								target = root
							}
						}
						subtract = {
							value = 5
							desc = "CURRENT_IO_HOSTS_FRIENDS"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							OR = {
								is_rival_of = root
								is_enemy_of = root
							}
						}
						add = {
							value = 20
							desc = "CURRENTIO_HOSTS_ENEMIES_OR_RIVALS"
						}
					}
				}
			}
			else_if = {
				limit = { is_member_of_international_organization = international_organization:italian_league_3 }
				international_organization:italian_league_3 = {
					leader_country = {
						subtract = {
							desc = "CURRENT_LEAGUE_LEADER_OPINION"
							root = {
								value = "opinion(prev)"
							}
						}
						subtract = {
							value = modifier:diplomatic_reputation
							multiply = 5
							desc = "CURRENT_LEAGUE_LEADER_DIP_REP"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							giving_scripted_relation = {
								type = relation_type:alliance
								target = root
							}
						}
						subtract = {
							value = 5
							desc = "CURRENT_IO_HOSTS_FRIENDS"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							OR = {
								is_rival_of = root
								is_enemy_of = root
							}
						}
						add = {
							value = 20
							desc = "CURRENTIO_HOSTS_ENEMIES_OR_RIVALS"
						}
					}
				}
			}
			else_if = {
				limit = { is_member_of_international_organization = international_organization:foreign_league_france }
				international_organization:foreign_league_france = {
					leader_country = {
						subtract = {
							desc = "CURRENT_LEAGUE_LEADER_OPINION"
							root = {
								value = "opinion(prev)"
							}
						}
						subtract = {
							value = modifier:diplomatic_reputation
							multiply = 5
							desc = "CURRENT_LEAGUE_LEADER_DIP_REP"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							giving_scripted_relation = {
								type = relation_type:alliance
								target = root
							}
						}
						subtract = {
							value = 5
							desc = "CURRENT_IO_HOSTS_FRIENDS"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							OR = {
								is_rival_of = root
								is_enemy_of = root
							}
						}
						add = {
							value = 20
							desc = "CURRENTIO_HOSTS_ENEMIES_OR_RIVALS"
						}
					}
				}
			}
			else = {
				international_organization:foreign_league_iberia = {
					leader_country = {
						subtract = {
							desc = "CURRENT_LEAGUE_LEADER_OPINION"
							root = {
								value = "opinion(prev)"
							}
						}
						subtract = {
							value = modifier:diplomatic_reputation
							multiply = 5
							desc = "CURRENT_LEAGUE_LEADER_DIP_REP"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							giving_scripted_relation = {
								type = relation_type:alliance
								target = root
							}
						}
						subtract = {
							value = 5
							desc = "CURRENT_IO_HOSTS_FRIENDS"
						}
					}
					every_international_organization_member = {
						limit = {
							this != root
							OR = {
								is_rival_of = root
								is_enemy_of = root
							}
						}
						add = {
							value = 20
							desc = "CURRENTIO_HOSTS_ENEMIES_OR_RIVALS"
						}
					}
				}
			}
		}
	}
	
	ai_desire_to_allow_new_member = {
		add = {
			desc = "WE_WANT_THE_ORGANIZATION_TO_GROW"
			value = 5
		}
		subtract = {
			desc = "CONQUEST_DESIRE_ON_US"
			value = "root.leader_country.conquer_desire(scope:actor)"
		}
	}
}
