# template LobbyViewBackground
# {
# 	texture = "gfx/interface_old/from_sulla/marble_tile_l.dds"
# 	spriteType = Corneredtiled
# 	spriteborder = { 0 0 }
# 	margin = { -6 -6 }
# 	shaderfile = "gfx/FX/pdxgui_default.shader"
# }

template LobbyViewModuleBackground {
	# block "modulebackgroundstyle" {
		shaderfile = "gfx/FX/pdxgui_default.shader"
		texture = "gfx/editor_gui/editor_field.dds"
		spriteType = CorneredStretched
		spriteborder = { 6 6 }
	# }
}

# template LobbyMapModeButton
# {
# 	onclick = "[MapMode.SetMapMode]"
# 	input_action = "[MapMode.GetInputAction]"
# 	use_global_input_instance = yes
# 	raw_text = "[MapMode.GetName]"
# 	tooltip = "[MapMode.GetTooltip]"

# 	modify_texture = {
# 		visible = "[MapMode.IsActive]"
# 		using = color_gold_texture
# 		alpha = 0.4
# 	}
# }

template unique_content_item_header_bg {
	using = bg_card_header_01_advances
	blockoverride "header_advances_extra" {
		visible = "[UniqueContentItem.IsAdvanceDefinition]"
	}

	using = bg_card_header_01_government
	blockoverride "header_government_extra" {
		visible = "[Or4(UniqueContentItem.IsGovernmentReform, UniqueContentItem.IsEstatePrivilege, UniqueContentItem.IsLaw, UniqueContentItem.IsCabinetAction)]"
	}

	using = bg_card_header_01_military
	blockoverride "header_military_extra" {
		visible = "[Or(UniqueContentItem.IsLevySetup, UniqueContentItem.IsSubUnitDef)]"
	}

	using = bg_card_header_01_production
	blockoverride "header_production_extra" {
		visible = "[UniqueContentItem.IsBuildingType]"
	}

	using = bg_card_header_01_diplomacy
	blockoverride "header_diplomacy_extra" {
		visible = "[UniqueContentItem.IsCountryInteraction]"
	}

	blockoverride "graphical_culture_pattern_texture" {
		texture = "[GetGraphicalCultureTextureForCountry('header_pattern', LobbyView.GetSelectedPlayable.GetCountry.Self)]"
	}
}

template unit_type_illustration_playable {
	tooltipwidget = {
		using = SubUnitType_tooltip
	}

	masked_threecolor_icon = {
		visible = "[Not(SubUnitType.GetCategory.IsArmy)]"
		texture = "[GetSubunitTypeIllustration(SubUnitType.Self, Playable.GetJominiPlayableCountryRef.GetCulture)]"
		size = { 100% 100% }
		texture_density = 2
		spriteborder = { 0 0 }
		frame_grid = {3 1}
		frame = 2
		mask =  "[GetSubunitTypeIllustrationMask(SubUnitType.Self, Playable.GetJominiPlayableCountryRef.GetCulture)]"
		primary_color = "[GetCountryUnitPrimaryColor(Playable.GetJominiPlayableCountryRef, SubUnitType.Self)]"
		secondary_color = "[GetCountryUnitSecondaryColor(Playable.GetJominiPlayableCountryRef, SubUnitType.Self)]"
		tertiary_color = "[GetCountryUnitTertiaryColor(Playable.GetJominiPlayableCountryRef, SubUnitType.Self)]"
	}
	masked_threecolor_icon = {
		visible = "[SubUnitType.GetCategory.IsArmy]"
		texture = "[GetSubunitTypeIllustration(SubUnitType.Self, Playable.GetJominiPlayableCountryRef.GetCulture)]"
		size = { 100% 100% }
		texture_density = 2
		spriteborder = { 0 0 }
		frame_grid = {3 1}
		frame = 1
		mask =  "[GetSubunitTypeIllustrationMask(SubUnitType.Self, Playable.GetJominiPlayableCountryRef.GetCulture)]"
		primary_color = "[GetCountryUnitPrimaryColor(Playable.GetJominiPlayableCountryRef, SubUnitType.Self)]"
		secondary_color = "[GetCountryUnitSecondaryColor(Playable.GetJominiPlayableCountryRef, SubUnitType.Self)]"
		tertiary_color = "[GetCountryUnitTertiaryColor(Playable.GetJominiPlayableCountryRef, SubUnitType.Self)]"
	}
	icon = {
		parentanchor = center
		ignore_layout = yes
		size = {100% 100%}
		texture = "gfx/interface/component_masks/mask_events_texture_full.dds"
		spriteType = corneredstretched
		spriteborder = {60 60}
		texture_density = 2
		alpha = 0.6
		modify_texture = {
			using = color_dark_brown_texture
		}
	}
}

template LobbyTopbarBg {
	screen_grab = {
		visible = "[Not(IsScreenGrabWorking)]"
		id = "shared_background"
		texture_ref = "ScreenGrabTexture0"
		constant_buffer_ref = "ScreenGrabConstants0"
		fullscreen = yes
		post_effect = Blur
	}

	background = {
		using = color_dark_blue_texture
		alpha = 0.9
	}

	background = {
		using = color_light_blue_texture
		alpha = 0.1
	}

	background = {
		using = tile_background_squared_texture

		modify_texture = {
			using = color_bg_blue_texture
		}

		modify_texture = {
			visible = "[Not(LobbyView.HasSelectedPlayable)]"
			texture = "gfx/interface/component_overlay/striped_texture.dds"
			texture_density = 2
			spriteType = corneredtiled
			spriteborder = { 0 0 }
			blend_mode = overlay
		}

		modify_texture = {
			visible = "[LobbyView.HasSelectedPlayable]"
			texture = "[GetGraphicalCultureTextureForCountry('top_bar_bg', LobbyView.GetSelectedPlayable.GetCountry.Self)]"
			texture_density = 2
			spriteType = corneredtiled
			spriteborder = { 0 0 }
			blend_mode = overlay
			alpha = 0.3
		}
	}

	background = {
		using = tile_frame_horizontal_texture
		alpha = 1

		modify_texture = {
			using = color_new_gold_texture
			blend_mode = overlay
		}
		modify_texture = {
			using = color_bg_blue_texture
			blend_mode = overlay
			alpha = 0.2
		}
		modify_texture = {
			using = color_purple_texture
			blend_mode = multiply
			alpha = 0.2
		}
	}
}

types MultiplayerLobby
{
	# type LobbyViewTitle = textbox {
	# 	size = { 100% 24 }
	# 	using = Font_Type_Standard
	# 	position = { 0 10 }
	# 	align = center
	# }

	type LobbySubHeader = widget {
		layoutpolicy_horizontal = expanding
		size = { -1 30 }

		hbox = {
			margin_right = 10
			layoutpolicy_horizontal = expanding

			hbox = {
				layoutpolicy_horizontal = expanding
				margin = { 10 5 }
				using = bg_name_banner_left
				text_single = {
					layoutpolicy_horizontal = expanding
					autoresize = no
					align = nobaseline
					using = Font_Type_Headers

					block "text" {
						using = text_default_text_template
					}
				}
			}
		}
	}

	type unique_content_item_specific = hbox {

		# ADVANCE
		widget = {
			size = {40 40}
			visible = "[UniqueContentItem.IsAdvanceDefinition]"
			datacontext = "[UniqueContentItem.GetAdvanceDefinition]"

			using = background_advance
			icon = {
				parentanchor = center
				size = {70% 70%}
				texture = "[GetAdvanceIcon(AdvanceDefinition.Self)]"
			}
		}

		# LAW
		icon = {
			visible = "[UniqueContentItem.IsLaw]"
			size = {35 35}
			texture = "[GetLawIcon(UniqueContentItem.GetLaw)]"
		}

		# BUILDING
		icon = {
			visible = "[UniqueContentItem.IsBuildingType]"
			size = {35 35}
			texture = "[GetBuildingIcon(UniqueContentItem.GetBuildingType)]"
		}

		# COUNTRY INTERACTIONS
		icon = {
			visible = "[UniqueContentItem.IsCountryInteraction]"
			size = {35 35}
			texture = "gfx/interface/icons/flat_icons/tabicons/diplomacy.dds"
		}

		# SUBUNIT DEFINITION
		widget = {
			size = {35 45}
			visible = "[UniqueContentItem.IsSubUnitDef]"
			datacontext = "[UniqueContentItem.GetSubUnitDef]"
			datacontext = "[LobbyView.GetSelectedPlayable]"
			using = unit_type_illustration_playable

		}

		# LEVY SETUP
		# widget = {
		# 	size = {35 45}
		# 	visible = "[UniqueContentItem.IsLevySetup]"
		# 	datacontext = "[UniqueContentItem.GetLevySetup.GetUnit]"
		# 	datacontext = "[LobbyView.GetSelectedPlayable]"
		# 	using = unit_type_illustration_playable
		# }

		# CABINET ACTION
		widget = {
			visible = "[UniqueContentItem.IsCabinetAction]"
			datacontext = "[UniqueContentItem.GetCabinetAction]"
			size = {35 35}
			cabinet_action_power = {
				parentanchor = center
				blockoverride "cabinet_action_power_size" {
					size = {23 23}
				}
			}
			# using = cabinet_action_tooltip_icon
			# blockoverride "cabinet_action_tooltip_icon_size"{
			# 	size = {100% 100%}
			# }
		}

		# GOV REFORM
		government_reform_icon = {
			visible = "[UniqueContentItem.IsGovernmentReform]"
			datacontext = "[UniqueContentItem.GetGovernmentReform]"
			size = { 32 45 }
		}

		# ESTATE PRIVILEGE
		widget = {
			size = { 32 45 }
			visible = "[UniqueContentItem.IsEstatePrivilege]"
			datacontext = "[UniqueContentItem.GetEstatePrivilege]"

			icon = {
				parentanchor = center
				size = { 90% 90% }
				texture = "[GetEstatePrivilegeIcon(EstatePrivilege.Self)]"
			}

			icon = {
				size = { 100% 100% }

				background = {
					texture = "gfx/interface/buttons/estate_privileges/frame_shadow_ep.dds"
					using = color_dark_brown
					texture_density = 2
				}

				background = {
					texture = "gfx/interface/buttons/estate_privileges/frame_2_ep.dds"
					using = color_dark_brown
					texture_density = 2
				}

				texture = "gfx/interface/buttons/estate_privileges/frame_1_ep.dds"
				texture_density = 2

				modify_texture = {
					using = color_new_gold_texture
					blend_mode = add
				}
			}
		}
	}

	type unique_content_item = widget {
		layoutpolicy_horizontal = expanding
		size = { -1 58 }
		using = bg_paper_card
		using = bg_cabinet_card_frame

		tooltip = "[UniqueContentItem.GetName]"
		tagtooltip_enabled = yes
		vbox = {
			margin = { 4 0 }
			margin_top = 4
			widget = {
				layoutpolicy_horizontal = expanding
				size = { -1 27 }
				using = unique_content_item_header_bg
			}

			expand = {}
		}
		hbox = {
			spacing = 5
			margin = { 10 4 }

			unique_content_item_specific = {}

			vbox = {
				layoutpolicy_horizontal = expanding
				text_single = {
					layoutpolicy_horizontal = expanding
					size = {-1 25}
					autoresize = no
					text = "[UniqueContentItem.GetName]"
				}
				text_single = {
					layoutpolicy_horizontal = expanding
					size = {-1 25}
					autoresize = no
					text = "[UniqueContentItem.GetLink]"
				}
			}

			icon = {
				size = { 30 30 }
				visible = "[UniqueContentItem.HasAge]"
				datacontext = "[UniqueContentItem.GetAge]"

				tooltipwidget = {
					using = Age_tooltip
				}
				# gfx\interface\icons\age
				texture = "[GetAgeIcon(Age.Self)]"
			}

			widget = {
				size = { 35 35 }
				visible = "[UniqueContentItem.IsLaw]"
				datacontext = "[UniqueContentItem.GetLaw]"
				icon = {
					parentanchor = center
					size = { 80% 80% }
					tooltip = "[Law.GetCategoryName]"
					texture = "[GetLawCategoryIcon(Law.GetCategory)]"
				}
			}

			widget = {
				size = { 35 35 }
				visible = "[UniqueContentItem.IsEstatePrivilege]"
				datacontext = "[UniqueContentItem.GetEstatePrivilege]"

				icon = {
					parentanchor = center
					size = { 100% 100% }
					datacontext = "[EstatePrivilege.GetType]"
					datacontext = "[GetNullUIAction]"
					tooltipwidget = {
						using = EstateType_tooltip
					}
					texture = "[GetEstateIcon(EstatePrivilege.GetType)]"
				}
			}
		}
	}

	# type PlayerlistWrapper = widget {
	# 	using = layoutpolicy_expanding
	# 	filter_mouse = left|right

	# 	widget = {
	# 		visible = "[LobbyView.HasServerInfo]"
	# 		size = { 100% 100% }
	# 	}
	# }

	type LobbyMultiplayerPanel = widget {
		size = { 430 -1 }
		layoutpolicy_vertical = expanding
		using = bg_main_inner_notabs_alt
		alwaystransparent = no
		filter_mouse = all

		vbox = {
			using = layoutpolicy_expanding
			margin_bottom = 25

			window_header_alt = {
				using = bg_main_inner_alt
				blockoverride "window_header_alt_color_texture"{
					using = color_default_brown_texture
				}

				blockoverride "header_text" {
					text = "LOBBY_MULTIPLAYER_SETTINGS"
				}
			}

			# TOP BUTTONS
			widget = {
				layoutpolicy_horizontal = expanding
				size = {-1 75}
				background = {
					using = color_black_texture
					alpha = 0.93

					using = color_dark_blue
					using = overlay_window
					using = overlay_leather
				}

				vbox = {
					margin = { 15 5 }
					spacing = 2

					# GAME SETTINGS
					hbox = {
						layoutpolicy_horizontal = expanding
						spacing = 5

						widget = {
							layoutpolicy_horizontal = expanding
							size = {-1 30}
							layoutstretchfactor_horizontal = 2
							editbox_single = {
								size = {100% 30}
								blockoverride "editbox_label" {
									text = "JOMINI_MULTIPLAYER_GUI_SERVER_NAME"
								}
								blockoverride "editbox_properties" {
									text = "[LobbyView.GetServerInfo.GetServerName]"
									tooltip_enabled = no
									oneditingfinished = "[LobbyView.SetName]"
									ontextedited = "[LobbyView.OnNameEdit]"
									enabled = "[CanEditSettingsAfterHost]"
								}
							}

							ui_direction_button = {
								size = { 22 22 }
								using = snd_UI_forward

								parentanchor = right|vcenter
								position = { -10 0 }

								texture = "gfx/interface/buttons/flats/button_simple.dds"
								mirror = horizontal
								texture_density = 2
								using = bg_circle

								enabled = "[CanEditSettingsAfterHost]"
								visible = "[CanEditSettingsAfterHost]"
								tooltipwidget = {BasicFunctionalTooltip = {}}

								action_tooltip = {
									click_type = left
									click_mode = single
									title = "JOMINI_MULTIPLAYER_GUI_CHANGE_SERVER_NAME"
									on_action = "[LobbyView.SetName]"
									enabled = "[CanEditSettingsAfterHost]"
								}
							}
						}

						widget = {
							visible = "[JominiIsHostOrLocal]"
							layoutpolicy_horizontal = expanding
							size = {-1 30}
							layoutstretchfactor_horizontal = 1
							editbox_single = {
								size = {100% 30}
								name = server_password # widget name is referenced in code, please no duplicates in this window
								password = yes

								blockoverride "editbox_label" {
									text = "JOMINI_MULTIPLAYER_GUI_SERVER_PASSWORD"
								}

								blockoverride "editbox_properties" {
									text = "[GameLobby.GetPassword]"
									tooltip_enabled = no
									oneditingfinished = "[GameLobby.SetPassword]"
									enabled = "[CanEditSettingsAfterHost]"
								}
							}

							ui_direction_button = {
								size = { 22 22 }
								using = snd_UI_forward

								parentanchor = right|vcenter
								position = { -10 0 }

								texture = "gfx/interface/buttons/flats/button_simple.dds"
								mirror = horizontal
								texture_density = 2
								using = bg_circle

								enabled = "[CanEditSettingsAfterHost]"
								visible = "[CanEditSettingsAfterHost]"
								tooltipwidget = {BasicFunctionalTooltip = {}}

								action_tooltip = {
									click_type = left
									click_mode = single
									title = "JOMINI_MULTIPLAYER_GUI_CHANGE_SERVER_PASSWORD"
									on_action = "[LobbyView.SetPassword]"
									enabled = "[CanEditSettingsAfterHost]"
								}
							}
						}
					}

					# GAME INFO
					hbox = {
						layoutpolicy_horizontal = expanding

						button_regular = {
							layoutpolicy_horizontal = expanding
							size = {-1 30}
							layoutstretchfactor_horizontal = 2
							visible = "[LobbyView.GetServerInfo.HasServerID]"
							text = "JOMINI_MULTIPLAYER_GUI_SERVER_ID"
							tooltipwidget = {BasicFunctionalTooltip = {}}

							action_tooltip = {
								click_type = left
								click_mode = single
								title = "COPY_SERVER_ID"
								on_action = "[LobbyView.CopyServerID]"
							}
						}

						widget = {
							layoutpolicy_horizontal = expanding
							layoutstretchfactor_horizontal = 1
							size = {-1 30}

							using = bg_text_mask_container_brown

							text_single = {
								layoutpolicy_horizontal = expanding
								align = center
								parentanchor = center

								text = "JOMINI_MULTIPLAYER_GUI_GAME_VERSION"
							}
						}
					}
				}
			}

			# TABS
			widget = {
				layoutpolicy_horizontal = expanding
				size = { -1 50 }

				background = {
					using = color_black_texture
					alpha = 0.93

					using = color_dark_blue
				}

				background = {
					using = bg_fade_vertical_up_mask_texture
					alpha = 0.3

					modify_texture = {
						using = color_black_texture
						blend_mode = multiply
					}
				}

				hbox = {
					margin_left = 10
					margin_right = 10
					margin_top = 10
					spacing = 5

					button_main_tab_alt = {
						layoutpolicy_horizontal = expanding
						name = "show_players"
						blockoverride "tab_text"{
							text = "JOMINI_MULTIPLAYER_GUI_SHOW_PLAYERS"
						}
						enabled = "[GameIsMultiplayer]"
						onclick = "[LobbyView.SetShowPlayerList('(bool)yes')]"
						down = "[LobbyView.ShowPlayerList]"
					}

					button_main_tab_alt = {
						using = layoutpolicy_expanding
						name = "show_settings"
						blockoverride "tab_text"{
							text = "JOMINI_MULTIPLAYER_GUI_SHOW_SETTINGS"
						}
						enabled = "[GameIsMultiplayer]"
						onclick = "[LobbyView.SetShowPlayerList( '(bool)no' )]"
						onclick = "[RefreshModsView]"
						down = "[Not(LobbyView.ShowPlayerList)]"
					}
				}
			}

			widget = {
				layoutpolicy_horizontal = expanding
				size = {-1 45}

				hbox = {
					margin = { 15 5 }

					# VISIBILITY PRIVATE
					widget = {
						layoutpolicy_vertical = expanding
						size = {100 -1}
						visible = "[LobbyView.GetServerInfo.IsInvite]"

						hbox = {
							hbox = {
								spacing = 10
								header_button_left = {
									size = {35 35}
									blockoverride "button_icon_stretch_sprite" {}
									blockoverride "header_button_frame_inner" {visible = no}
									blockoverride "header_button_icon_size" { size = { 30 30 } }
									blockoverride "header_button_text_layout" {}
									blockoverride "header_button_icon_obj" {
										icon = {
											size = { 27 27 }
											parentanchor = center
											texture = "gfx/interface/icons/map_subdivisons/locked.dds"
											glow = {
												name = "drop_shadow"
												glow_radius = 3
												color = {0.0 0.0 0.0 1.0}
												alpha = 0.3
											}

											modify_texture = {
												using = color_black_texture
												alpha = 0.4
												blend_mode = multiply
											}

											modify_texture = {
												using = color_new_gold_texture
												alpha = 0.8
											}
										}
									}

									enabled = "[CanEditSettingsAfterHost]"
									tooltipwidget = {BasicFunctionalTooltip = {}}

									action_tooltip = {
										click_type = left
										click_mode = single
										enabled = "[CanEditSettingsAfterHost]"
										title = "LOBBY_MULTIPLAYER_SETTINGS_TOGGLE_PUBLIC"
										on_action = "[LobbyView.ToggleVisibility]"
									}
								}

								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_PRIVATE"
									maximumsize = {80 25}
								}
							}

							expand = {}
						}
					}

					# VISIBILITY PUBLIC
					widget = {
						layoutpolicy_vertical = expanding
						size = {100 -1}
						visible = "[LobbyView.GetServerInfo.IsPublic]"

						hbox = {
							hbox = {
								spacing = 10
								header_button_left = {
									size = {35 35}
									blockoverride "button_icon_stretch_sprite" {}
									blockoverride "header_button_frame_inner" {visible = no}
									blockoverride "header_button_icon_size" { size = { 30 30 } }
									blockoverride "header_button_text_layout" {}
									blockoverride "header_button_icon_obj" {

										icon = {
											size = { 27 27 }
											parentanchor = center
											texture = "gfx/interface/icons/map_subdivisons/unlocked.dds"
											glow = {
												name = "drop_shadow"
												glow_radius = 3
												color = {0.0 0.0 0.0 1.0}
												alpha = 0.3
											}

											modify_texture = {
												using = color_black_texture
												alpha = 0.4
												blend_mode = multiply
											}

											modify_texture = {
												using = color_new_gold_texture
												alpha = 0.8
											}
										}
									}

									enabled = "[CanEditSettingsAfterHost]"

									tooltipwidget = {BasicFunctionalTooltip = {}}

									action_tooltip = {
										click_type = left
										click_mode = single
										enabled = "[CanEditSettingsAfterHost]"
										title = "LOBBY_MULTIPLAYER_SETTINGS_TOGGLE_PRIVATE"
										on_action = "[LobbyView.ToggleVisibility]"
									}
								}

								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_PUBLIC"
									maximumsize = {80 25}
								}
							}

							expand = {}
						}
					}

					expand = {}

					# HOT JOIN
					widget = {
						layoutpolicy_vertical = expanding
						size = {165 -1}
						visible = "[JominiIsHostOrLocal]"

						hbox = {
							hbox = {
								spacing = 5

								expand = {}
								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_AUTO_ACCEPT"
									maximumsize = {120 17}
								}

								checkbutton = {
									using = button_checkbox_template
									size = {35 35}
									name = "hotjoin_autoaccept"
									checked = "[LobbyView.IsAutoAccept]"
									onclick = "[LobbyView.ToggleAutoAccept]"
									enabled = "[CanEditSettingsAfterHost]"
									tooltipwidget = {LeftClickButtonTooltip = {blockoverride "onclick_text"{text = "JOMINI_MULTIPLAYER_GUI_AUTO_ACCEPT"}enabled = "[CanEditSettingsAfterHost]"}}
								}
							}
							tooltipwidget = {
								SimpleContextualTooltipType = {
									blockoverride "title_icon" {
										icon = {
											using = tooltip_title_icon_size
											texture = "gfx/interface/icons/players.dds"
										}
									}
									textcontext = "JOMINI_MULTIPLAYER_GUI_AUTO_ACCEPT_TT"
								}
							}
						}
					}
				}
			}
			widget = {
				layoutpolicy_horizontal = expanding
				size = {-1 45}

				hbox = {
					margin = { 15 5 }

					widget = {
						layoutpolicy_vertical = expanding
						size = {90 -1}

						text_single = {
							parentanchor = center
							text = "LOBBY_MULTIPLAYER_NUMBER_OF_PLAYERS"
							maximumsize = {80 25}
						}
					}

					expand = {}

					widget = {
						layoutpolicy_vertical = expanding
						size = {100 -1}

						text_single = {
							parentanchor = center
							text = "LOBBY_MULTIPLAYER_NUMBER_OF_PLAYERS_READY"
							maximumsize = {80 25}
						}
					}
				}
			}

			vbox = {
				using = layoutpolicy_expanding
				margin = {15 0}

				LobbyViewMPInfo = {
					using = layoutpolicy_expanding
					visible = "[And(GameIsMultiplayer, Not(LobbyView.ShowPlayerList))]"
				}

				LobbyViewPlayerList = {
					using = layoutpolicy_expanding
					visible = "[And(GameIsMultiplayer, LobbyView.ShowPlayerList)]"
				}

				expand = {}
			}

			expand = {}
		}

		window_bottom_paper_template = {}
	}

	type LobbyMultiplayerPanelNoServer = widget {
		size = { 430 -1 }
		layoutpolicy_vertical = expanding
		using = bg_main_inner_notabs_alt
		alwaystransparent = no
		filter_mouse = all

		vbox = {
			using = layoutpolicy_expanding
			spacing = 15
			margin_bottom = 25

			window_header_alt = {
				using = bg_main_inner_alt
				blockoverride "window_header_alt_color_texture"{
					using = color_default_brown_texture
				}

				blockoverride "header_text" {
					text = "LOBBY_MULTIPLAYER_GAME_TITLE"
				}
			}

			vbox = {
				margin = { 25 0 }
				layoutpolicy_horizontal = expanding

				subheader = {
					using = bg_name_banner
					blockoverride "content" {
						text_single = {
							using = layoutpolicy_expanding
							text = "JOMINI_MULTIPLAYER_GUI_GAME_SETTINGS"
							autoresize = yes
							align = nobaseline
							parentanchor = center
							using = Font_Type_Headers
						}
					}
				}

				vbox = {
					layoutpolicy_horizontal = expanding
					spacing = 15
					margin = { 10 0 }
					margin_top = 15

					editbox_single = {
						enabled = "[And(Not(GameIsMultiplayer), Not(HasHostError))]"
						layoutpolicy_horizontal = expanding
						blockoverride "editbox_label" {
							text = "JOMINI_MULTIPLAYER_GUI_SERVER_NAME"
						}
						blockoverride "editbox_properties" {
							name = "no_server_name" # widget name is referenced in code, please no duplicates in this window
							text = "[GetDefaultServerName]"
							tooltip_enabled = no
							maxcharacters = 64
							oneditingfinished = "[GameLobby.SetNameNoServer]"
						}
					}

					editbox_single = {
						layoutpolicy_horizontal = expanding
						password = yes

						blockoverride "editbox_label" {
							text = "JOMINI_MULTIPLAYER_GUI_SERVER_PASSWORD"
						}

						blockoverride "editbox_properties" {
							name = "no_server_password" # widget name is referenced in code, please no duplicates in this window
							tooltip_enabled = no
							maxcharacters = 64
							oneditingfinished = "[GameLobby.SetPasswordNoServer]"
						}
					}

					hbox = {
						layoutpolicy_horizontal = expanding
						minimumsize = {-1 36}
						spacing = 8
						margin = { 15 10 }
						using = bg_text_mask_container_dark_brown

						# VISIBILITY PRIVATE
						widget = {
							layoutpolicy_horizontal = expanding
							layoutstretchfactor_horizontal = 2
							size = {-1 40}
							visible = "[GameLobby.IsInvite]"

							hbox = {
								spacing = 8
								header_button_left = {
									size = {35 35}
									blockoverride "button_icon_stretch_sprite" {}
									blockoverride "header_button_frame_inner" {visible = no}
									blockoverride "header_button_icon_size" { size = { 30 30 } }
									blockoverride "header_button_text_layout" {}
									blockoverride "header_button_icon_obj" {
										icon = {
											size = { 27 27 }
											parentanchor = center
											texture = "gfx/interface/icons/map_subdivisons/locked.dds"
											glow = {
												name = "drop_shadow"
												glow_radius = 3
												color = {0.0 0.0 0.0 1.0}
												alpha = 0.3
											}

											modify_texture = {
												using = color_black_texture
												alpha = 0.4
												blend_mode = multiply
											}

											modify_texture = {
												using = color_new_gold_texture
												alpha = 0.8
											}
										}
									}

									enabled = "[CanEditSettingsAfterHost]"
									tooltipwidget = {BasicFunctionalTooltip = {}}

									action_tooltip = {
										click_type = left
										click_mode = single
										enabled = "[CanEditSettingsAfterHost]"
										title = "LOBBY_MULTIPLAYER_SETTINGS_TOGGLE_PUBLIC"
										on_action = "[GameLobby.ToggleVisibility]"
									}
								}

								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_PRIVATE"
									using = layoutpolicy_expanding
									autoresize = no
									align = left|nobaseline
								}
							}
						}

						# VISIBILITY PUBLIC
						widget = {
							layoutpolicy_horizontal = expanding
							layoutstretchfactor_horizontal = 2
							size = {-1 40}
							visible = "[Not(GameLobby.IsInvite)]"

							hbox = {
								spacing = 8
								header_button_left = {
									size = {35 35}
									blockoverride "button_icon_stretch_sprite" {}
									blockoverride "header_button_frame_inner" {visible = no}
									blockoverride "header_button_icon_size" { size = { 30 30 } }
									blockoverride "header_button_text_layout" {}
									blockoverride "header_button_icon_obj" {

										icon = {
											size = { 27 27 }
											parentanchor = center
											texture = "gfx/interface/icons/map_subdivisons/unlocked.dds"
											glow = {
												name = "drop_shadow"
												glow_radius = 3
												color = {0.0 0.0 0.0 1.0}
												alpha = 0.3
											}

											modify_texture = {
												using = color_black_texture
												alpha = 0.4
												blend_mode = multiply
											}

											modify_texture = {
												using = color_new_gold_texture
												alpha = 0.8
											}
										}
									}

									enabled = "[CanEditSettingsAfterHost]"

									tooltipwidget = {BasicFunctionalTooltip = {}}

									action_tooltip = {
										click_type = left
										click_mode = single
										enabled = "[CanEditSettingsAfterHost]"
										title = "LOBBY_MULTIPLAYER_SETTINGS_TOGGLE_PRIVATE"
										on_action = "[GameLobby.ToggleVisibility]"
									}
								}

								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_PUBLIC"
									using = layoutpolicy_expanding
									autoresize = no
									align = left|nobaseline
								}
							}
						}

						checkbutton = {
							using = button_checkbox_template
							onclick = "[GameLobby.ToggleAutoAccept]"
							checked = "[GameLobby.IsAutoAccept]"
							tooltipwidget = {LeftClickButtonTooltip = {blockoverride "onclick_text"{text = "JOMINI_MULTIPLAYER_GUI_AUTO_ACCEPT"}}}
						}

						text_single = {
							layoutstretchfactor_horizontal = 3
							using = layoutpolicy_expanding
							autoresize = no
							align = left|nobaseline
							text = "JOMINI_MULTIPLAYER_GUI_AUTO_ACCEPT"
							tooltipwidget = {
								SimpleContextualTooltipType = {
									blockoverride "title_icon" {
										icon = {
											using = tooltip_title_icon_size
											texture = "gfx/interface/icons/players.dds"
										}
									}
									textcontext = "JOMINI_MULTIPLAYER_GUI_AUTO_ACCEPT_TT"
								}
							}
						}
					}
				}

				expand = {}
			}

			hbox = {
				layoutpolicy_horizontal = expanding
				margin = { 35 0 }
				visible = "[And(Not(GameIsMultiplayer), Not(LobbyView.ShowHosting))]"
				button_regular = {
					layoutpolicy_horizontal = expanding
					size = {-1 40}
					visible = "[And(Not(GameIsMultiplayer), Not(LobbyView.ShowHosting))]"
					enabled = "[And(GameLobby.CanOpenMultiplayer, Not(HasHostError))]"
					text = "JOMINI_MULTIPLAYER_GUI_HOST_BUTTON"
					tooltipwidget = {BasicFunctionalTooltip = {}}
					action_tooltip = {
						click_type = left
						click_mode = single
						enabled = "[GameLobby.CanOpenMultiplayer]"
						on_action = "[GameLobby.OpenMultiplayer]"
						title = "JOMINI_MULTIPLAYER_GUI_HOST_BUTTON"
					}
				}
			}

			hbox = {
				layoutpolicy_horizontal = expanding
				margin = { 35 0 }
				visible = "[LobbyView.ShowHosting]"
				JominiLobbyViewHostingStatus = {
					margin = { 30 0 }
					minimumsize = { -1 50 }

					blockoverride "window_background" {}
					using = bg_text_mask_container_dark_brown

					blockoverride "setup_textbox" {
						using = text_multi_template
						align = center
					}
				}
			}

			hbox = {
				layoutpolicy_horizontal = expanding
				margin = { 35 0 }
				JominiLobbyViewHostError = {
					margin = { 30 0 }
					minimumsize = { -1 100 }

					blockoverride "window_background" {}
					using = bg_text_mask_container_dark_brown

					blockoverride "jomini_standard_textbox" {
						using = text_single_template
						align = center
					}

					blockoverride "lobbyview_button_size" {
						layoutpolicy_horizontal = fixed
						size = { 120 30 }
					}
				}
			}

			expand = {}
		}

		window_bottom_paper_template = {}
	}

	type LobbySelectedCountryPanel = widget {
		using = layoutpolicy_expanding
		alwaystransparent = no
		filter_mouse = all

		using = bg_main_inner_image_alt
		blockoverride "overall_bckg" {
			using = bg_main_inner_alt_base
		}

		background = {
			using = bg_vignette_mask_texture
			alpha = 0.5

			modify_texture = {
				using = color_black_texture
				blend_mode = multiply
			}
		}

		background = {
			texture = "[GetGraphicalCultureTextureForCountry('pattern_bevel_vertical_bis', LobbyView.GetSelectedPlayable.GetCountry.Self)]"
			texture_density = 2
			spriteType = corneredtiled
			spriteborder = { 12 0 }
			alpha = 0.4
		}

		vbox = {
			datacontext = "[LobbyView.GetSelectedPlayable.GetCountry]"
			datacontext = "[GameLobby.GetUniqueContentDescription]"
			margin = {10 0}
			margin_bottom = 10

			vbox = {
				layoutpolicy_horizontal = expanding
				spacing = 5

				hbox = {
					layoutpolicy_horizontal = expanding

					country_flag_big = {
						size = { 120 80 }
					}

					vbox = {
						layoutpolicy_horizontal = expanding
						widget = {
							layoutpolicy_horizontal = expanding
							size = {-1 40}
							using = bg_panel_bar
							blockoverride "bg_panel_bar_graphical_texture"{
								texture = "[GetGraphicalCultureTextureForCountry('panel_bar_corner_bg', Country.Self)]"
							}

							hbox = {
								margin = {10 0}
								spacing = 5

								text_single = {
									maximumsize = { 375 -1 }
									text = "[Country.GetLongNameWithNoTooltip]"
									using = Font_Type_Headers
									using = Font_Size_Big
									default_format = "#yellow_titles"
									align = center|nobaseline

									tooltipwidget = {
										using = CountryTooltip
									}
								}

								expand = {}
							}
						}

						# HEADER
						window_selection_header_alt = {
							blockoverride "window_header_fade"{
								modify_texture = {
									texture = "gfx/interface/component_masks/mask_fade_horizontal_middle.dds"
									blend_mode = alphamultiply
									alpha = 0.2
								}

								modify_texture = {
									texture = "gfx/interface/component_masks/mask_fadehorizontal_middle_thick.dds"
									blend_mode = alphamultiply
									alpha = 0.2
								}
							}
							blockoverride "header_text_object" {
								hbox = {
									margin = { 5 3 }

									hbox = {
										spacing = 7
										ignoreinvisible = yes
										margin = {5 0}
										layoutpolicy_vertical = expanding

										using = bg_paper_card
										using = bg_cabinet_card_frame

										# gov type
										icon = {
											size = { 25 25 }
											texture = "[GetGovernmentTypeIcon(Country.GetGovernment.GetGovernmentType)]"
											texture_density = 2

											datacontext = "[Country.GetGovernment.GetGovernmentType]"
											tooltipwidget = {
												using = GovernmentType_tooltip

												blockoverride "title_icon_texture" {
													texture = "[GetGovernmentTypeIcon(Country.GetGovernment.GetGovernmentType)]"
												}
											}
										}

										divider_flavor_01 = {
											size = {5 -1}
											blockoverride "divider_extras" {
												margin = {4 -4}
											}
										}

										# country type

										icon = {
											size = { 23 23 }
											texture = "[GetCountryTypeIcon(Country.Self)]"
											texture_density = 2

											tooltipwidget = {
												using = CountryType_tooltip
											}

											glow = {
												name = "drop_shadow"
												glow_radius = 3
												color = {0.0 0.0 0.0 1.0}
												alpha = 0.5
											}
										}

										divider_flavor_01 = {
											size = {5 -1}
											blockoverride "divider_extras" {
												margin = {4 -4}
											}
										}

										# country rank
										icon = {
											size = { 21 21 }
											texture = "[GetCountryRankIcon(Country.GetRank)]"
											texture_density = 2

											datacontext = "[Country.GetRank]"
											tooltipwidget = {
												using = CountryRank_tooltip
											}

											glow = {
												name = "drop_shadow"
												glow_radius = 3
												color = {0.0 0.0 0.0 1.0}
												alpha = 0.6
											}
										}
									}

									expand = {}

									# EVENTS
									hbox = {
										using = layoutpolicy_expanding
										maximumsize = { 85 -1 }
										using = bg_paper_card
										using = bg_cabinet_card_frame
										tooltipwidget = {
											ContextualTooltipType = {
												blockoverride "title_text" {
													text = "COUNTRY_EVENTS_SPECIFIC_LOBBY_DESCRIPTION_TT"
												}
												blockoverride "title_icon" {
													icon = {
														using = tooltip_title_icon_size
														texture = "gfx/interface/icons/events/history.dds"
													}
												}
												blockoverride "concept_link" {
													text = "[country|E]"
												}
												blockoverride "tooltip_content" {
													TooltipTextBlock = {
														blockoverride "text" {
															text = "[UniqueContentDescription.GetEventsUniqueContentDesc]"
														}
													}
												}
											}
										}
										hbox = {
											spacing = 3
											icon = {
												size = {20 20}
												texture = "gfx/interface/icons/events/history.dds"
											}

											text_single = {
												align = nobaseline
												size = {22 20}
												autoresize = no
												text = "[UniqueContentDescription.GetEventsAmountUniqueContent]"
											}
										}
									}

									# UNIQUE FLAVOR
									hbox = {
										using = layoutpolicy_expanding
										maximumsize = { 85 -1 }
										using = bg_paper_card
										using = bg_cabinet_card_frame
										tooltipwidget = {
											ContextualTooltipType = {
												blockoverride "title_text" {
													text = "COUNTRY_SPECIFIC_LOBBY_DESCRIPTION_TT"
												}
												blockoverride "title_icon" {
													icon = {
														using = tooltip_title_icon_size
														texture = "gfx/interface/icons/flat_icons/country.dds"
													}
												}
												blockoverride "concept_link" {
													text = "[country|E]"
												}
												blockoverride "tooltip_content" {
													TooltipTextBlock = {
														blockoverride "text" {
															text = "[UniqueContentDescription.GetUniqueContentFlavorLobbyDesc]"
														}
													}
												}
											}
										}
										hbox = {
											spacing = 3
											icon = {
												size = {20 20}
												texture = "gfx/interface/icons/flat_icons/country_bonus.dds"
											}

											text_single = {
												size = {22 20}
												autoresize = no
												align = nobaseline
												text = "[UniqueContentDescription.GetAmountUniqueContentFlavor]"
											}
										}
									}
								}
							}

							blockoverride "header_graphical_texture"{
								texture = "[GetGraphicalCultureTextureForCountry('top_header_bg', Country.Self)]"
							}
						}
					}
				}

				# OVERVIEW
				country_header = {
					blockoverride "country_header_size" {
						size = { -1 246 }
					}

					blockoverride "country_government_character_labels_align" {
						align = nobaseline
					}

					blockoverride "country_header_character_name" {
						visible = no
					}

					blockoverride "abilities_parent" {
						allow_outside = yes

						dynasty_shield_mid = {
							position = { 0 1 }
							parentanchor = vcenter|left
							visible = "[Character.HasDynasty]"
							datacontext = "[Character.GetDynasty]"

							blockoverride "size" {
								size = { 35 25 }
							}

							blockoverride "show_as_button" { visible = no }
							blockoverride "show_as_icon" { visible = yes }
						}
					}

					blockoverride "character_religion_visibility" {
						visible = no
					}

					blockoverride "abilities" {
						widget = {
							layoutpolicy_horizontal = expanding
							vbox = {
								hbox = {
									margin_left = 42
									margin_right = 10
									spacing = 2
									using = layoutpolicy_expanding
									text_single = {
										margin_top = 1
										using = Font_Type_Headers
										using = Font_Size_Medium
										default_format = "#yellow_titles"
										maximumsize = {270 -1}
										text = "[Character.GetNameToFit('(int32)29', '(bool)yes')]"
									}

									text_single = {
										fontsize = 18
										raw_text = " [Character.GetAge|T]"
										tooltipwidget = {
											using = AgeAndSex_tooltip
										}
									}

									gender_icon = {
										blockoverride "tooltip_override" {
											tooltipwidget = {
												using = AgeAndSex_tooltip
											}
										}
										size = { 20 20 }
									}

									expand = {}

									character_abilities = {
										blockoverride "abilities_bg" {
											background = {
												texture = "gfx/interface/component_tiles/square_tile.dds"
												texture_density = 2
												alpha = 0.3
												blend_mode = overlay
												modify_texture = {
													using = color_black_texture
													blend_mode = multiply
												}
											}
										}
									}
								}
							}
						}
					}

					blockoverride "character_title_left" {
						widget = {
							visible = "[LobbyView.GetSelectedPlayable.GetCountry.GetGovernment.HasActiveRegent]"
							size = { 45 35 }
							allow_outside = yes
							datacontext = "[LobbyView.GetSelectedPlayable.GetCountry.GetGovernment]"

							button = {
								parentanchor = center
								size = { 30 30 }
								texture = "gfx/interface/icons/character_roles/regent.dds"

								texture_density = 2
								mirror = horizontal
								tooltipwidget = {
									using = CurrentRegencyTooltip
								}
							}
						}
					}

					blockoverride "character_right_visible" {
						visible = no
					}

					blockoverride "character_dynasty_shield_visible" {
						visible = no
					}

					blockoverride "character_portait_extra" {
						portrait_standard_full_body_center_button = {
							parentanchor = bottom|hcenter
							position = { 0 -35 }
							size = { 250 220 }
							datacontext = "[Country.GetGovernment.GetRulerOrRegent]"
							blockoverride "character_contextmenu"{}
							blockoverride "portrait_click"{}
							blockoverride "rightclick"{}
						}
					}
					blockoverride "country_header_extra" {
						hbox = {
							layoutpolicy_horizontal = expanding
							parentanchor = bottom
							position = { 5 -50 }
							maximumsize = { -1 30 }
							righttoleft = yes
							spacing = 4
							datamodel = "[GameLobby.GetLeaderOfInternationalOrganizations]"
							item = {
								InternationalOrganizationFakeButton = {
									blockoverride "tooltip_content" {
										tooltipwidget = {
											BasicFunctionalTooltip = {
												blockoverride "tooltip_content" {
													TooltipTextBlock = {
														datacontext = "[InternationalOrganization]"
														textcontext = "LOBBYVIEW_IO_LEADER_TT"
													}
												}
											}
										}
									}
								}
							}
							expand = {}
						}
					}		
				}

				# PRIMARY CULTURE & POPULATION & PRIMARY RELIGION
				header_secondary_tabs = {
					blockoverride "content" {
						button_main_tab_alt = {
							using = layoutpolicy_expanding

							tooltipwidget = {
								using = SubTabCountryOverviewTooltip
							}

							down = "[GameLobby.IsCountryTabOverview]"

							onclick = "[GameLobby.SetCountryTabOverview]"
							blockoverride "tab_text"{
								text = "SUBTAB_COUNTRY_OVERVIEW"
							}
						}

						button_main_tab_alt = {
							using = layoutpolicy_expanding

							tooltipwidget = {
								using = SubTabCountryContentTooltip
							}

							down = "[GameLobby.IsCountryTabContent]"

							onclick = "[GameLobby.SetCountryTabContent]"
							blockoverride "tab_text"{
								text = "SUBTAB_COUNTRY_CONTENT"
							}
						}

						button_main_tab_alt = {
							using = layoutpolicy_expanding

							tooltipwidget = {
								using = SubTabCountryDescriptionTooltip
							}

							down = "[GameLobby.IsCountryTabDescription]"

							onclick = "[GameLobby.SetCountryTabDescription]"
							blockoverride "tab_text"{
								text = "SUBTAB_COUNTRY_DESCRIPTION"
							}
						}
					}
				}
			}

			subheader = {
				visible = "[GameLobby.IsCountryTabOverview]"
				blockoverride "subheader_background" {}
				blockoverride "content" {
					hbox = {
						margin = { 8 0 }
						spacing = 8

						# PRIMARY CULTURE
						widget = {
							size = { 34 34 }
							tagtooltip_enabled = yes
							tooltip = "[primary_culture|e]"

							icon = {
								size = { 40 40 }
								texture = "gfx/interface/icons/culture/primary_culture.dds"
								texture_density = 2
								alpha = 1
							}
						}

						vbox = {
							layoutpolicy_horizontal = expanding
							text_single = {
								layoutpolicy_horizontal = expanding
								text = "[primary_culture|e]"
								datacontext = "[Country.GetCulture]"
							}

							text_single = {
								layoutpolicy_horizontal = expanding
								align = nobaseline
								text = "[Country.GetCulture.GetName]"
							}
						}

						# hbox = {
						# 	spacing = 5
						# 	widget = {
						# 		size = { 24 24 }
						# 		tooltip = "[capital|e]"
						# 		tagtooltip_enabled = yes
						# 		icon = {
						# 			size = { 100% 100% }
						# 			using = icon_country_capital
						# 		}

						# 	}

						# 	text_single = {
						# 		autoresize = yes
						# 		align = right
						# 		raw_text = "[Country.GetCapital.GetName]"
						# 	}
						# }

						# PRIMARY RELIGION
						vbox = {
							layoutpolicy_horizontal = expanding
							text_single = {
								layoutpolicy_horizontal = expanding
								align = right
								text = "[primary_religion|e]"
							}

							text_single = {
								layoutpolicy_horizontal = expanding
								align = right|nobaseline
								text = "[Country.GetReligion.GetName]"
							}
						}

						widget = {
							size = { 34 34 }
							tagtooltip_enabled = yes
							tooltip = "[primary_religion|e]"
							icon = {
								size = { 34 34 }
								texture = "[GetReligionIcon(Country.GetReligion)]"
								texture_density = 2
							}
						}
					}
				}
			}

			subheader = {
				visible = "[GameLobby.IsCountryTabOverview]"
				blockoverride "subheader_background" {}
				blockoverride "content" {
					hbox = {
						# blockoverride "location_details_extra" {
						# 	spacing = 0
						# 	margin = {0 0}
						# }

						hbox = {
							using = layoutpolicy_expanding
							using = bg_text_mask_container_brown

							tooltipwidget = {
								using = towns_or_cities_tooltip
							}
							spacing = 5

							expand = {}
							text_single = {
								autoresize = yes
								align = right
								text = "[Country.GetOwnedLocationCount|L]"
							}
							icon = {
								size = { 24 24 }
								texture = "gfx/interface/icons/map_subdivisons/location.dds"
							}
							expand = {}
						}

						hbox = {
							using = layoutpolicy_expanding
							spacing = 5

							using = bg_text_mask_container_brown
							blockoverride "text_mask_extra" {
								alpha = 0.1
							}

							expand = {}
							text_single = {
								autoresize = yes
								align = right
								raw_text = "[Country.GetTotalPopulation]"
							}

							widget = {
								size = { 24 24 }
								datacontext = "[Country.GetPopulationChart.GetPopsPiechartWidget]"
								tooltipwidget = {

									ContextualTooltipType = {
										blockoverride "title_icon" {
											icon = {
												using = tooltip_title_icon_size
												using = icon_population
											}
										}

										blockoverride "title_text" {
											datacontext = "[Country]"
											text = "POPULATION_TOOLTIP_HEADER"
										}

										blockoverride "concept_link" {
											text = [population|E]
										}

										blockoverride "tooltip_content" {
											hbox = {
												layoutpolicy_horizontal = expanding
												visible = "[Not(Country.HasEnoughHistoricalPopulation)]"
												spacing = 10
												vbox = {
													using = layoutpolicy_expanding
													spacing = 10
													using = PopulationTooltipCharts
												}
											}

											hbox = {
												layoutpolicy_horizontal = expanding
												visible = "[Country.HasEnoughHistoricalPopulation]"
												spacing = 10
												ignoreinvisible = yes

												vbox = {
													using = layoutpolicy_expanding
													spacing = 10
													using = PopulationTooltipCharts
												}
											}
										}
									}
								}

								icon = {
									size = { 100% 100% }
									texture = "gfx/interface/icons/location_icons/population.dds"
								}
							}
							expand = {}
						}

						hbox = {
							spacing = 5
							using = layoutpolicy_expanding
							using = bg_text_mask_container_brown

							expand = {}
							text_single = {
								autoresize = yes
								align = right
								raw_text = "[Country.GetTotalTaxBase]"
							}

							widget = {
								size = { 24 24 }
								icon = {
									size = { 100% 100% }
									texture = "gfx/interface/icons/location_icons/tax_base.dds"
								}
								tooltip = "[tax_base|e]"
								tagtooltip_enabled = yes
							}
							expand = {}
						}
						hbox = {
							using = layoutpolicy_expanding
							tooltipwidget = { using = Army_size_tooltip }
							spacing = 5

							using = bg_text_mask_container_brown
							blockoverride "text_mask_extra" {
								alpha = 0.1
							}

							expand = {}
							text_single = {
								autoresize = yes
								align = right
								text = "[Country.GetTotalArmyStrengthAndPotentialLevies|L0]"
							}

							icon = {
								size = { 24 24 }
								texture = "gfx/interface/icons/unit_category/total_strength.dds"
							}
							expand = {}
						}
						hbox = {
							using = layoutpolicy_expanding
							tooltipwidget = { using = Navy_size_tooltip }
							spacing = 5

							using = bg_text_mask_container_brown

							expand = {}
							text_single = {
								autoresize = yes
								align = right
								text = "[Country.GetNavyStrength|0L]"
							}

							icon = {
								size = { 24 24 }
								texture = "gfx/interface/icons/flat_icons/declare_war/navy.dds"
							}
							expand = {}
						}
					}
					widget = {
						size = {100% 100%}
						ignore_layout = yes
						alwaystransparent = yes
						using = bg_cabinet_card_frame
					}
				}
			}

			scrollarea = {
				visible = "[GameLobby.IsCountryTabOverview]"
				using = layoutpolicy_expanding
				autoresizescrollarea = no
				scrollbarpolicy_horizontal = always_off

				scrollbar_vertical = {
					using = Scrollbar_Vertical
				}

				scrollwidget = {
					vbox = {
						using = layoutpolicy_expanding
						margin = { 7 0 }
						spacing = 10

						# SOCIETY PIECHARTS
						hbox = {
							layoutpolicy_horizontal = expanding
							vbox = {
								datacontext = "[Country.GetPopulationChart.GetPopsPiechartWidget]"
								margin_top = 10
								spacing = 10

								using = PopulationCultureTooltipChart
								blockoverride "population_culture_tooltip_bg"{
									using = bg_paper_card
									using = bg_cabinet_card_frame
								}

								using = PopulationReligionTooltipChart
								blockoverride "piechart_religion_icon" {
									texture = "[GetReligionIcon(Country.GetReligion)]"
								}
								blockoverride "population_religion_tooltip_bg"{
									using = bg_paper_card
									using = bg_cabinet_card_frame
								}

								blockoverride "scrollarea_pie_size" {
									size = { 360 145 }
								}

								blockoverride "scrollarea_pie_bg" {
									using = bg_dark_paper_card
								}
								blockoverride "icon_pie_left_extra" {
									widget = {
										size = {85% 85%}
										parentanchor = center
										alwaystransparent = yes
										ignore_layout = yes
										using = bg_number_container_bckg
										using = bg_frame_squared_brown
									}
								}
							}
							expand = {}
						}

						# RELATIONS

						filtered_sorted_list = {
							datacontext = "[GameLobby.GetDiplomaticRelationsSortSearch]"

							blockoverride "scroll_list_layout" {
								# addcolumn = 100%
								# addrow = 45
								vbox = {
									layoutpolicy_horizontal = expanding
									spacing = 10
									margin_left = 7

									vbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10
										hbox = {
											visible = "[Not(IsDataModelEmpty(GameLobby.GetMemberOfInternationalOrganizations))]"
											layoutpolicy_horizontal = expanding

											header_paper_card_horizontal = {
												blockoverride "header_paper_card_size"{
													layoutpolicy_horizontal = expanding
													size = { -1 45 }
												}
												layoutpolicy_horizontal = expanding

												using = bg_cabinet_card_frame

												blockoverride "bg_card_header_01_bg" {
													background = {
														texture = "gfx/interface/component_tiles/square_tile.dds"
														texture_density = 2
														spriteType = corneredtiled
														spriteborder = { 10 10 }

														modify_texture = {
															using = color_purple_texture
															blend_mode = multiply
														}

														modify_texture = {
															texture = "gfx/interface/cards/headers/header_pattern_07.dds"
															alpha = 0.7
															texture_density = 2
															spriteType = corneredtiled
															blend_mode = overlay
														}
													}

													background = {
														using = color_black_texture
														alpha = 0.6
													}
												}

												blockoverride "header_content" {
													widget = {
														size = { 100% 100% }

														tagtooltip_enabled = yes
														tooltip = "[international_organizations|e]"

														hbox = {
															expand = {}

															icon = {
																size = { 22 22 }
																texture = "gfx/interface/icons/alerts_icons/international_organization.dds"
																glow = {
																	name = "drop_shadow"
																	glow_radius = 3
																	color = {0.0 0.0 0.0 1.0}
																	alpha = 0.3
																}
															}
															expand = {}
														}
													}
												}

												# RIGHT
												blockoverride "bottom_content" {
													hbox = {
														using = bg_corner_flavor
														blockoverride "corner_flavor_texture" {
															texture = "gfx/interface/component_decoration/bg_corner_flavor_06.dds"
															texture_density = 2
															spriteType = Corneredstretched
															spriteborder = { 35 35 }
															alpha = 0.7
														}
														blockoverride "corner_flavor_color" {
															modify_texture = {
																using = color_bg_blue_texture
																blend_mode = multiply
															}
														}

														margin = { 10 0 }
														hbox = {
															layoutpolicy_vertical = expanding
															spacing = 4
															datamodel = "[DataModelFirst(GameLobby.GetMemberOfInternationalOrganizations, '(int32)12')]"
															item = {
																InternationalOrganizationFakeButton = {
																	blockoverride "tooltip_content" {
																		tooltipwidget = {
																			using = InternationalOrganization_tooltip
																		}
																	}
																}
															}
														}

														expand = {}

														text_single = {
															margin = {5 5}
															using = Font_Type_Headers
															raw_text = "+[GetRelationOverUILimit(GetDataModelSize(GameLobby.GetMemberOfInternationalOrganizations))]"
															align = nobaseline
															visible = "[GreaterThan_int32(GetDataModelSize(GameLobby.GetMemberOfInternationalOrganizations), GetRelationsUILimit)]"
															tooltipwidget = {
																ContextualTooltipType = {
																	blockoverride "title_text" {
																		text = "game_concept_international_organizations"
																	}

																	blockoverride "concept_link" {
																		text = "[international_organizations|e]"
																	}

																	blockoverride "title_icon" {
																		icon = {
																			using = tooltip_title_icon_size
																			texture = "gfx/interface/icons/alerts_icons/international_organization.dds"
																			glow = {
																				name = "drop_shadow"
																				glow_radius = 3
																				color = {0.0 0.0 0.0 1.0}
																				alpha = 0.4
																			}
																		}
																	}

																	blockoverride "tooltip_content" {
																		TooltipListScrollArea = {
																			blockoverride "block_scrollarea" {
																				maximumsize = { -1 400 }
																			}

																			blockoverride "scrollarea_content" {
																				vbox = {
																					set_parent_dimension_to_minimum = height
																					layoutpolicy_horizontal = expanding

																					datamodel = "[DataModelSkipFirst(GameLobby.GetMemberOfInternationalOrganizations, GetRelationsUILimit)]"
																					item = {
																						InternationalOrganizationFakeButton = {
																							blockoverride "tooltip_content" {
																								tooltipwidget = {
																									using = InternationalOrganization_tooltip
																								}
																							}
																						}
																					}
																				}
																			}
																		}
																	}
																}
															}
															using = bg_number_container_bckg
															blockoverride "number_container_alpha" {
																alpha = 0.5
															}
															blockoverride "number_container_color" {
																modify_texture = {
																	using = color_bg_blue_texture
																	blend_mode = multiply
																}
															}
														}
													}
												}
											}
										}
										datamodel = "[GameLobby.GetDiplomaticRelations]"
										item = {
											relation_type_item = {
												blockoverride "small_relations_datamodel"{
													datamodel = "[DataModelFirst(RelationTypeItem.GetRelations, '(int32)8')]"
												}
				
												blockoverride "extra_small_relations_text" {
													raw_text = "+[Subtract_int32(GetDataModelSize(RelationTypeItem.GetRelations), '(int32)8')]"
												}
				
												blockoverride "extra_small_relations_visible"{
													visible = "[GreaterThan_int32(GetDataModelSize(RelationTypeItem.GetRelations), '(int32)8')]"
												}
											}
										}
									}
									expand = {}
								}
							}
						}

						expand = {}
					}
				}
			}

			scrollarea = {
				visible = "[GameLobby.IsCountryTabContent]"
				using = layoutpolicy_expanding
				autoresizescrollarea = no
				scrollbarpolicy_horizontal = always_off

				scrollbar_vertical = {
					using = Scrollbar_Vertical
				}

				scrollwidget = {
					vbox = {
						using = layoutpolicy_expanding

						# UNIQUE CONTENT
						filtered_sorted_list = {
							datacontext = "[GameLobby.GetUniqueContentCategoriesSortSearch]"

							blockoverride "scroll_list_is_empty" {
								visible = "[IsDataModelEmpty(GameLobby.GetUniqueContentCategories)]"
							}

							blockoverride "scroll_list_is_empty_text" {
								text = "UNIQUE_CONTENT_LIST_EMPTY"
							}

							blockoverride "scroll_list_layout" {
								vbox = {
									layoutpolicy_horizontal = expanding
									spacing = 10
									margin = { 7 10 }

									vbox = {
										layoutpolicy_horizontal = expanding
										spacing = 10
										datamodel = "[GameLobby.GetUniqueContentCategories]"
										item = {
											laws_list_item = {
												visible = "[Not(IsDataModelEmpty(UniqueContentCategory.GetUniqueContentItems))]"
												blockoverride "graphical_culture_pattern_texture" {
													texture = "[GetGraphicalCultureTextureForCountry('header_pattern', Country.Self)]"
												}
												blockoverride "law_type_button" {
													action_tooltip = {
														title = "TOGGLE_UNIQUE_CONTENT_CATEGORY"
														on_action = "[GameLobby.Vars.SetOrToggle( 'category', UniqueContentCategory.GetName )]"
													}
													
													tooltipwidget = { BasicFunctionalTooltip = {} }
												}

												blockoverride "law_icon" {
													texture = "[UniqueContentCategory.GetIcon]"
												}
												blockoverride "law_type_button_text" {
													text = "[UniqueContentCategory.GetName]"
												}
												blockoverride "laws_amount" {
													text = "[GetDataModelSize(UniqueContentCategory.GetUniqueContentItems)]"
												}
												blockoverride "law_arrow_expanded" {
													visible = "[GameLobby.Vars.HasValue( 'category', UniqueContentCategory.GetName )]"
												}
												blockoverride "law_arrow_not_expanded" {
													visible = "[Not(GameLobby.Vars.HasValue( 'category', UniqueContentCategory.GetName ))]"
												}
												blockoverride "laws_list_datamodel" {
													visible = "[GameLobby.Vars.HasValue( 'category', UniqueContentCategory.GetName )]"
													datamodel = "[UniqueContentCategory.GetUniqueContentItems]"
												}
												blockoverride "law_unique_flavor_visible" {
													visible = no
												}
												blockoverride "laws_list_inner_item" {
													unique_content_item = {}
												}
												blockoverride "law_category_color" {
													# texture = "[LawCategory.GetBgCategoryColor]"
													using = color_mid_blue_texture
												}
											}
										}
									}
									expand = {}
								}
							}
						}

						expand = {}
					}
				}
			}

			vbox = {
				visible = "[GameLobby.IsCountryTabDescription]"
				margin = { 10 10 }
				layoutpolicy_horizontal = expanding

				# DECRIPTION
				text_multi = {
					using = bg_main_inner_alt_base
					blockoverride "bg_main_inner_alt_base_extra"{
						margin_bottom = 10
					}

					fontsize = 14
					margin = { 15 6 }
					margin_top = 16
					text = "[LobbyView.GetSelectedPlayable.GetCountry.GetHistoryDesc]"

					layoutpolicy_horizontal = expanding
					autoresize = yes

					background = {
						margin_bottom = 10
						using = bg_vignette_mask_texture
						alpha = 0.5

						modify_texture = {
							using = color_black_texture
							blend_mode = multiply
						}
					}

					background = {
						margin_bottom = 10
						using = paper_card_texture
						alpha = 0.7

						modify_texture = {
							using = color_dark_brown_texture
							alpha = 0.5
						}
						modify_texture = {
							using = overlay_paper_03
							blend_mode = overlay
						}

						modify_texture = {
							using = bg_fade_vertical_down_mask_texture
							blend_mode = alphamultiply
							alpha = 0.1
						}
					}
				}
			}

			expand = {}
		}

		window_bottom_paper_template = {}
	}

	type LobbyCountryListWidget = widget {
		size = { 430 -1 }
		layoutpolicy_vertical = expanding
		using = bg_main_inner_notabs_alt
		alwaystransparent = no
		filter_mouse = all

		state = {
			name = "jomini_preselected_changed"
			# Can be used for showing a fancy animation when changing country selection in the lobby
			duration = 0
			alpha = 1
		}

		vbox = {
			using = layoutpolicy_expanding
			margin_bottom = 25

			window_header_alt = {
				using = bg_main_inner_alt
				blockoverride "window_header_alt_color_texture"{
					using = color_default_brown_texture
				}
			
				blockoverride "header_text" {
					text = "SELECT_TITLE_FRONTEND"
				}
			}

			vbox = {
				using = layoutpolicy_expanding
				margin = {15 0}

				widget = {
					name = "lobby_country_list"
					using = layoutpolicy_expanding

					filtered_sorted_list = {
						datacontext = "[AccessLobbyCountryList.GetCountriesSortSearch.WithFilterTags('no_filters')]"

						blockoverride "sort_buttons_filtered_list" {
							sort_by_key_button = {
								name = "name"
								using = layoutpolicy_expanding
							}

							sort_by_key_button = {
								name = "difficulty"
								using = layoutpolicy_expanding
							}

							sort_by_key_button = {
								name = "country_type"
								using = layoutpolicy_expanding
							}

							sort_by_key_button = {
								name = "population"
								using = layoutpolicy_expanding
							}

							sort_by_key_button = {
								name = "unique_content"
								using = layoutpolicy_expanding
							}
						}

						blockoverride "scroll_list_layout" {
							fixedgridbox = {
								datamodel = "[AccessLobbyCountryList.GetCountries]"
								addcolumn = 100%
								addrow = 74
								datamodel_wrap = 1
								flipdirection = yes
								setitemsizefromcell = yes

								item = {
									widget = {
										size = { 100% 90% }
										tooltipwidget = {
											using = CountryTooltip
										}

										vbox = {
											clickable_header_card = {
												onmousehierarchyenter = "[PdxGuiWidget.SetHighlightCountry( Country.Self )]"
												blockoverride "header_color" {
													texture = "gfx/interface/colors/mid_blue.dds"
												}
												blockoverride "header_pattern" {
													texture = "gfx/interface/cards/headers/header_pattern_07.dds"
													alpha = 0.7
												}
												blockoverride "clickable_header_card_size"{
													size = { -1 65 }
												}
												blockoverride "header_size" {
													size = { -1 35 }
												}
												blockoverride "header_content" {
													ondoubleclick = "[PanToCountry(Country.Self)]"

													action_tooltip = {
														click_type = left
														click_mode = single

														block "click_action" {
															title = "LOBBYVIEW_SELECT_COUNTRY"
															on_action = "[SetLobbyCountry(Country.Self)]"
														}
													}

													background = {
														texture = "gfx/interface/colors/mid_blue.dds"
														margin = {0 0}
														alpha = 0.8

														modify_texture = {
															texture = "gfx/interface/component_masks/mask_fade_horizontal.dds"
															blend_mode = alphamultiply
															mirror = horizontal
														}
													}

													widget = {
														size = {100% 100%}
														hbox = {
															margin_left = 90
															margin_right = 5
															text_single = {
																using = layoutpolicy_expanding
																autoresize = no
																align = left|nobaseline
																using = Font_Type_Headers
																using = Font_Size_Small
																alwaystransparent = yes
																text = "[Country.GetLongNameWithNoTooltip]"

																block "name_sort_highlight" {}
															}

															hbox = {
																spacing = 0
																ignoreinvisible = yes

																# gov type
																widget = {
																	size = { 23 23 }
																	icon = {
																		size = { 20 20 }
																		position = {0 -1}
																		parentanchor = center
																		texture = "[GetGovernmentTypeIcon(Country.GetGovernment.GetGovernmentType)]"
																		texture_density = 2

																		datacontext = "[Country.GetGovernment.GetGovernmentType]"
																		tooltipwidget = {
																			using = GovernmentType_tooltip

																			blockoverride "title_icon_texture" {
																				texture = "[GetGovernmentTypeIcon(Country.GetGovernment.GetGovernmentType)]"
																			}
																		}
																	}
																}

																# country type
																widget = {
																	size = { 23 23 }

																	icon = {
																		size = { 20 20 }
																		position = {0 1}
																		parentanchor = center
																		texture = "[GetCountryTypeIcon(Country.Self)]"
																		texture_density = 2

																		tooltipwidget = {
																			using = CountryType_tooltip
																		}

																		glow = {
																			name = "drop_shadow"
																			glow_radius = 3
																			color = {0.0 0.0 0.0 1.0}
																			alpha = 0.5
																		}

																		block "country_type_sort_highlight" {}
																	}
																}

																# country rank
																widget = {
																	size = { 23 23 }

																	icon = {
																		size = { 20 20 }
																		parentanchor = left|vcenter
																		texture = "[GetCountryRankIcon(Country.GetRank)]"
																		texture_density = 2
																		alpha = 1

																		datacontext = "[Country.GetRank]"
																		tooltipwidget = {
																			using = CountryRank_tooltip
																		}

																		glow = {
																			name = "drop_shadow"
																			glow_radius = 3
																			color = {0.0 0.0 0.0 1.0}
																			alpha = 0.6
																		}
																	}
																}
															}
														}
													}
												}
												blockoverride "bottom_content" {

													widget = {
														size = {100% 100%}
														hbox = {
															margin_left = 90
															spacing = 2

															# DIFFICULTY
															text_single = {
																using = layoutpolicy_expanding
																autoresize = no
																align = center|nobaseline
																visible = "[Country.HasDifficultyLevel]"
																text = "[Country.GetDifficultyLevelName]"
																tooltipwidget = {
																	SimpleContextualTooltipType = {
																		blockoverride "title_icon" {
																			icon = {
																				using = tooltip_title_icon_size
																				texture = "gfx/interface/icons/alerts_icons/welcome_to_caesar.dds"
																			}
																		}
																		blockoverride "concept_link" {
																			text = "[country|E]"
																		}
																		textcontext = "[Country.GetDifficultyLevelDesc]"
																	}
																}

																block "difficulty_sort_highlight" {}
															}

															divider_flavor_01 = {
																visible = "[And(Country.HasCountryDescriptionCategory,Country.HasDifficultyLevel)]"
																size = {9 -1}
															}

															# ARCHETYPES
															text_single = {
																visible = "[Country.HasCountryDescriptionCategory]"
																using = layoutpolicy_expanding
																autoresize = no
																align = center|nobaseline
																text = "[Country.GetCountryDescriptionCategoryName]"

																tooltipwidget = {
																	ContextualTooltipType = {
																		blockoverride "title_icon" {

																			country_flag_mid = {
																				size = { 53 40 }
																			}
																		}

																		blockoverride "title_text" {
																			text = "[Country.GetCountryDescriptionCategoryName]"
																		}

																		blockoverride "concept_link" {
																			text = "[country|e]"
																		}

																		blockoverride "tooltip_content" {
																			TooltipTextBlock = {
																				textcontext = "[Country.GetCountryDescriptionCategoryDesc]"																			}
																		}
																	}
																}
															}

															divider_flavor_01 = {
																visible = "[Country.HasCountryDescriptionCategory]"
																size = {9 -1}
															}

															# POPULATION
															text_single = {
																using = layoutpolicy_expanding
																autoresize = no
																align = center|nobaseline
																text = "[Country.GetTotalPopulation]"

																block "population_sort_highlight" {}
															}

															expand = {}
														}
													}
												}
											}
										}
										country_flag_mid = {
											size = { 82 62 }
											parentanchor = left|vcenter
											position = {0 0}

											blockoverride "hover_leave" {}
										}
									}
								}
							}
						}
					}
				}
			}

			expand = {}
		}

		window_bottom_paper_template = {}
	}

	# type LobbyViewSpaceWidget = flowcontainer {
	# 	margin = { 0 5 }

	# 	widget = {
	# 		alwaystransparent = no
	# 		vbox = {
	# 			minimumsize = { 510 -1 }
	# 			using = bg_window_default
	# 			using = window_margin
	# 			set_parent_size_to_minimum = yes

	# 			text_label_center_light_blue = {
	# 				text = "JOMINI_MULTIPLAYER_GUI_GAME_CONFIGURATION"
	# 				layoutpolicy_horizontal = expanding
	# 			}

	# 			divider_center_gold = {
	# 				layoutpolicy_horizontal = expanding
	# 				size = { -1 1.5 }
	# 			}

	# 			hbox = {
	# 				using = layoutpolicy_expanding
	# 				margin = { 10 10 }
	# 				margin_bottom = 0

	# 				button_flavor = {
	# 					using = button_flavor_resize_to_fit_text
	# 					onclick = "[OpenGameRules]"
	# 					text = "GAME_RULES"
	# 				}
	# 			}
	# 		}
	# 	}
	# }

	type LobbyViewGameInfoPanel = vbox {
		layoutpolicy_horizontal = expanding
		background = {
			using = LobbyViewModuleBackground
		}
		# block "game_info" {}
	}

	type LobbyViewButtons = hbox {
		spacing = 0

		# GO TO MAIN MENU BUTTON
		button_regular = {
			size = { 34 34 }

			input_action = "close_window"
			action_tooltip = {
				click_mode = single
				on_action = "[LobbyView.GoBack]"
				on_action = "[HideGameRules]"
				title = "GO_TO_MAIN_MENU"
				enabled = "[LobbyView.CanGoBack]"
			}
			tooltipwidget = {
				ContextualTooltipType = {
					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/icons/flat_icons/tabicons/settings_flat_icon.dds"
						}
					}

					blockoverride "title_text" {
						text = "GO_TO_MAIN_MENU"
					}
					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "GO_TO_MAIN_MENU_desc"
							}
						}
					}
				}
			}
			button = {
				using = ui_direction_button_overlay
				using = back_button_alt_texture
				size = {80% 80%}
				parentanchor = center

				background = {
					using = bg_button_light_round_texture
					modify_texture = {
						using = color_dark_blue_texture
					}
				}

				action_tooltip = {
					click_mode = single
					on_action = "[LobbyView.GoBack]"
					on_action = "[HideGameRules]"
					title = "GO_TO_MAIN_MENU"
					enabled = "[LobbyView.CanGoBack]"
				}
				tooltipwidget = {
					ContextualTooltipType = {
						blockoverride "title_icon" {
							icon = {
								using = tooltip_title_icon_size
								texture = "gfx/interface/icons/flat_icons/tabicons/settings_flat_icon.dds"
							}
						}

						blockoverride "title_text" {
							text = "GO_TO_MAIN_MENU"
						}
						blockoverride "tooltip_content" {
							TooltipTextBlock = {
								blockoverride "text" {
									text = "GO_TO_MAIN_MENU_desc"
								}
							}
						}
					}
				}

				using = snd_UI_backward
			}
			# button = {
			# 	parentanchor = center
			# 	size = {80% 80%}
			# 	texture = "gfx/interface/buttons/flats/back_button.dds"
			# 	texture_density = 2

			# 	modify_texture = {
			# 		using = overlay_window_texture
			# 		blend_mode = overlay
			# 		alpha = 0.7
			# 	}
			# 	modify_texture = {
			# 		using = overlay_stone_texture
			# 		blend_mode = overlay
			# 		alpha = 0.8
			# 	}

			# 	modify_texture = {
			# 		using = color_new_gold_texture
			# 	}

			# 	glow = {
			# 		glow_radius = 5
			# 		color = { 1.0 0.85 0.55 1.0 }
			# 		alpha = 0.6

			# 		block "glow_visible" {
			# 			visible = no
			# 		}
			# 	}

			# 	background = {
			# 		using = bg_circle_texture
			# 		margin = {3 3}
			# 		modify_texture = {
			# 			using = color_dark_blue_texture
			# 			blend_mode = multiply
			# 		}
			# 	}
			# }
		}

		# random country
		button_regular = {
			using = layoutpolicy_expanding

			text_single = {
				parentanchor = center
				maximumsize = {200 -1}
				text = "MULTIPLAYER_LOBBY_CHOOSE_RANDOM_CHARACTER"
			}
			onclick = "[GameLobby.SetRandomPlayableObserverCharacter]"

			action_tooltip = {
				title = "MULTIPLAYER_LOBBY_CHOOSE_RANDOM_CHARACTER"
			}

			tooltipwidget = {
				ConceptTooltipType = {
					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "[GetConceptTexture('dice')]"
						}
					}

					blockoverride "title_text" {
						text = "MULTIPLAYER_LOBBY_CHOOSE_RANDOM_CHARACTER"
					}
					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "MULTIPLAYER_LOBBY_CHOOSE_RANDOM_CHARACTER_desc"
							}
						}
					}
				}
			}
		}

		# observe
		button_regular = {
			using = layoutpolicy_expanding
			enabled = "[GameLobby.CanToggleObserve]"
			button_checkbox_visibility = {
				size = { 30 30 }
				position = { 5 1 }
				checked = "[LobbyView.IsObserver]"
				onclick = "[GameLobby.ToggleObserve]"
			}

			text_single = {
				parentanchor = center
				maximumsize = {200 -1}
				text = "[SelectLocalization(LobbyView.IsObserver, 'JOMINI_MULTIPLAYER_GUI_DISABLE_OBSERVE', 'JOMINI_MULTIPLAYER_GUI_OBSERVE')]"
			}

			action_tooltip = {
				click_mode = single
				click_type = left
				title = "[SelectLocalization(LobbyView.IsObserver, 'JOMINI_MULTIPLAYER_GUI_DISABLE_OBSERVE', 'JOMINI_MULTIPLAYER_GUI_OBSERVE')]"
				enabled = "[GameLobby.CanToggleObserve]"
				on_action = "[GameLobby.ToggleObserve]"
			}

			tooltipwidget = {
				ConceptTooltipType = {
					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/icons/flat_icons/tabicons/settings_flat_icon.dds"
						}
					}

					blockoverride "title_text" {
						text = "OBSERVER"
					}
					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "[GameLobby.ToggleObserveTT]"
							}
						}
					}
				}
			}
		}

		# Clear country observed
		header_button_left = {
			visible = "[And3(LobbyView.IsObserver, LobbyView.HasSelectedPlayable, Not(IsPreparationLobby))]"
			size = { 30 30 }
			onclick = "[LobbyView.ClearPreSelected]"
			blockoverride "button_icon_stretch_sprite" {}
			blockoverride "header_button_frame_inner" {visible = no}
			blockoverride "header_button_icon_size" { size = { 28 28 } }
			blockoverride "header_button_text_layout" {}
			blockoverride "icon_texture" {
				texture = "gfx/interface/icons/unit_view/army_visible_icon.dds"
			}
			blockoverride "icon_overlay" {}

			tooltipwidget = {
				ConceptTooltipType = {
					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/icons/unit_view/army_visible_icon.dds"
						}
					}

					blockoverride "title_text" {
						text = "LOBBY_CLEAR_OBSERVING_COUNTRY"
					}
					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "LOBBY_CLEAR_OBSERVING_COUNTRY"
							}
						}
					}
				}
			}
		}

		header_button_left = {
			visible = "[And(GameLobby.Vars.HasValue('subtab', 'selected_country'), LobbyView.HasSelectedPlayable)]"
			size = { 30 30 }
			blockoverride "button_icon_stretch_sprite" {}
			blockoverride "header_button_frame_inner" {visible = no}
			blockoverride "header_button_icon_size" { size = { 26 26 } }
			blockoverride "header_button_text_layout" {}
			blockoverride "icon_overlay" {}
			blockoverride "icon_texture" {
				texture = "gfx/interface/icons/alerts_icons/form_new_country.dds"
				texture_density = 2
			}
			
			action_tooltip = {
				title = "LOBBY_OPEN_SELECTED_COUNTRY_TT"
				on_action = "[GameLobby.Vars.SetOrToggle('subtab','not_selected_country')]"
			}
			tooltipwidget = {
				ConceptTooltipType = {
					blockoverride "title_text" {
						text = "LOBBY_OPEN_SELECTED_COUNTRY_TT"
					}

					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/buttons/flats/release_country.dds"

							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.5
								blend_mode = add
							}
							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.6
							}
						}
					}

					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "LOBBY_OPEN_SELECTED_COUNTRY_TT_des"
							}
						}
					}
				}
			}
		}
		header_button_left = {
			visible = "[And(Not(GameLobby.Vars.HasValue('subtab', 'selected_country')), LobbyView.HasSelectedPlayable)]"
			size = { 30 30 }
			blockoverride "button_icon_stretch_sprite" {}
			blockoverride "header_button_frame_inner" {visible = no}
			blockoverride "header_button_icon_size" { size = { 30 30 } }
			blockoverride "header_button_text_layout" {}
			blockoverride "icon_overlay" {}
			blockoverride "header_button_template_push_properties"{
				gfxtype = togglepushbuttongfx
				effectname = "NoHighlight"
				upframe = 2
				uphoverframe = 2
				uppressedframe = 3
				downframe = 2
				downhoverframe = 2
				downpressedframe = 3
				disableframe = 4
			}
			blockoverride "icon_texture" {
				texture = "gfx/interface/icons/alerts_icons/form_new_country.dds"
				texture_density = 2
			}
			background = {
				texture = "gfx/interface/component_tiles/square_glow.dds"
				margin = {5 5}
				block "header_button_modify_visible" {}
				modify_texture = {
					using = color_bone_texture
				}
				alpha = 0.5
				modify_texture = {
					using = color_white_texture
					blend_mode = overlay
					alpha = 0.2
				}
			}
			action_tooltip = {
				on_action = "[GameLobby.Vars.Set('subtab','selected_country')]"
				title = "LOBBY_CLOSE_SELECTED_COUNTRY_TT"
			}
			tooltipwidget = {
				ConceptTooltipType = {
					blockoverride "title_text" {
						text = "LOBBY_CLOSE_SELECTED_COUNTRY_TT"
					}

					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/buttons/flats/release_country.dds"

							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.5
								blend_mode = add
							}
							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.6
							}
						}
					}

					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "LOBBY_CLOSE_SELECTED_COUNTRY_TT_des"
							}
						}
					}
				}
			}
		}
		expand = {}
	}

	# type button_tab_dlc_mods = button_panel_tab_alt {
	# 	using = layoutpolicy_expanding
	# 	onclick = "[OpenModsView]"
	# 	onclick = "[HideGameRules]"
	# 	onclick = "[GameLobby.Vars.SetOrToggle('tab','DLC')]"
	# 	down = "[GameLobby.Vars.HasValue('tab', 'DLC')]"

	# 	action_tooltip = {
	# 		title = "LOBBY_DLC_LIST_TT"
	# 	}

	# 	tooltipwidget = {
	# 		ConceptTooltipType = {

	# 			blockoverride "title_text" {
	# 				text = "LOBBY_DLC_LIST_TT"
	# 			}

	# 			blockoverride "title_icon" {
	# 				icon = {
	# 					using = tooltip_title_icon_size
	# 					texture = "gfx/interface/icons/flat_icons/objectives.dds"
	# 					# UNTIL THERE IS A NEW TEXTURE
	# 					modify_texture = {
	# 						using = color_new_gold_texture
	# 						alpha = 0.8
	# 						blend_mode = overlay
	# 					}
	# 					modify_texture = {
	# 						using = color_new_gold_texture
	# 						alpha = 0.6
	# 					}
	# 				}
	# 			}

	# 			blockoverride "tooltip_content" {
	# 				TooltipTextBlock = {
	# 					blockoverride "text" {
	# 						text = "LOBBY_DLC_LIST_TT_desc"
	# 					}
	# 				}
	# 			}
	# 		}
	# 	}

	# 	icon = {
	# 		texture = "gfx/interface/icons/flat_icons/objectives.dds"
	# 		# UNTIL THERE IS A NEW TEXTURE
	# 		modify_texture = {
	# 			using = color_new_gold_texture
	# 			alpha = 0.8
	# 			blend_mode = overlay
	# 		}
	# 		modify_texture = {
	# 			using = color_new_gold_texture
	# 			alpha = 0.6
	# 		}
	# 		texture_density = 2
	# 		size = { 22 22 }
	# 		parentanchor = center

	# 		using = button_panel_tab_icon_effect
	# 		blockoverride "icon_effect_visible" { visible = no }
	# 	}
	# }

	type close_right_tabs = button_close_alt {
		blockoverride "close_properties" {
			parentanchor = vcenter|right
		}
		blockoverride "close_inputaction"{}
		block "close_button_tooltip" {
			tooltipwidget = {
				LeftClickButtonTooltip = {
					blockoverride "onclick_text" { text = "CLOSE_TAB" }
				}
			}
		}
	}

	#type button_tab_selected_country = button_regular {
	#	using = button_regular_texture
	#	enabled = "[LobbyView.HasSelectedPlayable]"
	#	down = "[And(LobbyView.HasSelectedPlayable, Not(GameLobby.Vars.HasValue('subtab', 'selected_country')))]"
	#
	#	icon = {
	#		texture = "gfx/interface/buttons/flats/release_country.dds"
	#		texture_density = 2
	#		size = { 22 22 }
	#		parentanchor = center
	#
	#		# UNTIL THERE IS A NEW TEXTURE
	#		modify_texture = {
	#			using = color_new_gold_texture
	#			alpha = 0.5
	#			blend_mode = add
	#		}
	#		modify_texture = {
	#			using = color_new_gold_texture
	#			alpha = 0.6
	#		}
	#
	#		using = button_panel_tab_icon_effect
	#		blockoverride "icon_effect_visible" { visible = no }
	#	}
	#}

	type button_tab_rules = button_regular {
		using = layoutpolicy_expanding
		onclick = "[OpenGameRules]"
		onclick = "[HideModsView]"
		onclick = "[GameLobby.Vars.SetOrToggle('tab','GameRules')]"
		down = "[GameLobby.Vars.HasValue('tab', 'GameRules')]"

		action_tooltip = {
			title = "GAME_RULES"
		}

		tooltipwidget = {
			ConceptTooltipType = {

				blockoverride "title_text" {
					text = "GAME_RULES"
				}

				blockoverride "title_icon" {
					icon = {
						using = tooltip_title_icon_size
						texture = "gfx/interface/icons/flat_icons/tabicons/settings_flat_icon.dds"
					}
				}

				blockoverride "tooltip_content" {
					TooltipTextBlock = {
						blockoverride "text" {
							text = "GAME_RULES_des"
						}
					}
				}
			}
		}

		icon = {
			texture = "gfx/interface/icons/flat_icons/tabicons/settings_flat_icon.dds"
			texture_density = 2
			size = { 22 22 }
			parentanchor = center

			using = button_panel_tab_icon_effect
			blockoverride "icon_effect_visible" { visible = no }
		}
	}

	type LobbyViewTabs = hbox {
		using = bg_panel_tabs

		# RULES
		button_tab_rules = {
			visible = "[GameLobby.Vars.HasValue('tab', 'GameRules')]"
			onclick = "[HideGameRules]"
			background = {
				using = color_bg_brown_texture
				modify_texture = {
					texture = "gfx/interface/colors/intense_brown.dds"
					blend_mode = add
					alpha = 0.3
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_fade_horizontal_middle.dds"
					blend_mode = alphamultiply
					alpha = 0.5
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_fadehorizontal_middle_thick.dds"
					blend_mode = alphamultiply
				}
			}
		}
		button_tab_rules = {
			visible = "[Not(GameLobby.Vars.HasValue('tab', 'GameRules'))]"
		}

		# COUNTRIES
		button_regular = {
			using = layoutpolicy_expanding
			onclick = "[HideGameRules]"
			onclick = "[HideModsView]"
			onclick = "[GameLobby.Vars.SetOrToggle('tab','country_list')]"
			down = "[GameLobby.Vars.HasValue('tab', 'country_list')]"

			action_tooltip = {
				title = "LOBBY_COUNTRY_LIST_TT"
			}
			background = {
				using = color_bg_brown_texture
				modify_texture = {
					texture = "gfx/interface/colors/intense_brown.dds"
					blend_mode = add
					alpha = 0.3
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_fade_horizontal_middle.dds"
					blend_mode = alphamultiply
					alpha = 0.5
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_fadehorizontal_middle_thick.dds"
					blend_mode = alphamultiply
				}
			}

			tooltipwidget = {
				ConceptTooltipType = {

					blockoverride "title_text" {
						text = "LOBBY_COUNTRY_LIST_TT"
					}

					blockoverride "title_icon" {
						icon = {
							texture = "gfx/interface/buttons/flats/release_country.dds"
							using = tooltip_title_icon_size

							# UNTIL THERE IS A NEW TEXTURE
							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.5
								blend_mode = add
							}
							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.6
							}
						}
					}

					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "LOBBY_COUNTRY_LIST_TT_des"
							}
						}
					}
				}
			}

			icon = {
				texture = "gfx/interface/buttons/flats/release_country.dds"
				texture_density = 2
				size = { 22 22 }
				parentanchor = center

				# UNTIL THERE IS A NEW TEXTURE
				modify_texture = {
					using = color_new_gold_texture
					alpha = 0.5
					blend_mode = add
				}
				modify_texture = {
					using = color_new_gold_texture
					alpha = 0.6
				}

				using = button_panel_tab_icon_effect
				blockoverride "icon_effect_visible" { visible = no }
			}
		}

		# HOST MP
		button_regular = {
			using = layoutpolicy_expanding
			down = "[GameLobby.Vars.HasValue('tab', 'multiplayer')]"
			enabled = "[JominiIsMultiplayerAccessible]"

			background = {
				using = color_bg_brown_texture
				modify_texture = {
					texture = "gfx/interface/colors/intense_brown.dds"
					blend_mode = add
					alpha = 0.3
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_fade_horizontal_middle.dds"
					blend_mode = alphamultiply
					alpha = 0.5
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_fadehorizontal_middle_thick.dds"
					blend_mode = alphamultiply
				}
			}

			action_tooltip = {
				click_type = left
				click_mode = single
				title = "MP_BTN"
				on_action = "[HideGameRules]"
				on_action = "[HideModsView]"
				on_action = "[GameLobby.Vars.SetOrToggle('tab','multiplayer')]"
				enabled = "[JominiIsMultiplayerAccessible]"
			}

			tooltipwidget = {
				ConceptTooltipType = {
					blockoverride "title_text" {
						text = "JOMINI_MULTIPLAYER_GUI_SESSION_HEADER"
					}

					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/icons/flat_icons/common_language_old.dds"
							# UNTIL THERE IS A NEW TEXTURE
							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.8
								blend_mode = overlay
							}
							modify_texture = {
								using = color_new_gold_texture
								alpha = 0.6
							}
						}
					}

					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "[JominiGetMultiplayerAccessibleString]"
							}
						}
					}
				}
			}

			icon = {
				texture = "gfx/interface/icons/flat_icons/common_language_old.dds"
				# UNTIL THERE IS A NEW TEXTURE
				modify_texture = {
					using = color_new_gold_texture
					alpha = 0.8
					blend_mode = overlay
				}
				modify_texture = {
					using = color_new_gold_texture
					alpha = 0.6
				}
				texture_density = 2
				size = { 22 22 }
				parentanchor = center

				using = button_panel_tab_icon_effect
				blockoverride "icon_effect_visible" { visible = no }
			}
		}
	}

	# type LobbyViewBackgroundBorders = icon {
	# 	texture = "gfx/interface_old/from_sulla/small_window_frame_corners.dds"
	# 	spriteType = Corneredtiled
	# 	size = { 100% 100% }
	# 	spriteborder = { 32 24 }
	# 	shaderfile = "gfx/FX/pdxgui_default.shader"
	# 	parentanchor = top|right
	# 	widgetanchor = top|right
	# }

	type LobbyViewPlayerList = widget {
		using = layoutpolicy_expanding
		alwaystransparent = no
		visible = "[GameIsMultiplayer]"

		vbox = {
			LobbySubHeader = {
				blockoverride "text" {
					text = "JOMINI_MULTIPLAYER_GUI_PLAYER_LIST_LABEL"
				}
			}

			scrollbox = {
				using = layoutpolicy_expanding

				blockoverride "scrollbox_content" {
					fixedgridbox = {
						addcolumn = 400
						addrow = 90
						setitemsizefromcell = yes

						datamodel = "[LobbyView.Players]"
						item = {
							widget = {
								JominiLobbyViewPlayerItem = {
									size = { 97% 70 }
									parentanchor = left|vcenter
								}
							}
						}
					}
				}

				blockoverride "scrollbox_empty" {
					visible = "[IsDataModelEmpty( LobbyView.Players )]"
					text = ""
				}

				blockoverride "scrollbox_expand" {
					expand = {
						layoutpolicy_vertical = growing
						visible = "[DataModelHasItems( LobbyView.Players )]"
					}
				}
			}
		}
	}

	type LobbyViewMPInfo = vbox {
		name = "mp_info"
		layoutpolicy_horizontal = expanding

		visible = "[LobbyView.HasServerInfo]"
		alwaystransparent = no
		filter_mouse = left|right

		spacing = 10
		margin = { 5 0 }

		widget = {
			using = layoutpolicy_expanding
			vbox = {
				button_default = {
					layoutpolicy_horizontal = expanding

					hbox = {
						margin = { 15 0 }
						spacing = 10
						text_single = {
							layoutpolicy_horizontal = expanding
							text = "JOMINI_MULTIPLAYER_GUI_ENABLED_DLCS"
							align = nobaseline
						}
						icon = {
							visible = "[Not(LobbyView.ShouldShowEnabledDLCs)]"
							size = { 22 22 }
							texture = "gfx/interface/buttons/flats/button_simple_right.dds"
							using = color_gold
							modify_texture = {
								using = overlay_window_texture
								blend_mode = overlay
								alpha = 1
							}
						}

						icon = {
							visible = "[LobbyView.ShouldShowEnabledDLCs]"
							size = { 22 22 }
							texture = "gfx/interface/buttons/flats/button_simple_down.dds"
							using = color_gold
							modify_texture = {
								using = overlay_window_texture
								blend_mode = overlay
								alpha = 1
							}
						}
					}

					enabled = "[LobbyView.HasEnabledDLCs]"
					onclick = "[LobbyView.ToggleShowEnabledDLCs]"
				}

				scrollbox = {
					using = layoutpolicy_expanding

					blockoverride "scrollbox_content" {
						fixedgridbox = {
							datamodel = "[LobbyView.GetEnabledDLCs]"
							visible = "[And3(LobbyView.ShouldShowEnabledDLCs, DataModelHasItems( LobbyView.GetEnabledDLCs ), HasModsView)]"
							addcolumn = 100%
							addrow = 48
							datamodel_wrap = 1
							flipdirection = yes
							setitemsizefromcell = yes
		
							item = {
								widget = {
									size = { 99% 48 }
									visible = "[HasActiveDLC(CString.GetString)]"
									datacontext = "[AccessActiveDLC(CString.GetString)]"
									dlc_ingame_card = {}
								}
							}
						}
					}

					blockoverride "scrollbox_empty" {
						visible = "[IsDataModelEmpty( LobbyView.GetEnabledDLCs )]"
						text = "JOMINI_MULTIPLAYER_GUI_NO_DLCS"
					}

					blockoverride "scrollbox_expand" {
						expand = {
							layoutpolicy_vertical = growing
							visible = "[DataModelHasItems( LobbyView.GetEnabledDLCs )]"
						}
					}
				}
			}
		}

		widget = {
			using = layoutpolicy_expanding
			vbox = {

				button_default = {
					layoutpolicy_horizontal = expanding

					hbox = {
						margin = { 15 0 }
						spacing = 10

						text_single = {
							layoutpolicy_horizontal = expanding
							text = "JOMINI_MULTIPLAYER_GUI_ENABLED_MODS"
							align = nobaseline
						}
						icon = {
							visible = "[Not(LobbyView.ShouldShowEnabledMods)]"
							size = { 22 22 }
							texture = "gfx/interface/buttons/flats/button_simple_right.dds"
							using = color_gold
							modify_texture = {
								using = overlay_window_texture
								blend_mode = overlay
								alpha = 1
							}
						}

						icon = {
							visible = "[LobbyView.ShouldShowEnabledMods]"
							size = { 22 22 }
							texture = "gfx/interface/buttons/flats/button_simple_down.dds"
							using = color_gold
							modify_texture = {
								using = overlay_window_texture
								blend_mode = overlay
								alpha = 1
							}
						}
					}

					enabled = "[LobbyView.HasEnabledMods]"
					onclick = "[LobbyView.ToggleShowEnabledMods]"
				}

				scrollbox = {
					using = layoutpolicy_expanding

					blockoverride "scrollbox_content" {
						fixedgridbox = {
							datamodel = "[LobbyView.GetEnabledMods]"
							visible = "[And3(LobbyView.ShouldShowEnabledMods, DataModelHasItems( LobbyView.GetEnabledMods ), HasModsView)]"
							addcolumn = 100%
							addrow = 48
							datamodel_wrap = 1
							flipdirection = yes
							setitemsizefromcell = yes
							item = {
								widget = {
									size = { 99% 48 }
									visible = "[HasActiveMod(CString.GetString)]"
									datacontext = "[AccessActiveMod(CString.GetString)]"
									mod_ingame_card = {}
								}
							}
						}
					}

					blockoverride "scrollbox_empty" {
						visible = "[IsDataModelEmpty( LobbyView.GetEnabledMods )]"
						text = "JOMINI_MULTIPLAYER_GUI_NO_MODS"
					}

					blockoverride "scrollbox_expand" {
						expand = {
							layoutpolicy_vertical = growing
							visible = "[DataModelHasItems( LobbyView.GetEnabledMods )]"
						}
					}
				}
			}
		}
	}

	# type LobbyViewGameConfiguration = vbox {
	# 	layoutpolicy_horizontal = expanding

	# 	widget = {
	# 		filter_mouse = left|right
	# 		alwaystransparent = no

	# 		size = { 0 60 }
	# 		layoutpolicy_horizontal = expanding

	# 		button_default = {
	# 			parentanchor = center|hcenter
	# 			enabled = "[LobbyView.CanGoBack]"
	# 			text = "BACK"
	# 			onclick = "[LobbyView.GoBack]"
	# 			tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "[LobbyView.GetGoBackToolTip]" } } }
	# 		}
	# 	}
	# }

	# type SullaLobbyViewHost = vbox {
	# 	layoutpolicy_horizontal = expanding
	# 	visible = "[And(Not(HasHostError),Not(GameIsMultiplayer))]"
	# 	alwaystransparent = no
	# 	filter_mouse = left|right

	# 	JominiLobbyViewButton = {
	# 		block "host_button" {
	# 			text = "JOMINI_MULTIPLAYER_GUI_HOST_BUTTON"
	# 		}

	# 		tooltipwidget = {BasicFunctionalTooltip = {}}

	# 		action_tooltip = {
	# 			click_type = left
	# 			click_mode = single
	# 			title = "[LobbyView.GetOpenMultiplayerToolTip]"
	# 			on_action = "[LobbyView.OpenMultiplayer]"
	# 		}

	# 		# block "host_button_enabled" {
	# 			enabled = "[And(JominiIsMultiplayerAccessible, JominiIsHostOrLocal)]"
	# 		# }

	# 		layoutpolicy_horizontal = expanding
	# 	}
	# }

	type InternationalOrganizationFakeButton = container {
		icon = {
			using = header_button_texture
			size = { 30 30 }
			parentanchor = center
			frame = 1
		}

		icon = {
			block "icon_size" {
				size = { 26 26 }
			}
			block "icon_texture" {
				texture = "[InternationalOrganization.GetIcon]"
				texture_density = 2
			}
			modify_texture = {
				using = overlay_stone_texture
				blend_mode = alphamultiply
				alpha = 0.5
			}

			parentanchor = center
			texture_density = 2
		}

		block "tooltip_content" {}
	}

	type lobby_play_single_player_button = widget {
		block "lobby_play_single_player_button_visible_position" {
			visible = "[And(Not(GameLobby.IsStarting), Not(Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible)))]"
			position = { 0 -100 }
		}
		size = { 440 66 }
		parentanchor = bottom|hcenter
		allow_outside = yes
		visible_at_creation = no

		# start - host MP waiting to open server
		button_wax = {
			blockoverride "button_texture" {
				texture = "gfx/interface/buttons/button_wax_country_blue.dds"
			}
			parentanchor = center
			visible_at_creation = no
			visible = "[And(Not(GameIsMultiplayer), GameLobby.GetWaitForOpenToMultiplayer)]"
			using = button_resize_to_fit_text
			margin = { 40 20 }
			fontsize = 20
			text = "LOBBY_MULTIPLAYER_WAITING_TO_HOST"
			tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "LOBBYVIEW_OPEN_MP_TT" } enabled = no } }
			enabled = no
		}

		# start - hosted MP only in preparation lobby
		button_wax = {
			blockoverride "button_texture" {
				texture = "gfx/interface/buttons/button_wax_yellow.dds"
			}

			parentanchor = center
			visible_at_creation = no
			visible = "[And3(GameIsMultiplayer, Not(GameLobby.GetWaitForOpenToMultiplayer), IsPreparationLobby)]"
			using = button_resize_to_fit_text
			margin = { 40 20 }
			fontsize = 20
			text = "[SelectLocalization(GameIsMultiplayer, 'LOBBY_START_MULTIPLAYER', Select_CString(LobbyView.HasSelectedPlayable, 'LOBBY_START', Select_CString(LobbyView.IsObserver, 'LOBBY_START_OBSERVER', 'SELECT_TITLE_FRONTEND')))]"

			enabled = "[And3(GameLobby.CanStart, Not(HasHostError), Not(LobbyView.ShowHosting))]"
			tooltipwidget = {BasicFunctionalTooltip = {}}
			action_tooltip = {
				click_type = left
				click_mode = single
				enabled = "[GameLobby.CanStart]"
				on_action = "[StartLobbyGame]"
				title = "[SelectLocalization(GameIsMultiplayer, 'LOBBY_START_MULTIPLAYER', Select_CString(LobbyView.HasSelectedPlayable, 'LOBBY_START', Select_CString(LobbyView.IsObserver, 'LOBBY_START_OBSERVER', 'SELECT_TITLE_FRONTEND')))]"
				conditions = "[GameLobby.CanStartTT]"
			}
		}

		# start - MP when game already started and SP
		button_wax = {
			blockoverride "button_texture" {
				texture = "gfx/interface/buttons/button_wax_yellow.dds"
			}

			allow_outside = yes
			parentanchor = center
			visible_at_creation = no
			visible = "[Or(And(GameIsMultiplayer, Not(IsPreparationLobby)), And(Not(GameIsMultiplayer), Not(GameLobby.GetWaitForOpenToMultiplayer)))]"
			
			using = button_resize_to_fit_text
			margin = { 40 20 }
			fontsize = 20
			default_format = "#yellow_titles"
			text = "[GameLobby.GetStartButtonText]"
			enabled = "[GameLobby.CanJoin]"
			tooltipwidget = {BasicFunctionalTooltip = {}}
			action_tooltip = {
				click_type = left
				click_mode = single
				enabled = "[GameLobby.CanJoin]"
				on_action = "[HideGameRules]"
				on_action = "[HideModsView]"
				on_action = "[GameLobby.Vars.Clear('tab')]"
				on_action = "[LobbyView.ControlSelected]"
				on_action = "[GameLobby.Ready]"
				title = "[GameLobby.GetStartButtonText]"
				conditions = "[GameLobby.CanJoinTT]"
			}
		}

		flowcontainer = {
			# not visible if host MP waiting to open server
			visible_at_creation = no
			visible = "[Not(GameIsMultiplayer)]"

			parentanchor = top|hcenter
			widgetanchor = bottom|hcenter
			position = { 0 -10 }
			margin = { 5 2 }
			spacing = 0

			using = bg_paper_card
			using = bg_cabinet_card_frame

			widget = {
				size = { 50 50 }
				tooltipwidget = {
					ContextualTooltipType = {
						blockoverride "title_icon" {

							# # # Ironman on
							icon = {
								visible = "[GameIsIronman]"
								using = tooltip_title_icon_size
								texture = "gfx/interface/icons/flat_icons/ironman_flat.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
							# # # Ironman off
							icon = {
								visible = "[Not( GameIsIronman )]"
								using = tooltip_title_icon_size
								texture = "gfx/interface/icons/flat_icons/ironman_off.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
						}
						
						blockoverride "title_text" {
							text = "IRONMAN_LABEL"
						}

						blockoverride "tooltip_content" {
							TooltipTextBlock = {
								blockoverride "text" {
									text = "PLAY_BUTTON_IRONMAN_MODE_TOOLTIP"
								}
							}
						}
					}
				}

				# # # Ironman on
				icon = {
					visible = "[GameIsIronman]"
					parentanchor = center
					size = { 60% 60% }
					texture = "gfx/interface/icons/flat_icons/ironman_flat.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}

				# # # Ironman off
				icon = {
					visible = "[Not( GameIsIronman )]"
					parentanchor = center
					size = { 60% 60% }
					texture = "gfx/interface/icons/flat_icons/ironman_off.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}
			}

			widget = {
				size = { 50 50 }
				tooltipwidget = {
					ContextualTooltipType = {
						blockoverride "title_icon" {
							# # # Cannot Get Achievement
							icon = {
								using = tooltip_title_icon_size
								visible = "[Not( CanGetAchievements )]"
								texture = "/gfx/interface/icons/flat_icons/cannot_get_achievement.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
							# # # Can Get Achievement
							icon = {
								using = tooltip_title_icon_size
								visible = "[CanGetAchievements]"
								texture = "/gfx/interface/icons/flat_icons/achievement.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
						}

						blockoverride "title_text" {
							text = "ACHIEVEMENTS_LABEL"
						}

						blockoverride "tooltip_content" {
							TooltipTextBlock = {
								blockoverride "text" {
									text = "PLAY_BUTTON_ACHIEVEMENTS_TOOLTIP"
								}
							}
						}
					}
				}
				
				# # # Cannot Get Achievement
				icon = {
					parentanchor = center
					size = {50% 50%}
					visible = "[Not( CanGetAchievements )]"
					texture = "/gfx/interface/icons/flat_icons/cannot_get_achievement.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}
				
				# # # Can Get Achievement
				icon = {
					parentanchor = center
					size = {50% 50%}
					visible = "[CanGetAchievements]"
					texture = "/gfx/interface/icons/flat_icons/achievement.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}
			}
		}
		flowcontainer = {
			# not visible if host MP waiting to open server
			visible_at_creation = no
			visible = "[GameIsMultiplayer]"

			parentanchor = top|hcenter
			widgetanchor = bottom|hcenter
			position = { 0 -70 }
			margin = { 5 2 }
			spacing = 0

			using = bg_paper_card
			using = bg_cabinet_card_frame

			widget = {
				size = { 50 50 }
				tooltipwidget = {
					ContextualTooltipType = {
						blockoverride "title_icon" {

							# # # Ironman on
							icon = {
								visible = "[GameIsIronman]"
								using = tooltip_title_icon_size
								texture = "gfx/interface/icons/flat_icons/ironman_flat.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
							# # # Ironman off
							icon = {
								visible = "[Not( GameIsIronman )]"
								using = tooltip_title_icon_size
								texture = "gfx/interface/icons/flat_icons/ironman_off.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
						}
						
						blockoverride "title_text" {
							text = "IRONMAN_LABEL"
						}

						blockoverride "tooltip_content" {
							TooltipTextBlock = {
								blockoverride "text" {
									text = "PLAY_BUTTON_IRONMAN_MODE_TOOLTIP"
								}
							}
						}
					}
				}

				# # # Ironman on
				icon = {
					visible = "[GameIsIronman]"
					parentanchor = center
					size = { 60% 60% }
					texture = "gfx/interface/icons/flat_icons/ironman_flat.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}

				# # # Ironman off
				icon = {
					visible = "[Not( GameIsIronman )]"
					parentanchor = center
					size = { 60% 60% }
					texture = "gfx/interface/icons/flat_icons/ironman_off.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}
			}

			widget = {
				size = { 50 50 }
				tooltipwidget = {
					ContextualTooltipType = {
						blockoverride "title_icon" {
							# # # Cannot Get Achievement
							icon = {
								using = tooltip_title_icon_size
								visible = "[Not( CanGetAchievements )]"
								texture = "/gfx/interface/icons/flat_icons/cannot_get_achievement.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
							# # # Can Get Achievement
							icon = {
								using = tooltip_title_icon_size
								visible = "[CanGetAchievements]"
								texture = "/gfx/interface/icons/flat_icons/achievement.dds"

								glow = {
									name = "drop_shadow"
									glow_radius = 3
									color = {0.0 0.0 0.0 1.0}
									alpha = 0.6
								}
							}
						}

						blockoverride "title_text" {
							text = "ACHIEVEMENTS_LABEL"
						}

						blockoverride "tooltip_content" {
							TooltipTextBlock = {
								blockoverride "text" {
									text = "PLAY_BUTTON_ACHIEVEMENTS_TOOLTIP"
								}
							}
						}
					}
				}
				
				# # # Cannot Get Achievement
				icon = {
					parentanchor = center
					size = {50% 50%}
					visible = "[Not( CanGetAchievements )]"
					texture = "/gfx/interface/icons/flat_icons/cannot_get_achievement.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}
				
				# # # Can Get Achievement
				icon = {
					parentanchor = center
					size = {50% 50%}
					visible = "[CanGetAchievements]"
					texture = "/gfx/interface/icons/flat_icons/achievement.dds"

					glow = {
						name = "drop_shadow"
						glow_radius = 3
						color = {0.0 0.0 0.0 1.0}
						alpha = 0.6
					}
				}
			}
		}
	}

	type lobby_mp_ready_button = widget {
		size = { 310 67 }
		parentanchor = bottom|hcenter
		
		# Only if is preparation lobby, after game started we don't need the ready button
		visible_at_creation = no

		block "lobby_mp_ready_button_visible_position" {
			position = { 0 -168 }
			visible = "[And(And3(GameIsMultiplayer, IsPreparationLobby, Not(LobbyView.ShowHosting)), 
				Not(Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible)))]"
		}

		# Ready
		button_wax = {
			blockoverride "button_texture" {
				texture = "gfx/interface/buttons/button_wax_country_blue.dds"
			}
			parentanchor = center
			using = button_resize_to_fit_text
			margin = { 40 20 }
			fontsize = 18
			visible_at_creation = no
			visible = "[And(Or(Not(IsPlayer), Not(LobbyView.CanControlSelected)), Not(LobbyView.IsObserver))]"
			text = "[SelectLocalization(LobbyView.HasSelectedPlayable, 'LOBBY_SELECT_MULTIPLAYER', 'SELECT_TITLE_FRONTEND')]"
			enabled = "[GameLobby.CanJoin]"

			tooltipwidget = {BasicFunctionalTooltip = {}}

			action_tooltip = {
				click_type = left
				click_mode = single
				enabled = "[GameLobby.CanJoin]"
				on_action = "[LobbyView.ControlSelected]"
				on_action = "[GameLobby.Ready]"
				title = "[SelectLocalization(LobbyView.HasSelectedPlayable, 'LOBBY_SELECT_MULTIPLAYER', 'SELECT_TITLE_FRONTEND')]"
				conditions = "[GameLobby.CanJoinTT]"
			}
		}

		# Unready
		button_wax = {
			blockoverride "button_texture" {
				texture = "gfx/interface/buttons/button_wax_country_blue.dds"
			}
			parentanchor = center
			using = button_resize_to_fit_text
			margin = { 40 20 }
			fontsize = 18
			visible_at_creation = no
			visible = "[And(IsPlayer, LobbyView.CanControlSelected)]"
			text = "LOBBY_UNSELECT_MULTIPLAYER"
			onclick = "[UnselectLobbyCountry]"
			enabled = "[GameLobby.CanUnSelect]"

			tooltipwidget = {BasicFunctionalTooltip = {}}
			action_tooltip = {
				click_type = left
				click_mode = single
				title = "LOBBY_UNSELECT_MULTIPLAYER"
				on_action = "[UnselectLobbyCountry]"
				enabled = "[GameLobby.CanUnSelect]"
			}
		}

		# Observer
		button_wax = {
			blockoverride "button_texture" {
				texture = "gfx/interface/buttons/button_wax_country_blue.dds"
			}
			parentanchor = center
			using = button_resize_to_fit_text
			margin = { 40 20 }
			fontsize = 18
			visible_at_creation = no
			visible = "[LobbyView.IsObserver]"
			text = "[GameLobby.GetObserveCountryButtonMPText]"
			enabled = "[LobbyView.HasSelectedPlayable]"
			
			tooltipwidget = {BasicFunctionalTooltip = {}}
			action_tooltip = {
				click_type = left
				click_mode = single
				title = "[GameLobby.GetObserveCountryButtonMPText]"
				on_action = "[ObserverMPButtonOnClick]"
				enabled = "[LobbyView.HasSelectedPlayable]"
			}
		}
	}
}

JominiMultiplayerLobby = {

	# CLOUD SAVE INDICATOR
	icon = {
		name = "cloud_save_indicator"
		position = { -330 2 }
		parentanchor = top|right
		texture = "gfx/interface/settings/on_save.dds"
		shaderfile = "gfx/FX/pdxgui_glow_game.shader"
		tooltipwidget = {
			ContextualTooltipType = {
				blockoverride "title_icon" {
					icon = {
						size = { 50 50 }
						texture = "gfx/interface/icons/flat_icons/cloud_save_flat.dds"
					}
				}

				blockoverride "title_text" {
					text = "LOAD_CLOUDSAVE_TOOLTIP"
				}

				blockoverride "tooltip_content" {
					TooltipTextBlock = {
						blockoverride "text" {
							text = "CLOUD_SAVE_IN_PROGRESS_TOOLTIP"
						}
					}
				}
			}
		}
		visible_at_creation = no
		visible = "[GameIsCloudStorageOperationInProgress]"
	}

	# VERSION INFO BOX
	widget = {
		visible_at_creation = no
		visible = "[Not(GameLobby.Vars.Exists('tab'))]"
		parentanchor = bottom|right
		position = { -10 -10 }
		using = custom_version_label
		using = Animation_Show_Hide_UI_Lobby
	}

	# ERROR PLATYPUS
	error_platypus = {
		visible_at_creation = no
		visible = "[HasErrors]"
		parentanchor = bottom|right
		position = { -500 0 }
	}

	# READY BUTTON
	lobby_mp_ready_button = {}
	lobby_mp_ready_button = {
		blockoverride "lobby_mp_ready_button_visible_position" {
			position = { 0 -207 }
			visible = "[And(And3(GameIsMultiplayer, IsPreparationLobby, Not(LobbyView.ShowHosting)), 
				Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible))]"
		}
	}

	# Country Flavour Info
	vbox = {
		visible_at_creation = no
		visible = "[LobbyView.HasSelectedPlayable]"
		parentanchor = top|hcenter
		margin = {520 40}

		layoutpolicy_horizontal = expanding
	}

	# PLAY BUTTON
	lobby_play_single_player_button = {}
	lobby_play_single_player_button = {
		blockoverride "lobby_play_single_player_button_visible_position" {
			visible = "[And(Not(GameLobby.IsStarting), Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible))]"
			position = { 0 -140 }
		}
	}

	# MAPMODES
	mapmodes_collapsed_window = {
		allow_outside = yes
	}

	mapmode_current_button = {
		allow_outside = yes
		parentanchor = hcenter|bottom
		position = { 0 -50 }
		visible_at_creation = no
		visible = "[Not(Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible))]"
		state = {
			name = _show
			alpha = 0
			next = show_wait
		}

		state = {
			name = show_wait
			duration = 0.2
			alpha = 0
			next = show_final
		}

		state = {
			name = show_final
			duration = 0.2
			bezier = { 0.0 1.0 0.0 1.0 }
			alpha = 1
		}						
	
		state = {
			name = _hide
			alpha = 0
		}


		mapmodes_color_ledger = {
			visible_at_creation = no
			visible = "[And(HasMapColorLedger, And(MapModeSelectorVars.Exists('color_ledger'), Not(Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible))))]"
			parentanchor = right|bottom
			widgetanchor = left|bottom
			position = { 10 0 }
		}
	}

	mapmodes_button_color_ledger = {
		allow_outside = yes
		blockoverride "button_ledger_position_visible" {
			position = { 140 0 }
			parentanchor = hcenter|bottom
			visible_at_creation = no
			visible = "[Not(Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible))]"
		}

		mapmodes_color_ledger = {
			visible_at_creation = no
			visible = "[And(HasMapColorLedger, And(MapModeSelectorVars.Exists('color_ledger_bottom'),
				Not(Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible))))]"
			parentanchor = left|top
			widgetanchor = left|bottom
			position = { 0 -10 }
		}
	}

	mapmodes_button_color_ledger = {
		allow_outside = yes
		blockoverride "button_ledger_position_visible" {
			position = { 340 0 }
			parentanchor = hcenter|bottom
			visible_at_creation = no
			visible = "[Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible)]"
		}

		mapmodes_color_ledger = {
			visible_at_creation = no
			visible = "[And(HasMapColorLedger, And(MapModeSelectorVars.Exists('color_ledger_bottom'),
				Or3(MapModeSelectorVars.Exists('hover'), MapModeSelectorVars.Exists('action'), MapModeSelectorVars.IsVisible)))]"
			parentanchor = left|top
			widgetanchor = left|bottom
			position = { 0 -10 }
		}
	}

	mapmodes_window = {
		blockoverride "mapmodes_window_extra" {
			parentanchor = hcenter|bottom

			mapmodes_color_ledger = {
				visible_at_creation = no
				visible = "[And(HasMapColorLedger, And(MapModeSelectorVars.Exists('color_ledger'),
					Not(MapModeSelectorVars.Exists('action'))))]"
				parentanchor = hcenter|bottom
				position = { 270 -105 }
			}

			mapmode_current_button = {
				visible_at_creation = no
				visible = "[Not(MapModeSelectorVars.Exists('tab'))]"
				parentanchor = hcenter|top
				widgetanchor = hcenter|bottom
				position = { 0 -10 }
			}
		}
	}

	# TOP BAR
	widget = {
		size = { 100% 40 }
		parentanchor = top|hcenter
		alwaystransparent = no
		filter_mouse = right|left
		using = LobbyTopbarBg

		using = Animation_Show_Hide_UI_Lobby

		hbox = {
			
			margin_top = 2

			# LEFT BUTTONS
			widget = {
				size = { 570 34 }
				LobbyViewButtons = {}
			}

			# divider_solid_gold = {
			# 	layoutpolicy_vertical = fixed
			# 	layoutpolicy_horizontal = fixed
			# 	size = { 2 34 }
			# }

			expand = {}

			# DATE
			widget = {
				using = layoutpolicy_expanding

				# BACK TO SINGLE PLAYER BUTTON
				button_regular = {
					size = { 210 100% }
					position = { 15 0 }
					visible_at_creation = no
					visible = "[Or(GameIsMultiplayer, LobbyView.HasServerInfo)]"

					fontsize = 15
					text = "BECOME_SINGLE_PLAYER"

					tooltipwidget = {BasicFunctionalTooltip = {}}

					action_tooltip = {
						click_type = left
						click_mode = single
						title = "BECOME_SINGLE_PLAYER_TT"
						on_action = "[BecomeSinglePlayer]"
						on_action = "[UnselectLobbyCountry]"
					}
				}

				hbox = {
					parentanchor = center
					using = layoutpolicy_expanding
					spacing = 20

					expand = {}

					text_single = {
						maximumsize = { 510 -1 }
						align = left|nobaseline

						using = Font_Type_Headers
						using = Font_Size_Medium
						default_format = "#color_white"

						text = "THE_WORLD_CATCHING_UP"
						visible_at_creation = no
						visible = "[IsLocalPlayerReplayingCommands]"
					}

					text_single = {
						maximumsize = { 510 -1 }
						align = left|nobaseline

						using = Font_Type_Headers
						using = Font_Size_Medium
						default_format = "#color_white"

						text = "CURRENT_DATE_STRING"
						visible_at_creation = no
						visible = "[Not(IsLocalPlayerReplayingCommands)]"
					}

					expand = {}
				}

				hbox = {
					visible_at_creation = no
					visible = "[GameIsMultiplayer]"
					spacing = 10
					margin = {10 0}

					expand = {}

					text_single = {
						layoutpolicy_vertical = expanding
						maximumsize = {200 -1}

						using = Font_Type_Headers
						using = Font_Size_Medium
						default_format = "#color_white"
						text = "LOBBY_MULTIPLAYER_GAME"

					}

					# header_button_left = {
					# 	size = { 25 25 }

					# 	enabled = "[TransferUnit.CanTransfer]"
					# 	action_tooltip = {
					# 		click_type = left
					# 		click_mode = single
					# 		enabled = "[TransferUnit.CanTransfer]"
					# 		title = "[TransferUnit.GetTransferInfo]"	
					# 		on_action = "[TransferUnit.Transfer]"
					# 	}

					# 	tooltipwidget = {
					# 		BasicFunctionalTooltip = {}
					# 	}	

					# 	onclick = "[ToggleMultiplayerChat]"
					# 	tooltipwidget = {
					# 		LeftClickButtonTooltip = {
					# 			blockoverride "onclick_text" { text = "[GetMultiplayerChat.GetTooltip]" }
					# 		}
					# 	}

					# 	blockoverride "button_icon_stretch_sprite" {}
					# 	blockoverride "header_button_frame_inner" {visible = no}
					# 	blockoverride "header_button_icon_size" { size = { 24 24 } }
					# 	blockoverride "header_button_text_layout" {}
					# 	blockoverride "icon_texture" {
					# 		texture = "gfx/interface/icons/flat_icons/dialect.dds"
					# 		using = button_panel_tab_icon_effect
					# 		blockoverride "icon_effect_visible" {visible = "[IsMultiplayerChatShown]"}
					# 	}
					# 	piechart = {
					# 		using = bg_circle
					# 		parentanchor = top|right
					# 		visible = "[MPChatNewMessage]"
					# 		size = { 10 10 }

					# 		pieslice_no_highlight = {
					# 			alwaystransparent = yes
					# 			texture = "gfx/interface/pie_charts/pie_chart_blue_progress.dds"
					# 			value = 100
					# 			color = { 1 1 1 1 }
					# 		}
					# 	}
					# }

					widget = {
						size = { 30 30 }

						header_button_left = {
							size = { 100% 100% }
							parentanchor = center
							position = { 0 -1 }

							onclick = "[ToggleMultiplayerChat]"
							tooltipwidget = {
								LeftClickButtonTooltip = {
									blockoverride "onclick_text" { text = "[GetMultiplayerChat.GetTooltip]" }
								}
							}

							blockoverride "icon_overlay" {
								modify_texture = {
									visible = "[IsMultiplayerChatShown]"
									using = color_bone_texture
									alpha = 0.3
								}

								glow = {
									visible = "[IsMultiplayerChatShown]"
									glow_radius = 3
									color = { 0.80 0.68 0.39 1.0 }
									alpha = 0.6
								}
								
							}
							blockoverride "button_icon_stretch_sprite" {}
							blockoverride "header_button_frame_inner" {visible = no}
							blockoverride "header_button_icon_size" { size = { 24 24 } }
							blockoverride "header_button_text_layout" {

							}
							blockoverride "icon_texture" {
								texture = "gfx/interface/icons/flat_icons/dialect.dds"
							}
							blockoverride "header_button_widget_extra" {
								piechart = {
									ignore_layout = yes
									using = bg_circle
									parentanchor = top|right
									visible = "[MPChatNewMessage]"
									size = { 10 10 }
		
									pieslice_no_highlight = {
										alwaystransparent = yes
										texture = "gfx/interface/pie_charts/pie_chart_blue_progress.dds"
										value = 100
										color = { 1 1 1 1 }
									}
								}
							}
						}
						# card_header_button_01 = {
						# 	size = { 100% 100% }
						# 	parentanchor = center
						# 	position = { 0 -1 }
	
						# 	using = bg_card_header_01
						# 	blockoverride "bg_card_header_01_bg" {
						# 		background = {
						# 			texture = "gfx/interface/component_tiles/square_tile.dds"
						# 			texture_density = 2
						# 			spriteType = corneredtiled
						# 			spriteborder = { 10 10 }
	
						# 			modify_texture = {
						# 				using = color_greyish_texture
						# 				blend_mode = multiply
						# 			}
	
						# 			modify_texture = {
						# 				texture = "gfx/interface/cards/headers/header_pattern_07.dds"
						# 				alpha = 0.7
						# 				texture_density = 2
						# 				spriteType = corneredtiled
						# 				blend_mode = overlay
						# 			}
						# 		}
						# 	}
	
						# 	onclick = "[ToggleMultiplayerChat]"
						# 	tooltipwidget = {
						# 		LeftClickButtonTooltip = {
						# 			blockoverride "onclick_text" { text = "[GetMultiplayerChat.GetTooltip]" }
						# 		}
						# 	}
						# 	icon = {
						# 		parentanchor = center
						# 		size = { 60% 60% }
						# 		texture = "gfx/interface/icons/flat_icons/dialect.dds"
	
						# 		modify_texture = {
						# 			using = color_new_gold_texture
						# 			blend_mode = multiply
						# 			alpha = 0.1
						# 		}
						# 		using = button_panel_tab_icon_effect
						# 		blockoverride "icon_effect_visible" {visible = "[IsMultiplayerChatShown]"}
						# 	}
						# 	piechart = {
						# 		using = bg_circle
						# 		parentanchor = top|right
						# 		visible = "[MPChatNewMessage]"
						# 		size = { 10 10 }
	
						# 		pieslice_no_highlight = {
						# 			alwaystransparent = yes
						# 			texture = "gfx/interface/pie_charts/pie_chart_blue_progress.dds"
						# 			value = 100
						# 			color = { 1 1 1 1 }
						# 		}
						# 	}
						# }
					}
				}
			}

			expand = {}

			# divider_solid_gold = {
			# 	layoutpolicy_vertical = expanding
			# 	layoutpolicy_horizontal = fixed
			# 	size = { 2 34 }
			# }

			# RIGHT BUTTONS

			widget = {
				layoutpolicy_vertical = expanding
				size = { 430 -1 }

				LobbyViewTabs = {}
			}
		}
	}
	
	container = {
		parentanchor = top|hcenter
		position = { 0 60 }

		paused_indicator = {
			parentanchor = center
			visible_at_creation = no
			visible = "[And8(GameIsMultiplayer, Not(IsPreparationLobby), Not(HasGameStartedForTheFirstTime), Not(IsSaving), Not(IsWritingDumps), Not(IsRecalculatingCacheData), Not(IsPlayerHotjoining), Not(IsDisconnecting))]"
		}

		saving_indicator = {
			parentanchor = center
			visible_at_creation = no
			visible = "[IsSaving]"
		}

		oos_indicator = {
			parentanchor = center
			visible_at_creation = no
			visible = "[IsWritingDumps]"
		}

		recalculate_indicator = {
			parentanchor = center
			visible_at_creation = no
			visible = "[And(IsRecalculatingCacheData, GameIsMultiplayer)]"
		}

		player_joining_indicator = {
			parentanchor = center
			visible_at_creation = no
			visible = "[And5(IsPlayerHotjoining, Not(IsRecalculatingCacheData), Not(IsWritingDumps), Not(IsSaving), Not(IsDisconnecting))]"
		}

		disconnecting_indicator = {
			parentanchor = center
			visible_at_creation = no
			visible = "[And4(IsDisconnecting, Not(IsSaving), Not(IsWritingDumps), Not(IsRecalculatingCacheData))]"
		}
	}

	widget = {
		visible = "[GameLobby.Vars.Exists('tab')]"
		parentanchor = top|right
		position = { 0 42 }
		size = { 40 40 }

		ui_direction_button_holder_right = {}

		close_right_tabs = {
			blockoverride "close_onclick" {
				visible = "[GameLobby.Vars.HasValue('tab', 'GameRules')]"
				onclick = "[HideGameRules]"
				onclick = "[GameLobby.Vars.SetOrToggle('tab','GameRules')]"
			}
		}
		close_right_tabs = {
			blockoverride "close_onclick" {
				visible = "[GameLobby.Vars.HasValue('tab', 'country_list')]"
				onclick = "[HideModsView]"
				onclick = "[GameLobby.Vars.SetOrToggle('tab','country_list')]"
			}
		}
		close_right_tabs = {
			blockoverride "close_onclick" {
				visible = "[GameLobby.Vars.HasValue('tab', 'DLC')]"
				onclick = "[HideModsView]"
				onclick = "[GameLobby.Vars.SetOrToggle('tab','DLC')]"
			}
		}
		close_right_tabs = {
			blockoverride "close_onclick" {
				visible = "[GameLobby.Vars.HasValue('tab', 'multiplayer')]"
				onclick = "[GameLobby.Vars.SetOrToggle('tab','multiplayer')]"
			}
		}
	}
	blockoverride "left_panel_content" {
		using = layoutpolicy_expanding
		margin_top = 40
		filter_mouse = all

		vbox = {
			using = layoutpolicy_expanding
			using = bg_lateralview
			visible_at_creation = no
			visible = "[And(LobbyView.HasSelectedPlayable, Not(GameLobby.Vars.HasValue('subtab', 'selected_country')))]"
			LobbySelectedCountryPanel = {}
			name = "lobby_left_panel"
		}
	}

	blockoverride "right_panel" {
		widget = {
			parentanchor = right
			widgetanchor = right
			filter_mouse = all

			@right_panel_width = 430
			@right_panel_x = 0

			size = { @right_panel_width 100% }
			position = { @right_panel_x 0 }

			state = {
				name = hide_ui_lobby
				using = Animation_Show_Hide_Properties

				position_x = @right_panel_width
				alpha = 0
			}

			state = {
				name = show_ui_lobby
				using = Animation_Show_Hide_Properties

				position_x = @right_panel_x
				alpha = 1
			}

			vbox = {
				margin_top = 40
				LobbyViewGameInfoPanel = {}

				vbox = {
					using = layoutpolicy_expanding
					using = bg_lateralview
					visible_at_creation = no
					visible = "[And(GameLobby.Vars.HasValue( 'tab', 'multiplayer' ), Not(LobbyView.HasServerInfo))]"
					LobbyMultiplayerPanelNoServer = {}
				}

				vbox = {
					using = layoutpolicy_expanding
					using = bg_lateralview
					visible_at_creation = no
					visible = "[And(GameLobby.Vars.HasValue( 'tab', 'multiplayer' ), LobbyView.HasServerInfo)]"
					LobbyMultiplayerPanel = {}
				}

				vbox = {
					using = layoutpolicy_expanding
					using = bg_lateralview
					visible_at_creation = no
					visible = "[GameLobby.Vars.HasValue( 'tab', 'country_list' )]"
					LobbyCountryListWidget = {
						blockoverride "difficulty_sort_highlight" {
							sort_by_highlight = {
								name = "difficulty"
							}
						}

						blockoverride "name_sort_highlight" {
							sort_by_highlight = {
								name = "name"
							}
						}

						blockoverride "population_sort_highlight" {
							sort_by_highlight = {
								name = "population"
							}
						}

						blockoverride "country_type_sort_highlight" {
							sort_by_highlight = {
								name = "country_type"
							}
						}
					}
				}
			}
		}
	}

	# [SD] CASEAR-55844 assets cleanup - commenting unused(?) gui script
	# blockoverride "window_background" {
	# 	texture = "gfx/interface_old/from_sulla/small_window_frame_corners_copy.dds"
	# 	spriteType = Corneredtiled
	# 	spriteborder = { 32 24 }
	# 	margin = { 0 0 }
	# 	shaderfile = "gfx/FX/pdxgui_default.shader"
	# }

	# using this to set priority to the cw type
	blockoverride "observer_button"  {}

	blockoverride "collapse_button_properties" {
		using = button_default_template
	}

	blockoverride "expand_button_properties" {
		using = button_default_template
	}

	blockoverride "text_edit_button" {
		using = button_default_template
	}

	blockoverride "buttonstyle" {
		using = button_default_template
	}

	blockoverride "host_modify_button" {}

	# [SD] CASEAR-55844 assets cleanup - commenting unused(?) gui script
	# blockoverride "remove_player_button_style" {
	# 	texture = "gfx/interface_old/from_sulla/font_icon_paper_cross.dds"
	# 	gfxtype = framedbuttongfx
	# 	effectname = "NoHighlight"
	# 	framesize = { 16 16 }
	# 	upframe = 1
	# 	downframe = 2
	# 	overframe = 2
	# }

	blockoverride "jomini_standard_textbox" {
		using = Font_Type_Standard
	}

	blockoverride "host_button" {
		using = button_default_template
		text = "JOMINI_MULTIPLAYER_GUI_HOST_BUTTON"
	}

	blockoverride "player_item_styling" {
		background = {
			using = bg_container_framed_texture
		}
	}

	blockoverride "playable_icon" {
		hbox = {
			visible_at_creation = no
			visible = "[LobbyPlayer.HasPlayable]"

			country_flag_mid = {
				visible = "[LobbyPlayer.HasPlayable]"
				datacontext = "[LobbyPlayer.GetPlayable.GetCountry]"

				blockoverride "click" {
					onclick = "[PanToCountry(GetCountry( LobbyPlayer.GetPlayable.GetCountry.GetTag ).Self)]"
				}

				contextmenu_enabled = no
				blockoverride "hover" {}
			}

			text_single = {
				text = "[LobbyPlayer.GetPlayable.GetCountry.GetName]"
				align = center
			}
		}
	}

	blockoverride "playerlist_playable" {
		visible = no
	}

	blockoverride "playerlist_item_content" {

		using = bg_paper_card
		using = bg_cabinet_card_frame
		margin = { 5 0 }
		widget = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding

			hbox = {
				margin = { 0 5 }
				vbox = {
					using = layoutpolicy_expanding

					hbox = {
						using = layoutpolicy_expanding
						margin = { 5 0 }
						spacing = 5
						margin_left = 75

						using = bg_card_header_01
						widget = {
							visible = "[LobbyPlayer.IsObserver]"
							size = { 24 24 }
							icon = {
								size = { 24 24 }
								texture = "gfx/interface/icons/unit_view/army_visible_icon.dds"
							}
						}
						text_single = {
							layoutpolicy_horizontal = expanding
							align = nobaseline
							text = "[LobbyPlayer.GetName]"
						}

						text_single = {
							visible = "[LobbyPlayer.IsHost]"
							align = nobaseline
							text = "HOST"
						}
					}

					hbox = {
						using = layoutpolicy_expanding
						margin = { 3 0 }
						margin_top = 5
						spacing = 10
						margin_left = 85

						text_single = {
							visible = "[LobbyPlayer.GetPlayable.GetCountry.IsValid]"
							text = "[LobbyPlayer.GetPlayable.GetCountry.GetName]"
							autoresize = yes
							align = nobaseline
						}

						widget = {
							layoutpolicy_horizontal = expanding
						}

						hbox = {
							using = bg_text_mask_container_brown
							minimumsize = {-1 30}

							hbox = {
								margin = {10 0}
								# Readyness
								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_READY"
									visible = "[And4(LobbyPlayer.IsReady, LobbyPlayer.IsDoneReplayingCommands, Not(LobbyPlayer.IsObserver), Not(LobbyPlayer.IsHotjoining))]"
									align = nobaseline|right
								}
		
								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_NOT_READY"
									visible = "[And4(Not(LobbyPlayer.IsReady), LobbyPlayer.IsDoneReplayingCommands, Not(LobbyPlayer.IsObserver), Not(LobbyPlayer.IsHotjoining))]"
									align = nobaseline|right
								}
		
								text_single = {
									visible = "[And(Not(LobbyPlayer.IsHotjoining), Not(LobbyPlayer.IsDoneReplayingCommands))]"
									text = "MULTIPLAYER_LOADING"
									align = nobaseline|right
								}
		
								text_single = {
									text = "JOMINI_MULTIPLAYER_GUI_OBSERVER"
									visible = "[LobbyPlayer.IsObserver]"
									align = nobaseline|right
								}
		
								text_single = {
									visible = "[And(LobbyPlayer.IsHotjoining, IsHost)]"
									text = "JOMINI_MULTIPLAYER_GUI_HOTJOIN_PROGRESS"
									align = nobaseline|right
								}
		
								text_single = {
									visible = "[And(LobbyPlayer.IsHotjoining, Not(IsHost))]"
									text = "MULTIPLAYER_JOINING_CLIENT"
									align = nobaseline|right
								}
							}
							
							header_button_left = {
								size = {30 30}
								blockoverride "button_icon_stretch_sprite" {}
								blockoverride "header_button_frame_inner" {visible = no}
								blockoverride "header_button_icon_size" { size = { 30 30 } }
								blockoverride "header_button_text_layout" {}
								blockoverride "header_button_icon_obj" {
									icon = {
										parentanchor = center
										size = { 20 20 }
										texture = "gfx/interface/icons/diplomatic_status/ai_accept_decline_icon.dds"
										frame_grid = {3 1}
										frame = 1
									}
								}
	
								enabled = "[LobbyPlayer.CanRemovePlayer]"
								visible = "[LobbyPlayer.CanRemovePlayer]"
								tooltipwidget = {BasicFunctionalTooltip = {}}
								action_tooltip = {
									click_type = left
									click_mode = single
									visible = "[LobbyPlayer.CanRemovePlayer]"
									title = "JOMINI_MULTIPLAYER_GUI_PLAYER_KICK_BUTTON_LABEL_TT"
									on_action = "[LobbyPlayer.RemovePlayer]"
								}
							}
	
							header_button_left = {
								size = {30 30}
								blockoverride "button_icon_stretch_sprite" {}
								blockoverride "header_button_frame_inner" {visible = no}
								blockoverride "header_button_icon_size" { size = { 30 30 } }
								blockoverride "header_button_text_layout" {}
								blockoverride "header_button_icon_obj" {
									icon = {
										parentanchor = center
										size = { 20 20 }
										texture = "gfx/interface/buttons/flats/clean_text.dds"
										modify_texture = {
											using = color_new_gold_texture
											blend_mode = add
										}
										modify_texture = {
											using = overlay_window_texture
											blend_mode = overlay
											alpha = 0.5
										}
									}
								}
	
								visible = "[And( LobbyPlayer.IsLocalPlayer, LobbyPlayer.IsReady )]"
								tooltipwidget = {BasicFunctionalTooltip = {}}
								action_tooltip = {
									click_type = left
									click_mode = single
									visible = "[And( LobbyPlayer.IsLocalPlayer, LobbyPlayer.IsReady )]"
									title = "JOMINI_MULTIPLAYER_GUI_CLEAR_SELECTION"
									on_action = "[LobbyView.ClearSelection]"
								}
							}
						}
					}
				}
			}

			widget = {
				size = {72 48}
				blockoverride "text_mask_extra" {
					alpha = 0.5
					margin = {-5 -4}
				}
				widget = {
					visible = "[Or(And(Not(LobbyPlayer.HasPlayable), Not(LobbyPlayer.IsObserver)), And(Not(LobbyPlayer.HasObservedPlayable), LobbyPlayer.IsObserver))]"
					size = { 68 46 }
					ignore_layout = yes
					parentanchor = center
					using = bg_paper_card
					using = bg_text_mask_container_dark_brown
					blockoverride "text_mask_extra" {
						margin = {0 0}
					}
					using = bg_cabinet_card_frame
				}
				country_flag_mid = {
					visible = "[And(LobbyPlayer.HasPlayable, Not(LobbyPlayer.IsObserver))]"

					datacontext = "[LobbyPlayer.GetPlayable.GetCountry]"

					blockoverride "click" {
						onclick = "[PanToCountry(GetCountry( LobbyPlayer.GetPlayable.GetCountry.GetTag ).Self)]"
					}

					contextmenu_enabled = no
					blockoverride "double_click" {}
					blockoverride "hover" {}
				}
				country_flag_mid = {
					visible = "[And(LobbyPlayer.HasObservedPlayable, LobbyPlayer.IsObserver)]"

					datacontext = "[LobbyPlayer.GetObservedPlayable.GetCountry]"

					blockoverride "click" {
						onclick = "[PanToCountry(GetCountry( LobbyPlayer.GetObservedPlayable.GetCountry.GetTag ).Self)]"
					}

					contextmenu_enabled = no
					blockoverride "double_click" {}
					blockoverride "hover" {}
				}
				ignore_layout = yes
				parentanchor = left|vcenter
			}
		}
	}

	# [SD] CASEAR-55844 assets cleanup - commenting unused(?) gui script
	# blockoverride "server_info_entry_styling" {
	# 	alwaystransparent = no
	# 	using = Font_Type_Standard
	# 	margin_bottom = 2
	# 	margin_left = 10
	# 	margin_right = 4
	# 	align = left
	# 	elide = right

	# 	icon = {
	# 		name = "frame"
	# 		texture = "gfx/interface_old/from_sulla/list_slot_corner_tiles.dds"
	# 		spriteType = Corneredtiled
	# 		spriteborder = { 12 12 }
	# 		size = { 296 28 }
	# 	}
	# }

	blockoverride "server_info_entry_size" {
		size = { 296 28 }
	}

	# block "servermode_text" {
		text = "JOMINI_MULTIPLAYER_GUI_SESSION_SERVER_MODE"
	# }

	blockoverride "mp_info_margin" {
		# margin_left = 18
	}

	blockoverride "mp_info_item_spacing" {
		spacing = 3
		margin_top = 8
	}

	# [SD] CASEAR-55844 assets cleanup - commenting unused(?) gui script
	# blockoverride "mp_info_item_background" {
	# 	using = Font_Type_Standard
	# 	margin_top = 4
	# 	margin_bottom = 5
	# 	margin_left = 10

	# 	icon = {
	# 		texture = "gfx/interface_old/from_sulla/list_slot_corner_tiles.dds"
	# 		spriteType = Corneredtiled
	# 		spriteborder = { 12 12 }
	# 		size = { 296 28 }
	# 	}
	# }

	blockoverride "left_panel_properties" {
		@left_panel_width = 570
		@left_panel_x = 0

		size = { @left_panel_width 100% }
		position = { @left_panel_x 0 }
		@left_panel_width_inverse = @[-left_panel_width]

		state = {
			name = hide_ui_lobby
			using = Animation_Show_Hide_Properties

			position_x = @left_panel_width_inverse
			alpha = 0
		}

		state = {
			name = show_ui_lobby
			using = Animation_Show_Hide_Properties

			position_x = @left_panel_x
			alpha = 1
		}
	}

	blockoverride "setup_textbox" {
		using = text_single_template
	}

	# blockoverride "player_loading_progress" {
	# 	textbox = {
	# 		text = "[LobbyPlayer.GetLoadingString]"
	# 		size = { 80 56 }
	# 		parentanchor = top|right
	# 		visible = "[LobbyPlayer.IsHotjoining]"
	# 		using = Font_Type_Standard
	# 		align = right
	# 	}
	# }

	blockoverride "setup_editbox" {
		using = Font_Type_Standard
		fontsize = 15
		fontcolor = { 1 1 1 1 }
		cursorcolor = { 1 1 0.5 1 }

		background = {
			margin_left = 5
			margin_top = 0
			texture = "gfx/editor_gui/editor_field.dds"
			spriteType = CorneredStretched
			spriteborder = { 4 4 }
			shaderfile = "gfx/FX/pdxgui_default.shader"
		}
	}

	# [SD] CASEAR-55844 assets cleanup - commenting unused(?) gui script
	# blockoverride "setup_checkbutton" {
	# 	texture = "gfx/interface_old/buttons/checkbox.dds"
	# 	framesize = { 36 36 }
	# }
}

JominiLobbyViewEndPreparationConfirmation = {
	blockoverride "properties" {
		modal = yes
		modality = all

		size = { 300 200 }
		parentanchor = center
		widgetanchor = center
	}

	blockoverride "content" {
		textbox = {
			name = "info"
			size = { 100% 50% }
			multiline = yes
			align = center|center
			text = "JOMINI_MULTIPLAYER_GUI_CONFIRMATION"
		}

		JominiLobbyViewButton = {
			onclick = "[EndPrepConfirm.Cancel]"
			text = "JOMINI_MULTIPLAYER_GUI_CANCEL"

			blockoverride "buttonstyle" {
				using = button_default_template
			}
		}

		JominiLobbyViewButton = {
			onclick = "[EndPrepConfirm.Confirm]"
			text = "JOMINI_MULTIPLAYER_GUI_CONFIRM"

			blockoverride "buttonstyle" {
				using = button_default_template
			}
		}
	}
}

JominiMultiplayerJoinRequest = {
	blockoverride "joinrequest_background" {}

	blockoverride "joinrequest_margins" {
		hbox = {
			layoutpolicy_horizontal = expanding
			minimumsize = {-1 50}
			
			using = bg_age_event_title
		
			blockoverride "bg_event_title_texture" {
				texture = "gfx/interface/component_tiles/bg_big_round_corners_up.dds"
				texture_density = 2
				spriteType = corneredstretched
				spriteBorder = { 40 40 }
				margin = {3 0}
				margin_bottom = 22
			}

			widget = {
				layoutpolicy_vertical = expanding
				size = {5 -1}
				
				AgeEventDecorationTop = {
					size = { 64 52 }
					position = { -10 -5 }
					parentanchor = left|top
					widgetanchor = top
				}

				AgeEventDecorationTop2 = {
					position = { -5 -5 }
					size = { 20 25 }
					parentanchor = left|bottom
					widgetanchor = left|vcenter
					mirror = horizontal
				}
			}

			hbox = {
				layoutpolicy_horizontal = expanding
				margin = {30 }

				textbox = {
					layoutpolicy_horizontal = expanding
					autoresize = yes

					using = text_multi_template
					using = Font_Size_Big
					default_format = "#yellow_titles"
					fontsize = 22
					fontsize_min = 15
					align = center|nobaseline
					text = "JOMINI_MULTIPLAYER_GUI_PLAYER_JOIN_REQUEST"
				}
			}

			widget = {
				layoutpolicy_vertical = expanding
				size = {5 -1}

				AgeEventDecorationTop = {
					size = { 64 52 }
					position = { 10 -5 }
					parentanchor = right|top
					mirror = horizontal
				}

				AgeEventDecorationTop2 = {
					position = { 5 -5 }
					size = { 20 25 }
					parentanchor = right|bottom
					widgetanchor = right|vcenter
				}
			}
		}
	}

	blockoverride "joinrequest_font" {
		visible = no
	}

	blockoverride "joinrequest_playername" {
		autoresize = no
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding
		text = "[PlayerJoinRequest.GetPlayerName]"
		using = text_multi_template
		elide = right
		margin = { 15 0 }
	}

	blockoverride "joinrequest_scrollarea_size" {
		size = { 500 200 }
		using = bg_age_event_inner
		using = bg_age_event_frame
	}

	blockoverride "joinrequest_scrollbar" {
		using = Scrollbar_Vertical
	}

	blockoverride "joinrequest_addrow" {
		addrow = 40
	}
	blockoverride "buttonstyle" {
		visible = no
	}

	blockoverride "alt_widget" {
		using = message_text_box_background

		button_regular = {
			tooltip_enabled = no
			size = { 75 30 }
			text = "JOMINI_MULTIPLAYER_GUI_PLAYER_JOIN_REQUEST_ACCEPT"
			onclick = "[PlayerJoinRequest.SetAccepted]"
			down = "[PlayerJoinRequest.IsAccepted]"
			using = snd_UI_popup_confirm
			using = button_down_toggle_properties_template
		}

		button_regular = {
			tooltip_enabled = no
			size = { 75 30 }
			text = "JOMINI_MULTIPLAYER_GUI_PLAYER_JOIN_REQUEST_REJECT"
			onclick = "[PlayerJoinRequest.SetRejected]"
			down = "[PlayerJoinRequest.IsRejected]"
			using = snd_UI_popup_confirm
			using = button_down_toggle_properties_template
		}
	}

	blockoverride "bottom_buttons" {
		vbox = {
			layoutpolicy_vertical = expanding
			layoutpolicy_horizontal = expanding
			
			using = bg_age_event_frame
			using = bg_paper_card


			button_regular = {
				tooltip_enabled = no
				text = "MULTIPLAYER_APPLY_HOTJOIN"
				using = button_resize_to_fit_text
				using = snd_UI_popup_confirm
				onclick = "[AcceptJoinRequests]"
			}
		}
	}
}

window = {
	name = "multiplayer_oos_message"
	size = { 600 700 }
	parentanchor = center
	visible_at_creation = no
	visible = "[DataModelHasItems( OosWindow.GetOosData )]"
	using = bg_window_default_alt

	vbox = {
		using = window_margin
		spacing = 5

		window_header_alt = {
			blockoverride "header_text" {
				text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_HEADER"
			}
		}

		vbox = {
			using = layoutpolicy_expanding
			using = bg_main_inner_notabs_alt

			text_multi = {
				visible = "[OosWindow.IsLocalOos]"
				margin = { 20 20 }
				autoresize = yes
				min_width = 560
				max_width = 560

				text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_MY"
			}

			text_multi = {
				visible = "[Not( OosWindow.IsLocalOos )]"
				margin = { 20 20 }
				autoresize = yes
				min_width = 560
				max_width = 560

				text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_DESC"
			}

			text_single = {
				visible = "[OosWindow.IsLocalOos]"
				margin = { 20 0 }
				autoresize = yes
				min_width = 560
				max_width = 560

				text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_DESC_LOCAL"
			}

			scrollarea = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				scrollbarpolicy_horizontal = always_off

				scrollbar_vertical = {
					using = Scrollbar_Vertical
				}

				scrollwidget = {
					vbox = {
						vbox = {
							margin = { 20 10 }
							layoutpolicy_horizontal = expanding
							datamodel = "[OosWindow.GetOosData]"
							spacing = 5

							item = {
								vbox = {
									layoutpolicy_horizontal = expanding
									margin = { 5 5 }
									spacing = 5

									using = bg_paper_card
									using = bg_cabinet_card_frame

									widget = {
										layoutpolicy_horizontal = expanding
										size = { -1 30 }

										using = bg_card_header_01

										hbox = {
											margin = { 10 0 }
											margin_left = 106

											text_single = {
												text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_PLAYER_NAME"
												layoutpolicy_horizontal = expanding
												layoutpolicy_vertical = expanding
											}
										}
									}

									hbox = {
										layoutpolicy_horizontal = expanding
										margin = { 5 0 }
										margin_left = 106
										spacing = 5

										datacontext = "[OosData.GetPlayable.GetCountry]"

										vbox = {
											layoutpolicy_horizontal = expanding
											spacing = 10
											margin_bottom = 5

											text_single = {
												visible = "[And( Not( OosData.IsObserver ), Country.IsValid )]"
												text = "[Country.GetName]"
												layoutpolicy_horizontal = expanding
												autoresize = no
											}

											text_multi = {
												text = "JOMINI_MULTIPLAYER_GUI_OBSERVER"
												visible = "[OosData.IsObserver]"
												min_width = 425
												max_width = 425
												autoresize = yes
												using = Font_Type_Standard
											}

											text_multi = {
												text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_TYPE"
												min_width = 425
												max_width = 425
												autoresize = yes
												layoutpolicy_horizontal = expanding
											}

											button_default = {
												layoutpolicy_horizontal = expanding
												visible = "[Or(OosWindow.IsLocalOos, OosWindow.IsMultiplayerHost)]"
												raw_text = "[Localize('MULTIPLAYER_GUI_OOS_MESSAGE_FOLDER')]: [RemoveDirectoryPath(OosData.GetFolder)]"

												onclick = "[OpenFileDirectory(OosData.GetFolder)]"
												tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_MESSAGE_FOLDER_TT" } } }
											}
										}
									}

									widget = {
										ignore_layout = yes
										size = { 100% 100% }
										datacontext = "[OosData.GetPlayable.GetCountry]"

										country_flag_big = {
											position = { 10 10 }
											ignore_layout = yes
											visible = "[Not( OosData.IsObserver )]"
										}
									}
								}
							}
						}

						expand = {}
					}
				}
			}

			vbox = {
				layoutpolicy_horizontal = expanding
				margin = { 10 10 }
				spacing = 5

				flowcontainer = {
					wrap_length = 560
					ignoreinvisible = yes
					spacing = 5

					# Ignore oos and continue
					button_default = {
						using = button_resize_to_fit_text
						text = "MULTIPLAYER_GUI_OOS_CLOSE"
						tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_CLOSE_TT" } } }
						onclick = "[OosWindow.Close]"
					}

					# Host: Resync all clients
					button_default = {
						visible = "[IsHost]"
						using = button_resize_to_fit_text
						text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_RESYNC"
						tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_SYNCH_TT" } } }
						onclick = "[OosWindow.Resync]"
					}

					# Client: Resync, just so they know this oiption exists.
					button_default = {
						visible = "[Not(IsHost)]"
						using = button_resize_to_fit_text
						text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_RESYNC"
						tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_SYNCH_CLIENT_TT" } } }
						enabled = no
					}
				}

				flowcontainer = {
					wrap_length = 560
					ignoreinvisible = yes
					spacing = 5

					# Host: continue without desynched players
					button_default = {
						using = button_resize_to_fit_text
						visible = "[IsHost]"
						text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_CONTINUE"
						tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_KICK_TT" } } }
						onclick = "[KickPlayerOOS]"
						onclick = "[OosWindow.Close]" #this clears oos info, do it last
					}

					# Clients: continue in SP
					button_default = {
						visible = "[Not(IsHost)]"
						using = button_resize_to_fit_text
						text = "MULTIPLAYER_GUI_OOS_SP"
						tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_SP_TT" } } }
						onclick = "[OosWindow.Close]"
						onclick = "[BecomeSinglePlayer]"
					}

					# Go to main menu
					button_default = {
						using = button_resize_to_fit_text
						text = "JOMINI_MULTIPLAYER_GUI_OOS_MESSAGE_EXIT_BUTTON"
						onclick = "[OosWindow.GoToMenu]"
						tooltipwidget = { LeftClickButtonTooltip = { blockoverride "onclick_text" { text = "MULTIPLAYER_GUI_OOS_END_GAME" } } }
					}
				}
			}
		}
	}

	window_bottom_paper_template = {}
}