types OrganizationPanel
{
	type organization_panel_default_header = widget {

		allow_outside = yes
		# who is in charge
		country_header = {
			allow_outside = yes
			size = { 100% 100% }
			visible = "[InternationalOrganizationsView.GetInternationalOrganization.IsLeaderCountryInPlace]"
			datacontext = "[InternationalOrganizationsView.GetInternationalOrganization.GetLeaderCountry]"
			# block "organization_panel_country_header" {
				scissor = no
			# }
			# blockoverride "history_button_anchor" {}

			blockoverride "character_religion_visibility" {
				visible = no
			}

			blockoverride "character_name_maximumsize" {
				maximumsize = { 430 -1 }
			}

			blockoverride "country_header_background"{
				icon =  {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					texture = "[InternationalOrganizationsView.GetIllustration]"
					# texture = "gfx/interface/illustrations/government/throne_rooms/throne_room_ashanti.dds"
					texture_density = 2
					spriteType = stretched
					spriteborder = { 0 0 }
				}
			}

			blockoverride "country_header_religion" {
				block "country_header_religion_margin"{}
				# Monthly effect
				block "country_header_religion_icon" {
					icon = {
						
						visible = "[InternationalOrganizationsView.GetInternationalOrganization.HasMonthlyEffect]"
						size = { 30 30 }
						texture = "[GetReligionIcon(InternationalOrganizationsView.GetInternationalOrganization.GetLeaderCountry.GetReligion)]"
						texture_density = 2
						alpha = 1
						tooltip = "[InternationalOrganizationsView.GetInternationalOrganization.GetMonthlyEffectText]"
						glow = {
							name = "drop_shadow"
							glow_radius = 3
							color = {0.0 0.0 0.0 1.0}
							alpha = 0.3
						}
					}
				}
			}

			blockoverride "extra_titles" {
				block "extra_titles_flag_overview" {
					country_flag_small = {
						datacontext = "[InternationalOrganizationsView.GetInternationalOrganization.GetLeaderCountry]"
					}
				}
			}

			blockoverride "country_header_extra" {
				hbox = {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					margin = { 10 10 }
					spacing = 8

					expand = {}
				}
			}

			blockoverride "abilities_widget" {
				ios_information_header = {}
			}

			block "io_decoration" {}
		}

		# no one in charge
		widget = {
			visible = "[Not(InternationalOrganizationsView.GetInternationalOrganization.IsLeaderCountryInPlace)]"
			using = bg_age_event_frame
			size = { 100% 100% }

			background = {
				texture = "gfx/interface/illustrations/international_organization_types/_default.dds"
				texture_density = 2
				spriteType = stretched
				spriteborder = { 0 0 }
			}
			background = {
				# gfx/interface/illustrations/international_organization_types/
				texture = "[InternationalOrganization.GetIllustration]"
				# texture = "gfx/interface/illustrations/government/throne_rooms/throne_room_ashanti.dds"
				texture_density = 2
				spriteType = stretched
				spriteborder = { 0 0 }
			}
			vbox = {
				layoutpolicy_horizontal = expanding

				expand = {}
				ios_information_header = {}
			}
		}

		# what to show if nobody is in charge
		# power struggle, election can happen
		vbox = {
			size = { 100% 100% }
			visible = "[And(InternationalOrganizationsView.GetInternationalOrganization.HasLeadershipElectionResolution,And(InternationalOrganizationsView.GetInternationalOrganization.UsesLeader,Not(InternationalOrganizationsView.GetInternationalOrganization.IsLeaderCountryInPlace)))]"
			margin = { 5 0}
			vbox = {
				layoutpolicy_horizontal = expanding
				margin = {15 15}

				using = bg_square_tile
				blockoverride "container_color" {
					modify_texture = {
						using = color_dark_blue_texture
						blend_mode = multiply
					}
					alpha = 0.7
				}

				text_single = {
					text = "INTERNATIONAL_ORGANIZATION_POWER_STRUGGLE_TITLE"
					margin_bottom = 10
				}

				text_multi = {
					max_width = 390
					text = "INTERNATIONAL_ORGANIZATION_POWER_STRUGGLE_1"
					autoresize = yes
					margin_bottom = 10
				}
				
				text_multi = {
					max_width = 390
					text = "INTERNATIONAL_ORGANIZATION_POWER_STRUGGLE_2"
					autoresize = yes
				}
			}
			hbox = {
				maximumsize = { -1 48 }
				visible = "[And(InternationalOrganizationsView.GetInternationalOrganization.HasLeadershipElectionResolution,And(InternationalOrganizationsView.GetInternationalOrganization.UsesLeader,Not(InternationalOrganizationsView.GetInternationalOrganization.IsLeaderCountryInPlace)))]"
				using = bg_paper_card
				using = bg_cabinet_card_frame
				using = layoutpolicy_expanding
				#margin = {0 7}
				block "ios_information_header_content_extra_1" {}
				block "ios_information_header_content_extra_2" {}
			}
		}
		# power vacuum, no elections, don't know what to do
		vbox = {
			size = { 100% 100% }
			visible = "[And(Not(InternationalOrganizationsView.GetInternationalOrganization.HasLeadershipElectionResolution),And(InternationalOrganizationsView.GetInternationalOrganization.UsesLeader,Not(InternationalOrganizationsView.GetInternationalOrganization.IsLeaderCountryInPlace)))]"
			vbox = {
				layoutpolicy_horizontal = expanding
				margin = {10 15}

				text_single = {
					text = "INTERNATIONAL_ORGANIZATION_NO_LEADER_TITLE"
					default_format = "#high"
					margin_bottom = 10
				}

				using = bg_square_tile
				blockoverride "container_color" {
					modify_texture = {
						using = color_dark_brown_texture
						blend_mode = multiply
					}
					alpha = 0.7
				}
											
				text_multi = {
					max_width = 390
					text = "INTERNATIONAL_ORGANIZATION_NO_LEADER_1"
					autoresize = yes
					default_format = "#color_white"
					margin_bottom = 10
				}

				text_multi = {
					max_width = 390
					text = "INTERNATIONAL_ORGANIZATION_NO_LEADER_2"
					autoresize = yes
					default_format = "#color_white"
				}
			}
		}

		# no "leader country" but we have some actual leaders to display

		# #what to show if the org doesn't have leaders
		# widget = {
		# 	size = { 100% 100% }
		# 	visible = "[Not(InternationalOrganizationsView.GetInternationalOrganization.UsesLeader)]"

		# 	text_multi= {
		# 		parentanchor = center
		# 		widgetanchor = center
		# 		max_width = 500
		# 		autoresize = yes
		# 		raw_text = "#placeholder ï¿½RIC the UI for an IO that doesn't have leaders needs designing please :) #!"
		# 	}
		# }
	}

	type unions_abilities_header = widget {
		layoutpolicy_horizontal = expanding
		size = { -1 40 }

		block "character_dynasty" {
			hbox = {
				layoutpolicy_horizontal = expanding
				block "country_header_orientation" {}

				block "country_header_dynasty"{
					character_label_dynasty = {}
				}
				expand = {}
			}
		}

		# block "unions_abilities_header_bg" {
			using = bg_paper_card
			using = bg_cabinet_card_frame
		# }
		
		hbox = {
			allow_outside = yes
			block "country_header_orientation" {}

			block "abilities" {
				widget = {
					layoutpolicy_horizontal = expanding
					size = { -1 33 }
					
					hbox = {
						block "abilities_margins_ios" {
							margin_left = 35
						}
						
						character_abilities = {
							blockoverride "abilities_format" {
								layoutpolicy_vertical = expanding
								margin = { 7 0 }
								spacing = 10
								
							}
							blockoverride "abilities_bg_extra" {
								margin = {0 -3}
								alpha = 0.2
							}
							blockoverride "abilities_bg_frame_extra" {
								margin = {-1 -3}
								alpha = 0.5
							}
							# blockoverride "abilities_bg" {}
						}
						
						# block "country_header_abilities_extra" {}
						
						block "ios_situations_disasters_abilities_expand" {
							expand = {}
						}
					}
				}
			}
		}
		
		## HISTORY BUTTON
		block "ios_situations_disasters_abilities_parent" {
			header_button_left = {
				parentanchor = vcenter|right
				position = {-10 0}
				size = {33 33}
				blockoverride "button_icon_stretch_sprite" {}
				blockoverride "header_button_frame_inner" {visible = no}
				blockoverride "header_button_icon_size" { size = { 30 30 } }
				blockoverride "header_button_text_layout" {}

				blockoverride "icon_texture" {
					texture = "gfx/interface/buttons/flats/history.dds"
					texture_density = 2
				}

				tooltipwidget = {
					LeftClickButtonTooltip = {
						blockoverride "onclick_text" { 
							text = "RULING_HISTORY_INTERNATIONAL_ORGANIZATION_SIDEMENU"
						}
					}
				}
				visible = "[ShouldShowRulingHistoryForInternationalOrganization(InternationalOrganizationsView.GetInternationalOrganization.Self)]"
				onclick = "[ShowRulingHistoryForInternationalOrganization(InternationalOrganizationsView.GetInternationalOrganization.Self)]"
			}
		}
	}
	
	type ios_information_header = widget {
		layoutpolicy_horizontal = expanding
		size = { -1 48 }
		block "ios_information_header_visible" {
			visible = "[Or(GreaterThan_int32(GetDataModelSize(InternationalOrganizationsView.GetInternationalOrganization.GetType.GetVariables), '(int32)0' ),
			InternationalOrganizationsView.GetInternationalOrganization.HasLeaderChangeMethod)]"
		}
		
		block "ios_information_header_bg" {
			using = bg_paper_card
			using = bg_cabinet_card_frame
		}
		
		hbox = {
			allow_outside = yes
			block "country_header_orientation" {}
			
			# block "ios_information_header_content" {
				divider_flavor_01 = { 
					block "divider_flavor_01_layout_size"{size = {9 -1}}
					block "divider_flavor_01_visible"{visible = yes}
				}
				hbox = {
					# block "ios_info_header_left_visible" {
						visible = "[GreaterThan_int32(GetDataModelSize(InternationalOrganizationsView.GetInternationalOrganization.GetType.GetVariables), '(int32)0' )]"
					# }
					using = layoutpolicy_expanding
					datamodel = "[InternationalOrganizationsView.GetInternationalOrganization.GetType.GetVariables]"
					item = {
						hbox = {
							block "ios_info_header_left_item_visible" {}
							using = layoutpolicy_expanding
							spacing = 5
							tooltipwidget = {
								using = IOVariableTooltip
							}

							expand = {}
							block "ios_information_header_order" {
								text_single = {
									margin_right = 5
									autoresize = yes
									align = right
									text = "[InternationalOrganizationsView.GetInternationalOrganization.GetVariableText(InternationalOrganizationTypeVariable.GetTag)]"
								}
								
								hbox = {
									using = organization_piechart_template
									blockoverride "organization_piechart_size" { size = { 25 25 } }
									blockoverride "organization_piechart_value" 
									{
										value = "[Subtract_float(FixedPointToFloat(InternationalOrganizationsView.GetInternationalOrganization.GetVariable(InternationalOrganizationTypeVariable.GetTag)),FixedPointToFloat(InternationalOrganizationTypeVariable.GetMin))]"
									}
									blockoverride "organization_piechart_max_value" 
									{
										value = "[Subtract_float(FixedPointToFloat(InternationalOrganizationTypeVariable.GetMax), FixedPointToFloat(InternationalOrganizationsView.GetInternationalOrganization.GetVariable(InternationalOrganizationTypeVariable.GetTag)))]"
									}
									blockoverride "organization_piechart_icon" 
									{
										texture = "[InternationalOrganizationsView.GetInternationalOrganization.GetVariableIcon(InternationalOrganizationTypeVariable.GetTag)]"
									}
								}
							}
							expand = {}
							divider_flavor_01 = { 
								block "divider_flavor_01_layout_size"{size = {9 -1}}
							}
						}
					}
				}
				
				block "ios_information_header_content_extra_3" {}

				hbox = {
					# block "ios_info_header_right_visible" {
						visible = "[And(Player.IsMemberOfInternationalOrganization(InternationalOrganizationsView.GetInternationalOrganization), EqualTo_string(InternationalOrganizationsView.GetInternationalOrganization.GetType.GetNameKey, 'middle_kingdom'))]"
					# }
					using = layoutpolicy_expanding

					datacontext = "[Player.GetModifierTooltipContext('eunuch_power')]"
					spacing = -10
					# margin_right = -10
					tooltipwidget = {
						using = CountryModifier_tooltip
					}
				
					text_single = {
						margin_left = 5
						autoresize = yes
						text = "[Player.GetModifierValue('eunuch_power')]"
					}
					icon = {
						texture = "gfx/interface/icons/modifier_types/eunuch_power.dds"
						size = { 31 31 }
					}
					
					divider_flavor_01 = { 
						block "divider_flavor_01_layout_size"{size = {9 -1}}
					}
				}

				### IO - Treasury
				hbox = {
					using = layoutpolicy_expanding
					visible = "[InternationalOrganizationsView.GetInternationalOrganization.IsCurrencyEnabled('gold')]"

					expand = {}
					hbox = {
						spacing = 3
						margin_left = 3
						tooltipwidget = {
							using = IOGoldResourceTooltip
						}

						using = bg_number_container_bckg

						background = {
							texture = "gfx/interface/component_masks/mask_fade_horizontal_right.dds"
							texture_density = 2
							spriteType = stretched
							alpha = 0.5
							visible = "[InternationalOrganizationsView.GetInternationalOrganization.IsCurrencyValueEqualOrLessThanZero('gold')]"
						
							modify_texture = {
								using = color_red_texture
								blend_mode = multiply
							}
						}
						
						### RESOURCE NUMBER
						widget = {
							layoutpolicy_vertical = expanding
							size = {40 -1}
							tooltipwidget = {
								using = IOGoldResourceTooltip
							}
							hbox = {
								text_single = {
									visible = "[Not(LessThan_CFixedPoint(InternationalOrganizationsView.GetInternationalOrganization.GetFixedPointCurrencyValue('gold'), '(CFixedPoint)0'))]"
									layoutpolicy_horizontal = expanding
									autoresize = no
									size = { -1 15 }
									align = left|nobaseline
									text = "[InternationalOrganizationsView.GetInternationalOrganization.GetCurrencyValue('gold')]"
									tooltipwidget = {
										using = IOGoldResourceTooltip
									}
									using = Font_Size_Small
								}

								### RESOURCE NEGATIVE NUMBER
								text_single = {
									visible = "[LessThan_CFixedPoint(InternationalOrganizationsView.GetInternationalOrganization.GetFixedPointCurrencyValue('gold'), '(CFixedPoint)0')]"
									layoutpolicy_horizontal = expanding
									autoresize = no
									size = { -1 15 }
									align = left|nobaseline
									text = "[InternationalOrganizationsView.GetInternationalOrganization.GetCurrencyValue('gold')]"
									default_format = "#color_red;bold"
									tooltipwidget = {
										using = IOGoldResourceTooltip
									}
									using = Font_Size_Small
								}
							}
						}

						icon = {
							visible = "[Not(LessThan_CFixedPoint(InternationalOrganizationsView.GetInternationalOrganization.GetFixedPointCurrencyValue('gold'), '(CFixedPoint)0'))]"
							texture = "gfx/interface/icons/resources/gold.dds"
							texture_density = 2
							size = {24 24}
							tooltipwidget = {
								using = IOGoldResourceTooltip
							}
						}
					}
					expand = {}
					divider_flavor_01 = { 
						block "divider_flavor_01_layout_size"{size = {9 -1}}
					}
				}

				block "ios_information_header_content_extra_1" {}
				block "ios_information_header_content_extra_2" {}

				hbox = {
					using = layoutpolicy_expanding
					visible = "[InternationalOrganizationsView.GetInternationalOrganization.HasLeaderChangeMethod]"

					expand = {}
					piechart = {
						size = { 30 30 }
						using = bg_circle
						using = piechart_angles
						
						pieslice = {
							texture = "gfx/interface/pie_charts/pie_chart_alpha_80.dds"
							value = "[FixedPointToFloat(InternationalOrganizationsView.GetInternationalOrganization.GetLeaderChangeProgress)]"
							color = { 0.01 0.6 0.9 1 } 
						}
						
						pieslice = {
							texture = "gfx/interface/pie_charts/pie_chart_alpha_80.dds"
							value = "[FixedPointToFloat(InternationalOrganizationsView.GetInternationalOrganization.GetLeaderChangeTotalDays)]"
							color = { 0.0 0.1 0.1 1 }
						}
						
						icon = {
							size = { 80% 80% }
							parentanchor = center
							texture = "gfx/interface/icons/character_roles/regent.dds"
							texture_density = 2
							glow = {
								name = "drop_shadow"
								glow_radius = 3
								color = {0.0 0.0 0.0 1.0}
								alpha = 0.3
							}
						}

						using = bg_circle_piechart
						tooltipwidget = {
							SimpleContextualTooltipType = {
								lowpriotextcontext = "[InternationalOrganizationsView.GetInternationalOrganization.GetLeaderChangeMethodTooltip]"
								blockoverride "concept_link" {
									text = "[international_organization|e]"
								}
								blockoverride "title_icon" {
									icon = {
										using = tooltip_title_icon_size
										texture = "gfx/interface/icons/character_roles/regent.dds"											
									}
								}
							}
						}
					}
					expand = {}
					divider_flavor_01 = { 
						block "divider_flavor_01_layout_size"{size = {9 -1}}
					}
				}
			# }
		}
	}
}

template "ios_header_content_extra_template" {
	hbox = {
		spacing = 5
		using = layoutpolicy_expanding

		expand = {}
		block "ios_header_content_extra" {}
		expand = {}
		block "ios_header_content_divider" {
			divider_flavor_01 = { 
				block "divider_flavor_01_layout_size"{size = {9 -1}}
			}
		}
	}
}
