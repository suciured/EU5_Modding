namespace = slave_trade

slave_trade.1 = {
	type = country_event
	title = slave_trade.1.title
	desc = slave_trade.1.desc
	trigger = {

		knows_about_institution = institution:new_world
		NOT = { has_embraced_institution = institution:new_world }
	
		OR = {
			current_age = age_4_reformation
			current_age = age_5_absolutism
		}
	
		capital.market = {
			owner = root
			is_produced_in_market = goods:slaves_goods
			NOT = { owner = root }
			any_export = {
				goods = goods:slaves_goods
				NOT = { owner = root }
			}
		}
		
		NOT = {
			ruler = { has_character_modifier = protecting_against_slave_trade }  
		}
		
		NOT = {
			ruler = { has_character_modifier =  accepting_slave_trade }  
		}

	}

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"


	immediate = {
		capital.market = {
			ordered_export = {
				limit = {
					goods = goods:slaves_goods
					NOT = { owner = root }
				}
				order_by = trade_volume
				max = 1
				
				owner = {
					save_scope_as = slaver_country
				}
			}
		}
		
	}

	option = {
		name = slave_trade.1.a
		ruler = { add_character_modifier = { modifier = accepting_slave_trade months = -1 mode = add_and_extend } } 
	}
	option = {
		name = slave_trade.1.b
		trigger = {
			has_markets = yes
		}
		ruler = { add_character_modifier = { modifier = protecting_against_slave_trade months = -1 mode = add_and_extend } } 
		capital.market = {
			every_merchant_in_market = {
				limit = {
					OR = {
						NOT = { religion.group = root.religion.group }
						this = scope:slaver_country
					}
				}
				add_opinion = { target = root modifier = slave_trade_obstructed }
			}
		}

	}
}

slave_trade.5 = {
	hide_portraits = yes
	type = country_event
	title = slave_trade.5.title
	desc = slave_trade.5.desc
	trigger = {
		any_owned_location = {
			has_building_with_at_least_one_level = slave_center
		}
	}

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"

	immediate = {
		random_owned_location = {
			limit = {
				has_building_with_at_least_one_level = slave_center
			}
			save_scope_as = slave_location
		}
	}
	
	
	option = {
		name = slave_trade.5.a
		add_stability = stability_weak_penalty
		add_prestige = prestige_weak_penalty
	}
	option = {
		name = slave_trade.5.b
		
		save_scope_as = from
		
		scope:slave_location = {
			every_foreign_buildings_in_location = {
				limit = {
					building_type = building_type:slave_center
				}
				owner = {
					trigger_event_silently = { id = slave_trade.6 days = { 100 200 } }
				}
				show_as_tooltip = {
					owner =  { add_casus_belli = { target = scope:from type = casus_belli:cb_conquer_province province = scope:slave_location.province } }
				}
			}
			destroy_building = "building(building_type:slave_center|owner)"
		}
		
	}
}

slave_trade.6 = {
	type = country_event
	title = slave_trade.6.title
	desc = slave_trade.6.desc
	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"

	
	option = {
		name = slave_trade.6.a
		add_casus_belli = { target = scope:from type = casus_belli:cb_conquer_province province = scope:slave_location.province }
	}
}