namespace = witch_trials
# Witchcraft - non Catholic
witch_trials.1 = {
	type = country_event
	title = witch_trials.1.title
	desc = witch_trials.1.desc

	trigger = {
		religion.group = religion_group:christian
		NOT = {
			religion = religion:catholic
		}
		NOT = { has_country_modifier = nationwide_witch_hunts }
		NOT = { has_country_modifier = forbade_witch_hunts }
		any_owned_location = {
			NOT = { has_location_modifier = local_witch_hunts }
			OR = {
				has_any_disease_present = yes
				prosperity < 0
				province = { is_starving = yes }
			}
		}
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		random_owned_location = {
			limit = {
				NOT = { has_location_modifier = local_witch_hunts }
				OR = {
					has_any_disease_present = yes
					prosperity < 0
					province = { is_starving = yes }
				}
			}
			save_scope_as = target_location
		}
	}

	# Allow them to proceed with the local trials.
	option = {
		name = witch_trials.1.a
		scope:target_location = {
			add_location_modifier = {
				modifier = local_witch_hunts
				years = 10
				mode = add_and_extend
			}
		}
	}

	# [Inquisitor] can see to these matters in a more organized fashion.
	option = {
		name = witch_trials.1.b
		trigger = {
			any_cabinet_action = {
				this = cabinet_action:promote_religion
			}
		}
		add_country_modifier = {
			modifier = nationwide_witch_hunts
			years = 10
			mode = add_and_extend
		}
	}

	# Such foolish superstitions have no place in [Country]!
	option = {
		name = witch_trials.1.c
		add_country_modifier = {
			modifier = forbade_witch_hunts
			years = 10
			mode = add_and_extend
		}
	}
}

scripted_effect remove_witch_trials_modifiers = {
	if = {
		limit = {
			any_owned_location = {
				has_location_modifier = local_witch_hunts
			} 
		}
		every_owned_location = {
			limit = {
				has_location_modifier = local_witch_hunts
			}
			remove_location_modifier = local_witch_hunts
		}
	}
	if = {
		limit = {
			has_country_modifier = nationwide_witch_hunts
		}
		remove_country_modifier = nationwide_witch_hunts
	}
}

#Witch Trials - Catholic
witch_trials.1000 = {
	type = country_event
	title = witch_trials.1000.title
	desc = witch_trials.1000.desc
	trigger = {
		religion = religion:catholic
		country_exists = c:PAP
		c:PAP = { has_ruler = yes }
		has_ruler = yes
		NOT = { has_country_modifier = nationwide_witch_hunts }
		NOT = { has_country_modifier = forbade_witch_hunts }
		international_organization:catholic_church = {
			OR = {
				international_organization:catholic_church = {
					any_current_policy_in_international_organization = {
						this = policy:witchcraft_aknowledged
					}
				}
				international_organization:catholic_church = {
					any_current_policy_in_international_organization = {
						this = policy:witchcraft_not_aknowledged
					}
				}
			}
		}
		any_owned_location = {
			NOT = { has_location_modifier = local_witch_hunts }
			OR = {
				has_any_disease_present = yes
				prosperity < 0
				province = { is_starving = yes }
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		random_owned_location = {
			limit = {
				NOT = { has_location_modifier = local_witch_hunts }
				OR = {
					has_any_disease_present = yes
					prosperity < 0
					province = { is_starving = yes }
				}
			}
			save_scope_as = target_location
		}
		save_scope_as = event_root_country
	}

	option = { #there is no witchcraft
		name = witch_trials.1000.a

		trigger = {
			international_organization:catholic_church = {
				any_current_policy_in_international_organization = {
					this = policy:witchcraft_not_aknowledged
				}
			}
		}
		scope:target_location = {
			add_location_modifier = {
				modifier = local_witch_hunts
				years = 1
				mode = add_and_extend
			}
		}
	}

	option = { #We will not interfere, not now.
		name = witch_trials.1000.b

		trigger = {
			international_organization:catholic_church = {
				any_current_policy_in_international_organization = {
					this = policy:witchcraft_aknowledged
				}
			}
		}
		
		scope:target_location = {
			add_location_modifier = {
				modifier = local_witch_hunts
				years = 10
				mode = add_and_extend
			}
		}
	}

	option = { #Send a messenger to the Pope
		name = witch_trials.1000.c

		trigger = {
			OR = {
				international_organization:catholic_church = {
					any_current_policy_in_international_organization = {
						this = policy:witchcraft_aknowledged
					}
				}
				international_organization:catholic_church = {
					any_current_policy_in_international_organization = {
						this = policy:witchcraft_not_aknowledged
					}
				}
			}
			NOT = {
				tag = PAP
			}
		}
		c:PAP = {
			trigger_event_non_silently = { id = witch_trials.1001 } 
		}
		scope:target_location = {
			add_location_modifier = {
				modifier = local_witch_hunts
				years = 10
				mode = add_and_extend
			}
		}
	}

	option = { #The Dominican Inquisition will take care of them
		name = witch_trials.1000.d

		trigger = {
			international_organization:catholic_church = {
				any_current_policy_in_international_organization = {
					this = policy:witchcraft_aknowledged
				}
			}
		}
		
		add_country_modifier = {
			modifier = nationwide_witch_hunts
			years = 10
			mode = add_and_extend
		}
	}
}

witch_trials.1001 = { #A Cry for Help
	type = country_event
	title = witch_trials.1001.title
	desc = witch_trials.1001.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		scope:event_root_country = {
			ruler = {
				save_scope_as = target_ruler
			}
		}
	}

	option = { #Witches are not real
		name = witch_trials.1001.a

		trigger = {
			international_organization:catholic_church = {
				any_current_policy_in_international_organization = {
					this = policy:witchcraft_not_aknowledged
				}
			}
		}

		religion:catholic = { add_reform_desire = reform_desire_weak_increase }
		add_government_power = government_power_extreme_bonus
		scope:event_root_country = {
			trigger_event_non_silently = { id = witch_trials.1002 }
		}
	}

	option = { #Send them an Inquisitor
		name = witch_trials.1001.b

		trigger = {
			international_organization:catholic_church = {
				any_current_policy_in_international_organization = {
					this = policy:witchcraft_aknowledged
				}
			}
		}

		religion:catholic = { add_reform_desire = reform_desire_weak_decrease }
		scope:event_root_country = {
			trigger_event_non_silently = { id = witch_trials.1003 }
		}
	}
}

#[GetCountry('PAP').GetGovernment.GetRulerTitle] Condemns Witch Trials
witch_trials.1002 = {
	hide_portraits = yes
	#This event can only be sent to a country by the Pope so we know that from = PAP
	type = country_event
	title = witch_trials.1002.title
	desc = witch_trials.1002.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = witch_trials.1002.a

		add_religious_influence = religious_influence_weak_bonus
		custom_tooltip = {
			text = witch_trials.remove_modifiers.tt
			remove_witch_trials_modifiers = yes
		}
		c:PAP = {
			add_opinion = { target = root modifier = opinion_witchtrials_good }
		}
	}

	option = {
		name = witch_trials.1002.b

		add_religious_influence = religious_influence_weak_penalty
		c:PAP = {
			add_opinion = { target = root modifier = opinion_witchtrials_bad }
		}
	}
}

#The [GetCountry('PAP').GetGovernment.GetRulerTitle] permits the witch trials
#event_root_country scope is available 
witch_trials.1003 = {
	#This event can only be sent to a country by the Pope so we know that from = PAP
	type = country_event
	title = witch_trials.1003.title
	desc = witch_trials.1003.desc

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = {
		name = witch_trials.1003.a
		
		add_religious_influence = religious_influence_weak_bonus
		c:PAP = {
			add_opinion = { target = root modifier = opinion_witchtrials_good }
		}
	}
	option = {
		name = witch_trials.1003.b

		add_religious_influence = religious_influence_weak_penalty
		custom_tooltip = {
			text = witch_trials.remove_modifiers.tt
			remove_witch_trials_modifiers = yes
		}
		c:PAP = {
			add_opinion = { target = root modifier = opinion_witchtrials_bad }
		}
	}
}