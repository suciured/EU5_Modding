namespace = confucian_events

scripted_trigger suitable_foreign_religion_location = {
	dominant_religion != root.religion
	average_satisfaction >= 0.5
}

confucian_events.1 = {
	type = country_event
	title = confucian_events.1.title
	desc = confucian_events.1.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_owned_location = {
			suitable_foreign_religion_location = yes
			NOT = { 
				has_location_modifier = shangdi_conflict_refused
				has_location_modifier = shangdi_conflict_accepted
			}
		}
	}

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		random_owned_location = {
			limit = {
				suitable_foreign_religion_location = yes
				NOT = { 
					has_location_modifier = shangdi_conflict_refused
					has_location_modifier = shangdi_conflict_accepted
				}
			}
			save_scope_as = target_location
			event_illustration_peasants_foreign_religion_pop_type_effect = yes
		}
	}

	option = {
		name = confucian_events.1.a
		add_government_power = government_power_mild_bonus
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_mild_penalty
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = 0.10 }
		scope:target_location = {
			add_location_modifier = { modifier = shangdi_conflict_refused years = 5 mode = add_and_extend }
		}
	}

	option = {
		name = confucian_events.1.b
		add_government_power = government_power_weak_penalty
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_mild_bonus
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_penalty }
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = -0.10 }
		scope:target_location = {
			add_location_modifier = { modifier = shangdi_conflict_accepted years = 5 mode = add_and_extend }
		}
	}
}

confucian_events.2 = {
	type = country_event
	title = confucian_events.2.title
	desc = confucian_events.2.desc

	trigger = {
		exists = root.religion.language
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_owned_location = {
			OR = {
				AND = {
					exists = dominant_religion.language
					dominant_religion.language != root.religion.language
				}
				AND = {
					dominant_religion != root.religion
					dominant_culture.language != root.culture.language
					dominant_culture.language != root.court_language
					dominant_culture.language != root.liturgical_language
				}
			}
			average_satisfaction >= 0.5
		}
		NOT = {
			has_country_modifier = classics_translated
			has_country_modifier = classics_defended
		}
	}

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		random_owned_location = {
			limit = {
				OR = {
					AND = {
						exists = dominant_religion.language
						dominant_religion.language != root.religion.language
					}
					AND = {
						dominant_religion != root.religion
						dominant_culture.language != root.culture.language
						dominant_culture.language != root.court_language
						dominant_culture.language != root.liturgical_language
					}
				}
				average_satisfaction >= 0.5
			}
			save_scope_as = target_location
			event_illustration_peasants_foreign_religion_pop_type_effect = yes
		}
	}

	option = {
		name = confucian_events.2.a
		add_country_modifier = { modifier = classics_translated months = 121 mode = add_and_extend }
		scope:target_location = {
			every_pop = {
				limit = {
					owner = root
					OR = {
						AND = {
							exists = religion.language
							religion.language != root.religion.language
						}
						AND = {
							religion != root.religion
							culture.language != root.culture.language
							culture.language != root.court_language
							culture.language != root.liturgical_language
						}
					}
				}
				add_pop_satisfaction = pop_satisfaction_mild_bonus
			}
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_weak_towards_equilibrium = yes
		}
	}

	option = {
		name = confucian_events.2.b
		add_country_modifier = { modifier = classics_defended months = 121 mode = add_and_extend }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
	}
}

confucian_events.3 = {
	type = country_event
	title = confucian_events.3.title
	desc = confucian_events.3.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_cabinet_character = {
			adm > 70
			religion = root.religion
		}
		any_owned_location = {
			suitable_foreign_religion_location = yes
		}
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_government_estate_effect = yes
		random_owned_location = {
			limit = {
				suitable_foreign_religion_location = yes
			}
			save_scope_as = target_location
		}
		random_cabinet_character = {
			limit = {
				adm > 70
				religion = root.religion
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = confucian_events.3.a
		remove_from_cabinet = scope:target_character
		scope:target_character = { add_character_modifier = { modifier = banned_from_cabinet years = 5 mode = add_and_extend }	}
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_mild_penalty
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			add_harmony = harmony_weak_bonus
		}
		if = {
			limit = {
				is_leader_of_international_organization = international_organization:middle_kingdom
			}
			change_celestial_authority = { value = celestial_authority_weak_penalty }
		}
		scope:target_location = {
			every_pop = {
				limit = {
					owner = root
					religion != root.religion
				}
				add_pop_satisfaction = pop_satisfaction_mild_bonus
			}
		}
		add_stability = stability_mild_bonus
	}

	option = {
		name = confucian_events.3.b
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_weak_towards_equilibrium = yes
		}
		if = {
			limit = {
				is_leader_of_international_organization = international_organization:middle_kingdom
			}
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
		add_government_power = government_power_weak_penalty
		add_country_modifier = { modifier = converted_minister months = 121 mode = add_and_extend }
		scope:target_character = { change_character_religion = scope:target_location.dominant_religion }
	}
}

confucian_events.4 = {
	type = country_event
	title = confucian_events.4.title
	desc = confucian_events.4.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_owned_location = {
			integration_level = core
			suitable_foreign_religion_location = yes
		}
	}

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = {
		random_owned_location = {
			limit = {
				integration_level = core
				suitable_foreign_religion_location = yes
			}
			save_scope_as = target_location
			event_illustration_peasants_foreign_religion_pop_type_effect = yes
		}
	}

	option = {
		name = confucian_events.4.a
		scope:target_location = {
			every_pop = {
				limit = {
					owner = root
					religion != root.religion
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}
		add_prestige = prestige_weak_penalty
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_penalty
		}
		if = { 
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_penalty }
		}
	}

	option = {
		name = confucian_events.4.b
		scope:target_location.province = {
			every_location_in_province = {
				limit = { dominant_religion = scope:target_location.dominant_religion }
				change_control = control_severe_penalty
			}
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
	}
}

confucian_events.5 = {
	type = country_event
	title = confucian_events.5.title
	desc = confucian_events.5.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_owned_location = {
			integration_level = core
			suitable_foreign_religion_location = yes
		}
		has_ruler = yes
	}

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		random_owned_location = {
			limit = {
				integration_level = core
				suitable_foreign_religion_location = yes
			}
			save_scope_as = target_location
		}
	}

	option = {
		name = confucian_events.5.a
		add_prestige = prestige_weak_penalty
		scope:target_location.province = {
			every_location_in_province = {
				limit = { dominant_religion = scope:target_location.dominant_religion }
				change_control = control_severe_penalty
			}
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_penalty
		}
	}

	option = {
		name = confucian_events.5.b
		scope:target_location.province = {
			every_location_in_province = {
				limit = { dominant_religion = scope:target_location.dominant_religion }
				add_location_modifier = { modifier = local_rites_represed months = 121 mode = add_and_extend }
			}
		}
		add_government_power = government_power_weak_penalty
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_penalty }
		}
	}
}

confucian_events.6 = {
	type = country_event
	title = confucian_events.6.title
	desc = confucian_events.6.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_cabinet_character = {
			dip >= 70
		}
		any_owned_location = {
			integration_level = core
			suitable_foreign_religion_location = yes
		}
	}

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		random_owned_location = {
			limit = {
				integration_level = core
				suitable_foreign_religion_location = yes
			}
			save_scope_as = target_location
			event_illustration_peasants_foreign_religion_pop_type_effect = yes
		}
		random_cabinet_character = {
			limit = { dip >= 70 }
			save_scope_as = target_character
		}
	}

	option = {
		name = confucian_events.6.a
		scope:target_location.province = {
			every_location_in_province = {
				limit = { dominant_religion != root.religion }
				change_control = control_weak_penalty
			}
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
		add_stability = stability_weak_bonus
	}

	option = {
		name = confucian_events.6.b
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_penalty }
		}
		add_government_power = government_power_mild_penalty
		add_prestige = prestige_mild_penalty
		scope:target_location.province = {
			every_location_in_province = {
				limit = { dominant_religion != root.religion }
				change_control = control_severe_bonus
			}
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			add_harmony = harmony_weak_bonus
		}
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_bonus
		}
	}
}

confucian_events.7 = {
	type = country_event
	title = confucian_events.7.title
	desc = confucian_events.7.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_owned_location = {
			integration_level = core
			suitable_foreign_religion_location = yes
		}
	}

	immediate = {
		random_owned_location = {
			limit = {
				integration_level = core
				suitable_foreign_religion_location = yes
			}
			save_scope_as = target_location
		}
	}

	option = {
		name = confucian_events.7.a
		add_prestige = prestige_mild_bonus
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_mild_bonus }
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
	}

	option = {
		name = confucian_events.7.b
		scope:target_location = {
			every_pop = {
				limit = { culture != root.capital.dominant_culture }
				split_pop = {
					fraction = 0.20
					culture = root.capital.dominant_culture
				}
			}
			change_development  = development_weak_bonus
		}
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_bonus
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			add_harmony = harmony_weak_bonus
		}
	}
}

confucian_events.8 = {
	type = country_event
	title = confucian_events.8.title
	desc = confucian_events.8.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		has_ruler = yes
		has_heir = yes
		heir = { 
			age_in_years >= 15
			NOT = { has_trait = just }
			NOT = { has_trait = righteous }
			NOT = { has_trait = kind_hearted }
			NOT = { has_trait = benevolent }
			NOT = { has_trait = scholar }
			NAND = {
				adm > 50
				dip > 50
			}
		}
		government_type = government_type:monarchy
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_government_estate_effect = yes
		ruler = { save_scope_as = target_ruler }
		heir = { save_scope_as = target_heir }
	}

	option = {
		name = confucian_events.8.a
		add_stability = stability_extreme_penalty
		scope:target_heir = {
			add_character_modifier = { modifier = blocked_from_being_ruler years = -1 mode = add_and_extend }
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }
		if = {
			limit = { modifier:allow_harmony = yes }
			add_harmony = harmony_mild_penalty
		}
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_mild_bonus
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_strong_penalty }
		}
	}
	option = {
		name = confucian_events.8.b
		heir = {
			if = {
				limit = {
					NOT = { age_in_years >= 45 }
					NOT = { has_trait = naive }
				}
				add_trait = trait:naive
			}
		}
		add_prestige = prestige_weak_penalty
		add_government_power = government_power_weak_penalty
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_severe_penalty
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_bonus }
	}
}

confucian_events.9 = {
	type = country_event
	title = confucian_events.9.title
	desc = confucian_events.9.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		has_ruler = yes
		NOT = {
			has_country_modifier = banned_novel
		}
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}

	option = {
		name = confucian_events.9.a
		add_country_modifier = { modifier = banned_novel months = 60 mode = add_and_extend }
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_mild_bonus
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			add_harmony = harmony_weak_bonus
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_mild_penalty }
		}
	}
	option = {
		name = confucian_events.9.b
		add_government_power = government_power_weak_penalty
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_penalty
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
		add_country_modifier = { modifier = allowed_critical_novel months = 60 mode = add_and_extend }
	}
}

confucian_events.10 = {
	type = country_event
	title = confucian_events.10.title
	desc = confucian_events.10.desc

	trigger = {
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = confucian_events.10.a
		change_gold_effect = { scale = -4.80 }
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_severe_bonus
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_strong_bonus }
		}
	}

	option = {
		name = confucian_events.10.b
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_penalty
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_penalty }
		}
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
	}
}

confucian_events.11 = { #Moral Guidance in an Era of Turmoil (Neo-Confucianism)
	type = country_event
	title = confucian_events.11.title
	desc = confucian_events.11.desc

	trigger = {
		OR = {
			religion = religion:shinto
			religion = religion:mahayana
			religion = religion:sanjiao
		}
		current_age = age_2_renaissance
	}

	immediate = {
		create_character = {
			adm = { 60 90 }
			dip = { 60 90 }
			mil = { 60 90 }
			create_in_limbo = yes
			random_estate_type_trigger = {
				root = { estate_type_allowed_in_cabinet = { estate_type = prev } }
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = confucian_events.11.a
		scope:target_character = { move_country = root }
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_bonus
		}
	}
	option = {
		name = confucian_events.11.b
		add_legitimacy = legitimacy_mild_bonus
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
		hidden_effect = {
			kill_character_silently = scope:target_character
		}
	}
}

confucian_events.12 = { #Birth and Privilege
	type = country_event
	title = confucian_events.12.title
	desc = confucian_events.12.desc

	trigger = {
		NOT = { has_country_modifier = self_made_men }
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
		any_character = {
			has_dynasty = no
			is_ruler = no
			is_heir = no
			total_abilities >= 200
			is_female = no
		}
	}

	illustration_tags = {
		10 = happy
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
		random_character = {
			limit = {
				has_dynasty = no
				is_ruler = no
				is_heir = no
				total_abilities >= 200
				is_female = no
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = confucian_events.12.a
		add_country_modifier = { modifier = self_made_men months = 120 mode = add_and_extend }
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_weak_bonus
		}
	}
	option = {
		name = confucian_events.12.b
		add_stability = stability_mild_bonus
		if = {
			limit = { modifier:allow_harmony = yes }
			add_harmony = harmony_weak_penalty
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
	}
}

confucian_events.13 = { #Meritocracy
	type = country_event
	title = confucian_events.13.title
	desc = confucian_events.13.desc
	image = "gfx/interface/illustrations/institutions/meritocracy.dds"

	trigger = {
		has_ruler = yes
		NOR = {
			has_country_modifier = rational_administration
			has_country_modifier = supported_loyal_retainers
		}
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:sect
			international_organization_has_policy = policy:confucianism_policy
		}
	}

	immediate = {
		ruler ?= { save_scope_as = target_ruler }
	}

	option = {
		name = confucian_events.13.a
		add_country_modifier = { modifier = rational_administration months = 120 mode = add_and_extend }
		if = {
			limit = { modifier:allow_righteousness = yes }
			add_righteousness = righteousness_mild_bonus
		}
		if = {
			limit = {
				religion = { has_honor = yes }
			}
			add_honor = honor_weak_penalty
		}
		add_legitimacy = legitimacy_weak_bonus
	}
	option = {
		name = confucian_events.13.b
		add_country_modifier = { modifier = supported_loyal_retainers months = 120 mode = add_and_extend }
		if = {
			limit = { modifier:allow_harmony = yes }
			harmony_mild_towards_equilibrium = yes
		}
		if = {
			limit = { is_leader_of_international_organization = international_organization:middle_kingdom }
			change_celestial_authority = { value = celestial_authority_weak_bonus }
		}
		add_stability = stability_weak_bonus
	}
}
