namespace = flavor_dlh

scripted_effect set_head_scope = {
	if = {
		limit = {
			exists = ruler
		}
		ruler = { save_scope_as = target_character2 }
	}
	else_if = { 
		limit = {
			exists = regent 
		}
		regent = { save_scope_as = target_character2 }
	}
}

flavor_dlh.1 = {
	type = country_event
	title = flavor_dlh.1.title
	desc = flavor_dlh.1.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1650.1.1
		to = 1750.1.1
		monthly_chance = 2
	}

	trigger = {
		religion.group = religion_group:muslim
		"culture_percentage_in_country(culture:marathi_culture)" > 0
	}
	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_dlh.1.a
		historical_option = yes
		custom_tooltip = {
			text = flavor_dlh.1.a.tt	
			every_pop = {
				limit = {
					owner = root
					culture = culture:marathi_culture
				}
				add_pop_satisfaction = pop_satisfaction_ultimate_penalty
			}
		}
	}
	option = {
		name = flavor_dlh.1.b
		add_stability = stability_ultimate_penalty
	}
}

flavor_dlh.2 = {
	type = country_event
	title = flavor_dlh.2.title
	desc = flavor_dlh.2.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1340.1.1
		to = 1370.12.30
		monthly_chance = 2
	}

	trigger = {
		is_situation_active = situation:fall_of_delhi
		any_province = {
			AND = {
				OR = {
					this = location:sindkedh.province
					this = location:bijapur.province
					area = area:telingana_area
					area = area:maharashtra_area
					area = area:konkan_area
				}
				NOT = { area = area:gondwana_area }
			}
			count > 4
		}
	}
	
	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		set_head_scope = yes
		if = {
			limit = {
				owns = location:gulbarga 
			}
			location:gulbarga = { save_scope_as = target_location }
		}
		else = {
			ordered_owned_location = {
				limit = {
					OR = {
						province = location:sindkedh.province
						province = location:bijapur.province
						province = location:gulbarga.province
						area = area:telingana_area
						area = area:maharashtra_area
						area = area:konkan_area
					}
				}
				order_by = population
				check_range_bounds = no
				max = 1
				save_scope_as = target_location
			}
		}
		every_owned_location = {
			limit = {
				OR = {
					province = location:sindkedh.province
					province = location:bijapur.province
					province = scope:target_location.province
					area = area:telingana_area
					area = area:maharashtra_area
					area = area:konkan_area
				}
			}
			add_to_temporary_list = give_me_to_the_bahmanis
		}
		scope:target_location = {
			province = { save_scope_as = target_province }
			create_country_from_location = {
				locations = give_me_to_the_bahmanis #add all the locations at creation time so that all the initial proximities get calculated
				set_variable = { name = bahmanis_var value = yes }
				save_scope_as = target_bahmanis_revolter_scope
				set_country_rank = country_rank:rank_kingdom
			}
		}
		scope:target_bahmanis_revolter_scope = {
			add_gold = 1000
			form_country = formable_country:BAH_f
			if = {
				limit = { exists = dynasty:bahman_dynasty }
				create_character = {
					culture = culture:afghan_culture
					religion = religion:sunni
					dynasty = dynasty:bahman_dynasty
					estate = estate_type:nobles_estate
					first_name = name_ishmael
					birth_date = 1292.6.1
					add_trait = trait:conqueror
					save_scope_as = target_character
				}
			}
			else = {
				create_character = {
					culture = culture:afghan_culture
					religion = religion:sunni
					estate = estate_type:nobles_estate
					first_name = name_ishmael
					birth_date = 1292.6.1
					add_trait = trait:conqueror
					save_scope_as = target_character
				}
				scope:target_character = {
					found_dynasty = random
				}
			}
			set_new_ruler = scope:target_character
			change_religion = religion:sunni
			change_religion_for_ruler_and_family = { country = ROOT religion = religion:sunni }
			make_subject_of = {
				target = c:DLH
				type = subject_type:vassal
			}
			set_variable = {
				name = delhi_claimants_variable
				value = yes
			}
			every_owned_location = {
				add_core = scope:target_bahmanis_revolter_scope
				change_integration_level = core
			}
		}
	}

	option = {
		name = flavor_dlh.2.a
		historical_option = yes

		scope:target_bahmanis_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { 
				is_situation_active = situation:fall_of_delhi
				situation:fall_of_delhi = { has_active_resolution = yes}
			}
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							subtract = 0.05
						}
					}
				}
			}
		}
	}
	option = {
		name = flavor_dlh.2.b
		
		cancel_subject = scope:target_bahmanis_revolter_scope
		hidden_effect = {
			scope:target_bahmanis_revolter_scope = {
				change_country_color = map_bahmanis
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_10_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.1
						}
					}
				}
				scope:target_bahmanis_revolter_scope = {
					set_variable = {
						name = delhi_claimants_variable
						value = yes
					}
				}
			}
		}
	}

	option = {
		name = flavor_dlh.2.c
		trigger = {
			is_ai = no
		}
		change_player = scope:target_bahmanis_revolter_scope
		scope:target_bahmanis_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
}

flavor_dlh.3 = {
	type = country_event
	title = flavor_dlh.3.title
	desc = flavor_dlh.3.desc

	fire_only_once = yes
	
	dynamic_historical_event = {
		tag = DLH
		from = 1348.1.1
		to = 1389.12.30
		monthly_chance = 1
	}

	trigger = {
		is_situation_active = situation:fall_of_delhi
		any_province = {
			OR = {
				area = { this = area:malwa_area }
				this = location:sabalgarh.province
				this = location:bhojpur.province
				this = location:deogarh.province
				this = location:aklera.province
				this = location:sheopur.province
				this = location:ranthambore.province
			}
			count > 4
		}
	}
	
	illustration_tags = {
		10 = angry
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		set_head_scope = yes
		if = {
			limit = {
				owns = location:dhar
			}
			location:dhar = { save_scope_as = target_location }
		}
		else = {
			ordered_owned_location = {
				limit = {
					OR = {
						area = area:malwa_area
						province = location:sabalgarh.province
						province = location:bhojpur.province
						province = location:deogarh.province
						province = location:aklera.province
						province = location:sheopur.province
						province = location:ranthambore.province
					}
				}
				order_by = population
				check_range_bounds = no
				max = 1
				save_scope_as = target_location
			}
		}
		scope:target_location = {
			province = { save_scope_as = target_province }
		}
		scope:target_location = {
			create_country_from_location = {
				set_variable = { name = malwa_var value = yes }
				save_scope_as = target_malwa_revolter_scope
				set_country_rank = country_rank:rank_kingdom
			}
		}
		scope:target_malwa_revolter_scope = {
			add_gold = 1000
			change_country_tag = MLW
			change_country_name = MLW
			change_country_adjective = MLW_ADJ
			change_country_color = map_malwa
			change_country_flag = MLW
			create_character = {
				culture = root.culture
				religion = religion:sunni
				estate = estate_type:peasants_estate
				first_name = name_amid
				birth_date = 1301.6.1
				save_scope_as = target_character
			}
			set_new_ruler = scope:target_character
			change_religion = religion:sunni
			change_religion_for_ruler_and_family = { country = ROOT religion = religion:sunni }
			make_subject_of = {
				target = c:DLH
				type = subject_type:vassal
			}
			set_variable = {
				name = delhi_claimants_variable
				value = yes
			}
		}
		every_owned_location = {
			limit = {
				OR = {
					area = area:malwa_area
					province = location:sabalgarh.province
					province = location:bhojpur.province
					province = location:deogarh.province
					province = location:aklera.province
					province = location:sheopur.province
					province = location:ranthambore.province
				}
			}
			change_location_owner = scope:target_malwa_revolter_scope
			add_core = scope:target_malwa_revolter_scope
			change_integration_level = core
		}
	}

	option = {
		name = flavor_dlh.3.a
		historical_option = yes

		scope:target_malwa_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { 
				is_situation_active = situation:fall_of_delhi
				situation:fall_of_delhi = { has_active_resolution = yes}
			}
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
	
	option = {
		name = flavor_dlh.3.b
		
		cancel_subject = scope:target_malwa_revolter_scope
		hidden_effect = {
			scope:target_malwa_revolter_scope = {
				change_country_color = map_malwa
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_10_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.1
						}
					}
				}
				scope:target_malwa_revolter_scope = {
					set_variable = {
						name = delhi_claimants_variable
						value = yes
					}
				}
			}
		}
	}

	option = {
		name = flavor_dlh.3.c
		trigger = {
			is_ai = no
		}
		change_player = scope:target_malwa_revolter_scope
		scope:target_malwa_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
}

flavor_dlh.4 = {
	type = country_event
	title = flavor_dlh.4.title
	desc = flavor_dlh.4.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1370.1.1
		to = 1405.12.30
		monthly_chance = 2
	}

	trigger = {
		any_province = {
			area = area:gujarat_area
			count > 2
		}
		owns = location:khambat
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		set_head_scope = yes
		if = {
			limit = {
				owns = location:khambat
			}
			location:khambat = { save_scope_as = target_location }
		}
		else = {
			ordered_owned_location = {
				limit = { area = area:gujarat_area }
				order_by = population
				check_range_bounds = no
				max = 1
				save_scope_as = target_location
			}
		}
		scope:target_location = {
			province = { save_scope_as = target_province }
		}
		scope:target_location = {
			create_country_from_location = {
				set_variable = { name = gujarat_var value = yes }
				save_scope_as = target_gujarat_revolter_scope
				set_country_rank = country_rank:rank_kingdom
			}
		}
		scope:target_gujarat_revolter_scope = {
			add_gold = 1000
			change_country_tag = GJR
			change_country_name = GJR
			change_country_adjective = GJR_ADJ
			change_country_color = map_gujarat
			change_country_flag = GJR
			create_character = {
				culture = root.culture
				religion = root.religion
				estate = estate_type:peasants_estate
				first_name = Zafar
				last_name = name_muzaffar
				birth_date = 1350.6.1
				save_scope_as = target_character
			}
			set_new_ruler = scope:target_character
			change_religion = religion:sunni
			change_religion_for_ruler_and_family = { country = ROOT religion = religion:sunni }
			make_subject_of = {
				target = c:DLH
				type = subject_type:vassal
			}
			set_variable = {
				name = delhi_claimants_variable
				value = yes
			}
		}
		every_owned_location = {
			limit = {
				area = area:gujarat_area
			}
			change_location_owner = scope:target_gujarat_revolter_scope
			add_core = scope:target_gujarat_revolter_scope
			change_integration_level = core
		}
	}

	option = {
		name = flavor_dlh.4.a
		historical_option = yes

		scope:target_gujarat_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { 
				is_situation_active = situation:fall_of_delhi
				situation:fall_of_delhi = { has_active_resolution = yes}
			}
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
	option = {
		name = flavor_dlh.4.b
		
		cancel_subject = scope:target_gujarat_revolter_scope
		hidden_effect = {
			scope:target_gujarat_revolter_scope = {
				change_country_color = map_gujarat
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_10_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.1
						}
					}
				}
				scope:target_gujarat_revolter_scope = {
					set_variable = {
						name = delhi_claimants_variable
						value = yes
					}
				}
			}
		}
	}

	option = {
		name = flavor_dlh.4.c
		trigger = {
			is_ai = no
		}
		change_player = scope:target_gujarat_revolter_scope
		scope:target_gujarat_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
}

flavor_dlh.5 = {
	type = country_event
	title = flavor_dlh.5.title
	desc = flavor_dlh.5.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1370.1.1
		to = 1405.12.30
		monthly_chance = 1
	}

	trigger = {
		any_province = {
			OR = {
				area = area:rokhilkhand_area
				area = area:awadh_area
				area = area:bhojpur_area
				this = location:asni.province
				this = location:kalpi.province
			}
			count > 4
		}
		owns = location:jaunpur
	}
	
	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		set_head_scope = yes
		if = {
			limit = {
				owns = location:jaunpur
			}
			location:jaunpur = { 
				save_scope_as = target_location 
			}
		}
		else = {
			ordered_owned_location = {
				limit = { 
					OR = {
						area = area:rokhilkhand_area
						area = area:awadh_area
						area = area:bhojpur_area
						province = location:asni.province
						province = location:kalpi.province
					}
				}
				order_by = population
				check_range_bounds = no
				max = 1
				save_scope_as = target_location
			}
		}
		scope:target_location = {
			province = { save_scope_as = target_province }
		}
		scope:target_location = {
			create_country_from_location = {
				set_variable = { name = jaunpur_var value = yes }
				save_scope_as = target_jaunpur_revolter_scope
				set_country_rank = country_rank:rank_kingdom
			}
		}
		scope:target_jaunpur_revolter_scope = {
			add_gold = 1000
			change_country_tag = JNP
			change_country_name = JNP
			change_country_adjective = JNP_ADJ
			change_country_color = map_jaunpur
			change_country_flag = JNP
			create_character = {
				culture = root.culture
				religion = root.religion
				estate = estate_type:peasants_estate
				first_name = name_malik
				last_name = Sarwar
				birth_date = 1350.6.1
				save_scope_as = target_character
			}
			set_new_ruler = scope:target_character
			change_religion = religion:sunni
			change_religion_for_ruler_and_family = { country = ROOT religion = religion:sunni }
			make_subject_of = {
				target = c:DLH
				type = subject_type:vassal
			}
			set_variable = {
				name = delhi_claimants_variable
				value = yes
			}
		}
		every_owned_location = {
			limit = {
				OR = {
					area = area:rokhilkhand_area
					area = area:awadh_area
					area = area:bhojpur_area
					province = location:asni.province
					province = location:kalpi.province
				}
			}
			change_location_owner = scope:target_jaunpur_revolter_scope
			add_core = scope:target_jaunpur_revolter_scope
			change_integration_level = core
		}
	}

	option = {
		name = flavor_dlh.5.a
		historical_option = yes

		scope:target_jaunpur_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { 
				is_situation_active = situation:fall_of_delhi
				situation:fall_of_delhi = { any_active_resolution = { this = resolution:fall_of_delhi_resolution } }
			}
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
	option = {
		name = flavor_dlh.5.b
		
		cancel_subject = scope:target_jaunpur_revolter_scope
		scope:target_jaunpur_revolter_scope = {
			hidden_effect = {
				change_country_color = map_jaunpur
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_10_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.1
						}
					}
				}
				scope:target_jaunpur_revolter_scope = {
					set_variable = {
						name = delhi_claimants_variable
						value = yes
					}
				}
			}
		}
	}

	option = {
		name = flavor_dlh.5.c
		trigger = {
			is_ai = no
		}
		change_player = scope:target_jaunpur_revolter_scope
		scope:target_jaunpur_revolter_scope = {
			declare_war_with_cb = {	
				target = c:DLH
				type = casus_belli:cb_independence_war	
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
	}
}

flavor_dlh.6 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.6.title
	desc = flavor_dlh.6.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1340.1.1
		to = 1360.12.30
		monthly_chance = 1
	}

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	trigger = {
		any_subject = {
			capital.area = area:bengal_area
			liberty_desire >= 50
		}
		any_province = {
			OR = {
				this = location:chai.province
				area = area:mithila_area
			}
		}
		any_owned_location = {							#We have a land connection to mithila_area and chai.province to avoid bordergore
			province = {
				NOR = {
					this = location:chai.province
					area = area:mithila_area
				}
			}
			any_neighbor_location = {
				owner ?= c:DLH
				OR = {
					this.province = location:chai.province
					area = area:mithila_area
				}
			}
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		set_head_scope = yes
		ordered_subject = {
			limit = { 
				liberty_desire >= 50
				capital.area = area:bengal_area
			}
			order_by = total_population
			save_scope_as = target_subject
			if = {
				limit = {
					exists = ruler
				}
				ruler = { save_scope_as = target_character }
			}
			else_if = { 
				limit = {
					exists = regent 
				}
				regent = { save_scope_as = target_character }
			}
		}
	}

	option = {
		name = flavor_dlh.6.a #Grant them territory
		historical_option = yes

		custom_tooltip = mithilaarea_hazaribagh_province_granted_to_target_subject
		hidden_effect = {
			every_owned_location = {
				limit = {
					OR = {
						province = location:chai.province
						area = area:mithila_area
					}
				}
				change_location_owner = scope:target_subject
				remove_core = ROOT
				add_core = scope:target_subject
				change_integration_level = core
			}
		}
		scope:target_subject = {
			set_variable = { name = delhi_gave_territory value = yes }
		}
		if = {
			limit = { 
				is_situation_active = situation:fall_of_delhi
				situation:fall_of_delhi = { has_active_resolution = yes}
			}
			custom_tooltip = gain_5_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.05
						}
					}
				}
			}
		}
		add_government_power = government_power_ultimate_penalty
	}

	option = {	#Send them a gift instead
		name = flavor_dlh.6.b 
		change_gold_effect = { scale = -12 }
		every_subject = {
			limit = {
				capital.area = area:bengal_area
				liberty_desire >= 50
			}
			set_variable = { name = delhi_gave_money value = yes }
			add_gold = {
				value = overlord.monthly_income_trade_and_tax
				multiply = 4
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_3_progress_for_claimants_tt
			hidden_effect = {
				situation:fall_of_delhi = {
					"active_resolution(resolution:fall_of_delhi_resolution).resolution_proposer" = {
						change_variable = {
							name = fall_of_delhi_vote_weight
							add = 0.03
						}
					}
				}
			}
		}
		add_government_power = government_power_extreme_penalty
	}

	option = {
		name = flavor_dlh.6.c 

		add_country_modifier = {
			modifier = silver_famine_modifier
			years = 20
			mode = add_and_extend
		}
		every_subject = {
			limit = {
				capital.area = area:bengal_area
			}
			add_liberty_desire = liberty_desire_extreme_plus
			add_opinion = {
				target = overlord
				modifier = opinion_refused_demands
			}
		}
		if = {
			limit = { is_situation_active = situation:fall_of_delhi }
			custom_tooltip = gain_2_progress_for_delhi_tt
			hidden_effect = {
				c:DLH = {
					change_variable = {
						name = fall_of_delhi_vote_weight
						add = 0.02
					}
				}
			}
		}
	}
	after = {
		every_subject = {
			limit = {
				capital.area = area:bengal_area
				liberty_desire >= 50
			}
			trigger_event_non_silently = flavor_dlh.7
		}
	}
}

flavor_dlh.7 = {
	type = country_event
	title = flavor_dlh.7.title
	desc = flavor_dlh.7.desc

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate } 
	}

	option = {
		name = flavor_dlh.7.a 
		trigger = {
			OR = {
				has_variable = delhi_gave_money
				overlord = {
					any_subject = { has_variable = delhi_gave_territory }
				}
			}
		}

		if = {
			limit = { has_variable = delhi_gave_money }
			show_as_tooltip = {
				add_gold = {
					value = overlord.monthly_income_trade_and_tax
					multiply = 4
				}
			}
			add_government_power = government_power_extreme_bonus
		}
		if = {
			limit = { has_variable = delhi_gave_territory }
			custom_tooltip = gained_delhi_lands_tt
		}
		add_government_power = government_power_extreme_bonus
	}

	option = {
		name = flavor_dlh.7.b 

		trigger = {
			NOR = {
				has_variable = delhi_gave_money
				has_variable = delhi_gave_territory
			}
		}

		show_as_tooltip = {
			overlord = {
				every_subject = {
					limit = {
						capital.area = area:bengal_area
					}
					add_liberty_desire = liberty_desire_extreme_plus
					add_opinion = {
						target = overlord
						modifier = opinion_refused_demands
					}
				}
			}
			overlord = {
				add_country_modifier = {
					modifier = silver_famine_modifier
					years = 20
					mode = add_and_extend
				}
			}
		}
	}

	after = {
		remove_variable = delhi_gave_money
		remove_variable = delhi_gave_territory
	}
}

flavor_dlh.8 = {	
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.8.title
	desc = flavor_dlh.8.desc
	fire_only_once = yes

	dynamic_historical_event = {
		tag = DLH
		from = 1341.1.1
		to = 1405.12.30
		monthly_chance = 5
	}

	trigger = {
		is_situation_active = situation:fall_of_delhi
		exists = character:dlh_qutb_ud_in_aibak
	}

	illustration_tags = {
		10 = interior
		10 = angry
	}

	immediate = { 
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate } 
		character:dlh_qutb_ud_in_aibak = { save_scope_as = target_character }
	}

	option = {
		name = flavor_dlh.8.a 
		
		add_stability = stability_extreme_penalty
		add_estate_satisfaction = { 
			type = estate_type:nobles_estate 
			value = estate_satisfaction_extreme_penalty 
		}
		change_societal_value = {
			type = serfdom_vs_free_subjects
			value = societal_value_large_move_to_right
		}
	}

	option = {
		name = flavor_dlh.8.b

		add_government_power = government_power_extreme_penalty
		add_estate_satisfaction = { 
			type = estate_type:nobles_estate 
			value = estate_satisfaction_extreme_bonus 
		}
		change_societal_value = {
			type = serfdom_vs_free_subjects
			value = societal_value_large_move_to_left
		}
		custom_tooltip = delhi_lose_5_support_tt
		hidden_effect = {
			c:DLH = {
				change_variable = {
					name = fall_of_delhi_vote_weight
					add = -0.05
				}
			}
		}
	}
	historical_info = flavor_dlh.8.historical_info
}

flavor_dlh.9 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.9.title
	desc = flavor_dlh.9.desc
	fire_only_once = yes

	dynamic_historical_event = {
		tag = DLH
		from = 1339.1.1
		to = 1350.12.30
		monthly_chance = 5
	}

	trigger = {
		is_situation_active = situation:fall_of_delhi
		exists = character:dlh_jalalat_ud_din_razia
	}

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = { 
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate } 
		character:dlh_jalalat_ud_din_razia = { save_scope_as = target_character }
	}

	option = {
		name = flavor_dlh.9.a 
		
		add_stability = stability_extreme_penalty
		add_estate_satisfaction = { type = estate_type:peasants_estate 
			value = estate_satisfaction_severe_bonus
		}
	}

	option = {
		name = flavor_dlh.9.b

		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_extreme_bonus 
		}
		custom_tooltip = delhi_lose_5_support_tt
		hidden_effect = {
			c:DLH = {
				change_variable = {
					name = fall_of_delhi_vote_weight
					subtract = 0.05
				}
			}
		}
	}
	historical_info = flavor_dlh.9.historical_info
}

#Delhi plans to claim China
flavor_dlh.10 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.10.title
	desc = flavor_dlh.10.desc
	historical_info = flavor_dlh.10.historical_info

	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1350.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		exists = international_organization:middle_kingdom
		exists = international_organization:middle_kingdom.leader_country
		ruler ?= character:dlh_muhammad_bin_tughluq	
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		international_organization:middle_kingdom.leader_country = {
			event_illustration_nobility_estate_of_rival_effect = yes
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
			capital ?= {
				save_scope_as = target_location
			}
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}

		save_scope_as = target_country2
	}

	option = {
		name = flavor_dlh.10.a
		
		historical_option = yes

		add_casus_belli = {
			target = scope:target_country
			type = casus_belli:cb_dlh_invasion_of_china
		}

		international_organization:middle_kingdom.leader_country ?= {
			trigger_event_silently = flavor_dlh.11
		}

		add_stability = stability_extreme_penalty
	}

	option = {
		name = flavor_dlh.10.b
		
		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_move_to_right
		}
	}
}

flavor_dlh.11 = {
	type = country_event
	title = flavor_dlh.11.title
	desc = flavor_dlh.11.desc

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_dlh.11.a
		
		show_as_tooltip = {
			scope:target_country2 = {
				add_casus_belli = {
					target = root
					type = casus_belli:cb_dlh_invasion_of_china
				}
			}
		}
	}
}

######
# Lodi Dynasty Related Events
#####

#Rise of the Lodis
flavor_dlh.12 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.12.title
	desc = flavor_dlh.12.desc

	dynamic_historical_event = {
		tag = DLH
		from = 1440.1.1
		to = 1500.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	fire_only_once = yes

	trigger = {
		"culture_percentage_in_country(culture:afghan_culture)" > 0
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		capital ?= {
			create_dynasty_from_location = lodi_dynasty
		}

		create_character = {
			first_name = name_bahlul
			culture = culture:afghan_culture
			religion = root.religion
			dynasty = dynasty:lodi_dynasty
			estate = estate_type:nobles_estate
			birth_date = 1421.4.5
			save_scope_as = target_character
		}

		ordered_province = {
			limit = {
				"culture_percentage(culture:afghan_culture)" > 0
			}
			order_by = population
			max = 1
			save_scope_as = target_province
			random_location_in_province = {
				save_scope_as = target_location
			}
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.12.a

		custom_tooltip = {
			text = dlh_release_lodi_as_governors_tt
			scope:target_location = {
				create_country_from_location = {
					set_country_rank = country_rank:rank_kingdom
					save_scope_as = target_country
					set_new_ruler = scope:target_character
					change_religion = root.religion
					change_religion_for_ruler_and_family = { country = scope:target_country religion = root.religion }
					change_culture = culture:afghan_culture
					change_country_name = LOD
					
				}
			}
			
			scope:target_province = {
				every_location_in_province = {
					change_location_owner = scope:target_country
					add_core = scope:target_country
					change_integration_level = core
				}
			}

			set_variable = {
				name = dlh_lodi_country
				value = scope:target_country
			}

			scope:target_country = {
				make_subject_of = {
					target = c:DLH
					type = subject_type:vassal
				}
			}
		}
	}

	option = {
		name = flavor_dlh.12.b
		
		custom_tooltip = {
			text = dlh_all_afghani_pops_in_province_lose_30_satisfaction
			scope:target_province = {
				every_location_in_province = {
					every_pop = {
						limit = {
							owner = root
							culture = culture:afghan_culture
						}
						add_pop_satisfaction = pop_satisfaction_extreme_penalty
					}
				}
			}
		}
	}
}

#Expansion of Lodi holdings
flavor_dlh.13 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.13.title
	desc = flavor_dlh.13.desc

	dynamic_historical_event = {
		tag = DLH
		from = 1400.1.1
		to = 1450.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	fire_only_once = yes

	trigger = {
		var:dlh_lodi_country ?= {
			is_subject = yes
			any_owned_location = {
				any_neighbor_location = {
					owner ?= c:DLH
					any_pop = {
						culture = culture:afghan_culture
					}
				}
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		var:dlh_lodi_country ?= {
			every_owned_location = {
                limit = {
                    any_neighbor_location = {
                        owner ?= c:DLH
						any_pop = {
							culture = culture:afghan_culture
						}
                    }
                }
                every_neighbor_location = {
                    limit = {
                        owner ?= C:DLH
                        area = { 
                            NOT = { is_in_list = list_of_neighboring_areas }
                        }
                    }
                    area = {
                        add_to_list = list_of_neighboring_areas
                    }
                }
            }

			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}

		random_in_list = {
			list = list_of_neighboring_areas
			save_scope_as = target_area
		}
	}

	option = {
		name = flavor_dlh.13.a

		custom_tooltip = {
			text = dlh_give_entire_area_to_lodi_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= c:DLH
					}
					change_location_owner = scope:target_country
					add_core = scope:target_country
					change_integration_level = core
				}
			}
		}
	}

	option = {
		name = flavor_dlh.13.b
		
		add_stability = stability_mild_penalty
		scope:target_country = {
			add_liberty_desire = 20
		}
	}
}

#Fall of the Lodis
flavor_dlh.14 = {
	type = country_event
	title = flavor_dlh.14.title
	desc = flavor_dlh.14.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	fire_only_once = yes

	option = {
		name = flavor_dlh.14.a
		
		add_legitimacy = legitimacy_mild_bonus

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}
		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_dlh.14.b
		
		custom_tooltip = {
			text = dlh_all_afghan_locations_gain_prosperity_tt
			every_owned_location = {
				limit = {
					any_pop = {
						culture = culture:afghan_culture
					}
				}
				change_prosperity = prosperity_mild_bonus
			}
		}

		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
	}
}

#Lodi Administration
flavor_dlh.15 = {
	type = country_event
	title = flavor_dlh.15.title
	desc = flavor_dlh.15.desc

	illustration_tags = {
		10 = interior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1400.1.1
		to = 1500.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		exists = dynasty:lodi_dynasty
		ruler_or_heir_if_regent ?= {
			dynasty ?= dynasty:lodi_dynasty
		}	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.15.a
		
		add_legitimacy = legitimacy_mild_penalty
		add_stability = stability_mild_penalty
	}

	option = {
		name = flavor_dlh.15.b
		
	change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.15.c
		
		trigger = {
			ruler_or_heir_if_regent ?= {
				has_trait = righteous
			}	
		}

		add_legitimacy = legitimacy_mild_bonus
	}
}

#incompetence of the Lodis
flavor_dlh.16 = {
	type = country_event
	title = flavor_dlh.16.title
	desc = flavor_dlh.16.desc

	illustration_tags = {
		10 = interior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1400.1.1
		to = 1500.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		exists = dynasty:lodi_dynasty
		ruler_or_heir_if_regent ?= {
			dynasty ?= dynasty:lodi_dynasty
			adm < 25
		}	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.16.a
		
		add_inflation = inflation_extreme_penalty
		add_stability = stability_mild_penalty
	}

	option = {
		name = flavor_dlh.16.b
		
		custom_tooltip = {
			text = dlh_all_pops_lose_10_satisfaction_tt
			every_owned_location = {
				every_pop = {
					limit = {
						owner = root
					}
					add_pop_satisfaction = pop_satisfaction_mild_penalty
				}
			}
		}
	}
}

scripted_effect construct_delhi_tombs = {
	construct_building = {
		building_type = building_type:delhi_tomb
	}
	change_development = development_mild_bonus
	change_prosperity = prosperity_mild_bonus
}

# Tomb inspired by Qubbat-i-Sulaibiya
flavor_dlh.17 = {
	type = country_event
	title = flavor_dlh.17.title
	desc = flavor_dlh.17.desc

	fire_only_once = yes

	illustration_tags = {
		10 = interior
		10 = regular
	}

	trigger = {
		religion.group = religion_group:muslim	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ordered_owned_location = {
			order_by = development
			limit = {
				NOT = { has_building = building_type:delhi_tomb }
			}
			max = 1
			save_scope_as = target_location
		}	

		previous_ruler ?= {
			save_scope_as = target_character
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.17.a
		
		scope:target_location = {
			construct_delhi_tombs = yes
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.17.b
		
		add_prestige = prestige_mild_penalty
	}
}

flavor_dlh.18 = {
	type = country_event
	title = flavor_dlh.18.title
	desc = flavor_dlh.18.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	fire_only_once = yes

	trigger = {
		religion.group = religion_group:muslim
		scope:target_character ?= {
			has_trait = scholar
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ordered_owned_location = {
			order_by = development
			limit = {
				NOT = { has_building = building_type:delhi_tomb }
			}
			max = 1
			save_scope_as = target_location
		}	

		previous_ruler ?= {
			save_scope_as = target_character
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.18.a
		
		scope:target_location = {
			construct_delhi_tombs = yes
		}

		add_research_progress = research_progress_mild_bonus

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.18.b
		
		add_prestige = prestige_mild_penalty
	}
}

#Lodi Tomb
flavor_dlh.19 = {
	type = country_event
	title = flavor_dlh.19.title
	desc = flavor_dlh.19.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	fire_only_once = yes

	trigger = {
		government_type = government_type:monarchy
		scope:target_character ?= {
			dynasty ?= dynasty:lodi_dynasty
		}	

		"culture_percentage_in_country(culture:afghan_culture)" > 0
	}

	immediate = {

		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ordered_owned_location = {
			order_by = development
			limit = {
				NOT = { has_building = building_type:delhi_tomb }
				any_pop = {
					culture = culture:afghan_culture
				}
			}
			max = 1
			save_scope_as = target_location
		}

		previous_ruler ?= {
			save_scope_as = target_character
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.19.a
		
		scope:target_location = {
			construct_delhi_tombs = yes
			every_pop = {
				limit = {
					owner = root
				}
				add_pop_satisfaction = pop_satisfaction_severe_bonus
			}
		}
	}

	option = {
		name = flavor_dlh.19.b
		
		add_prestige = prestige_mild_penalty
	}
}

#Hisar-e-Firoza
flavor_dlh.20 = {
	type = country_event
	title = flavor_dlh.20.title
	desc = flavor_dlh.20.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1420.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		location:hisar.owner ?= root

		government_type = government_type:monarchy
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:clergy_estate }
		location:hisar = {
			save_scope_as = target_location
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.20.a
		
		scope:target_location = {
			create_art = {
				key = hisar_e_firoza
				quality = 75
				type = work_of_art_type:palace
			}
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.20.b
		
		add_prestige = prestige_mild_penalty
	}

	option = {
		name = flavor_dlh.20.c
		
		trigger = {
			ruler_or_regent ?= {
				has_trait = architectural_visionary
			}	
		}

		scope:target_location = {
			create_art = {
				artist = scope:target_character
				key = hisar_e_firoza
				quality = 85
				type = work_of_art_type:palace
			}

			change_development = development_mild_bonus
		}

		change_gold_effect = { scale = -4 }

	}

	option = {
		name = flavor_dlh.20.d
		
		trigger = {
			ruler_or_regent ?= {
				has_trait = malevolent
			}	
		}

		scope:target_location = {
			create_art = {
				artist = scope:target_character
				key = hisar_e_firoza
				quality = 0.85
				type = work_of_art_type:palace
			}

			change_control = control_mild_penalty
		}
	}
}

#Fortifying Jaunpur
flavor_dlh.21 = {
	type = country_event
	title = flavor_dlh.21.title
	desc = flavor_dlh.21.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1360.1.1
		to = 1420.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		location:jaunpur.owner ?= root
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:jaunpur = {
			save_scope_as = target_location
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.21.a
		
		scope:target_location = {
			if = {
				limit = {
					has_building = building_type:castle
				}
				change_development = development_mild_bonus
				change_prosperity = prosperity_mild_bonus
				owner ?= {
					add_gold = {
						value = root.monthly_income_trade_and_tax
						multiply = -0.5
					}
				}
			}
			else = {
				construct_building = {
					building_type = building_type:castle
					cost_multiplier = 0.75
					cost_multiplier_reason = military_cheap_sponsorship
				}
			}
		}
	}

	option = {
		name = flavor_dlh.21.b
		
		add_prestige = prestige_mild_penalty
		scope:target_location = {
			change_control = control_mild_penalty
		}

		change_societal_value = {
			type = offensive_vs_defensive
			value = societal_value_move_to_left
		}
	}

	option = {
		name = flavor_dlh.21.c
		
		trigger = {
			ruler_or_regent ?= {
				has_trait = defensive_planner
			}	
		}

		scope:target_location = {
			if = {
				limit = {
					has_building = building_type:castle
				}
				change_development = development_mild_bonus
				change_prosperity = prosperity_mild_bonus
				add_gold = {
					value = root.monthly_income_trade_and_tax
					multiply = -0.25
				}
			}
			else = {
				construct_building = {
					building_type = building_type:castle
					cost_multiplier = 0.6
					cost_multiplier_reason = military_cheap_sponsorship
				}
			}
		}

		change_societal_value = {
			type = offensive_vs_defensive
			value = societal_value_move_to_right
		}
	}
}

flavor_dlh.22 = {
	type = country_event
	title = flavor_dlh.22.title
	desc = flavor_dlh.22.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1500.1.1
		to = 1600.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		location:agra.owner ?= root
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:agra = {
			save_scope_as = target_location
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.22.a

		scope:target_location = {
			upgrade_location_rank = yes
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.22.b
		
		add_prestige = prestige_mild_penalty
	}

	option = {
		name = flavor_dlh.22.c
		
		trigger = {
			scope:target_character ?= {
				has_trait = architectural_visionary
			}
		}

		scope:target_location = {
			upgrade_location_rank = yes
			change_prosperity = prosperity_mild_bonus
			change_control = control_mild_bonus
		}

		change_gold_effect = { scale = -3 }
	}
}

#Lahdjat Sikandar Shahi wa-lata'if-i la-mutanahi
flavor_dlh.23 = {
	type = country_event
	title = flavor_dlh.23.title
	desc = flavor_dlh.23.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1490.1.1
		to = 1550.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		prestige >= 50
		ruler_or_regent ?= {
			has_trait = scholar
		}	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.23.a
		
		capital ?= {
			create_art = {
				key = lahdjat_sikandar_shahi_wa_lata_if_i_la_mutanahi
				quality = 75
				type = work_of_art_type:play
			}
		}
		
		change_gold_effect = { scale = -1 }

		scope:target_character = {
			add_character_modifier = {
				mode = add_and_extend
				modifier = dlh_artistic_burnout
				years = 5
			}
		}
	}

	option = {
		name = flavor_dlh.23.b
		
		add_prestige = prestige_mild_penalty
	}
}

flavor_dlh.24 = {
	type = country_event
	title = flavor_dlh.24.title
	desc = flavor_dlh.24.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1360.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		religion.group = religion_group:muslim
		prestige >= 75
		NOT = { has_advance = university_advance } #Early university effectively
		ruler_or_regent ?= {
			has_trait = zealot
			has_trait = scholar
			religion.group = religion_group:muslim
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:clergy_estate }
		capital ?= {
			save_scope_as = target_location
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.24.a
		
		scope:target_location = {
			construct_building = {
				building_type = building_type:university
				cost_multiplier = 2
				cost_multiplier_reason = military_expensive_sponsorship
			}
		}
	}

	option = {
		name = flavor_dlh.24.b
		
		culture = {
			add_cultural_influence = cultural_influence_weak_penalty
			add_cultural_tradition = cultural_tradition_weak_penalty
		}
	}
}

#Moving Capital to Delhi
flavor_dlh.25 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.25.title
	desc = flavor_dlh.25.desc

	illustration_tags = {
		10 = exterior
		10 = happy
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		capital != location:delhi
		location:delhi.owner ?= root
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		capital ?= {
			save_scope_as = target_location
		}

		location:delhi = {
			save_scope_as = target_location2
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.25.a
		
		set_capital = scope:target_location2

		scope:target_location2 = {
			change_development = development_mild_bonus
		}

		change_gold_effect = { scale = -1 }
	}

	option = {
		name = flavor_dlh.25.b
		
		add_stability = stability_mild_penalty
	}
}

flavor_dlh.26 = {
	type = country_event
	title = flavor_dlh.26.title
	desc = flavor_dlh.26.desc
	historical_info = flavor_dlh.26.historical_info

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = { #Should be created as soon as you have a Lodi ruler
		tag = DLH
		from = 1440.1.1			#Can't fire before event 12 which starts checking in 1440
		to = 1821.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		exists = dynasty:lodi_dynasty
		at_war = no
		exists = dynasty:lodi_dynasty
		ruler_or_heir_if_regent ?= {
			dynasty ?= dynasty:lodi_dynasty
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		capital ?= {
			save_scope_as = target_location
		}

		create_character = {
			artist = architect
			religion = root.religion
			culture = root.culture
			estate = estate_type:burghers_estate
			age = 25
			artist_skill = {
				0.6
				0.8
			}
			save_scope_as = target_character
			create_in_limbo = yes
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.26.a
		
		scope:target_location = {
			create_art = {
				artist = scope:target_character
				key = lodi_gardens
				quality = 75
				type = work_of_art_type:monument
			}
		}
		change_gold_effect = { scale = -2 }
		scope:target_character = { move_country = root }
	}

	option = {
		name = flavor_dlh.26.b
		
		add_prestige = prestige_mild_penalty

		scope:target_character = {
			banish_character = yes
		}
	}
}

#Mad Sultan of Delhi
flavor_dlh.27 = {
	type = country_event
	title = flavor_dlh.27.title
	desc = flavor_dlh.27.desc
	historical_info = flavor_dlh.27.historical_info

	illustration_tags = {
		10 = interior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1821.1.1
		monthly_chance = 25
	}

	fire_only_once = yes

	trigger = {
		government_type = government_type:monarchy
		ruler ?= character:dlh_muhammad_bin_tughluq	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.27.a
		
		custom_tooltip = {
			text = dlh_unique_mad_sultan_events_tt
			ruler ?= {
				set_variable = dlh_mad_sultan_events
			}
		}
		scope:target_character = {
			add_character_modifier = {
				mode = replace
				modifier = dlh_the_mad_sultan
				years = -1
			}
		}
	}
}

#$CAPITAL$ Looted
flavor_dlh.28 = {
	type = country_event
	title = flavor_dlh.28.title
	desc = flavor_dlh.28.desc
	historical_info = flavor_dlh.27.historical_info
	major = yes
	major_trigger = {
		this = scope:target_country2
	}

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		scope:target_location.owner ?= {
			save_scope_as = target_country2
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.28.a
		
		scope:target_location = {
			change_prosperity = prosperity_extreme_penalty
			change_development = development_extreme_penalty
		}

		add_gold = {
			value = root.monthly_income_trade_and_tax
		}

		add_opinion_mutual_effect = {
			modifier = dlh_looted_capital
			target = scope:target_country2
		}
	}
}

#Increase of taxes in $AREA$
flavor_dlh.29 = {
	type = country_event
	title = flavor_dlh.29.title
	desc = flavor_dlh.29.desc
	historical_info = flavor_dlh.29.historical_info

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	trigger = {
		ruler ?= {
			has_variable = dlh_mad_sultan_events
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		random_owned_location = {
			area = {
				save_scope_as = target_area
			}
		}

		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.29.a

		custom_tooltip = {
			text = dlh_every_location_in_area_gets_following_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					add_location_modifier = {
						mode = add_and_extend
						modifier = dlh_increased_taxes
						months = 60
					}
					change_control = control_mild_penalty
				}
			}
		}
	}

	option = {
		name = flavor_dlh.29.b
		
		ruler_or_regent ?= {
			add_character_modifier = {
				mode = add_and_extend 
				modifier = dlh_restricted_power
			}
		}
	}
}

flavor_dlh.30 = {
	type = country_event
	title = flavor_dlh.30.title
	desc = flavor_dlh.30.desc
	historical_info = flavor_dlh.30.historical_info

	illustration_tags = {
		10 = interior
		10 = regular
	}

	trigger = {
		religion.group = religion_group:muslim
		ruler ?= {
			has_variable = dlh_mad_sultan_events
			NOT = { has_character_modifier = dlh_piety_focus_ruler }
		}	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.30.a
		
		ruler_or_regent ?= {
			add_character_modifier = {
				mode = add_and_extend
				modifier = dlh_piety_focus_ruler
				years = 2
			}
		}
	}
}

flavor_dlh.31 = {
	type = country_event
	title = flavor_dlh.31.title
	desc = flavor_dlh.31.desc
	historical_info = flavor_dlh.31.historical_info

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	trigger = {
		religion.group = religion_group:muslim
		ruler ?= {
			has_variable = dlh_mad_sultan_events
			NOT = { has_character_modifier = dlh_piety_focus_ruler }
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		random_owned_location = {
			area = {
				save_scope_as = target_area
			}
		}

		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.31.a
		
		custom_tooltip = {
			text = dlh_every_location_in_area_loses_control_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					change_control = control_extreme_penalty
				}
			}
		}
	}
}

#Curbing the Shias
flavor_dlh.32 = {
	type = country_event
	title = flavor_dlh.32.title
	desc = flavor_dlh.32.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }	
	}

	trigger = {
		religion != religion:shia
		"religion_percentage_in_country(religion:shia)" > 0
		root.religion = {
			religious_view = {
				target = religion:shia
				value < neutral
			}
		}
	}

	option = {
		name = flavor_dlh.32.a
		
		custom_tooltip = {
			text = dlh_15_percent_of_shia_pops_convert_to_root_religion_tt
			every_owned_location = {
				limit = {
					any_pop = {
						religion = religion:shia
					}
				}
				every_pop = {
					limit = {
						owner = root
						religion = religion:shia
					}
					split_pop = {
						fraction = 0.15
						religion = root.religion
					}
					add_pop_satisfaction = pop_satisfaction_extreme_penalty
				}
			}
		}

		add_stability = stability_extreme_penalty
	}

	option = {
		name = flavor_dlh.32.b
		
		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}

		add_stability = stability_mild_bonus
	}
}

flavor_dlh.33 = {
	type = country_event
	title = flavor_dlh.33.title
	desc = flavor_dlh.33.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		OR = {
			AND = {
				has_ruler = yes
				ruler != character:dlh_muhammad_bin_tughluq
			}
			AND = {
				has_regent = yes
				regent != character:dlh_muhammad_bin_tughluq
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		create_character = {
			first_name = name_malik
			last_name = maqbul
			culture = culture:telugu
			religion = religion:sunni
			estate = estate_type:clergy_estate
			birth_date = 1320.5.3
			save_scope_as = target_character
			adm = { 70 90 }
			dip = { 65 80 }
			mil = { 70 90 }
			create_in_limbo = yes
		}

		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.33.a
		
		scope:target_character = {
			add_character_modifier = {
				mode = add_and_extend
				modifier = dlh_grand_wazir_capabilities
				years = -1
			}
		}
		scope:target_character = { move_country = root }

		custom_tooltip = {
			text = dlh_character_grants_positive_events_as_long_as_they_are_in_cabinet_tt
			scope:target_character = {
				set_variable = dlh_grand_vizier
			}
		}
	}

	option = {
		name = flavor_dlh.33.b
		
		scope:target_character = {
			banish_character = yes
		}
	}
}

#Assisting locations in the Yamuna Canal
flavor_dlh.34 = {
	type = country_event
	title = flavor_dlh.34.title
	desc = flavor_dlh.34.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		area:doab_area = {
			any_location_in_area = {
				percent = 1
				OR = {
					owner ?= root
					is_ownable = no
				}
			}
		}

		any_cabinet_character ?= {
			has_variable = dlh_grand_vizier
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		random_cabinet_character ?= {
			limit = {
				has_variable = dlh_grand_vizier
			}
			save_scope_as = target_character
		}

		area:doab_area = {
			ordered_location_in_area = {
				order_by = population
				limit = {
					owner ?= root
				}
				position = 0
				save_scope_as = target_location
			}
			ordered_location_in_area = {
				order_by = population
				limit = {
					owner ?= root
				}
				position = 1
				save_scope_as = target_location2
			}
			ordered_location_in_area = {
				order_by = population
				limit = {
					owner ?= root
				}
				position = 2
				save_scope_as = target_location3
			}
		}
	}

	option = {
		name = flavor_dlh.34.a
		
		scope:target_location = {
			change_development = development_mild_bonus
			if = {
				limit = {
					has_building = building_type:irrigation_systems
				}
				construct_building = {
					building_type = building_type:irrigation_systems
					cost_multiplier = 1.5
					cost_multiplier_reason = peasants_expensive_sponsorship
				}
			}
			else = {
				change_prosperity = prosperity_mild_bonus

				owner ?= {
					add_gold = {
						value = root.monthly_income_trade_and_tax
						max = 200 #We do not want it to cost a lot for no gain
						multiply = -1
					}
				}
			}
		}

		scope:target_location2 = {
			change_development = development_mild_bonus
			if = {
				limit = {
					has_building = building_type:irrigation_systems
				}
				construct_building = {
					building_type = building_type:irrigation_systems
					cost_multiplier = 1.5
					cost_multiplier_reason = peasants_expensive_sponsorship
				}
			}
			else = {
				change_prosperity = prosperity_mild_bonus

				owner ?= {
					add_gold = {
						value = root.monthly_income_trade_and_tax
						max = 200 #We do not want it to cost a lot for no gain
						multiply = -1
					}
				}
			}
		}

		scope:target_location3 = {
			change_development = development_mild_bonus
			if = {
				limit = {
					has_building = building_type:irrigation_systems
				}
				construct_building = {
					building_type = building_type:irrigation_systems
					cost_multiplier = 1.5
					cost_multiplier_reason = peasants_expensive_sponsorship
				}
			}
			else = {
				change_prosperity = prosperity_mild_bonus

				owner ?= {
					add_gold = {
						value = root.monthly_income_trade_and_tax
						max = 200 #We do not want it to cost a lot for no gain
						multiply = -1
					}
				}
			}
		}
	}

	option = {
		name = flavor_dlh.34.b
		
		scope:target_location = {
			change_prosperity = prosperity_mild_penalty
		}

		scope:target_location2 = {
			change_prosperity = prosperity_mild_penalty
		}

		scope:target_location3 = {
			change_prosperity = prosperity_mild_penalty
		}
	}
}

#Combating Famine
flavor_dlh.35 = {
	type = country_event
	title = flavor_dlh.35.title
	desc = flavor_dlh.35.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		any_province = {
			region = capital.region
			percent >= 0.05
			is_starving = yes
		}
		any_cabinet_character ?= {
			has_variable = dlh_grand_vizier
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		random_cabinet_character ?= {
			limit = {
				has_variable = dlh_grand_vizier
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.35.a
		
		custom_tooltip = {
			text = dlh_whilst_grand_vizier_is_in_council_or_ruler_allow_combat_famine_parliament_debate_tt
			scope:target_character = {
				set_variable = dlh_famine_reduction_flag
			}
		}
	}

	option = {
		name = flavor_dlh.35.b
		
		add_government_power = government_power_extreme_bonus
	}
}

flavor_dlh.36 = {
	type = country_event
	title = flavor_dlh.36.title
	desc = flavor_dlh.36.desc
	historical_info = flavor_dlh.36.historical_info

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		any_cabinet_character ?= {
			has_variable = dlh_grand_vizier
		}	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_cabinet_character ?= {
			limit = {
				has_variable = dlh_grand_vizier
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.36.a
		historical_option = yes
		
		add_stability = stability_extreme_bonus
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_penalty
		}
	}

	option = {
		name = flavor_dlh.36.b
		
		add_estate_satisfaction = {
			type = estate_type:peasants_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}

#Force taxation on Hindus
flavor_dlh.37 = {
	type = country_event
	title = flavor_dlh.37.title
	desc = flavor_dlh.37.desc
	historical_info = flavor_dlh.37.historical_info

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		any_cabinet_character ?= {
			has_variable = dlh_grand_vizier
		}

		"religion_percentage_in_country(religion:hindu)" > 0.5
		religion != religion:hindu
		country_has_estate = estate_type:dhimmi_estate
	}

	immediate = {
		event_illustration_peasants_foreign_religion_pop_type_effect = yes
		random_cabinet_character ?= {
			limit = {
				has_variable = dlh_grand_vizier
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.37.a
		
		change_gold_effect = { scale = 6 }

		custom_tooltip = {
			text = dlh_5_percent_of_pops_convert_to_our_religion_tt
			every_owned_location = {
				limit = {
					any_pop = {
						religion = religion:hindu
					}
				}
				every_pop = {
					limit = {
						religion = religion:hindu
					}
					split_pop = {
						fraction = 0.05
						religion = root.religion
					}
				}
			}
		}

		add_estate_satisfaction = {
			type = estate_type:dhimmi_estate
			value = estate_satisfaction_ultimate_penalty
		}
	}

	option = {
		name = flavor_dlh.37.b
		
		add_estate_satisfaction = {
			type = estate_type:dhimmi_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

#Coup event for Malik Maqbul. Never happened but it's nice alt-history
flavor_dlh.38 = {
	type = country_event
	title = flavor_dlh.38.title
	desc = flavor_dlh.38.desc

	illustration_tags = {
		10 = interior
		10 = armed
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		government_type = government_type:monarchy
		any_cabinet_character ?= {
			has_variable = dlh_grand_vizier
		}

		"estate_power(estate_type:crown_estate)" < 0.2
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
		random_cabinet_character ?= {
			limit = {
				has_variable = dlh_grand_vizier
			}
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.38.a
		
		set_new_ruler = scope:target_character2

		scope:target_character2 = {
			change_character_estate = estate_type:crown_estate
			every_descendant = {
				limit = {
					owner = root
				}
				change_character_estate = estate_type:crown_estate
			}
			every_spouse = {
				limit = {
					owner = root
				}
				change_character_estate = estate_type:crown_estate
			}
		}

		remove_variable = dlh_grand_vizier
	}
}


flavor_dlh.39 = {
	type = country_event
	title = flavor_dlh.39.title
	desc = flavor_dlh.39.desc

	trigger = {
		tag = DLH
		OR = {
			ruler_or_heir_if_regent ?= { has_dynasty = no }
			NOT = { exists = dynasty:tughlaq_dynasty }
			AND = {
				exists = dynasty:tughlaq_dynasty
				ruler_or_heir_if_regent ?= {
					has_dynasty = yes
					dynasty != dynasty:tughlaq_dynasty
				}
			}
		}
	}

	fire_only_once = yes

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.39.a
		
		add_stability = stability_mild_penalty

		custom_tooltip = {
			text = dlh_20_percent_of_slaves_become_peasants_tt
			every_owned_location = {
				limit = {
					any_pop = {
						pop_type = pop_type:slaves
					}
				}
				every_pop = {
					split_pop = {
						fraction = 0.2
						type = pop_type:peasants
					}
				}
			}
		}
	}
}

#Establishment of Ghulaman-i-Firuz Shahi
flavor_dlh.40 = {
	type = country_event
	title = flavor_dlh.40.title
	desc = flavor_dlh.40.desc

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1500.1.1
		monthly_chance = 3
	}

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"

	immediate = {
		ruler_or_regent = {
			save_scope_as = target_character
		}
	}

	fire_only_once = yes

	trigger = {
		has_embraced_institution = institution:professional_armies
		ruler_or_heir_if_regent ?= {
			dynasty ?= dynasty:tughlaq_dynasty
		}
	}

	option = {
		name = flavor_dlh.40.a
		
		unlock_government_reform_effect = {
			type = tughlaq_slave_army_reform
		}
	}

	option = {
		name = flavor_dlh.40.b
		
		add_stability = stability_mild_bonus
	}
}

flavor_dlh.41 = {
	type = country_event
	title = flavor_dlh.41.title
	desc = flavor_dlh.41.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"

	trigger = {
		ruler_or_heir_if_regent ?= {
			adm < 25
			dip < 25
			mil < 25
			NOT = { has_character_modifier = dlh_corrupt_guard }
		}

		has_reform = government_reform:tughlaq_slave_army_reform
	}

	immediate = {
		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.41.a
		
		scope:target_character = {
			add_character_modifier = {
				mode = add_and_extend
				modifier = dlh_corrupt_guard
				years = 10
			}
		}
	}

	option = {
		name = flavor_dlh.41.b
		
		change_gold_effect = { scale = -3 }
	}
}

#Tughlaq Architecture
flavor_dlh.42 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.42.title
	desc = flavor_dlh.42.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		ruler_or_heir_if_regent ?= {
			dynasty ?= dynasty:tughlaq_dynasty
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
		create_character = {
			age = 25
			artist = architect
			artist_skill = 0.6
			culture = root.culture
			religion = root.religion
			estate = estate_type:burghers_estate
			save_scope_as = target_character2
			create_in_limbo = yes
		}	

		create_character = {
			age = 25
			artist = architect
			artist_skill = 0.6
			culture = root.culture
			religion = root.religion
			estate = estate_type:burghers_estate
			save_scope_as = target_character3
			create_in_limbo = yes
		}

		capital ?= {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_dlh.42.a
		
		add_prestige = prestige_extreme_bonus

		scope:target_location = {
			change_development = development_extreme_bonus
		}

		change_gold_effect = { scale = -2 }
		scope:target_character2 = { move_country = root }
		scope:target_character3 = { move_country = root }
	}

	option = {
		name = flavor_dlh.42.b
		
		scope:target_character2 = {
			banish_character = yes
		}
		scope:target_character3 = {
			banish_character = yes
		}
	}
}

flavor_dlh.43 = {
	type = country_event
	title = flavor_dlh.43.title
	desc = flavor_dlh.43.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1505.1.1
		to = 1520.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		location:delhi = {
			owner ?= root
			any_work_of_art_in_location = {
				this = work_of_art:qutb_minar
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:delhi = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_dlh.43.a
		
		scope:target_location = {
			change_prosperity = prosperity_mild_penalty
			random_work_of_art_in_location = {
				limit = {
					this = work_of_art:qutb_minar
				}
				change_art_quality = -20
			}
		}
	}

	option = {
		name = flavor_dlh.43.b
		
		scope:target_location = {
			change_prosperity = prosperity_mild_penalty
			random_work_of_art_in_location = {
				limit = {
					this = work_of_art:qutb_minar
				}
				change_art_quality = -10
			}
		}

		change_gold_effect = { scale = -2 }
	}

	after = {
		trigger_event_silently = {
			id = flavor_dlh.44
			months = { 50 120 }
		}
	}
}

#Expanding The Qutb Minar
flavor_dlh.44 = {
	type = country_event
	title = flavor_dlh.44.title
	desc = flavor_dlh.44.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	fire_only_once = yes

	trigger = {
		location:delhi = {
			owner ?= root
			any_work_of_art_in_location = {
				this = work_of_art:qutb_minar
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:delhi = {
			save_scope_as = target_location
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.44.a
		
		scope:target_location = {
			random_work_of_art_in_location = {
				limit = {
					this = work_of_art:qutb_minar
				}
				change_art_quality = 15
			}
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.44.b
		
		add_prestige = prestige_mild_penalty
	}


}

#Regulating inflation brought by the Mad Sultan
flavor_dlh.45 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.45.title
	desc = flavor_dlh.45.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		exists = character:dlh_muhammad_bin_tughluq
		OR = {
			AND = {
				has_ruler = yes
				ruler != character:dlh_muhammad_bin_tughluq
			}
			AND = {
				has_regent = yes
				regent != character:dlh_muhammad_bin_tughluq
			}
		}
		inflation > 0.5
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:clergy_estate }
		character:dlh_muhammad_bin_tughluq = {
			save_scope_as = target_character
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.45.a
		
		add_inflation = inflation_extreme_bonus

		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_radical_penalty
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.45.b
		
		add_inflation = inflation_extreme_penalty
	}
}

flavor_dlh.46 = {
	type = country_event
	title = flavor_dlh.46.title
	desc = flavor_dlh.46.desc

	illustration_tags = {
		10 = interior
		10 = happy
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1360.1.1
		to = 1420.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		has_embraced_institution = institution:renaissance	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}	
	}

	option = {
		name = flavor_dlh.46.a
		
		culture = {
			add_cultural_influence = cultural_influence_extreme_bonus
			add_cultural_tradition = cultural_tradition_extreme_bonus
		}

		change_societal_value = {
			type = spiritualist_vs_humanist
			value = societal_value_move_to_right
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_dlh.46.b
		
		add_prestige = prestige_mild_penalty

		change_societal_value = {
			type = spiritualist_vs_humanist
			value = societal_value_move_to_left
		}
	}
}

flavor_dlh.47 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.47.title
	desc = flavor_dlh.47.desc

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1500.1.1
		to = 1600.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		"culture_percentage_in_country(culture:afghan_culture)" > 0
		any_owned_location = {
			is_capital = no
			any_pop = {
				pop_type = pop_type:nobles
				culture = culture:afghan_culture
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ordered_owned_location = {
			order_by = population
			limit = {
				is_capital = no
				any_pop = {
					pop_type = pop_type:nobles
					culture = culture:afghan_culture
				}
			}
			max = 1
			save_scope_as = target_location
			area = {
				save_scope_as = target_area
			}
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.47.a
		
		custom_tooltip = {
			text = dlh_afghan_unrest_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					every_pop = {
						limit = {
							owner = root
							culture = culture:afghan_culture
						}
						add_pop_satisfaction = pop_satisfaction_extreme_penalty
					}
				}
			}
		}
	}

	option = {
		name = flavor_dlh.47.b

		custom_tooltip = {
			text = dlh_afghan_control_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					change_control = control_extreme_penalty
				}
			}
		}
		
		change_societal_value = {
			type = spiritualist_vs_humanist
			value = societal_value_move_to_left
		}

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_extreme_penalty
		}
	}
}

#Sayyids event. Would normally only happen for AI since it requires them to be subject of the Timurids
flavor_dlh.48 = {
	type = country_event
	title = flavor_dlh.48.title
	desc = flavor_dlh.48.desc

	illustration_tags = {
		10 = interior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1380.1.1
		to = 1410.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		country_exists = c:TIM
		is_subject_of = c:TIM	
	}

	immediate = {
		event_illustration_government_estate_effect = yes
		capital ?= {
			create_dynasty_from_location = sayyid_dynasty
		}
		create_character = {
			first_name = name_khizr
			culture = root.culture
			religion = root.religion
			dynasty = dynasty:sayyid_dynasty
			adm = 60
			dip = 80
			mil = 50
			estate = estate_type:nobles_estate
			birth_date = 1361.8.2
			save_scope_as = target_character
		}

		overlord = {
			save_scope_as = target_country
		}
	}

	option = {
		name = flavor_dlh.48.a
		
		set_new_ruler = scope:target_character
		add_liberty_desire = 25
	}

	option = {
		name = flavor_dlh.48.b
		
		add_liberty_desire = -30
	}
}

#Re-implementation of shahana-i-mandi
flavor_dlh.50 = {
	type = country_event
	title = flavor_dlh.50.title
	desc = flavor_dlh.50.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1400.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		ruler_or_regent ?= {
			religion.group = religion_group:muslim
			has_trait = zealot
		}	
	}

	immediate = {
		event_illustration_government_estate_effect = yes
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.50.a
		
		unlock_government_reform_effect = {
			type = shahana_i_mandi
		}

		add_reform = government_reform:shahana_i_mandi
	}

	option = {
		name = flavor_dlh.50.b
		
		add_estate_satisfaction = {
			type = estate_type:dhimmi_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

#Slave guard assassinates ruler
flavor_dlh.51 = {
	type = country_event
	title = flavor_dlh.51.title
	desc = flavor_dlh.51.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_slaves_goods.dds"

	trigger = {
		has_reform = government_reform:tughlaq_slave_army_reform
	}

	immediate = {
		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.51.a
		
		kill_character = {
			target = scope:target_character
			reason = assassination
		}

		add_stability = stability_mild_penalty
	}
}

# Appointment of a Traveler
flavor_dlh.52 = {
	type = country_event
	title = flavor_dlh.52.title
	desc = flavor_dlh.52.desc

	trigger = {
		any_neighbor_country = {
			religion.group = religion_group:muslim
			any_character = {
				religion = ROOT.religion
				total_abilities >= 200
				is_ruler = no
				is_regent = no
				is_heir = no
				is_adolescent = no
			}
		}
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_neighbor_country = {
			limit = {
				religion.group = religion_group:muslim
				any_character = {
					religion = ROOT.religion
					total_abilities >= 200
					is_ruler = no
					is_regent = no
					is_heir = no
					is_adolescent = no
				}
			}
			event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
			random_character = {
				limit = {
					total_abilities >= 200
					religion = ROOT.religion
					is_ruler = no
					is_regent = no
					is_heir = no
					is_adolescent = no
				}
				save_scope_as = target_character
			}
		}
	}

	option = {
		name = flavor_dlh.52.a
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = "add_estate_satisfaction_utility(nobles_estate|estate_satisfaction_mild_penalty)"
			}
		}

		scope:target_character = {
			move_country = ROOT

			add_character_modifier = {
				modifier = dlh_foreign_appointee
				years = -1
			}
		}

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_penalty
		}
	}

	option = {
		name = flavor_dlh.52.b
		
		ai_chance = {
			factor = 0.1
		}

		if = {
			limit = {
				has_societal_value = societal_value_type:outward_vs_inward
			}
			change_societal_value = {
				type = outward_vs_inward
				value = societal_value_minor_move_to_right
			}
		}
		else = {
			add_prestige = prestige_weak_bonus
		}
	}
}

# Dismissal from Post
flavor_dlh.53 = {
	type = country_event
	title = flavor_dlh.53.title
	desc = flavor_dlh.53.desc

	trigger = {
		any_cabinet_character = {
			count >= 1
		}
		ruler ?= { has_variable = dlh_mad_sultan_events }
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_cabinet_character = {
			save_scope_as = target_character
		}
		ruler = {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.53.a
		
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				government_power <= 50
			}
		}

		remove_from_cabinet = scope:target_character
		scope:target_character = {
			add_character_modifier = {
				mode = replace
				modifier = banned_from_cabinet
			}
		}
		add_estate_satisfaction = {
			type = scope:target_character.estate_type
			value = estate_satisfaction_mild_penalty
		}
	}

	option = {
		name = flavor_dlh.53.b

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				government_power > 50
			}
		}

		add_government_power = government_power_extreme_penalty
	}
}

# Rebellion Report from Slave
flavor_dlh.54 = {
	type = country_event
	title = flavor_dlh.54.title
	desc = flavor_dlh.54.desc

	trigger = {
		any_character = {
			has_estate = estate_type:nobles_estate
			is_ruler = no
			is_regent = no
			is_heir = no
			is_adolescent = no
			is_female = no
		}
		any_province = {
			NOT = {
				any_location_in_province = {
					controller != owner
				}
			}
		}
	}

	illustration_tags = {
		10 = armed
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		random_character = {
			limit = {
				has_estate = estate_type:nobles_estate
				is_ruler = no
				is_regent = no
				is_heir = no
				is_adolescent = no
				is_female = no
			}
			save_scope_as = target_character
		}

		random_province = {
			limit = {
				NOT = {
					any_location_in_province = {
						controller != owner
					}
				}
			}
			save_scope_as = target_province
		}

		scope:target_province = {
			every_location_in_province = {
				add_to_list = rebel_locations
			}
		}

		create_rebel = {
			category = pretender
			save_scope_as = target_rebels
		}

		scope:target_character = {
			change_character_allegiance = scope:target_rebels
		}
	}

	option = {
		name = flavor_dlh.54.a

		ai_chance = {
			factor = 0.25
		}
		
		scope:target_character = {
			imprison_character_effect = {
				years = -1
			}
		}

		add_government_power = government_power_severe_penalty
		add_stability = stability_severe_penalty

		destroy_rebel = scope:target_rebels
	}

	option = {
		name = flavor_dlh.54.b

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				any_war = {
					count >= 1
				}
			}
		}
		
		create_instant_rebellion = {
			list = rebel_locations
			rebel = scope:target_rebels
		}
	}
}

# Iqta Holder Unable to Meet Quota
flavor_dlh.55 = {
	type = country_event
	title = flavor_dlh.55.title
	desc = flavor_dlh.55.desc

	trigger = {
		ruler ?= { 
			has_variable = dlh_mad_sultan_events
		}
		any_province = {
			NOT = {
				any_location_in_province = {
					controller != owner
				}
			}
		}
	}

	
	illustration_tags = {
		10 = armed
		10 = exterior
	}

	immediate = {
		random_character = {
			limit = {
				has_estate = estate_type:nobles_estate
			}
			save_scope_as = target_character
		}

		ruler = {
			save_scope_as = target_character2
		}

		random_province = {
			limit = {
				NOT = {
					any_location_in_province = {
						controller != owner
					}
				}
			}
			save_scope_as = target_province
		}

		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }

		scope:target_province = {
			every_location_in_province = {
				add_to_list = rebel_locations
			}
		}

		create_rebel = {
			category = pretender
			save_scope_as = target_rebels
		}

		scope:target_character = {
			change_character_allegiance = scope:target_rebels
		}
	}

	option = {
		name = flavor_dlh.55.a

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				any_war = {
					count >= 1
				}
			}
		}
		
		create_instant_rebellion = {
			list = rebel_locations
			rebel = scope:target_rebels
		}
	}

	option = {
		name = flavor_dlh.55.b

		ai_chance = {
			factor = 0.25
		}
		
		add_prestige = prestige_mild_bonus

		destroy_rebel = scope:target_rebels

		add_country_modifier = {
			mode = replace
			modifier = dlh_iqta_holder_appeasement
			years = 10
		}
	}
}

# Heritable Iqta
flavor_dlh.56 = {
	type = country_event
	title = flavor_dlh.56.title
	desc = flavor_dlh.56.desc

	illustration_tags = {
		10 = regular
		10 = exterior
	}
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		unlock_estate_privilege_effect = {
			type = heritable_iqta
		}
	}

	trigger = {
		has_law = iqta_law
		OR = {
			is_situation_active = situation:fall_of_delhi
			any_active_disaster = {
				disaster_type = disaster_type:dissolution_of_delhi
			}
		}
	}

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1390.1.1
		monthly_chance = 5
	}

	option = {
		name = flavor_dlh.56.a

		ai_chance = {
			factor = 0.1
		}
		
		grant_estate_privilege = estate_privilege:heritable_iqta
	}

	option = {
		name = flavor_dlh.56.b

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				estate_satisfaction:nobles_estate < 0.4
			}
		}
		
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_extreme_penalty
		}
	}
}

# Diwan-i Bandagan
flavor_dlh.57 = {
	type = country_event
	title = flavor_dlh.57.title
	desc = flavor_dlh.57.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1350.1.1
		to = 1380.1.1
		monthly_chance = 3
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		random_current_reforms = {
			save_scope_as = target_reform
		}
		random_current_reforms = {
			limit = {
				is_major_reform = no
			}
			save_scope_as = target_reform
		}
	}

	option = {
		name = flavor_dlh.57.a

		ai_chance = {
			factor = 1
		}
		
		historical_option = yes

		if = {
			limit = {
				num_reforms >= modifier:government_reform_slots
				exists = scope:target_reform
			}
			remove_reform = scope:target_reform
		}
		
		unlock_government_reform_effect = {
			type = diwan_i_bandagan
		}
		add_reform = government_reform:diwan_i_bandagan
	}

	option = {
		name = flavor_dlh.57.b

		ai_chance = {
			factor = 0
		}
		
		unlock_government_reform_effect = {
			type = diwan_i_bandagan
		}
	}
}

# Mamluk Recruitment
flavor_dlh.58 = {
	type = country_event
	title = flavor_dlh.58.title
	desc = flavor_dlh.58.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1380.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_dlh.58.a

		ai_chance = {
			factor = 0.5
			modifier = {
				factor = 2
				manpower < yearly_manpower
			}
		}
		
		add_yearly_manpower = 0.25

		change_societal_value = {
			type = land_vs_naval
			value = societal_value_move_to_left
		}
	}

	option = {
		name = flavor_dlh.58.b

		ai_chance = {
			factor = 0.5

			modifier = {
				factor = 2
				stability < 50
			}
			modifier = {
				factor = 2
				government_power < 50
			}
		}
		
		add_government_power = government_power_extreme_bonus
		add_stability = stability_mild_bonus
		add_country_modifier = {
			mode = replace
			modifier = dlh_slaves_in_cabinet
			years = 10
		}
	}
}

scripted_effect success_of_qarachil = {
	custom_tooltip = {
		text = gain_5_sop_tt
		change_variable = {
			name = fall_of_delhi_vote_weight
			add = 0.05
		}
	}

	add_army_tradition = army_tradition_mild_bonus
}

scripted_effect loss_of_qarachil = {
	custom_tooltip = {
		text = lose_5_sop_tt
		change_variable = {
			name = fall_of_delhi_vote_weight
			subtract = 0.05
		}
	}

	add_prestige = prestige_extreme_penalty
}

# Failure of the Qarachil Expedition
flavor_dlh.59 = {
	type = country_event
	title = flavor_dlh.59.title
	desc = flavor_dlh.59.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1340.1.1
		to = 1350.1.1
		monthly_chance = 10
	}

	trigger = {
		is_situation_active = situation:fall_of_delhi
		ruler ?= character:dlh_muhammad_bin_tughluq
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		area:nepal_area = {
			save_scope_as = target_area
		}
		ruler = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_dlh.59.a

		ai_chance = {
			factor = 0.1
		}

		c:KMN ?= {
			ROOT = {
				add_casus_belli = {
					target = PREV
					type = casus_belli:cb_annex
				}
			}
		}
		
		c:GWL ?= {
			ROOT = {
				add_casus_belli = {
					target = PREV
					type = casus_belli:cb_annex
				}
			}
		}
		
		custom_tooltip = {
			set_variable = dlh_qarachil_expedition_second
			set_variable = {
				name = dlh_qarachil_expedition_second_timer
				years = 10
			}
			text = dlh_benefits_of_subjugating
		}
		show_as_tooltip = {
			success_of_qarachil = yes
		}
	}

	option = {
		name = flavor_dlh.59.b

		ai_chance = {
			factor = 0.9
		}
	
		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_move_to_right
		}
	}
}

# Success of the  Qarachil Expedition
flavor_dlh.60 = {
	type = country_event
	title = flavor_dlh.60.title
	desc = flavor_dlh.60.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1340.1.1
		to = 1360.1.1
		monthly_chance = 100
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		has_variable = dlh_qarachil_expedition_second
		has_variable = dlh_qarachil_expedition_second_timer
		is_situation_active = situation:fall_of_delhi
		area:nepal_area = {
			any_location_in_area = {
				percent >= 0.3
				owner ?= ROOT
			}
		}
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		remove_variable = dlh_qarachil_expedition_second_timer
		remove_variable = dlh_qarachil_expedition_second
	}

	option = {
		name = flavor_dlh.60.a
		
		success_of_qarachil = yes
	}
}

# Failure of the Second Qarachil Expedition
flavor_dlh.61 = {
	type = country_event
	title = flavor_dlh.61.title
	desc = flavor_dlh.61.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1340.1.1
		to = 1360.1.1
		monthly_chance = 100
	}

	illustration_tags = {
		10 = armed
		10 = exterior
	}

	trigger = {
		has_variable = dlh_qarachil_expedition_second
		NOT = { has_variable = dlh_qarachil_expedition_second_timer }
		is_situation_active = situation:fall_of_delhi	
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		remove_variable = dlh_qarachil_expedition_second
	}

	option = {
		name = flavor_dlh.61.a
		
		loss_of_qarachil = yes
	}
}

# Foreign Prince
flavor_dlh.62 = {
	type = country_event
	title = flavor_dlh.62.title
	desc = flavor_dlh.62.desc

	trigger = {
		region:persia_region = {
			any_present_country = {
				"border_distance_to(root)" < 300
				ruler ?= {
					has_dynasty = yes
				}
				any_character = {
					dynasty ?= prev.ruler.dynasty
					is_heir = no
					NOT = { is_close_relative = prev.ruler }
				}
			}
		}
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:nobles background = pop_type:soldiers }
		save_scope_as = from_country
		region:persia_region = {
			random_present_country = {
				limit = {
					"border_distance_to(root)" < 300
					ruler ?= {
						has_dynasty = yes
					}
					any_character = {
						dynasty ?= prev.ruler.dynasty
						is_heir = no
						NOT = { is_close_relative = prev.ruler }
					}
				}
				random_character = {
					limit = {
						dynasty ?= prev.ruler.dynasty
						is_heir = no
						NOT = { is_close_relative = prev.ruler }
					}
					save_scope_as = target_character
				}
				save_scope_as = target_country
				event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
			}
		}
	}

	option = {
		name = flavor_dlh.62.a

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				gold > {
					value = monthly_income_trade_and_tax
					multiply = 6
				}
			}
		}
		
		change_gold_effect = { scale = -3 }
		scope:target_character = {
			move_country = ROOT
		}
		scope:target_country = {
			trigger_event_non_silently = {
				id = flavor_dlh.63
			}
		}
	}

	option = {
		name = flavor_dlh.62.b

		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				gold <= {
					value = monthly_income_trade_and_tax
					multiply = 6
				}
			}
		}
	
		if = {
			limit = {
				has_societal_value = societal_value_type:outward_vs_inward
			}
			change_societal_value = {
				type = outward_vs_inward
				value = societal_value_minor_move_to_right
			}
		}
		else = {
			add_prestige = prestige_weak_bonus
		}
	}
}

# Foreign Prince - Notification
flavor_dlh.63 = {
	type = country_event
	title = flavor_dlh.63.title
	desc = flavor_dlh.63.desc

	illustration_tags = {
		10 = angry
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_dlh.63.a
		
		add_prestige = prestige_weak_penalty
	}
}

# Qutb Minar Struck by Lightning
flavor_dlh.64 = {
	type = country_event
	title = flavor_dlh.64.title
	desc = flavor_dlh.64.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_marble.dds"


	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1365.1.1
		to = 1375.1.1
		monthly_chance = 5
	}

	trigger = {
		exists = work_of_art:qutb_minar
		work_of_art:qutb_minar = {
			owner = ROOT
		}
	}

	immediate = {
		work_of_art:qutb_minar = {
			save_scope_as = target_work_of_art
		}
	}

	option = {
		name = flavor_dlh.64.a

		ai_chance = {
			factor = 1
			modifier = {
				factor = 10
				gold >= {
					value = monthly_income_trade_and_tax
					multiply = 6
				}
				gold < {
					value = monthly_income_trade_and_tax
					multiply = 9
				}
			}
		}
		
		change_gold_effect = { scale = -3	}
	}

	option = {
		name = flavor_dlh.64.b

		ai_chance = {
			factor = 1
			modifier = {
				factor = 10
				gold >= {
					value = monthly_income_trade_and_tax
					multiply = 9
				}
			}
		}
		
		change_gold_effect = { 	scale = -6 }
		scope:target_work_of_art = {
			change_art_quality = 10
			location.market ?= {
				add_goods_supply = {
					amount = market_goods_weak_loss
					goods = goods:marble
				}
			}
		}
	}

	option = {
		name = flavor_dlh.64.c

		ai_chance = {
			factor = 1
			modifier = {
				factor = 10
				gold < {
					value = monthly_income_trade_and_tax
					multiply = 6
				}
			}
		}
		
		add_prestige = prestige_mild_penalty
		scope:target_work_of_art = {
			change_art_quality = -10
		}
	}
}

scripted_trigger can_be_attacked = {
	NOR = {
		is_allied_with = {
			target = ROOT
		}
		is_subject_or_below_of = ROOT
		ROOT = {
			is_subject_or_below_of = PREV
		}
		any_international_organizations_member_of = {
			international_organization_type = international_organization_type:defensive_league
			ROOT = {
				is_member_of_international_organization = PREV
			}
		}
	}
}

# Chagatai Conflict
flavor_dlh.65 = {
	type = country_event
	title = flavor_dlh.65.title
	desc = flavor_dlh.65.desc
	randomlog = yes # Tracking Desync 20250825

	trigger = {
		country_exists = c:CHG
		OR = {
			is_neighbor_of = c:CHG
			any_neighbor_country = {
				is_subject_or_below_of = c:CHG
			}
		}
		c:CHG ?= {
			can_be_attacked = yes
		}
	}

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1350.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		c:CHG = {
			save_scope_as = target_country
			event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}
		ruler ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_dlh.65.a
		
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				trigger = {
					any_neighbor_country = {
						antagonism = {
							target = root
							value >= 50
						}
					}
				}
			}
		}
		
		drop_antagonism_bomb = {
			modifier = antagonism_opened_war_path
			target = capital
		}

		add_casus_belli = {
			target = scope:target_country
			type = casus_belli:cb_border_war
		}

		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_minor_move_to_left
		}
	}

	option = {
		name = flavor_dlh.65.b

		ai_chance = {
			factor = 1
		}
	
		add_diplomats = diplomats_weak_bonus
	}
}

# Heavy Taxes in North India
flavor_dlh.66 = {
	type = country_event
	title = flavor_dlh.66.title
	desc = flavor_dlh.66.desc

	trigger = {
		any_province = {
			OR = {
				area = area:awadh_area
				area = area:doab_area
			}
		}
	}	

	fire_only_once = yes
	dynamic_historical_event = {
		tag = DLH
		from = 1337.1.1
		to = 1345.1.1
		monthly_chance = 4
	}

	illustration_tags = {
		10 = angry
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }

		random_province = {
			limit = {
				OR = {
					area = area:awadh_area
					area = area:doab_area
				}
			}
			weight = {
				factor = 1
				modifier = {
					factor = population
				}
			}
			save_scope_as = target_province
			random_location_in_province = {
				limit = {
					any_pop = {
						pop_type = pop_type:burghers
					}
					any_pop = {
						pop_type = pop_type:peasants
					}
				}
				event_illustration_poptype_effect = { foreground = pop_type:burghers   background = pop_type:burghers }
			}
		}
	}

	option = {
		name = flavor_dlh.66.a

		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				stability < 25
			}
		}
		
		scope:target_province = {
			add_province_modifier = {
				mode = replace
				modifier = dlh_lightened_tax_burden
				years = 10
			}
		}

		add_stability = stability_weak_bonus
	}

	option = {
		name = flavor_dlh.66.b

		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				gold < {
					value = yearly_gold
					multiply = 0.5
				}
			}
		}
	
		add_gold = {
			value = 0
			add = {
				scope:target_province = {
					every_location_in_province = {
						add = location_tax_base
					}
				}
			}
			multiply = 6
		}

		add_estate_satisfaction = {
			type = estate_type:peasants_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}

#Lodi dynasty claims throne
flavor_dlh.1000 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.1000.title
	desc = flavor_dlh.1000.desc
	historical_info = flavor_dlh.1000.historical_info

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	trigger = {
		country_exists = c:DLH
		is_subject_of = c:DLH
		overlord = {
			at_war = no
		}
		exists = dynasty:lodi_dynasty
		ruler ?= {
			has_dynasty = yes
			dynasty = dynasty:lodi_dynasty
		}
	}

	immediate = {
		event_illustration_peasants_foreign_religion_pop_type_effect = yes
		overlord = {
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}

		save_scope_as = target_country2

		ruler_or_regent ?= {
			save_scope_as = target_character2
			dynasty ?= {
				save_scope_as = target_dynasty
			}
		}
	}

	option = {
		name = flavor_dlh.1000.a

		historical_option = yes
		
		overlord = {
			cancel_subject = root
		}

		scope:target_country = {
			trigger_event_non_silently = flavor_dlh.1001
		}
	}

	option = {
		name = flavor_dlh.1000.b

		add_liberty_desire = -30
	}
}

#Lodi dynasty claims throne
flavor_dlh.1001 = {
	type = country_event
	title = flavor_dlh.1001.title
	desc = flavor_dlh.1001.desc

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	immediate = {
		event_illustration_peasants_foreign_religion_pop_type_effect = yes

		remove_variable = dlh_lodi_country
	}

	option = {
		name = flavor_dlh.1001.a
		
		declare_war_with_cb = {
			target = scope:target_country2
			type = casus_belli:cb_lodi_claims
		}
	}

	option = {
		name = flavor_dlh.1001.b

		trigger = {
			is_ai = no
		}

		declare_war_with_cb = {
			target = scope:target_country2
			type = casus_belli:cb_lodi_claims
		}
		
		change_player = scope:target_country2
	}
}

#Lodi dynasty wins
flavor_dlh.1002 = {
	type = country_event
	title = flavor_dlh.1002.title
	desc = flavor_dlh.1002.desc

	illustration_tags = {
		10 = interior
		10 = happy
	}

	immediate = {
		event_illustration_government_estate_effect = yes

		ruler_or_regent.dynasty ?= {
			save_scope_as = target_dynasty
		}
	}

	option = {
		name = flavor_dlh.1002.a
		
		change_country_tag = DLH
		hidden_effect = {
			change_country_name = DLH
			change_country_adjective = DLH_ADJ
			change_country_color = map_delhi
			change_country_flag = DLH
		}
	}
}

scripted_trigger is_bengali_country = {
	OR = {
		this = c:STN
		this = c:GAU
		this = c:SGN
	}
}

#Bengali Governship
flavor_dlh.1100 = {
	hide_portraits = yes
	type = country_event
	title = flavor_dlh.1100.title
	desc = flavor_dlh.1100.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1340.1.1
		to = 1380.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		NOT = { exists = c:BNG }
		c:STN ?= {
			exists = yes
			is_subject_of = root
			is_ai = yes
		}
		c:GAU ?= {
			exists = yes
			is_subject_of = root
			is_ai = yes
		}
		c:SGN ?= {
			exists = yes
			is_subject_of = root
			is_ai = yes
		}
	}

	immediate = {
		event_illustration_government_estate_effect = yes
		ordered_subject = {
			order_by = total_population
			limit = {
				is_bengali_country =  yes
			}
			max = 1
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}
		ruler_or_regent ?= {
			save_scope_as = target_character2
		}

		save_scope_as = target_country2
	}

	option = {
		name = flavor_dlh.1100.a

		scope:target_country = {
			trigger_event_non_silently = flavor_dlh.1101
		}
	}

	option = {
		name = flavor_dlh.1100.b
		
		every_subject = {
			limit = {
				is_bengali_country = yes
			}
			add_liberty_desire = -20
		}
	}
}

flavor_dlh.1101 = {
	type = country_event
	title = flavor_dlh.1101.title
	desc = flavor_dlh.1101.desc
	major = yes
	major_trigger = {
		this = overlord	
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_government_estate_effect = yes	
	}

	option = {
		name = flavor_dlh.1101.a
		
		custom_tooltip = {
			text = dlh_demand_annexation_of_other_bengali_subjects_tt
			overlord = {
				every_subject = {
					limit = {
						this != root
						is_bengali_country = yes
					}
					trigger_event_silently = flavor_dlh.1102
				}
			}
		}

		form_country = formable_country:BNG_f

		add_liberty_desire = -50
	}

	option = {
		name = flavor_dlh.1101.b
		
		add_liberty_desire = 10

		add_stability = stability_extreme_penalty
	}
}



flavor_dlh.1102 = {
	type = country_event
	title = flavor_dlh.1102.title
	desc = flavor_dlh.1102.desc
	major = yes
	major_trigger = {
		this = scope:target_country	
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_government_estate_effect = yes	
	}

	option = {
		name = flavor_dlh.1102.a
		
		scope:target_country = {
			annex_country = {
				reason = MilitaryConquest
				country = root
			}
		}
	}

	option = {
		name = flavor_dlh.1102.b
		
		add_liberty_desire = 15
	}
}

#Gaining Liberty desire from Timurids. More for AI as this is not going to occur in a normal campaign
flavor_dlh.1200 = {
	type = country_event
	title = flavor_dlh.1200.title
	desc = flavor_dlh.1200.desc

	illustration_tags = {
		10 = interior
		10 = angry
	}

	dynamic_historical_event = {
		tag = DLH
		from = 1400.1.1
		to = 1450.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		country_exists = c:TIM
		is_subject_of = c:TIM
	}

	immediate = {
		event_illustration_government_estate_effect = yes
		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		overlord = {
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character2
			}
		}

		save_scope_as = target_country2
	}

	option = {
		name = flavor_dlh.1200.a
		
		custom_tooltip = {
			text = dlh_start_undermining_timurid_rule_tt
			trigger_event_silently = flavor_dlh.1201
		}

		add_liberty_desire = 35
	}

	option = {
		name = flavor_dlh.1200.b
		
		add_liberty_desire = -15
	}
}

#Populating court with supporters of ruler
flavor_dlh.1201 = {
	type = country_event
	title = flavor_dlh.1201.title
	desc = flavor_dlh.1201.desc

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:clergy_estate }
		create_character = {
			mil = {
				75
				90
			}
			culture = root.culture
			religion = root.religion
			estate = estate_type:nobles_estate
			save_scope_as = target_supporter
			create_in_limbo = yes
		}	
		create_character = {
			mil = {
				75
				90
			}
			culture = root.culture
			religion = root.religion
			estate = estate_type:nobles_estate
			save_scope_as = target_supporter2
			create_in_limbo = yes
		}	
	}

	option = {
		name = flavor_dlh.1201.a
		
		add_government_power = government_power_extreme_penalty

		scope:target_supporter = {
			move_country = root
		}

		scope:target_supporter2 = {
			move_country = root
		}

		add_liberty_desire = 15
	}

	option = {
		name = flavor_dlh.1201.b
		
		add_stability = stability_mild_bonus
		hidden_effect = {
   			kill_character_silently = scope:target_supporter
   			kill_character_silently = scope:target_supporter2
  		}
	}

	after = {
		trigger_event_silently = flavor_dlh.1202
	}
}

flavor_dlh.1202 = {
	type = country_event
	title = flavor_dlh.1202.title
	desc = flavor_dlh.1202.desc

	illustration_tags = {
		10 = interior
		10 = armed
	}

	immediate = {
		event_illustration_government_estate_effect = yes	
	}

	option = {
		name = flavor_dlh.1202.a
		
		overlord = {
			trigger_event_non_silently = flavor_dlh.1203
		}
	}

	option = {
		name = flavor_dlh.1202.b
		
		custom_tooltip = dlh_abandon_rebellion_plans_tt

		add_liberty_desire = -50
	}
}

flavor_dlh.1203 = {
	type = country_event
	title = flavor_dlh.1203.title
	desc = flavor_dlh.1203.desc

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	immediate = {
		event_illustration_peasants_foreign_religion_pop_type_effect = yes	
	}

	option = {
		name = flavor_dlh.1203.a
		
		ai_chance = {
			base = 40
			modifier = {
				factor = 2
				stability < -10
			}

			modifier = {
				factor = 2
				at_war = yes
			}

			modifier = {
				factor = 8
				army_size < scope:target_country2.army_size
			}

			modifier = {
				factor = 2
				opinion = {
					target = scope:target_country2
					value > 100
				}
			}
		}

		cancel_subject = scope:target_country2
	}

	option = {
		name = flavor_dlh.1203.b

		ai_chance = {
			base = 60
		}
		
		declare_war_with_cb = {
			target = scope:target_country2
			type = casus_belli:cb_annex
		}

		scope:target_country2 = {
			trigger_event_silently = flavor_dlh.1204
		}
	}
}

flavor_dlh.1204 = {
	type = country_event
	title = flavor_dlh.1204.title
	desc = flavor_dlh.1204.desc

	illustration_tags = {
		10 = exterior
		10 = regular
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_dlh.1204.a
		
		show_as_tooltip = {
			scope:target_country = {
				declare_war_with_cb = {
					target = root
					type = casus_belli:cb_annex
				}
			}
		}

		add_stability = stability_extreme_bonus
	}
}