namespace = flavor_nap

flavor_nap.3 = { #Renaissance in Naples
	type = country_event
	title = flavor_nap.3.title
	desc = flavor_nap.3.desc

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1400.1.1
		to = 1500.1.1
		monthly_chance = 5
	}

	trigger = {
		num_artists > 0
	}

	option = {
		name = flavor_nap.3.a
		historical_option = yes
		culture = {
			add_cultural_influence = cultural_influence_ultimate_bonus
			add_cultural_tradition = cultural_tradition_ultimate_bonus
		}
	}
	option = {
		name = flavor_nap.3.b
		add_legitimacy = legitimacy_mild_bonus
		add_prestige = prestige_mild_bonus
	}
}

flavor_nap.4 = { #The Great City of the Baroque
	type = country_event
	title = flavor_nap.4.title
	desc = flavor_nap.4.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1600.1.1
		to = 1650.1.1
		monthly_chance = 5
	}
	
	illustration_tags = {
        10 = happy
        10 = exterior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:naples = {
			save_scope_as = target_location
		}
	}

	trigger = {
		owns = location:naples
		location:naples = {
			integration_level = core
			num_pop_type:burghers > 20
		}
	}

	option = {
		name = flavor_nap.4.a
		historical_option = yes
		location:naples = {
			change_development  = development_severe_bonus
		}
	}
}

flavor_nap.200 = { #The Will of Robert
	type = country_event

	title = flavor_nap.200.title
	desc = flavor_nap.200.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1337.1.1
		to = 1340.1.1
		monthly_chance = 50
	}

	trigger = {
		character:nap_giovanna_i_anjou = {
			is_alive = yes
		}
		ruler ?= character:nap_robert_i_anjou
	}
	
	illustration_tags = {
        10 = angry
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:naples = {
			save_scope_as = target_location
		}
		character:nap_giovanna_i_anjou = {
			save_scope_as = alternative_heir
		}
		character:nap_robert_i_anjou = {
			save_scope_as = target_character
		}
	}


	option = {
		name = flavor_nap.200.a
		historical_option = yes
		change_heir_selection = heir_selection:cognatic_primogeniture
		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.201  days = 20 }
			}
		}
	}
	option = {
		name = flavor_nap.200.b
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_penalty }
		c:HUN = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
	}

}

flavor_nap.201 = { #Neapolitan Laws
	hide_portraits = yes
	type = country_event

	title = flavor_nap.201.title
	desc = flavor_nap.201.desc


	trigger = {
		not = { succession_law = c:NAP.succession_law }
	}
	
	illustration_tags = {
        10 = angry
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:naples = {
			save_scope_as = target_location
		}
		character:nap_giovanna_i_anjou = {
			save_scope_as = alternative_heir
		}
		character:nap_robert_i_anjou = {
			save_scope_as = target_character
		}
	}


	option = {
		name = flavor_nap.201.a
		historical_option = yes
		add_prestige = prestige_mild_penalty
		change_heir_selection = heir_selection:cognatic_primogeniture
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		c:NAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
	}
	option = {
		name = flavor_nap.201.b
		add_stability = stability_weak_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_bonus }
		c:NAP = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}

}

flavor_nap.210 = { #Charles of Artois
	type = country_event

	title = flavor_nap.210.title
	desc = flavor_nap.210.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1345.1.1
		to = 1360.1.1
		monthly_chance = 5
	}

	trigger = {
		character:nap_robert_i_anjou = {
			is_alive = no
		}
	}
	
	illustration_tags = {
        10 = regular
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:naples = {
			save_scope_as = target_location
		}
		#Ruler's Bastard Son
		create_character = {#https://en.wikipedia.org/wiki/Charles_d%27Artois
			first_name = name_charles
			last_name = Artus
			culture = culture:neapolitan
			religion = religion:catholic
			adm = 60 dip = 80 mil = 40
			female = no
			birth_date = 1300.1.1
			estate = estate_type:nobles_estate
			father = character:nap_robert_i_anjou
			change_dynasty = dynasty:artois_dynasty
			add_character_modifier = { modifier = bastard years = -1 mode = add_and_extend }
			save_scope_as = charles_artus_scope
			create_in_limbo = yes
		}
	}

	option = {
		name = flavor_nap.210.a
		historical_option = yes
		scope:charles_artus_scope = {
			move_country = root
		}
	}
	option = {
		name = flavor_nap.210.b

		add_legitimacy = legitimacy_weak_bonus
   		kill_character_silently = scope:charles_artus_scope
	}

}

flavor_nap.220 = { #The Husband's Crown
	hide_portraits = yes
	type = country_event

	title = flavor_nap.220.title
	desc = flavor_nap.220.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1340.5.1
		to = 1360.1.1
		monthly_chance = 20
	}


	trigger = {
		country_exists = c:PAP
		c:PAP = { has_ruler = yes }
		OR = {
			and = {
				ruler ?= character:nap_giovanna_i_anjou
				character:nap_giovanna_i_anjou = {
					is_alive = yes
				}
				character:hun_andras = {
					is_alive = yes
					first_spouse = character:nap_giovanna_i_anjou
				}
			}
			and = {
				ruler ?= character:nap_maria_anjou_ii
				character:nap_maria_anjou_ii = {
					is_alive = yes
				}
				character:hun_andras = {
					is_alive = yes
					OR = {
						first_spouse = character:nap_maria_anjou_ii
					}
				}
			}
		}
	}
	
	illustration_tags = {
        10 = regular
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:nap_giovanna_i_anjou = {
			save_scope_as = rulerScope
		}
		character:hun_andras = {
			save_scope_as = target_character
		}
		location:naples = {
			save_scope_as = target_location
		}
		set_variable = {
			name = prince_consort_enraged_flag value = 1
		}
	}

	option = {
		name = flavor_nap.220.a
		historical_option = yes
		custom_tooltip = flavor_nap.220.a.tt

		add_gold = {
			value = c:NAP.monthly_income_trade_and_tax
			multiply = -2
		}

		c:PAP = {
			trigger_event_silently = { id = flavor_nap.221  days = 20 }
		}

	}
	option = {
		name = flavor_nap.220.b
		custom_tooltip = flavor_nap.220.b.tt
		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}
}

flavor_nap.221 = { #The Husband's Crown - A Powerless King
	type = country_event

	title = flavor_nap.221.title
	desc = flavor_nap.221.desc

	image = "gfx/interface/illustrations/international_organization_types/catholic_church.dds"
	fire_only_once = yes

	immediate = {
		c:NAP.ruler = {
			save_scope_as = nap_ruler
			first_spouse = {
				save_scope_as = nap_consort
			}
		}
	}
	option = {
		name = flavor_nap.221.a
		historical_option = yes
		c:NAP = {
			add_opinion = { target = root modifier = opinion_jubilee_bad }
			trigger_event_silently = { id = flavor_nap.223  days = 20 }
		}
		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}
	option = {
		name = flavor_nap.221.b

		add_gold = {
			value = c:NAP.monthly_income_trade_and_tax
			multiply = 2
		}
		c:NAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
			trigger_event_silently = { id = flavor_nap.222  days = 20 }
		}
		c:HUN = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
	}
}

flavor_nap.222 = { #The Wrong is Righted
	type = country_event

	title = flavor_nap.222.title
	desc = flavor_nap.222.desc


	fire_only_once = yes
	
	illustration_tags = {
        10 = angry
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:PAP.ruler = {
			save_scope_as = pope_scope
		}
	}

	option = {
		name = flavor_nap.222.a
		set_new_ruler = character:hun_andras
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301  days = 20 }
			}
		}
		remove_variable = prince_consort_enraged_flag
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_penalty }

		c:PAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
	}
}

flavor_nap.223 = { #The Pope rejects our Request
	type = country_event

	title = flavor_nap.223.title
	desc = flavor_nap.223.desc


	fire_only_once = yes
	
	illustration_tags = {
        10 = happy
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
		c:PAP.ruler ?= {
			save_scope_as = pope_scope
		}
	}

	option = {
		name = flavor_nap.223.a
		historical_option = yes
		add_gold = {
			value = c:NAP.monthly_income_trade_and_tax
			multiply = 2
		}
	}
}


flavor_nap.230 = { #The Neapolitan Prince Consort
	type = country_event

	title = flavor_nap.230.title
	desc = flavor_nap.230.desc


	fire_only_once = yes
	
	
	dynamic_historical_event = {
		tag = HUN
		from = 1343.6.1
		to = 1360.1.1
		monthly_chance = 20
	}

	trigger = {
		country_exists = c:PAP
		country_exists = c:NAP

		ruler ?= {
			is_close_relative = character:hun_andras
		}

		c:NAP = {
			has_ruler = yes
			OR = {
				and = {
					ruler = character:nap_giovanna_i_anjou
					character:nap_giovanna_i_anjou ?= {
						is_alive = yes
					}
					character:hun_andras ?= {
						is_alive = yes
						first_spouse = character:nap_giovanna_i_anjou
					}
				}
				and = {
					ruler = character:nap_maria_anjou_ii
					character:nap_maria_anjou_ii ?= {
						is_alive = yes
					}
					character:hun_andras ?= {
						is_alive = yes
						OR = {
							first_spouse = character:nap_maria_anjou_ii
						}
					}
				}
			}
		}
		c:PAP = { has_ruler = yes }
	}
	
	illustration_tags = {
        10 = regular
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = target_character
		}
		location:naples = {
			save_scope_as = target_location
		}
		c:PAP = {
			ruler = { save_scope_as = target_pope }
		}
	}

	option = {
		name = flavor_nap.230.a
		historical_option = yes
		custom_tooltip = flavor_nap.230.a.tt

		add_gold = {
			value = c:HUN.monthly_income_trade_and_tax
			multiply = -2
		}
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_left }
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_bonus }
		c:PAP = {
			trigger_event_silently = { id = flavor_nap.231  days = 20 }
		}
	}	
	option = {
		name = flavor_nap.230.b
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_penalty }
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_right }
		}
	}
}

flavor_nap.231 = { #The Family of the Powerless King
	type = country_event

	title = flavor_nap.231.title
	desc = flavor_nap.231.desc


	fire_only_once = yes
	
	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = prince_consort
		}
	}

	option = {
		name = flavor_nap.231.a
		historical_option = yes

		add_gold = {
			value = c:HUN.monthly_income_trade_and_tax
			multiply = 2
		}
		c:HUN = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
		c:NAP = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
			trigger_event_silently = { id = flavor_nap.232  days = 20 }
		}

	}
	option = {
		name = flavor_nap.231.b
		c:NAP = {
			add_opinion = { target = root modifier = opinion_jubilee_good }
			trigger_event_silently = { id = flavor_nap.233  days = 20 }
		}
		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
			trigger_event_silently = { id = flavor_nap.234  days = 20 }
		}
	}
}


flavor_nap.232 = { #The Hungarian King
	type = country_event

	title = flavor_nap.232.title
	desc = flavor_nap.232.desc


	fire_only_once = yes

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = prince_consort
		}
	}

	option = {
		name = flavor_nap.232.a
		historical_option = yes
		kill_character = {
			target = character:hun_andras
			reason = assassination
		}
		remove_variable = prince_consort_enraged_flag
		set_variable = { name = andras_was_killed_flag value = 1 }

		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_bonus }
		c:HUN = {
			add_casus_belli = { target = c:NAP type = casus_belli:cb_claim_throne}
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}
	option = {
		name = flavor_nap.232.b
		set_new_ruler = character:hun_andras
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301  days = 20 }
			}
		}
		remove_variable = prince_consort_enraged_flag
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_penalty }

		random_owned_location = {
			every_pop = {	add_pop_satisfaction = pop_satisfaction_severe_penalty	}
		}
		random_owned_location = {
			every_pop = {	add_pop_satisfaction = pop_satisfaction_severe_penalty	}
		}
		c:HUN = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
	}
}

flavor_nap.233 = { #Hungarian Meddling
	type = country_event

	title = flavor_nap.233.title
	desc = flavor_nap.233.desc


	fire_only_once = yes

	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = prince_consort
		}
	}

	option = {
		name = flavor_nap.233.a
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}
}

flavor_nap.234 = { #The Pope rejects our Request
	type = country_event

	title = flavor_nap.234.title
	desc = flavor_nap.234.desc


	fire_only_once = yes

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = prince_consort
		}
	}

	option = {
		name = flavor_nap.234.a
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_penalty }
		add_gold = {
			value = c:HUN.monthly_income_trade_and_tax
			multiply = 2
		}
	}
}


flavor_nap.240 = { #The Ruler of Avignon
	type = country_event

	title = flavor_nap.240.title
	desc = flavor_nap.240.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1348.1.1
		to = 1370.1.1
		monthly_chance = 20
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		character:nap_carlo_ii_anjou = {
			save_scope_as = charles_lame
		}

		location:avignon = { save_scope_as = target_location }
	}

	trigger = {
		country_exists = c:PAP
		c:PAP = { has_ruler = yes }
		location:avignon = {
			controller = c:PAP
		}
		OR = {
			gold <= 200
			num_loans > 0
		}

	}
	option = {
		name = flavor_nap.240.a
		custom_tooltip = flavor_nap.240.a.tt
		historical_option = yes
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		c:PAP = {
			trigger_event_silently = { id = flavor_nap.241  days = 20 }
		}
	}
	option = {
		name = flavor_nap.240.b

		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
	}
}

flavor_nap.241 = { #An offer for the City
	type = country_event

	title = flavor_nap.241.title
	desc = flavor_nap.241.desc


	fire_only_once = yes

	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:rome = { save_scope_as = rome_location }
		location:avignon = { save_scope_as = target_location }
		character:pap_clement_v = {
			save_scope_as = old_pope_scope
		}
	}

	option = {
		name = flavor_nap.241.a
		historical_option = yes
		add_gold = {
			value = c:PAP.monthly_income_trade_and_tax
			multiply = -4
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		c:NAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
			trigger_event_silently = { id = flavor_nap.242  days = 20 }
		}
	}

	option = {
		name = flavor_nap.241.b
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_penalty }

		c:NAP = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
			trigger_event_silently = { id = flavor_nap.243  days = 20 }
		}
	}
}

flavor_nap.242 = { #The Papal City
	hide_portraits = yes
	type = country_event

	title = flavor_nap.242.title
	desc = flavor_nap.242.desc


	fire_only_once = yes

	trigger = {
		c:PAP = { has_ruler = yes }
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:avignon = { save_scope_as = target_location }
		c:PAP.ruler = {
			save_scope_as = pope_scope
		}
	}

	option = {
		name = flavor_nap.242.a
		historical_option = yes
		add_gold = {
			value = c:PAP.monthly_income_trade_and_tax
			multiply = 4
		}
		scope:target_location = {
			remove_core = c:PRO
		}
	}
}

flavor_nap.243 = { #A Stolen City
	type = country_event

	title = flavor_nap.243.title
	desc = flavor_nap.243.desc


	fire_only_once = yes

	illustration_tags = {
        10 = angry
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:avignon = { save_scope_as = target_location }
		c:PAP.ruler = {
			save_scope_as = pope_scope
		}
	}

	option = {
		name = flavor_nap.243.a
		add_prestige = prestige_weak_penalty
	}
}


flavor_nap.250 = { #The Trial of the Queen
	hide_portraits = yes
	type = country_event

	title = flavor_nap.250.title
	desc = flavor_nap.250.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1348.2.1
		to = 1360.1.1
		monthly_chance = 20
	}

	trigger = {
		country_exists = c:PAP
		exists = character:nap_giovanna_i_anjou
		ruler ?= character:nap_giovanna_i_anjou
		has_variable = andras_was_killed_flag
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = prince_consort
		}
		character:nap_giovanna_i_anjou = {
			save_scope_as = target_character
		}
		location:avignon = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_nap.250.a
		custom_tooltip = flavor_nap.250.a.tt
		historical_option = yes
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_mild_penalty }
		add_legitimacy = legitimacy_severe_bonus
		add_prestige = prestige_extreme_penalty

		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
		c:PAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_left }
		}
	}
	option = {
		name = flavor_nap.250.b
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_right }
		}
		add_legitimacy = legitimacy_mild_penalty
		add_prestige = prestige_weak_penalty
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_severe_penalty }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_weak_bonus }
		c:HUN = {
			add_casus_belli = { target = c:NAP type = casus_belli:cb_claim_throne}
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
		c:PAP = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}
	option = {
		name = flavor_nap.250.c
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
		c:HUN = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
		c:PAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}

		ruler = {
			change_character_estate = estate_type:clergy_estate
			remove_ruler = root
		}
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301  days = 20 }
			}
		}
	}
}

flavor_nap.260 = { #Louis, a thorn in our side
	type = country_event

	title = flavor_nap.260.title
	desc = flavor_nap.260.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1352.1.1
		to = 1360.1.1
		monthly_chance = 3
	}

	trigger = {
		character:nap_luigi_durazzo = {
			is_alive = yes
		}
		any_province = {
			area = area:apulia_area
			province_average_control < 0.30
			any_location_in_province = { num_pop_type:nobles > 0 }
			NOT = { has_province_modifier = local_noble_autonomy }
		}
		estate_satisfaction:nobles_estate < 0.5
		has_ruler = yes
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:nap_luigi_durazzo = {
			save_scope_as = luigi_durazzo
		}
		random_province = {
			limit = {
				area = area:apulia_area
				province_average_control < 0.30
				any_location_in_province = { num_pop_type:nobles > 0 }
				NOT = { has_province_modifier = local_noble_autonomy }
			}
			save_scope_as = unruly_nobles_province
		}
		ruler = { save_scope_as = targer_character }
	}

	option = {
		name = flavor_nap.260.a
		historical_option = yes
		if = {
			limit = {
				exists = scope:unruly_nobles_province
			}
			scope:unruly_nobles_province = {
				every_location_in_province = {
					every_pop = {	add_pop_satisfaction = pop_satisfaction_severe_penalty	}
				}
			}
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_weak_penalty
		}
	}
	option = {
		name = flavor_nap.260.b
		scope:unruly_nobles_province ?= {
			add_province_modifier = {
				modifier = local_noble_autonomy
				years = 20
				mode = add_and_extend
			}
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_weak_bonus
		}
	}
}

flavor_nap.270 = { #The pious Elzéar of Sabran
	type = country_event

	title = flavor_nap.270.title
	desc = flavor_nap.270.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1371.1.1
		to = 1401.1.1
		monthly_chance = 3
	}

	trigger = {
		religious_influence >= 50
		religion = religion:catholic
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		character:nap_carlo_anjou = {
			save_scope_as = carlo_anjou
		}
		character:nap_elzear_sabran = {
			save_scope_as = elzear_sabran
		}

	}

	option = {
		name = flavor_nap.270.a
		historical_option = yes
		trigger = {
			religious_influence >= 50
		}
		scope:elzear_sabran = {
			make_saint = c:NAP
		}
		add_prestige = prestige_severe_bonus
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_severe_bonus }
		add_religious_influence = religious_influence_ultimate_penalty

	}
	option = {
		name = flavor_nap.270.b

		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
	}
}

flavor_nap.280 = { #The Two Sicilies Reunited
	type = country_event

	title = flavor_nap.280.title
	desc = flavor_nap.280.desc


	fire_only_once = yes

	trigger = {
		tag = TWS
	}

	immediate = {
	}

	option = {
		name = flavor_nap.280.a
		trigger = {
			NOT = { capital = location:palermo }
			any_owned_location = { this = location:palermo }
		}
		set_capital = location:palermo
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_weak_bonus }
		add_legitimacy = legitimacy_severe_bonus
		add_prestige = prestige_extreme_bonus

	}

	option = {
		name = flavor_nap.280.b
		trigger = {
			NOT = { capital = location:naples }
			any_owned_location = { this = location:naples }
		}
		set_capital = location:naples
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_weak_bonus }
		add_legitimacy = legitimacy_severe_bonus
		add_prestige = prestige_extreme_bonus
	}

	option = {
		name = flavor_nap.280.c
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_weak_bonus }
		add_legitimacy = legitimacy_severe_bonus
		add_prestige = prestige_extreme_bonus
	}
}

flavor_nap.290 = { #The Resentful Prince Consort
	type = country_event

	title = flavor_nap.290.title
	desc = flavor_nap.290.desc

	trigger = {
		current_year >= 1342
		current_year < 1400
		has_variable = prince_consort_enraged_flag
		OR = {
			and = {
				ruler = character:nap_giovanna_i_anjou
				character:nap_giovanna_i_anjou = {
					is_alive = yes
				}
				character:hun_andras = {
					is_alive = yes
					first_spouse = character:nap_giovanna_i_anjou
				}
			}
			and = {
				ruler = character:nap_maria_anjou_ii
				character:nap_maria_anjou_ii = {
					is_alive = yes
				}
				character:hun_andras = {
					is_alive = yes
					OR = {
						first_spouse = character:nap_maria_anjou_ii
					}
				}
			}
		}
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:hun_andras = {
			save_scope_as = prince_consort
		}
	}

	option = {
		name = flavor_nap.290.a
		historical_option = yes
		kill_character = {
			target = character:hun_andras
			reason = assassination
			killer = ruler
		}
		remove_variable = prince_consort_enraged_flag
		set_variable = { name = andras_was_killed_flag value = 1 }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_bonus }
		c:HUN = {
			add_casus_belli = {
				target = c:NAP
				type = casus_belli:cb_claim_throne
				character = scope:prince_consort
			}
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}
	option = {
		name = flavor_nap.290.b
		set_new_ruler = character:hun_andras
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301  days = 20 }
			}
		}
		remove_variable = prince_consort_enraged_flag
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
	}
	option = {
		name = flavor_nap.290.c
		add_country_modifier = { modifier = loss_of_legal_competence years = 2 mode = add_and_extend }

		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
	}
}

flavor_nap.300 = { #The Future of Naples
	type = country_event

	title = flavor_nap.300.title
	desc = flavor_nap.300.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1368.1.1
		to = 1450.1.1
		monthly_chance = 2
	}

	trigger = {
		ruler ?= {
			is_female = yes
			is_alive = yes
			is_adult = yes
			age_in_years > 40
			num_of_children < 1
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:nap_robert_i_anjou = {
			save_scope_as = old_king
		}
		location:palermo.owner.ruler = {
			save_scope_as = palermo_ruler
		}
		location:palermo.owner = {
			save_scope_as = palermo_owner
		}
		c:FRA.ruler ?= {
			save_scope_as = french_ruler
		}
		character:nap_maria_anjou_ii.first_spouse ?= {
			save_scope_as = queen_sister_spouse
		}
		character:nap_giovanna_i_anjou  = {
			save_scope_as = queen
		}
	}

	option = {
		name = flavor_nap.300.a
		add_stability = stability_mild_penalty
		add_legitimacy = legitimacy_weak_bonus

	}
	option = {
		name = flavor_nap.300.b
		trigger = {
			exists = scope:queen_sister_spouse
			character:nap_maria_anjou_ii = {
				is_alive = yes
				is_married = yes
			}
		}
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301 }
			}
		}
		set_new_ruler = scope:queen_sister_spouse
		add_legitimacy = legitimacy_mild_penalty
	}
	option = {
		name = flavor_nap.300.c
		trigger = {
			scope:palermo_owner = {
				government_type = government_type:monarchy
				has_ruler = yes
			}
		}
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301}
			}
		}
		set_new_ruler = scope:palermo_ruler
		scope:palermo_owner ={
			trigger_event_silently = { id = flavor_nap.2 }
		}
		add_prestige = prestige_mild_bonus
		add_legitimacy = legitimacy_extreme_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
	}
	option = {
		name = flavor_nap.300.d
		historical_option = yes
		trigger = {
			exists = scope:french_ruler
			country_exists = c:FRA
			c:FRA = {
				government_type = government_type:monarchy
				has_ruler = yes
			}
		}
        union ?= {
            every_international_organization_member = {
				trigger_event_silently = { id = flavor_nap.301 }
			}
		}
		set_new_ruler = c:FRA.ruler
		c:FRA = {
			trigger_event_silently = { id = flavor_nap.2 }
		}
		add_prestige = prestige_mild_bonus
		add_legitimacy = legitimacy_extreme_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
	}
}

flavor_nap.301 = { #Neapolitan Decision
	type = country_event

	title = flavor_nap.301.title
	desc = flavor_nap.301.desc


	trigger = {
		c:NAP ?= {
			government_type = government_type:monarchy
			has_ruler = yes
		}
		not = { ruler = c:NAP.ruler }
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:naples = {
			save_scope_as = target_location
		}
		c:NAP.ruler = {
			save_scope_as = naples_ruler
		}
	}


	option = {
		name = flavor_nap.301.a
		set_new_ruler = c:NAP.ruler
		add_prestige = prestige_mild_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		c:NAP = {
			add_opinion = { target = root modifier = opinion_supportive_monarch }
		}
	}
	option = {
		name = flavor_nap.301.b
		add_stability = stability_weak_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_bonus }
		c:NAP = {
			add_opinion = { target = root modifier = opinion_backward_monarch }
		}
	}

}

flavor_nap.2 = { #The Abdication of [GetCountry('NAP').GetGovernment.GetPreviousRuler.GetName]
	type = country_event
	title = flavor_nap.2.title
	desc = flavor_nap.2.desc

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.2.a
		add_prestige = prestige_mild_bonus
	}
}

flavor_nap.101 = { #The Destruction of Amalfi
	type = country_event

	title = flavor_nap.101.title
	desc = flavor_nap.101.desc

	image = "gfx/interface/illustrations/location/sea/ocean_bigger.dds"

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1318.1.1
		to = 1368.1.1
		monthly_chance = 5
	}

	trigger = {
		c:NAP = {
			owns = location:salerno
		}
	}

	immediate = {
		location:salerno = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_nap.101.a
        historical_option = yes

		custom_tooltip = flavor_nap.101.a.tt
		hidden_effect = {
			scope:target_location = {
				change_prosperity = prosperity_severe_penalty
				every_pop = {
					add_pop_size = {
						value = pop_size
						multiply = -0.20
					}
				}
				ordered_buildings_in_location = {
					order_by = building_level
					max = {
						value = 1

						add = {
							value = num_buildings # In this case the context is location
							divide = 6
						}
					}

					location = { major_destroy_building_levels_in_location = yes }
				}
				every_neighbor_location = {
					limit = {
						is_port = yes
					}
					change_prosperity = prosperity_weak_penalty
					every_pop = {
						add_pop_size = {
							value = pop_size
							multiply = -0.05
						}
					}
				}
			}
		}
	}

	option = {
		name = flavor_nap.101.b

		custom_tooltip = flavor_nap.101.b.tt

		c:NAP = {
			add_gold = { value = location:salerno.owner.monthly_income_trade_and_tax multiply = -1 }
		}
		hidden_effect = {
			scope:target_location = {
				change_prosperity = prosperity_severe_penalty
				every_pop = {
					add_pop_size = {
						value = pop_size
						multiply = -0.20
					}
				}
				ordered_buildings_in_location = {
					order_by = building_level
					max = {
						value = 1

						add = {
							value = location.num_buildings
							divide = 6
						}
					}

					location = { major_destroy_building_levels_in_location = yes }
				}
				every_neighbor_location = {
					limit = {
						is_port = yes
					}
					change_prosperity = prosperity_weak_penalty
					every_pop = {
						add_pop_size = {
							value = pop_size
							multiply = -0.05
						}
					}
				}
			}
		}
	}
}

flavor_nap.102 = { #The Treaty of Villeneuve
	type = country_event

	title = flavor_nap.102.title
	desc = flavor_nap.102.desc

    illustration_tags = { }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		from = 1362.1.1
		to = 1382.1.1
		monthly_chance = 20
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler = { save_scope_as = target_ruler }
		c:PAP = { ruler = { save_scope_as = target_pope } }
		c:SIC = { ruler = { save_scope_as = target_sicily_ruler } }
	}

	trigger = {
		tag = NAP
		at_war = no
		country_exists = c:SIC
		area:sicily_area = {
			any_location_in_area = {
				is_core_of = root
			}
		}
		has_ruler = yes
		c:PAP = { has_ruler = yes }
		c:SIC = { has_ruler = yes }
	}

	option = {
		name = flavor_nap.102.a
        historical_option = yes

		custom_tooltip = flavor_nap.102.a.tt1
		hidden_effect = {
			c:SIC = {
				trigger_event_silently = { id = flavor_nap.103 }
			}
		}
		custom_tooltip = flavor_nap.102.a.tt2
		hidden_effect = {
			every_core_location = {
				limit = {
					area = area:sicily_area
				}
				remove_core = root
			}
		}
	}

	option = {
		name = flavor_nap.102.b

		add_opinion = { target = c:ARA modifier = opinion_insulted }
		add_opinion = { target = c:PAP modifier = opinion_mildly_displeased }
		add_opinion = { target = c:SIC modifier = opinion_insulted }
	}
}

flavor_nap.103 = { #The Treaty of Villeneuve (Sicily's answer)
	type = country_event

	title = flavor_nap.103.title
	desc = flavor_nap.103.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.103.a
        historical_option = yes

		change_gold_effect = { scale = -2 }
		custom_tooltip = flavor_nap.103.tt1
		hidden_effect = {
			c:NAP = {
				trigger_event_silently = { id = flavor_nap.106 }
			}
			c:SIC = {
				set_variable = {
					name = sicily_pays_tribute
					value = 1
				}
			}
		}
	}
	option = {
		name = flavor_nap.103.b
		c:SIC = {
			make_subject_of = {
				target = c:NAP
				type = subject_type:vassal
			}
		}
		add_opinion = { target = c:ARA modifier = opinion_insulted }
		add_opinion = { target = c:NAP modifier = opinion_pleased }


		custom_tooltip = flavor_nap.103.tt1
		custom_tooltip = flavor_nap.103.tt2
		hidden_effect = {
			c:ARA = {
				trigger_event_silently = { id = flavor_nap.104 }
			}
			c:NAP = {
				trigger_event_silently = { id = flavor_nap.105 }
			}
		}
	}
	option = {
		name = flavor_nap.103.c

		add_opinion = { target = c:NAP modifier = opinion_insulted }
		add_opinion = { target = c:PAP modifier = opinion_mildly_displeased }
		custom_tooltip = flavor_nap.103.tt1
		hidden_effect = {
			c:NAP = {
				trigger_event_silently = { id = flavor_nap.107 }
			}
		}

	}
}

flavor_nap.104 = { #The Treaty of Villeneuve (Aragon Reaction)
	type = country_event

	title = flavor_nap.104.title
	desc = flavor_nap.104.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes

	immediate = {
		
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.104.a
		add_casus_belli = {	target = c:SIC	type = casus_belli:cb_claim_throne	}
	}

	option = {
		name = flavor_nap.104.b
	}

}

flavor_nap.105 = { #The Treaty of Villeneuve (Naples Reaction Vassal)
	type = country_event

	title = flavor_nap.105.title
	desc = flavor_nap.105.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.105.a
		c:SIC = {
			make_subject_of = {
				target = c:NAP
				type = subject_type:vassal
			}
		}
	}

}

flavor_nap.106 = { #The Treaty of Villeneuve (Naples Reaction Homage)
	type = country_event

	title = flavor_nap.106.title
	desc = flavor_nap.106.desc

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.106.a
		historical_option = yes
		add_gold = { value = c:SIC.monthly_income_trade_and_tax multiply = 2 }
	}

}

flavor_nap.107 = { #The Treaty of Villeneuve (Naples Reaction Refusal)
	type = country_event

	title = flavor_nap.107.title
	desc = flavor_nap.107.desc

	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.107.a
		area:sicily_area = {
			every_location_in_area = {
				add_core = c:NAP
			}
		}
	}
}

flavor_nap.108 = { #The Treaty of Villeneuve (Sicily pays yearly homage)
	type = country_event

	title = flavor_nap.108.title
	desc = flavor_nap.108.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	trigger = {
		tag = SIC
		has_variable = sicily_pays_tribute
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}

	option = {
		name = flavor_nap.108.a
		historical_option = yes
		trigger = {
			NOT = { is_at_war_with = C:NAP }
		}
		change_gold_effect = { scale = -2 }
		custom_tooltip = flavor_nap.103.tt1
		hidden_effect = {
			c:NAP = {
				trigger_event_silently = { id = flavor_nap.106 }
			}
		}
	}

	option = {
		name = flavor_nap.108.b
		add_opinion = { target = c:NAP modifier = opinion_insulted }
		custom_tooltip = flavor_nap.103.tt1
		hidden_effect = {
			if = {
				limit = { 
					OR = {
						NOT = { is_at_war_with = C:NAP } 	
						NOT = {	has_truce_with = c:NAP }
					}
				}
				c:NAP = {
					trigger_event_silently = { id = flavor_nap.107 }
				}
			}
			c:SIC = {
				remove_variable = sicily_pays_tribute
			}
		}
	}
}

flavor_nap.109 = { #The Library of the Angevin Kings
	type = country_event

	title = flavor_nap.109.title
	desc = flavor_nap.109.desc

	image = "gfx/interface/illustrations/institutions/scientific_revolution.dds"

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1500.1.1
		monthly_chance = 20
	}

	immediate = {
		character:nap_charles_i_anjou = {
			save_scope_as = charles_i
		}
	}

	option = {
		name = flavor_nap.109.a
		historical_option = yes
		add_research_progress = research_progress_severe_bonus
		change_gold_effect = { scale = -2 } 
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}

	option = {
		name = flavor_nap.109.b

		trigger = {
			has_ruler = yes
			ruler = {
				OR = {
					has_trait = free_thinker
					has_trait = scholar
				}
			}
		}

		add_research_progress = research_progress_extreme_bonus
		change_gold_effect = { scale = -3 }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}

	option = {
		name = flavor_nap.109.c

		add_prestige = prestige_mild_penalty
	}
}

flavor_nap.110 = { #Grand Court of the Vicar
	type = country_event

	title = flavor_nap.110.title
	desc = flavor_nap.110.desc

	illustration_tags = {
        10 = angry
        10 = interior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1799.1.1
		monthly_chance = 5
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:nobles_estate }
		random_owned_location = {
			save_scope_as = target_location
		}
		character:nap_carlo_ii_anjou = {
            save_scope_as = target_character
        }
	}

	option = {
		name = flavor_nap.110.a
		add_prestige = prestige_weak_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_penalty }
	}

	option = {
		name = flavor_nap.110.b
		add_prestige = prestige_weak_penalty
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_penalty }
	}

	option = {
		name = flavor_nap.110.c
		add_prestige = prestige_mild_penalty
	}
}

flavor_nap.111 = { #The Basilica of Santa Chiara
	type = country_event

	title = flavor_nap.111.title
	desc = flavor_nap.111.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1343.1.1
		monthly_chance = 5
	}

	trigger = {
		government_type = government_type:monarchy
		has_ruler = yes
		owns = location:naples
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		location:naples = { save_scope_as = target_location }
		ruler = { save_scope_as = target_character }
	}

	option = {
		name = flavor_nap.111.a
		historical_option = yes
		add_prestige = prestige_mild_bonus
	}

	option = {
		name = flavor_nap.111.b
		add_opinion = { target = c:PAP modifier = opinion_pleased }
	}

}

flavor_nap.112 = { #The Destruction of the Scuola Medica Salernitana
	type = country_event

	title = flavor_nap.112.title
	desc = flavor_nap.112.desc

    illustration_tags = {
		10 = exterior
	}

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1650.1.1
		monthly_chance = 100
	}

	trigger = {
		NOT = {
			current_age = age_5_absolutism
		}
		owns = location:salerno
		location:salerno = {
			NOT = { has_building = building_type:medical_school }
		}
	}

	immediate = {
		event_illustration_estate_background_effect = { background = estate_type:clergy_estate }
		location:salerno = { save_scope_as = target_location }
	}

	option = {
		name = flavor_nap.112.a
		historical_option = yes
		change_gold_effect = { scale = -3 }
		location:salerno = { construct_building = { building_type = building_type:medical_school } }
	}

	option = {
		name = flavor_nap.112.b
	}

}

flavor_nap.113 = { #The Palace of Caserta
	type = country_event

	title = flavor_nap.113.title
	desc = flavor_nap.113.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1727.1.1
		to = 1777.1.1
		monthly_chance = 2
	}

	trigger = {
		government_type = government_type:monarchy
		owns = location:caserta
		has_ruler = yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = Luigi
			last_name = Vanvitelli
			birth_date = 1700.5.12
			adm = 80
			dip = 65
			mil = 15
			birth_location = location:naples
			artist = architect
			estate = estate_type:burghers_estate
			artist_skill = 0.85
			culture = culture:neapolitan
			save_scope_as = target_character
			create_in_limbo = yes
		}
		ruler = { save_scope_as = targer_ruler }
	}

	option = {
		name = flavor_nap.113.a
		historical_option = yes

		scope:target_character = { move_country = root }
		location:caserta = {
			create_art = {
				artist = scope:target_character
				quality = 90
				type = work_of_art_type:palace
				key = palace_of_caserta
			}
		}

	}

	option = {
		name = flavor_nap.113.b
		add_prestige = prestige_extreme_penalty
   		kill_character_silently = scope:target_character
	}

}

flavor_nap.114 = { #La Pudizia
	type = country_event

	title = flavor_nap.114.title
	desc = flavor_nap.114.desc

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1727.1.1
		to = 1777.1.1
		monthly_chance = 2
	}

	trigger = {
		owns = location:naples
		culture:neapolitan = {
			cultural_influence > 50
			cultural_tradition > 50
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = name_anthony
			last_name = Corradini
			birth_date = 1688.10.19
			adm = 70
			dip = 75
			mil = 25
			birth_location = location:venice
			artist = sculptor
			estate = estate_type:burghers_estate
			artist_skill = 0.85
			culture = culture:venetian
			save_scope_as = target_artist
		}

	}

	option = {
		name = flavor_nap.114.a

		historical_option = yes
		culture = {
			add_cultural_influence = cultural_influence_mild_bonus
		}
		add_prestige = prestige_weak_bonus
		location:naples = {
			create_art = {
				artist = scope:target_artist
				quality = 90
				type = work_of_art_type:statue
				key = pudizia
			}
		}
	}

}

flavor_nap.115 = { #San Leucio Silk Factory
	type = country_event

	title = flavor_nap.115.title
	desc = flavor_nap.115.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1725.1.1
		to = 1775.1.1
		monthly_chance = 10
	}

	trigger = {
		current_age = age_5_absolutism
		owns = location:caserta
		has_ruler = yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		ruler = { save_scope_as = target_character }
		location:caserta = { save_scope_as = target_location }
	}

	option = {
		name = flavor_nap.115.a

		historical_option = yes
		location:caserta = {
			construct_building = { building_type = building_type:fine_cloth_manufactory }
		}
	}

}

flavor_nap.116 = { #Accademia Pontaniana's delights the World
	type = country_event

	title = flavor_nap.116.title
	desc = flavor_nap.116.desc

	illustration_tags = {
        10 = exterior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1443.1.1
		to = 1542.1.1
		monthly_chance = 10
	}

	trigger = {
		owns = location:naples
		has_advance = academia_pontaniana
	}

	immediate = {
		event_illustration_estate_background_effect = { background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_nap.116.a
		historical_option = yes
		add_research_progress = research_progress_mild_bonus
	}

	option = {
		name = flavor_nap.116.b

		culture = {
			add_cultural_influence = cultural_influence_ultimate_bonus
			add_cultural_tradition = cultural_tradition_ultimate_bonus
		}
	}
}
flavor_nap.117 = { #Albanians flee
	type = country_event

	title = flavor_nap.117.title
	desc = flavor_nap.117.desc

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	trigger = {
		religion = religion:catholic

		any_country = {
			religion.group = religion_group:muslim
			own_entire_province = location:durres.province_definition
		}
		location:durres.province_definition = {
			 any_location_in_province_definition = { dominant_religion = religion:catholic }
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}

	option = {
		name = flavor_nap.117.a

		historical_option = yes

		every_province = {
			limit = {
				OR = {
					area = area:basilicata_area
					province_definition = province_definition:capitanata_province
					province_definition = province_definition:molise_province
				}

				c:NAP = {
					own_entire_province = prev.province_definition
				}

			}

			add_migration = {
				owner = prev
				from = province_definition:albania_province
				to = province_definition
				culture = culture:albanian
				religion = religion:catholic
				type = pop_type:peasants
				amount = 0.1
				months = 120
			}

		}
	}

	option = {
		name = flavor_nap.117.b

		add_opinion = { target = c:PAP modifier = opinion_mildly_displeased }

	}
}
flavor_nap.118 = { #Croatians flee
	type = country_event

	title = flavor_nap.118.title
	desc = flavor_nap.118.desc

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1550.1.1
		monthly_chance = 10
	}

	trigger = {
		any_country = {
			religion.group = religion_group:muslim
			"culture_percentage_in_country(culture:croatian)" > 0
		}
		c:NAP = {
			own_entire_province = location:trivento.province_definition #molise_province
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		ordered_country = {
			limit = {
				religion.group = religion_group:muslim
				"culture_percentage_in_country(culture:croatian)" > 0
			}
			order_by = "culture_percentage_in_country(culture:croatian)"
			max = 1


			save_scope_as = muslim_country
		}
	}


	option = {
		name = flavor_nap.118.a
		historical_option = yes
		scope:muslim_country = {
			every_province = {
				limit = {
					culture_percentage = {
						culture = culture:croatian
						value > 0
					}
				}
				add_migration = {
					owner = prev
					from = province_definition
					to = province_definition:molise_province
					culture = culture:croatian
					religion = religion:catholic

					type = pop_type:peasants
					amount = 0.200
					months = 12
				}
			}
		}
	}

	option = {
		name = flavor_nap.118.b

		add_opinion = { target = c:PAP modifier = opinion_mildly_displeased }

	}
}

flavor_nap.119 = { #Robert and Petrarca
	type = country_event

	title = flavor_nap.119.title
	desc = flavor_nap.119.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes
	trigger = {
		tag = NAP
		character:nap_robert_i_anjou ?= {
			is_alive = no
		}
		character:pap_francesco_petrarca ?= {
			is_alive = yes
			owner = c:PAP
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:nap_robert_i_anjou = { save_scope_as = target_robert }
		character:pap_francesco_petrarca = { save_scope_as = target_petrarca }
	}

	option = {
		name = flavor_nap.119.a

		historical_option = yes
		change_gold_effect = { scale = -1}
		custom_tooltip = flavor_nap.119.tt
		hidden_effect = {
			c:PAP = {
				trigger_event_silently = { id = flavor_nap.120 days = 20 }
			}
		}
	}

	option = {
		name = flavor_nap.119.b

	}
}

flavor_nap.120 = { #Robert and Petrarca (Answer)
	type = country_event

	title = flavor_nap.120.title
	desc = flavor_nap.120.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:pap_francesco_petrarca = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_nap.120.a

		historical_option = yes
		character:pap_francesco_petrarca = {
			move_country = c:NAP
		}
		hidden_effect = {
			c:NAP = {
				trigger_event_silently = { id = flavor_nap.1201 days = 20 }
			}
		}
	}

	option = {
		name = flavor_nap.120.b

		add_opinion = { target = c:NAP modifier = opinion_mildly_displeased }

		hidden_effect = {
			c:NAP = {
				trigger_event_silently = { id = flavor_nap.1202 days = 20 }
			}
		}
	}
}

flavor_nap.1201 = { #Robert and Petrarca (Petrarca Moves)
	type = country_event

	title = flavor_nap.1201.title
	desc = flavor_nap.1201.desc

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate= {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	fire_only_once = yes

	option = {
		name = flavor_nap.1201.a
		historical_option = yes
	}
}

flavor_nap.1202 = { #Robert and Petrarca (Petrarca does not Move)
	type = country_event

	title = flavor_nap.1202.title
	desc = flavor_nap.1202.desc

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	fire_only_once = yes

	option = {
		name = flavor_nap.1202.a

	}
}

flavor_nap.121 = { #Boccaccio's family's debt
	type = country_event

	title = flavor_nap.121.title
	desc = flavor_nap.121.desc

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1339.1.1
		to = 1341.1.1
		monthly_chance = 20
	}

	trigger = {
		character:nap_giovanni_boccaccio = {
			is_alive = yes
			owner = ROOT
		}
		country_exists = c:FLO
	}

	immediate = {
		character:nap_giovanni_boccaccio = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_nap.121.a

		historical_option = yes
		character:nap_giovanni_boccaccio = {
			move_country = c:FLO
		}
	}

	option = {
		name = flavor_nap.121.b

		change_gold_effect = { scale = -3 }
	}
}

flavor_nap.6 = { #Fate of Prato
	hide_portraits = yes
	type = country_event
	title = flavor_nap.6.title
	desc = flavor_nap.6.desc
	historical_info = flavor_nap.6.historical_info

	fire_only_once = yes

	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1345.1.1
		#1351 in our timeline
		to = 1355.1.1
		monthly_chance = 10
	}

	trigger = {
		country_exists = c:PRA
		c:PRA = {
			is_ai = yes
			in_union_with = ROOT
			any_province = {
				count = 1
			}
		}
		country_exists = c:FLO
		c:FLO = {
			is_neighbor_of = c:PRA
			NOT = { is_at_war_with = ROOT }
			NOT = { is_at_war_with = c:PRA }
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:FLO = {
			save_scope_as = target_country
		}
		c:PRA = {
			save_scope_as = sold_country
		}
		save_scope_as = nap_from
		character:nap_robert_i_anjou = {
			save_scope_as = robert_scope
		}

		set_local_variable = {
			name = cost_for_prato
			value = { value = c:PRA.monthly_income_trade_and_tax multiply = 60 }
		}
	}


	option = {
		name = flavor_nap.6.a

		historical_option = yes

		show_as_tooltip = {
			add_gold = local_var:cost_for_prato
		}


		scope:target_country = {
			show_as_tooltip = {
				add_gold = { value = local_var:cost_for_prato multiply = -1 }
			}
			trigger_event_non_silently = flavor_nap.7
		}
	}

	option = {
		name = flavor_nap.6.b

		add_legitimacy = legitimacy_mild_bonus
	}
}

flavor_nap.7 = { #Fate of Prato - Accept or Deny
	type = country_event
	title = flavor_nap.7.title
	desc = flavor_nap.7.desc
	historical_info = flavor_nap.7.historical_info
	
	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_nap.7.a

		historical_option = yes

		add_gold = { value = local_var:cost_for_prato multiply = -1 }

		c:PRA.capital.province = {
			change_province_owner = ROOT
		}

		scope:nap_from = {
			set_variable = nap_success
			trigger_event_silently = flavor_nap.8
		}
	}

	option = {
		name = flavor_nap.7.b

		add_prestige = prestige_mild_penalty
		scope:nap_from = {
			set_variable = nap_failure
			trigger_event_silently = flavor_nap.8
		}
	}
}

flavor_nap.8 = { #Fate of Prato - Notification
	type = country_event
	title = flavor_nap.8.title
	desc = {
		first_valid = {
			triggered_desc = {
				desc = flavor_nap.8.desc_success
				trigger = { has_variable = nap_success }
			}
			triggered_desc = {
				desc = flavor_nap.8.desc_failure
				trigger = { has_variable = nap_failure }
			}
		}
	}
	illustration_tags = {
        10 = regular
        10 = interior
    }
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	option = {
		name = flavor_nap.8.a

		trigger = { has_variable = nap_success }

		add_gold = local_var:cost_for_prato
	}

	option = {
		name = flavor_nap.8.b

		trigger = { has_variable = nap_failure }

		add_casus_belli = { target = scope:target_country type = casus_belli:cb_insulted_us }
	}

	after = {
		if = {
			limit = {
				has_variable = nap_failure
			}
			remove_variable = nap_failure
		}
		if = {
			limit = {
				has_variable = nap_success
			}
			remove_variable = nap_success
		}
	}
}

flavor_nap.9 = { #Giambattista della Porta
	type = country_event
	title = flavor_nap.9.title
	desc = flavor_nap.9.desc
	historical_info = flavor_nap.9.historical_info

	fire_only_once = yes

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1555.1.1
		to = 1558.1.1
		monthly_chance = 25
	}

	immediate = {
		create_character = { #https://en.wikipedia.org/wiki/Giambattista_della_Porta
			first_name = name_john.name_baptiste
			dynasty = dynasty:della_porta_dynasty
			adm = { 60 70 } dip = { 40 50 } mil = { 20 30 }
			birth_date = 1535.12.1
			birth_location = location:naples
			estate = estate_type:nobles_estate
			script = nap_giambattista_della_porta
			save_scope_as = giambattista_della_porta_scope
			create_in_limbo = yes
		}
	}

	option = {
		name = flavor_nap.9.a

		historical_option = yes

		scope:giambattista_della_porta_scope = {
			move_country = ROOT
		}
		change_gold_effect = { scale = -6 }

		add_research_progress = research_progress_severe_bonus
	}

	option = {
		name = flavor_nap.9.b

		add_prestige = prestige_mild_penalty

		hidden_effect = {
			kill_character_silently = scope:giambattista_della_porta_scope
		}
	}
}

flavor_nap.10 = { #Magia Naturalis
	type = country_event
	title = flavor_nap.10.title
	desc = flavor_nap.10.desc

	fire_only_once = yes

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1558.1.1
		to = 1565.1.1
		monthly_chance = 25
	}
	trigger = {
		character:nap_giambattista_della_porta = {
			owner = ROOT
			is_alive = yes
		}
	}

	immediate = {
		character:nap_giambattista_della_porta = { save_scope_as = target_character }
	}

	option = {
		name = flavor_nap.10.a
		historical_option = yes
		add_research_progress = research_progress_mild_bonus

		capital = {
			create_art = {
				artist = scope:target_character
				quality = { 60 70 }
				type = work_of_art_type:treatise
				key = magia_naturalis
			}
		}
	}
}

flavor_nap.11 = { #Fraticelli
	type = country_event
	title = flavor_nap.11.title
	desc = {
		first_valid = {
			triggered_desc = {
				desc = flavor_nap.11.desc_with_felip
				trigger = {
					exists = character:nap_felip_mallorca
					character:nap_felip_mallorca = {
						owner = ROOT
						is_alive = yes
					}
				}
			}
			triggered_desc = {
				desc = flavor_nap.11.desc
			}
		}
	}
	historical_info = flavor_nap.11.historical_info

	fire_only_once = yes

	illustration_tags = {
        10 = regular
        10 = interior
    }

	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1337.1.1
		to = 1350.1.1
		monthly_chance = 5
	}

	trigger = {
		country_exists = c:PAP
		c:PAP = {
			has_ruler = yes
		}
		has_ruler = yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		c:PAP.ruler = {
			save_scope_as = the_pope
		}
		ruler = {
			save_scope_as = target_character
		}
		character:nap_felip_mallorca ?= {
			save_scope_as = brother_of_queen
		}
	}

	option = {
		name = flavor_nap.11.a

		historical_option = yes

		add_country_modifier = {
			modifier = nap_fraticelli_sympathy
			years = 25
		}

		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_minor_move_to_right
		}
	}

	option = {
		name = flavor_nap.11.b

		add_religious_influence_if_valid = {
			VALUE = religious_influence_severe_bonus
		}

		c:PAP ?= {
			add_opinion = {
				target = ROOT
				modifier = nap_banned_fraticelli
			}
		}

		scope:brother_of_queen ?= {
			ROOT = {
				kill_character = {
					target = PREV
					reason = execution
					killer = ruler
				}
			}
		}
	}
}

flavor_nap.12 = { #https://en.wikipedia.org/wiki/State_of_the_Presidi
	type = country_event
	title = flavor_nap.12.title
	desc = flavor_nap.12.desc
	historical_info = flavor_nap.12.historical_info

	fire_only_once = yes

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1557.1.1
		to = 1800.1.1
		monthly_chance = 5
	}

	trigger = {
		owns = location:piombino
		owns = location:pitigliano
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		location:piombino = {
			save_scope_as = target_location
		}
		location:pitigliano = {
			save_scope_as = target_location2
		}
	}

	option = {
		name = flavor_nap.12.a
		historical_option = yes
		scope:target_location = {
			add_location_modifier = {
				modifier = nap_state_of_the_presidi
				years = -1
			}
		}
		scope:target_location2 = {
			add_location_modifier = {
				modifier = nap_state_of_the_presidi
				years = -1
			}
		}
		add_navy_tradition = navy_tradition_severe_bonus
	}
}

# Heavy Taxation
flavor_nap.400 = {
	type = country_event

	title = flavor_nap.400.title
	desc = flavor_nap.400.desc
	historical_info = flavor_nap.400.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = NAP
		tag = TWS
		from = 1640.1.1
		to = 1650.1.1
		monthly_chance = 5
	}
	
	illustration_tags = {
        10 = angry
        10 = interior
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	
	trigger = {
		owns = location:naples
	}

	option = {
		name = flavor_nap.400.a #Levy the Taxation

		historical_option = yes

		add_country_modifier = {
			modifier = nap_heavy_taxation
			years = 25
		}

		custom_tooltip = {
			text = nap_every_peasant_pop_loses_5_satisfaction
			every_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_weak_penalty #the real penalty is when you tax them
			}
		}

		trigger_event_non_silently = { id = flavor_nap.401 years = { 1 5 } }
	}
	option = {
		name = flavor_nap.400.b #Do not tax

		add_country_modifier = {
			modifier = nap_insufficient_funds
			years = 30
		}

		add_stability = stability_mild_penalty

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_severe_penalty
		}
	}
}

flavor_nap.401 = { #Masaniello's Revolt
	type = country_event

	title = flavor_nap.401.title
	desc = flavor_nap.401.desc
	historical_info = flavor_nap.401.historical_info

	illustration_tags = {
        10 = angry
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		create_character = { #https://en.wikipedia.org/wiki/Masaniello
			first_name = name_thomas
			last_name = Aniello
			nickname = Masaniello
			birth_date = 1620.6.29
			birth_location = location:naples
			religion = religion:catholic
			culture = culture:neapolitan
			estate = estate_type:peasants_estate
			script = nap_masaniello
			save_scope_as = masaniello_scope
			adm = { 50 60 }
			dip = { 40 50 }
			mil = { 40 50 }
			add_character_modifier = { modifier = rebel_leader_modifier years = -1 mode = add_and_extend }
		}
		create_rebel = {
			category = estate
			estate = peasants_estate

			name = flavor_nap_masaniello

			save_scope_as = rebel_target
		}
		set_variable = {
			name = future_republic_of_naples
			value = scope:rebel_target
		}
		scope:masaniello_scope = {
			change_character_allegiance = scope:rebel_target
		}
	}


	option = {
		name = flavor_nap.401.a

		historical_option = yes

		add_stability = stability_mild_penalty
		add_legitimacy = legitimacy_mild_bonus

		custom_tooltip = {
			text = flavor_nap.401.a.tt1
			#Get every non neapolitan pop in Italy
			every_owned_location = {
				limit = {
					region = region:italy_region
				}
				every_pop = {
					limit = {
						owner = root
						pop_type = pop_type:peasants
						NOT = { culture = root.culture }
					}
					add_pop_satisfaction = pop_satisfaction_severe_penalty
					change_pop_allegiance = scope:rebel_target
				}
			}
		}
		custom_tooltip = {
			text = flavor_nap.401.a.tt2
			#Get all pops in the 5 least controlled locations
			#in Italy to add some more impact to the rebellion
			ordered_owned_location = {
				order_by = { #Get the least controlled ones
					value = local_control
					multiply = -1
				}
				max = 5
				every_pop = {
					limit = {
						owner = root
						pop_type = pop_type:peasants
					}
					add_pop_satisfaction = pop_satisfaction_severe_penalty
					change_pop_allegiance = scope:rebel_target
				}
			}
		}

		scope:rebel_target = {
			add_rebel_progress = 0.9
		}
	}

	option = {
		name = flavor_nap.401.b
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_extreme_bonus }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		set_variable = { name = masaniellos_fight_flag value = 1 }
		grant_estate_privilege = estate_privilege:masaniellos_fight
	}
}

scripted_effect nap_republic_of_napoli_buffs = {
	add_reform = government_reform:serene_republic_of_naples
	change_societal_value = {
		type = serfdom_vs_free_subjects
		value = societal_value_large_move_to_right
	}
	change_societal_value = {
		type = offensive_vs_defensive
		value = societal_value_large_move_to_right
	}
	add_country_modifier = {
		modifier = nap_struggle_for_independence
		years = 10
	}
}

flavor_nap.402 = { #Establishment of the Republic of Naples
	type = country_event

	title = flavor_nap.402.title
	desc = flavor_nap.402.desc
	major = yes

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		scope:republic_of_naples = {
			change_government_type = government_type:republic
			set_country_rank = country_rank:rank_kingdom
		}
		nap_republic_of_napoli_buffs = yes
		save_scope_as = root_naples
		scope:republic_of_naples.capital = {
			save_scope_as = republic_of_naples_capital
		}
	}


	option = {
		name = flavor_nap.402.a

		show_as_tooltip = {
			scope:republic_of_naples = {
				nap_republic_of_napoli_buffs = yes
			}
		}
		scope:republic_of_naples = {
			trigger_event_non_silently = flavor_nap.403
		}
	}
	option = {
		name = flavor_nap.402.b

		change_player = scope:republic_of_naples
		show_as_tooltip = {
			scope:republic_of_naples = {
				nap_republic_of_napoli_buffs = yes
			}
		}
		scope:republic_of_naples = {
			trigger_event_non_silently = flavor_nap.403
		}
	}
}

flavor_nap.403 = { #Establishment of the Republic of Naples - as the nation
	type = country_event

	title = flavor_nap.403.title
	desc = flavor_nap.403.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	
	option = {
		name = flavor_nap.403.a

		nap_republic_of_napoli_buffs = yes

		add_country_modifier = {
			modifier = nap_favor_monarchy
			years = 40
		}
	}
	option = {
		name = flavor_nap.403.b

		nap_republic_of_napoli_buffs = yes

		add_country_modifier = {
			modifier = nap_favor_republic
			years = 40
		}
	}
}