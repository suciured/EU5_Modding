namespace = flavor_ira

scripted_effect qizilbash_estate_satisfaction = {
	if = {
		limit = { country_has_estate = estate_type:tribes_estate }
		add_estate_satisfaction = { type = estate_type:tribes_estate value = $value$ }
	}
}

#The Reforms of [target_character.GetNameWithNoTooltip]
flavor_ira.1 = {
	type = country_event
	title = flavor_ira.1.title
	desc = flavor_ira.1.desc
	historical_info = flavor_ira.1.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1340.1.1
		to = 1540.1.1
		monthly_chance = 20
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	trigger = {
		has_ruler = yes
		ruler ?= {
			total_abilities >= 150
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler ?= { save_scope_as = target_character }
		save_scope_as = target_country
	}
	option = {
		name = flavor_ira.1.a
		historical_option = yes
		trigger = { scope:target_character = { dip >= 50 } }
		set_country_rank_effect = { rank = country_rank:rank_empire }
		scope:target_character = {
			set_nickname_if_none_present = { nickname = nick_city_builder }
			add_character_modifier = {
				modifier = ira_city_builder
				years = modifier_duration_permanent
				mode = add_and_extend
			}
		}
		change_gold_effect = { scale = -6.00 }
		if = { limit = { owns = location:tabriz } location:tabriz = { change_development  = development_mild_bonus } }
		if = { limit = { owns = location:isfahan } location:isfahan = { change_development  = development_severe_bonus } }
		if = { limit = { owns = location:qazvin } location:qazvin = { change_development  = development_mild_bonus } }
		if = { limit = { owns = location:shiraz } location:shiraz = { change_development  = development_mild_bonus } }
		if = { limit = { owns = location:yazd } location:yazd = { change_development  = development_weak_bonus } }
		if = { limit = { owns = location:qom } location:qom = { change_development  = development_weak_bonus } }
		if = { limit = { owns = location:zanjan } location:zanjan = { change_development  = development_weak_bonus } }
	}
	option = {
		name = flavor_ira.1.b
		trigger = { scope:target_character = { mil >= 50 } }
		scope:target_character = {
			set_nickname_if_none_present = { nickname = nick_reformer }
			add_character_modifier = {
				modifier = ira_army_reformer
				years = modifier_duration_permanent
				mode = add_and_extend
			}
		}
		change_gold_effect = { scale = -6.00 }
		add_army_tradition = army_tradition_extreme_bonus
	}
	option = {
		name = flavor_ira.1.c
		trigger = { scope:target_character = { adm >= 50 } }
		scope:target_character = {
			set_nickname_if_none_present = { nickname = nick_lawgiver }
			add_character_modifier = {
				modifier = ira_the_lawgiver
				years = modifier_duration_permanent
				mode = add_and_extend
			}
		}
		change_gold_effect = { scale = -6.00 }
		add_stability = stability_severe_bonus
	}
	option = {
		name = flavor_ira.1.d
		add_prestige = prestige_weak_penalty
	}
}

#The Reign of [target_character.GetNameWithNoTooltip]
flavor_ira.2 = {
	type = country_event
	title = flavor_ira.2.title
	desc = flavor_ira.2.desc
	historical_info = flavor_ira.2.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1700.1.1
		monthly_chance = 5	#Triggers much likelier than the generic version of the event
	}
	illustration_tags = {
		10 = happy
		10 = exterior
	}
	trigger = {
		owns = location:isfahan
		is_eligible_for_the_great_ruler_event = yes
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler ?= { save_scope_as = target_character }
		save_scope_as = target_country
	}
	option = {
		name = flavor_ira.2.a
		set_character_as_the_great = { target = scope:target_character }
	}
}

#Advisor from Abroad
flavor_ira.3 = {
	type = country_event
	title = flavor_ira.3.title
	desc = flavor_ira.3.desc
	historical_info = flavor_ira.3.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1600.1.1
		to = 1640.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = happy
		10 = exterior
	}
	trigger = {
		trigger_if = { limit = { country_exists = c:GBR } knows_country = c:GBR }
		trigger_else_if = { limit = { country_exists = c:ENG } knows_country = c:ENG }
		trigger_else = { has_discovered = location:lewes }
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:lewes = {
			create_dynasty_from_location = sherley_dynasty
			save_scope_as = target_location
		}
		create_character = {
			first_name = name_thomas
			dynasty = dynasty:sherley_dynasty
			birth_date = 1542.1.1
			birth_location = scope:target_location
			culture = culture:english
			estate = estate_type:nobles_estate
			create_in_limbo = yes
			script = eng_thomas_sherley
		}
		create_character = {
			first_name = name_robert
			dynasty = dynasty:sherley_dynasty
			father = character:eng_thomas_sherley
			birth_date = 1581.1.1
			birth_location = scope:target_location
			culture = culture:english
			adm = 52
			dip = 74
			mil = 86
			estate = estate_type:nobles_estate
			create_in_limbo = yes
			save_scope_as = first_sibling
		}
		create_character = {
			first_name = name_anthony
			dynasty = dynasty:sherley_dynasty
			father = character:eng_thomas_sherley
			birth_date = 1565.1.1
			birth_location = scope:target_location
			culture = culture:english
			adm = 76
			dip = 82
			mil = 43
			estate = estate_type:nobles_estate
			create_in_limbo = yes
			save_scope_as = second_sibling
		}
		if = {
			limit = { country_exists = c:GBR }
			c:GBR = { save_scope_as = target_country }
		}
		else_if = {
			limit = { country_exists = c:ENG }
			c:ENG = { save_scope_as = target_country }
		}
		else = {
			scope:target_location = { owner = { save_scope_as = target_country } }
		}
		if = {
			limit = { current_year >= 1612 }
			kill_character_silently = character:eng_thomas_sherley
		}
		save_scope_as = root_country
	}
	after = {
		hidden_effect = {
			scope:second_sibling = {
				banish_character_to_country_effect = {
					target = scope:target_country
				}
			}
		}
	}

	option = {
		name = flavor_ira.3.a
		historical_option = yes
		add_country_modifier = {
			modifier = ira_abbas_advisors
			years = modifier_duration_years_normal
			mode = add_and_extend
		}
		scope:first_sibling = { move_country = root }
		change_gold_effect = { scale = -8 }
	}
	option = {
		name = flavor_ira.3.b
		add_stability = stability_mild_bonus
		scope:first_sibling = {
			banish_character_to_country_effect = {
				target = scope:target_country
			}
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_bonus }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
	}
}

#Political Turmoil
flavor_ira.4 = {
	type = country_event
	title = flavor_ira.4.title
	desc = flavor_ira.4.desc
	historical_info = flavor_ira.4.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1520.1.1
		to = 1700.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = angry
		10 = exterior
	}
	trigger = {
		trigger_if = {
			limit = { has_ruler = yes }
			ruler ?= { total_abilities < 120 }
		}
		trigger_else = {
			regent ?= { total_abilities < 180 }
		}
		has_advance = ira_the_qizilbash
		country_has_estate = estate_type:tribes_estate
		has_or_had_great_ruler = yes
		NOT = {
			character_is_the_great_ruler = {
				target = ruler_or_regent
			}
		}
		OR = {
			"estate_power(estate_type:tribes_estate)" > 0.5
			any_country_sub_unit = {
				sub_unit_type = unit_type:a_discovery_qizilbash
				percent >= 0.1
			}
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent ?= { save_scope_as = target_character }
		save_scope_as = target_country
		make_the_great_scope = { save_scope_as = great_ruler }
	}

	option = {
		name = flavor_ira.4.a
		historical_option = yes
		add_stability = stability_extreme_penalty
		add_manpower = { value = root.monthly_manpower multiply = -5 }
	}
	option = {
		name = flavor_ira.4.b
		change_gold_effect = { scale = -12.00 }
		add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_severe_penalty }
		custom_tooltip = {
			text = flavor_ira.4.b.tt
			every_unit = {
				limit = { any_sub_unit = { sub_unit_type = unit_type:a_discovery_qizilbash } }
				destroy_every_sub_unit_of_type = {
					sub_unit_type = unit_type:a_discovery_qizilbash
				}
			}
		}
	}
}

#Persian Miniature Painting
flavor_ira.5 = {
	type = country_event
	fire_only_once = yes
	title = flavor_ira.5.title
	desc = flavor_ira.5.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1600.1.1
		to = 1800.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	trigger = {
		religion.group = religion_group:muslim
		any_artist = {
			artist_type = painter
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		save_scope_as = target_country
	}

	option = {
		name = flavor_ira.5.a
		custom_tooltip = {
			text = flavor_ira.5.a.tt
			ordered_artist = {
				limit = { artist_type = painter }
				order_by = artist_skill
				max = 3
				check_range_bounds = no
				start_work_of_art = {
					work_of_art_type = work_of_art_type:miniature_painting
				}
			}
		}
		add_gold = {
			value = root.monthly_income_trade_and_tax
			multiply = {
				value = 12
				multiply = root.num_artists
				max = 36
			}
			multiply = -1
		}
	}
	option = {
		name = flavor_ira.5.b
		#Effects are in the after section, they will be shown anyway
	}
	after = {
		add_prestige = prestige_severe_bonus
		culture = { add_cultural_influence = cultural_influence_mild_bonus }
	}
}

#Iskander Munshi
flavor_ira.6 = {
	type = country_event
	title = flavor_ira.6.title
	desc = flavor_ira.6.desc
	fire_only_once = yes

	dynamic_historical_event = {
		tag = IRA
		from = 1580.1.1
		to = 1620.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	trigger = {
		stability > 15
		has_any_active_disaster = no
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		save_scope_as = target_country
		create_character = {
			first_name = name_alexander
			nickname = name_beg
			last_name = Munshi
			adm = { 60 90 }
			dip = 40
			mil = 45
			culture = root.culture
			religion = root.religion
			birth_date = 1561.1.1
			birth_location = root.capital
			estate = estate_type:burghers_estate
			create_in_limbo = yes
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.6.a
		scope:target_character = {
			move_country = scope:target_country
		}
		change_gold_effect = { scale = -6.00 }
		set_variable = { name = iskander_munshi value = scope:target_character }
	}

	option = {
		name = flavor_ira.6.b
		add_prestige = prestige_weak_penalty
		scope:target_character = {
			banish_character = yes
		}
	}
}

#Tarikh-e Alam-ara-ye Abbasi
flavor_ira.7 = {
	type = country_event
	fire_only_once = yes
	title = flavor_ira.7.title
	desc = flavor_ira.7.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1615.1.1
		to = 1635.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	trigger = {
		has_variable = iskander_munshi
		var:iskander_munshi = {
			is_alive = yes
		}
		OR = {
			has_ruler = yes
			has_or_had_great_ruler = yes
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		save_scope_as = target_country
		var:iskander_munshi = {
			save_scope_as = target_character
		}
		if = {
			limit = { has_or_had_great_ruler = yes }
			make_the_great_scope = { save_scope_as = target_ruler }
		}
		else = {
			ruler ?= {
				save_scope_as = target_ruler
			}
		}
	}

	option = {
		name = flavor_ira.7.a
		add_government_power = government_power_severe_bonus
		add_prestige = prestige_severe_bonus
		capital = {
			create_art = {
				artist = scope:target_character
				target = scope:target_ruler
				quality = 80
				type = work_of_art_type:chronicle
				key = tarikhe_alamaraye_abbasi
			}
		}
		remove_variable = iskander_munshi
	}
}

#An-Najaf al-Ashraf
flavor_ira.8 = {
	type = country_event
	title = flavor_ira.8.title
	desc = flavor_ira.8.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1400.1.1
		to = 1800.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	trigger = {
		religion = religion:shia
		owns = location:kufa
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		save_scope_as = target_country
		location:kufa = { save_scope_as = target_location }
	}
	option = {
		name = flavor_ira.8.a
		change_gold_effect = { scale = -12 }
		scope:target_location = {
			add_location_modifier = { modifier = ira_najaf years = modifier_duration_permanent mode = add_and_extend }
		}
	}
	option = {
		name = flavor_ira.8.b

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_ultimate_move_to_right }
		scope:target_location = {
			add_location_modifier = { modifier = ira_najaf years = modifier_duration_years_long mode = add_and_extend }
		}
	}
}

#The [Root.Culture.GetName] Influence
flavor_ira.9 = {
	type = country_event
	title = flavor_ira.9.title
	desc = flavor_ira.9.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1400.1.1
		to = 1800.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	trigger = {
		num_works_of_art > 10
		num_artists > 10
		is_during_bankruptcy = no
		monthly_balance > 0
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		save_scope_as = target_country
	}
	option = {
		name = flavor_ira.9.a
		add_prestige = prestige_severe_bonus
		culture = {
			add_cultural_influence = cultural_influence_severe_bonus
			add_cultural_tradition = cultural_tradition_severe_bonus
		}
	}
}

#Rise of the Musha'sha'iyyah
flavor_ira.10 = {
	type = country_event
	title = flavor_ira.10.title
	desc = flavor_ira.10.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1445.1.1
		to = 1455.1.1
		monthly_chance = 20
	}

	fire_only_once = yes

	trigger = {
		owns = location:hoveyzeh
		location:hoveyzeh = {
			any_pop = {
				NOT = { religion = religion:shia }
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		location:hoveyzeh = { save_scope_as = target_location }
		create_character = {
			first_name = name_muhammad
			last_name = ibn_falah
			culture = culture:iraqi_culture
			religion = religion:shia
			birth_date = 1400.1.1
			birth_location = scope:target_location
			estate = estate_type:clergy_estate
			create_in_limbo = yes
			save_scope_as = target_character
		}
		ruler_or_regent = {
			save_scope_as = target_ruler
		}
	}

	option = {
		name = flavor_ira.10.a
		custom_tooltip = {
			text = flavor_ira.10.a.tt
			scope:target_location.area = {
				every_location_in_area = {
					limit = { owner = root }
					add_location_modifier = { modifier = ira_mushashaiya years = modifier_duration_years_normal mode = add_and_extend }
					every_pop = {
						limit = { NOT = { religion = religion:shia } }
						split_pop = {
							fraction = 0.25
							religion = religion:shia
						}
					}
				}
			}
		}
		hidden_effect = {
   			kill_character_silently = scope:target_character
  		}
	}

	option = {
		name = flavor_ira.10.b
		trigger = {
			ruler_or_regent = { religion != religion:shia }
		}
		scope:target_ruler = { change_character_religion = religion:shia }
		add_legitimacy = legitimacy_weak_penalty
		scope:target_character = { move_country = root }
	}

	option = {
		name = flavor_ira.10.c
		kill_character = {
			target = scope:target_character
			reason = execution
			killer = scope:target_ruler
		}
		add_prestige = prestige_weak_penalty
		custom_tooltip = {
			text = flavor_ira.10.c.tt
			scope:target_location.area = {
				every_location_in_area = {
					limit = { dominant_religion = religion:shia }
					add_location_modifier = { modifier = ira_mushashaiya years = modifier_duration_years_short mode = add_and_extend }
				}
			}
		}
	}
}

#Rise of the Ṣafawiyya
flavor_ira.11 = {
	type = country_event
	title = flavor_ira.11.title
	desc = flavor_ira.11.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1455.1.1
		to = 1465.1.1
		monthly_chance = 20
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	fire_only_once = yes

	trigger = {
		OR = {
			religion = religion:shia
			any_owned_location = {
				dominant_religion = religion:shia
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_ira.11.a
		custom_tooltip = {
			text = flavor_ira.11.b.tt
			every_owned_location = {
				limit = {
					dominant_religion = religion:shia
				}
				add_location_modifier = { modifier = ira_safawiya years = modifier_duration_years_normal mode = add_and_extend }
			}
		}
	}

	option = {
		name = flavor_ira.11.b
		add_stability = stability_mild_penalty
	}
}

#$qizilbash$ Revolt
flavor_ira.12 = {
	type = country_event
	fire_only_once = yes
	title = flavor_ira.12.title
	desc = flavor_ira.12.desc

	trigger = {
		current_year >= 1450
		NOT = {
			current_year >= 1580
		}
		country_exists = c:IRA
		NOT = {
			tag = IRA
		}
		any_owned_location = {
			OR = {
				dominant_culture = culture:farsi_culture
				dominant_culture = culture:khorasani_culture
			}
			count >= 10
		}
	}
	
	illustration_tags = {
        10 = angry
        10 = exterior 
    }
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}

	option = {
		name = flavor_ira.12.a
		custom_tooltip = {
			text = flavor_ira.12.a.tt
			ordered_owned_location = {
				limit = {
					OR = {
						dominant_culture = culture:farsi_culture
						dominant_culture = culture:khorasani_culture
					}
					is_capital = no
				}
				order_by = population
				max = {
					value = 1
					add = {
						value = num_provinces
						divide = 10
					}
					max = num_provinces
				}
				every_pop = {
					limit = {
						owner = root
						OR = {
							culture = culture:farsi_culture
							culture = culture:khorasani_culture
						}
					}
					add_pop_satisfaction = pop_satisfaction_extreme_penalty
				}
			}
		}
	}

	option = {
		name = flavor_ira.12.b
		trigger = {
			stability >= 50
		}
		add_stability = stability_extreme_penalty
	}
}

#Armenian Slaves in the Persian Empire
flavor_ira.13 = {
	type = country_event
	title = flavor_ira.13.title
	desc = flavor_ira.13.desc
	historical_info = flavor_ira.13.historical_info
	fire_only_once = yes
	trigger = {
		country_has_estate = estate_type:tribes_estate
		religion.group = religion_group:muslim
		any_pop = {
			culture = culture:armenian_culture
		}
		region:caucasus_region = {
			any_location_in_region = {
				owner = root
				dominant_culture = culture:armenian_culture
				count >= 15
			}
		}
	}
	dynamic_historical_event = {
		tag = IRA
		from = 1400.1.1
		to = 1700.1.1
		monthly_chance = 20
	}
	illustration_tags = {
        10 = angry
        10 = exterior
    }
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		save_scope_as = target_country
		ruler_or_regent ?= { save_scope_as = target_character }
		culture:armenian_culture = { save_scope_as = target_culture }
		capital = {
			save_scope_as = target_location
		}
		region:caucasus_region = {
			every_location_in_region = {
				limit = {
					owner = root
					dominant_culture = culture:armenian_culture
				}
				add_to_list = armenian_locations
			}
		}
	}
	option = {
		name = flavor_ira.13.a
		historical_option = yes
		custom_tooltip = {
			text = flavor_ira.13.a.tt
			ordered_in_list = {
				list = armenian_locations
				order_by = population
				max = 5
				random_pop = {
					limit = { culture = culture:armenian_culture }
					transfer_pop = {
						target = scope:target_location
						operator = divide
						value = 40
					}
				}
			}
		}
		scope:target_location = {
			change_development = development_severe_bonus
		}
		add_country_modifier = {
			modifier = ira_sponsorship_of_christian_armenians_modifier
			years = modifier_duration_years_long
			mode = add_and_extend
		}
		qizilbash_estate_satisfaction = { value = estate_satisfaction_severe_penalty }
	}

	option = {
		name = flavor_ira.13.b
		add_stability = stability_mild_bonus
		add_country_modifier = {
			modifier = ira_elitist_caste_modifier
			years = modifier_duration_years_long
			mode = add_and_extend
		}
		qizilbash_estate_satisfaction = { value = estate_satisfaction_severe_bonus }
	}
}

#Turkmen Recruits Flock to the Banners
flavor_ira.14 = {
	type = country_event
	title = flavor_ira.14.title
	desc = flavor_ira.14.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1400.1.1
		to = 1700.1.1
		monthly_chance = 10
	}

	fire_only_once = yes

	trigger = {
		culture_percentage_in_country = {
			culture = culture:turkmen_culture
			value > 0
		}
	}
	
	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}
	
	option = {
		name = flavor_ira.14.a
		add_yearly_manpower = 1
		if = {
			limit = { country_has_estate = estate_type:tribes_estate}
			add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_weak_bonus }
		}
	}

	option = {
		name = flavor_ira.14.b
		if = {
			limit = { country_has_estate = estate_type:tribes_estate}
			add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_weak_penalty }
		}
		culture = { add_cultural_tradition = cultural_tradition_weak_bonus }
		add_prestige = prestige_weak_bonus
	}
}
##The New Persian Horse
flavor_ira.15 = {
	type = country_event
	title = flavor_ira.15.title
	desc = flavor_ira.15.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_horses.dds"

	dynamic_historical_event = {
		tag = IRA
		from = 1337.1.1
		to = 1837.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		produced_in_country:horses > 0
	}

	option = {
		name = flavor_ira.15.a
		add_country_modifier = { modifier = ira_selective_horse_breeding years = modifier_duration_years_normal mode = add_and_extend }
	}

	option = {
		name = flavor_ira.15.b
		add_country_modifier = { modifier = ira_intensive_horse_breeding years = modifier_duration_years_normal mode = add_and_extend }
	}
}

#Shahnameh of Shah $RULER$
flavor_ira.16 = {
	hide_portraits = yes
	type = country_event
	title = flavor_ira.16.title
	desc = flavor_ira.16.desc
	dynamic_historical_event = {
		tag = IRA
		from = 1450.1.1
		to = 1837.1.1
		monthly_chance = 5
	}
	fire_only_once = yes
	trigger = {
		has_ruler = yes
		num_artists > 0
		any_artist = {
			artist_type = writer
			artist_skill > 0.8
		}
	}
	illustration_tags = {
        10 = regular
        10 = exterior
    }
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler ?= {
			save_scope_as = target_ruler
		}
		random_artist = {
			limit = {
				artist_type = writer
				artist_skill > 0.8
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.16.a
		capital = {
			create_art = {
				artist = scope:target_character
				quality = 80
				type = work_of_art_type:chronicle
				key = shahnameh
			}
		}
		culture = {
			add_cultural_tradition = cultural_tradition_severe_bonus
		}
		scope:target_character = {
			add_character_modifier = {
				modifier = ira_well_renowned_artist
				years = modifier_duration_permanent
				mode = add_and_extend
			}
		}
	}
}

#Chinese Blue-and-White Porcelains
flavor_ira.17  = {
	type = country_event
	title = flavor_ira.17.title
	desc = flavor_ira.17.desc
	fire_only_once = yes

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_porcelain.dds"

	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1800.1.1
		monthly_chance = 5
	}
	trigger = {
		has_ruler = yes
		capital = {
			market ?= {
				NOT = { is_import_banned = goods:porcelain }
			}
		}
		any_related_country = {
			type = alliance
			capital.sub_continent = sub_continent:east_asia
			has_ruler = yes
			capital = {
				market ?= {
					NOT = { is_export_banned = goods:porcelain }
					is_produced_in_market = goods:porcelain
				}
			}
		}
	}
	immediate = {
		save_scope_as = root_country
		ruler ?= { save_scope_as = root_character }
		capital.market = { save_scope_as = root_market }
		random_related_country = {
			type = alliance
			limit = {
				capital.sub_continent = sub_continent:east_asia
				capital = {
					market ?= {
						NOT = { is_export_banned = goods:porcelain }
						is_produced_in_market = goods:porcelain
					}
				}
			}
			save_scope_as = target_country
			ruler ?= { save_scope_as = target_character }
		}
	}
	option = {
		name = flavor_ira.17.a
		scope:root_market = {
			add_goods_supply = {
				goods = goods:porcelain
				amount = market_goods_severe_gain
			}
		}
		add_prestige = prestige_mild_bonus
		scope:target_country = { add_prestige = prestige_mild_bonus }
	}
}

#The Persian Rugs
flavor_ira.18 = {
	type = country_event
	title = flavor_ira.18.title
	desc = flavor_ira.18.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_silk.dds"

	dynamic_historical_event = {
		tag = IRA
		from = 1450.1.1
		to = 1650.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		OR = {
			produced_in_country:silk > 10
			produced_in_country:fine_cloth > 10
			produced_in_country:dyes > 10
		}
	}


	option = {	#Monopolize the Rug Market
		name = flavor_ira.18.a
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = { type = mercantilism_vs_free_trade value = societal_value_minor_move_to_left }
		}
		add_country_modifier = { modifier = ira_rug_monopoly years = modifier_duration_years_long mode = add_and_extend }
	}

	option = {	#Flood the Rug Market
		name = flavor_ira.18.b
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = { type = mercantilism_vs_free_trade value = societal_value_minor_move_to_right }
		}
		add_country_modifier = { modifier = ira_increased_rug_trade years = modifier_duration_years_long mode = add_and_extend }
	}

	option = {	#Keep it moderate
		name = flavor_ira.18.c
		add_country_modifier = { modifier = ira_steady_rug_production years = modifier_duration_years_long mode = add_and_extend }
	}
}

#Rise of the Persian Arquebus
flavor_ira.19 = {
	type = country_event
	title = flavor_ira.19.title
	desc = flavor_ira.19.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1600.1.1
		to = 1700.1.1
		monthly_chance = 5
	}
	illustration_tags = {
        10 = armed
        10 = exterior
    }
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}
	trigger = {
		has_embraced_institution = institution:artillery_institution
		has_advance = ira_the_tofangchi
		any_country_sub_unit = {
			sub_unit_type = unit_type:a_tofangchi
			count > 10
		}
	}
	#A new gunpowder time has arrived!
	option = {
		name = flavor_ira.19.a
		qizilbash_estate_satisfaction = { value = estate_satisfaction_severe_penalty }
		add_army_tradition = army_tradition_severe_bonus
		custom_tooltip = {
			text = flavor_ira.19.a.tt
			every_country_sub_unit = {
				limit = { sub_unit_type = unit_type:a_tofangchi }
				add_subunit_experience = subunit_experience_severe_bonus
			}
		}
	}
	#We cannot abandon our traiditions!
	option = {
		name = flavor_ira.19.b
		trigger = { country_has_estate = estate_type:tribes_estate }
		qizilbash_estate_satisfaction = { value = estate_satisfaction_severe_bonus }
		add_army_tradition = army_tradition_mild_penalty
		add_stability = stability_mild_bonus
	}
}

#The Supreme Emerald Lion
flavor_ira.20 = {
	type = country_event
	title = flavor_ira.20.title
	desc = flavor_ira.20.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1837.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		has_ruler = yes
		region:persia_region = {
			any_location_in_region = {
				has_owner = yes
				owner = root
				count = all
			}
		}
		sub_continent:south_asia = {
			any_location_in_sub_continent = {
				has_owner = yes
				owner = root
				count >= 200
			}
		}
		sub_continent:middle_east = {
			any_location_in_sub_continent = {
				NOT = { region = region:persia_region }
				has_owner = yes
				owner = root
				count >= 250
			}
		}
		continent:europe = {
			any_location_in_continent = {
				has_owner = yes
				owner = root
				count >= 100
			}
		}
	}

	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler = { save_scope_as = target_ruler }
	}

	option = {
		name = flavor_ira.20.a
		add_prestige = prestige_ultimate_bonus
		add_country_modifier = { modifier = ira_the_emerald_lion years = modifier_duration_years_century mode = add_and_extend }
	}
}

#Redecorating Constantinople
flavor_ira.21 = {
	type = country_event
	title = flavor_ira.21.title
	desc = flavor_ira.21.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1337.1.1
		to = 1837.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		location:constantinople = {
			owner = root
			this != root.capital
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		capital = { save_scope_as = target_capital }
		location:constantinople = { save_scope_as = target_location }
	}

	#Expand its development
	option = {
		name = flavor_ira.21.a
		location:constantinople = {
			add_location_modifier = { modifier = ira_second_capital years = modifier_duration_years_normal mode = add_and_extend }
		}
	}

	#Siphon its development
	option = {
		name = flavor_ira.21.b
		location:constantinople = {
			change_prosperity = prosperity_severe_penalty
		}
		change_gold_effect = { scale = 1 }
	}
}

#Turkish integration
flavor_ira.22 = {
	type = country_event
	title = flavor_ira.22.title
	desc = flavor_ira.22.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1337.1.1
		to = 1600.1.1
		monthly_chance = 5
	}

	fire_only_once = yes
	
	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}

	trigger = {
		country_has_estate = estate_type:tribes_estate
		culture_group_percentage_in_country = {
			culture_group = culture_group:turkic_group
			value > 0
		}
	}

	option = {
		name = flavor_ira.22.a
		add_yearly_manpower = 3
		add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_mild_bonus }
		custom_tooltip = {
			text = flavor_ira.22.a.tt
			every_owned_location = {
				limit = {
					dominant_culture = { has_culture_group = culture_group:turkic_group }
				}
				change_control = control_weak_penalty
			}
		}
	}
	option = {
		name = flavor_ira.22.b
		add_yearly_manpower = 2
		add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_weak_penalty }
	}
}

#Georgian Slaves in the Persian Empire
flavor_ira.23 = {
	type = country_event
	title = flavor_ira.23.title
	desc = flavor_ira.23.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1337.1.1
		to = 1600.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		culture_percentage_in_country = {
			culture = culture:georgian_culture
			value > 0
		}
		has_ruler = yes
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler = { save_scope_as = target_ruler }
	}

	option = {
		name = flavor_ira.23.a
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		custom_tooltip = {
			text = flavor_ira.23.a.tt
			every_pop = {
				limit = {
					owner = root
					OR = {
						culture = culture:georgian_culture
						culture = culture:armenian_culture
					}
				}
				add_pop_satisfaction = pop_satisfaction_severe_bonus
			}
		}
	}

	option = {
		name = flavor_ira.23.b
		culture = { add_cultural_tradition = cultural_tradition_mild_bonus }
		custom_tooltip = {
			text = flavor_ira.23.b.tt
			every_pop = {
				limit = {
					owner = root
					OR = {
						culture = culture:georgian_culture
						culture = culture:armenian_culture
					}
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}
	}
}

#Sarkhej Roza and the City of Ahmedabad
flavor_ira.24 = {
	type = country_event
	title = flavor_ira.24.title
	desc = flavor_ira.24.desc

	historical_info = flavor_ira.24.historical_info

	dynamic_historical_event = {
		tag = IRA
		from = 1337.1.1
		to = 1600.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		location:ashaval = {
			owner = root
			is_core_of = root
		}
		has_ruler = yes
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:ashaval = { save_scope_as = target_location }
		ruler = { save_scope_as = target_ruler }
	}

	option = {
		name = flavor_ira.24.a
		historical_option = yes
		location:ashaval = {
			change_development = development_mild_bonus
			if = {
				limit = {
					NOT = { location_rank = location_rank:city }
				}
				change_location_rank = location_rank:city
			}
			if = {
				limit = {
					NOT = { has_building = building_type:temple }
				}
				construct_building = {
					building_type = building_type:temple
				}
			}
		}
		culture = { add_cultural_influence = cultural_influence_weak_bonus }
	}

	option = {
		name = flavor_ira.24.b
		culture = { add_cultural_tradition = cultural_tradition_weak_bonus }
	}
}

#Evolution of the Qizilbash
flavor_ira.25 = {
	type = country_event
	title = flavor_ira.25.title
	desc = flavor_ira.25.desc
	trigger = {
		has_advance = ira_the_qizilbash
		current_age_or_later = { age = age_4_reformation }
		NOT = { has_unlocked_unit_trigger = { type = a_reformation_qizilbash } }
	}
	
	illustration_tags = {
        10 = regular
        10 = exterior
    }
	
	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}
	
	option = {
		name = flavor_ira.25.a
		unlock_unit_effect = { type = a_reformation_qizilbash }
	}
}

#Clerical Aristocracy
flavor_ira.26 = {
	type = country_event
	title = flavor_ira.26.title
	desc = flavor_ira.26.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1505.1.1
		to = 1575.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:burghers_estate }
		unlock_estate_privilege_effect = {
			type = ira_clerical_aristocracy
		}
	}

	option = {
		name = flavor_ira.26.a

		grant_estate_privilege = estate_privilege:ira_clerical_aristocracy

		add_government_power = government_power_mild_penalty
	}

	option = {
		name = flavor_ira.26.b

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_penalty
		}

		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}

#Mirza Shah Hossein
flavor_ira.27 = {
	type = country_event
	title = flavor_ira.27.title
	desc = flavor_ira.27.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1490.1.1
		to = 1530.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:isfahan = {
			create_dynasty_from_location = husayn_dynasty
		}

		create_character = {
			estate = estate_type:nobles_estate
			first_name = name_mirza.name_shah
			dynasty = dynasty:husayn_dynasty
			adm = 75
			dip = 50
			mil = 55
			birth_location = location:isfahan
			birth_date = 1465.5.3 #unknown birth date
			culture = culture:farsi_culture
			religion = religion:shia
			save_scope_as = target_character
			create_in_limbo = yes
		}
	}

	option = { #Employ him as a vizier
		name = flavor_ira.27.a

		scope:target_character = {
			move_country = root
		}

		promote_to_head_of_cabinet_effect = {
			target = scope:target_character
		}
	}

	option = { #Employ him as a commander
		name = flavor_ira.27.b

		scope:target_character = {
			move_country = root
		}

		scope:target_character = {
			add_character_modifier = {
				mode = add
				modifier = ira_commander_of_the_tofangchi
				years = -1
			}
		}
	}

	option = { #Leave him be
		name = flavor_ira.27.c

		kill_character_silently = scope:target_character

		add_government_power = government_power_mild_bonus
	}
}

#Moving capital to Qazvin
flavor_ira.29 = {
	type = country_event
	title = flavor_ira.29.title
	desc = flavor_ira.29.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1450.1.1
		to = 1550.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		location:qazvin = {
			is_capital = no
			owner ?= root
		}
		num_rivals >= 1
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:qazvin = {
			save_scope_as = target_capital
		}

		capital ?= {
			save_scope_as = target_capital2
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		random_rival = {
			save_scope_as = target_country
		}
	}

	option = {
		name = flavor_ira.29.a

		set_capital = scope:target_capital

		scope:target_capital = {
			change_development = development_mild_bonus
			change_control = control_mild_bonus
		}

		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
	}

	option = {
		name = flavor_ira.29.b

		scope:target_capital2 = {
			change_development = development_extreme_bonus
			change_prosperity = prosperity_extreme_bonus
		}
	}
}

#Takmelat al-akhbar
flavor_ira.30 = {
	type = country_event
	title = flavor_ira.30.title
	desc = flavor_ira.30.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1535.1.1
		to = 1580.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		ruler_or_heir_if_regent ?= {
			has_dynasty = yes
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		create_character = {
			estate = estate_type:burghers_estate
			first_name = abdi_beg
			last_name = shirazi
			birth_date = 1513.5.3
			birth_location = location:tabriz
			adm = 63
			dip = 53
			mil = 14
			artist = writer
			artist_skill = 0.75
			save_scope_as = target_character
			create_in_limbo = yes
		}

		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_ira.30.a

		scope:target_character = { move_country = root }
		capital ?= {
			create_art = {
				artist = scope:target_character
				key = takmelat_al_akhbar
				quality = 75
				type = work_of_art_type:chronicle
			}
		}

		culture = {
			add_cultural_influence = cultural_influence_mild_bonus
			add_cultural_tradition = cultural_tradition_mild_bonus
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_ira.30.b

		scope:target_character = { move_country = root }
		add_prestige = prestige_mild_penalty

		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}

#Military reforms of Tahmasp
flavor_ira.31 = {
	type = country_event
	title = flavor_ira.31.title
	desc = flavor_ira.31.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1550.1.1
		to = 1700.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		ruler_or_regent ?= {
			OR = {
				mil >= 80
				has_trait = military_theorist
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.31.a

		trigger = {
			any_owned_location = {
				has_land_military_building = yes
			}
		}

		custom_tooltip = {
			text = ira_grant_prosperity_to_armory_building_locations
			every_owned_location = {
				limit = {
					has_land_military_building = yes
				}
				change_prosperity = prosperity_mild_bonus
			}
		}
	}

	option = {
		name = flavor_ira.31.b

		add_army_tradition = army_tradition_extreme_bonus
		change_societal_value = {
			type = quality_vs_quantity
			value = societal_value_huge_move_to_left
		}
	}

	option = {
		name = flavor_ira.31.c

		add_army_tradition = army_tradition_extreme_bonus
		change_societal_value = {
			type = quality_vs_quantity
			value = societal_value_huge_move_to_right
		}
	}
}

#Imamzadeh Hossein
flavor_ira.32 = {
	type = country_event
	title = flavor_ira.32.title
	desc = flavor_ira.32.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1530.1.1
		to = 1620.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		capital ?= location:qazvin
		religion = religion:shia
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		location:qazvin = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_ira.32.a

		scope:target_location = {
			create_art = {
				artist = scope:target_character
				key = imamzadeh_hossein
				quality = 80
				type = work_of_art_type:monument
			}
		}

		change_gold_effect = { scale = -4 }

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_right }
	}

	option = {
		name = flavor_ira.32.b


		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_left }
		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}
#Patronage of the Arts from the Safavids
flavor_ira.34 = {
	type = country_event
	title = flavor_ira.34.title
	desc = flavor_ira.34.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1550.1.1
		to = 1700.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		ruler ?= {
			has_dynasty = yes
			OR = {
				adm >= 80
				has_trait = scholar
			}
		}
		religion.group = religion_group:muslim
		prestige >= 50
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.34.a

		change_societal_value = {
			type = spiritualist_vs_humanist
			value = societal_value_move_to_right
		}

		unlock_estate_privilege_effect = {
			type = ira_iranian_art_patronage
		}

		change_gold_effect = { scale = -2 }

		add_research_progress = research_progress_mild_bonus
	}

	option = {
		name = flavor_ira.34.b

		add_prestige = prestige_mild_penalty

		change_societal_value = {
			type = spiritualist_vs_humanist
			value = societal_value_move_to_left
		}

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_left }

	}
}

#Currency Reform of Tahmasp
flavor_ira.35 = {
	type = country_event
	title = flavor_ira.35.title
	desc = flavor_ira.35.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1520.1.1
		to = 1650.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		inflation >= 0.05
		ruler ?= {
			OR = {
				adm >= 80
				has_trait = midas_touched
			}
		}
	}

	illustration_tags = {
        10 = angry
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.35.a

		capital.market ?= {
			add_temporary_demand = {
				type = demand:ira_currency_reforms
				years = 10
			}
		}

		add_inflation = inflation_extreme_bonus

		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_ira.35.b

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

#Good treatment of Armenia
flavor_ira.37 = {
	type = country_event
	title = flavor_ira.37.title
	desc = flavor_ira.37.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1550.1.1
		to = 1600.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		culture_percentage_in_country = {
			culture = culture:armenian_culture
			value > 0.05
		}

		culture != culture:armenian_culture
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		create_character = {
			culture = culture:armenian_culture
			religion = religion:orthodox
			age = 30
			adm = {
				40
				80
			}
			dip = {
				40
				80
			}
			mil = {
				40
				80
			}
			save_scope_as = target_character2
			create_in_limbo = yes
		}
	}

	option = {
		name = flavor_ira.37.a

		culture:armenian_culture = {
			add_cultural_influence = cultural_influence_severe_bonus
			add_cultural_tradition = cultural_tradition_severe_bonus
		}

		culture = {
			add_cultural_influence = cultural_influence_mild_penalty
			add_cultural_tradition = cultural_tradition_mild_penalty
		}

		scope:target_character2 = {
			move_country = root
		}

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_penalty
		}

		custom_tooltip = {
			text = ira_all_armenian_pops_gain_satisfaction
			every_pop = {
				limit = {
					owner ?= root
					culture = culture:armenian_culture
				}
				add_pop_satisfaction = pop_satisfaction_severe_bonus
			}
		}
	}

	option = {
		name = flavor_ira.37.b

		culture = {
			add_cultural_influence = cultural_influence_severe_bonus
			add_cultural_tradition = cultural_tradition_severe_bonus
		}

		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}

		custom_tooltip = {
			text = ira_all_armenian_pops_lose_satisfaction
			every_pop = {
				limit = {
					owner ?= root
					culture = culture:armenian_culture
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}
		hidden_effect = {
   			kill_character_silently = scope:target_character
  		}
	}
}

#Ali Qapu Palace
flavor_ira.38 = {
	type = country_event
	title = flavor_ira.38.title
	desc = flavor_ira.38.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1600.1.1
		to = 1700.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		capital ?= location:isfahan
		culture = { has_culture_group = culture_group:iranian_group }
		government_type = government_type:monarchy
		ruler ?= {
			has_dynasty = yes
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		location:isfahan = {
			save_scope_as = target_location
		}

		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.38.a

		scope:target_location = {
			create_art = {
				artist = scope:target_character
				key = ali_qapu_palace
				quality = 95
				type = work_of_art_type:palace
			}
		}

		add_government_power = government_power_mild_bonus

		change_gold_effect = { scale = -4 }
	}

	option = {
		name = flavor_ira.38.b

		add_prestige = prestige_extreme_penalty
		add_government_power = government_power_mild_penalty
	}
}

#Alcohol Ban
flavor_ira.39 = {
	type = country_event
	title = flavor_ira.39.title
	desc = flavor_ira.39.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1600.1.1
		to = 1700.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		religion.group = religion_group:muslim
		OR = {
			ruler_or_regent ?= {
				has_trait = zealot
			}
			societal_value:spiritualist_vs_humanist <= -20
		}
	}

	illustration_tags = {
        10 = angry
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		unlock_law_effect = {
			type = ira_alcohol_ban
		}

		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.39.a

		add_policy = policy:ban_on_alcohol

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}

		add_estate_satisfaction = {
			type = estate_type:peasants_estate
			value = estate_satisfaction_mild_penalty
		}

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_left }
	}

	option = {
		name = flavor_ira.39.b

		add_policy = policy:no_restriction_on_alcohol

		add_estate_satisfaction = {
			type = estate_type:peasants_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

flavor_ira.40 = {
	type = country_event
	title = flavor_ira.40.title
	desc = flavor_ira.40.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1600.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		religion_percentage_in_country = {
			religion = religion:zoroastrian
			value >= 0.05
		}

		religion.group = religion_group:muslim
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.40.a

		custom_tooltip = {
			text = ira_conversion_of_zoroastrians_tt
			every_pop = {
				limit = {
					owner ?= root
					religion = religion:zoroastrian
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
				random_list = {
					35 = {
						split_pop = {
							fraction = 0.3
							religion = root.religion
						}
					}
					30 = {
						split_pop = {
							fraction = 0.4
							religion = root.religion
						}
					}
					25 = {
						split_pop = {
							fraction = 0.45
							religion = root.religion
						}
					}
					20 = {
						split_pop = {
							fraction = 0.5
							religion = root.religion
						}
					}
				}
			}
		}

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}

		add_estate_satisfaction = {
			type = estate_type:dhimmi_estate
			value = estate_satisfaction_radical_penalty
		}
	}

	option = {
		name = flavor_ira.40.b

		custom_tooltip = {
			text = ira_satisfaction_for_zoroastrians_tt
			every_pop = {
				limit = {
					owner ?= root
					religion = religion:zoroastrian
				}
				add_pop_satisfaction = pop_satisfaction_extreme_bonus
			}
		}

		add_estate_satisfaction = {
			type = estate_type:dhimmi_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

#Farangi-Sazi (western painting) art style
flavor_ira.41 = {
	type = country_event
	title = flavor_ira.41.title
	desc = flavor_ira.41.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1550.1.1
		to = 1650.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		any_other_great_power = {
			capital ?= {
				continent = continent:europe
			}
			prev.prestige > prestige
			prev.culture.cultural_influence > culture.cultural_influence
		}

		capital ?= {
			continent != continent:europe
		}

		religion.group = religion_group:muslim
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ordered_other_great_power = {
			order_by = prestige
			limit = {
				capital ?= {
					continent = continent:europe
				}
			}
			max = 1
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_ira.41.a

		culture ?= {
			add_cultural_influence = cultural_influence_mild_bonus
			add_cultural_tradition = cultural_tradition_mild_penalty
		}

		scope:target_country.culture = {
			add_cultural_tradition = cultural_tradition_mild_bonus
		}

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_left
		}

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_penalty
		}
	}

	option = {
		name = flavor_ira.41.b

		culture ?= {
			add_cultural_tradition = cultural_tradition_mild_bonus
		}

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

flavor_ira.42 = {
	type = country_event
	title = flavor_ira.42.title
	desc = flavor_ira.42.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1690.1.1
		to = 1735.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		NOT = {
			any_cabinet_character = {
				modifier:is_head_of_cabinet = yes
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = name_muhammad
			last_name = qazvini
			estate = estate_type:burghers_estate
			adm = 80
			dip = 60
			mil = 30
			culture = culture:farsi_culture
			religion = religion:sunni
			birth_location = location:qazvin
			birth_date = 1670.5.3 #Unknown birthdate
			save_scope_as = target_character
			create_in_limbo = yes
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_ira.42.a

		scope:target_character = {
			add_adm = 5
			add_dip = 15
			add_mil = 10
			move_country = root
		}
		promote_to_head_of_cabinet_effect = {
			target = scope:target_character
		}

		change_gold_effect = { scale = -1 }
	}

	option = {
		name = flavor_ira.42.b

		add_government_power = government_power_mild_penalty

		kill_character_silently = {
			target = scope:target_character
		}
	}
}

flavor_ira.43 = {
	type = country_event
	title = flavor_ira.43.title
	desc = flavor_ira.43.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1600.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		owns = location:qom
		religion = religion:shia
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		location:qom = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_ira.43.a

		scope:target_location = {
			change_development = development_mild_bonus
			change_prosperity = prosperity_mild_bonus
		}

		change_gold_effect = { scale = -3 }

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_right }

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_ira.43.b
		
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_left }
	}
}

flavor_ira.44 = {
	hide_portraits = yes
	type = country_event
	title = flavor_ira.44.title
	desc = flavor_ira.44.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1600.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		ruler_or_heir_if_regent ?= {
			has_dynasty = yes
			dynasty ?= dynasty:safavid_dynasty
		}

		religion.group = religion_group:muslim
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character
		}

		ordered_accepted_culture = {
			order_by = cultural_influence
			max = 1
			save_scope_as = target_culture
		}
	}

	option = {
		name = flavor_ira.44.a

		culture = {
			add_cultural_influence = cultural_influence_severe_bonus
			add_cultural_tradition = cultural_tradition_severe_bonus
		}

		change_gold_effect = { scale = -2 }

		create_character = {
			estate = estate_type:burghers_estate
			culture = scope:target_culture
			mil = {
				40
				80
			}
			adm = {
				40
				80
			}
			dip = {
				40
				80
			}
			age = 30
			artist = painter
			artist_skill = {
				0.6
				0.9
			}
		}
	}

	option = {
		name = flavor_ira.44.b

		add_prestige = prestige_mild_penalty

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_right
		}
	}

	option = {
		name = flavor_ira.44.c

		trigger = {
			scope:target_character = {
				has_trait = scholar
			}
		}

		add_research_progress = research_progress_extreme_bonus

		change_gold_effect = { scale = -2 }
	}
}

#Qajar Tribes
flavor_ira.45 = {
	type = country_event
	title = flavor_ira.45.title
	desc = flavor_ira.45.desc
	historical_info = flavor_ira.45.historical_info

	dynamic_historical_event = {
		tag = IRA
		from = 1770.1.1
		to = 1821.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		government_type = government_type:monarchy
	}

	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		location:astarabad = {
			create_dynasty_from_location = qajar_dynasty
		}

		create_character = {
			first_name = name_agha.name_muhammad
			dynasty = dynasty:qajar_dynasty
			estate = estate_type:nobles_estate
			culture = culture:turkoman_culture
			religion = religion:sunni
			birth_location = location:astarabad
			birth_date = 1722.3.14
			adm = 65
			dip = 40
			mil = 75
			save_scope_as = target_character
			script = agha_muhammad_qajar
			create_in_limbo = yes
		}

		create_character = {
			first_name = name_fath.name_ali
			dynasty = dynasty:qajar_dynasty
			estate = estate_type:nobles_estate
			culture = culture:turkoman_culture
			religion = religion:sunni
			birth_location = location:damghan
			father = character:agha_muhammad_qajar
			birth_date = 1750.5.12
			adm = 55
			dip = 90
			mil = 60
			save_scope_as = target_character2
			script = fath_ali_qajar
			create_in_limbo = yes
		}
	}

	option = {
		name = flavor_ira.45.a

		add_government_power = government_power_mild_penalty

		custom_tooltip = {
			text = ira_qajar_dynasty_may_claim_crown
			set_variable = ira_qajar_dynasty_rebellion_flag
		}
	}

	option = {
		name = flavor_ira.45.b

		add_all_estate_satisfaction = {
			value = estate_satisfaction_mild_penalty
		}

		scope:target_character = {
			banish_character = yes
		}

		scope:target_character2 = {
			banish_character = yes
		}
	}
}

flavor_ira.46 = {
	type = country_event
	title = flavor_ira.46.title
	desc = flavor_ira.46.desc
	historical_info = flavor_ira.46.historical_info

	dynamic_historical_event = {
		tag = IRA
		from = 1770.1.1
		to = 1821.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		has_variable = ira_qajar_dynasty_rebellion_flag
		government_type = government_type:monarchy
		OR = {
			character:agha_muhammad_qajar = {
				is_alive = yes
			}
			character:fath_ali_qajar = {
				is_alive = yes
			}
		}
		ruler_or_regent != character:agha_muhammad_qajar
		ruler_or_regent != character:fath_ali_qajar

		legitimacy <= 60
		stability <= 5
	}

	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		if = {
			limit = {
				character:agha_muhammad_qajar = {
					is_alive = yes
				}
			}

			character:agha_muhammad_qajar = {
				save_scope_as = rebellion_ruler
			}

			character:fath_ali_qajar = {
				save_scope_as = rebellion_heir
			}
		}

		else = {
			character:fath_ali_qajar = {
				save_scope_as = rebellion_ruler
			}
		}

		ruler_or_regent ?= {
			save_scope_as = current_ruler
		}

		create_rebel = {
			category = pretender
			name = qajar_pretenders
			save_scope_as = target_rebel
		}

		set_variable = {
			name = current_ruler_power_variable
			value = {
				add = {
					value = "estate_power(estate_type:crown_estate)"
					multiply = 5
				}
				add = {
					value = government_power
					divide = 2
				}
			}
		}
		set_variable = {
			name = num_rebelling_locations
			value = 0
		}
		if = {
			limit = {
				var:current_ruler_power_variable < 100
			}
			while = {
				limit = { var:current_ruler_power_variable < 100 }
				ordered_owned_location = {
					limit = {
						is_capital = no
						NOT = { has_variable = already_supports_rebel_variable }
					}
					order_by = {
						value = population
						multiply = -1
					}
					max = 1
					owner = {
						change_variable = {
							name = current_ruler_power_variable
							add = 2
						}
						change_variable = {
							name = num_rebelling_locations
							add = 1
						}
					}
					set_variable = {
						name = already_supports_rebel_variable
						months = 2
					}
					every_pop = {
						limit = {
							owner = root
						}
						add_pop_satisfaction = pop_satisfaction_extreme_penalty
						change_pop_allegiance = scope:target_rebel
					}
				}
			}
		}

		scope:rebellion_ruler = {
			change_character_allegiance = scope:target_rebel
		}

		if = {
			limit = {
				exists = scope:rebellion_heir
			}
			scope:current_ruler = {
				change_character_allegiance = scope:target_rebel
			}
		}
	}

	option = {
		name = flavor_ira.46.a

		set_new_ruler = scope:rebellion_ruler

		add_stability = stability_severe_penalty

		scope:current_ruler = {
			banish_character = yes
		}

		destroy_rebel = scope:target_rebel
	}

	option = {
		name = flavor_ira.46.b

		scope:target_rebel = {
			add_rebel_progress = 0.75
		}
	}

	after = {
		remove_variable = ira_qajar_dynasty_rebellion_flag
		remove_variable = current_ruler_power_variable
		remove_variable = num_rebelling_locations
	}
}

#Rise of the Safavid Order as a country
flavor_ira.47 = {
	type = country_event
	title = flavor_ira.47.title
	desc = flavor_ira.47.desc

	fire_only_once = yes

	trigger = {
		current_year >=	1390
		current_year <= 1420
		owns = location:ardabil
		location:ardabil = {
			is_capital = no
		}
		religious_school = religious_school:safavid_school
		NOT = { country_exists = c:ABL }
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		location:ardabil = {
			save_scope_as = target_location
			area ?= {
				save_scope_as = target_area
			}
			create_dynasty_from_location = safavid_dynasty
		}

		create_character = {
			first_name = name_xwaja
			dynasty = dynasty:safavid_dynasty
			estate = estate_type:clergy_estate
			religion = religion:shia
			culture = culture:kurdish_culture
			birth_location = location:diyarbekir
			birth_date = 1370.5.12
			adm = 50
			dip = 40
			mil = 75
			save_scope_as = target_character
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_ira.47.a
		custom_tooltip = {
			text = flavor_ira.47.a.tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
						is_capital = no
					}
					add_core = c:ABL
				}
			}

			create_country_from_cores_in_our_locations = c:ABL

			c:ABL = {
				set_new_ruler = scope:target_character
				make_subject_of = {
					target = root
					type = subject_type:vassal
				}

				every_owned_location = {
					change_integration_level = core
				}

				change_culture = culture:farsi_culture
			}
		}
	}

	option = {
		name = flavor_ira.47.b

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_tiny_move_to_right }

		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_extreme_penalty
		}

		scope:target_character = {
			banish_character = yes
		}
	}

	option = {
		name = flavor_ira.47.c
		custom_tooltip = {
			text = flavor_ira.47.a.tt

			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					add_core = c:ABL
				}
			}

			create_country_from_cores_in_our_locations = c:ABL

			c:ABL = {
				set_new_ruler = scope:target_character
				make_subject_of = {
					target = root
					type = subject_type:vassal
				}

				every_owned_location = {
					change_integration_level = core
				}

				change_culture = culture:farsi_culture
			}
		}

		change_player = c:ABL
	}
}

#Ardabil militarism
flavor_ira.48 = {
	type = country_event
	title = flavor_ira.48.title
	desc = flavor_ira.48.desc

	dynamic_historical_event = {
		tag = ABL
		from = 1440.1.1
		to = 1500.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		ruler_or_regent ?= {
			mil >= 80
		}
		religious_school = religious_school:safavid_school
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.48.a

		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_move_to_left
		}

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_left
		}

		add_army_tradition = army_tradition_severe_bonus
	}

	option = {
		name = flavor_ira.48.b

		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_move_to_right
		}

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_right
		}
	}
}

#Christian Treatment
flavor_ira.49 = {
	hide_portraits = yes
	type = country_event
	title = flavor_ira.49.title
	desc = flavor_ira.49.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1580.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		"religion_group_percentage_in_country(religion_group:christian)" > 0.05
		"religion_group_percentage_in_country(religion_group:christian)" < 0.15
		religion.group = religion_group:muslim
		societal_value:spiritualist_vs_humanist < -20
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		random_present_religion_in_country = {
			limit = {
				group = religion_group:christian
			}
			save_scope_as = target_religion
		}

		create_character = {
			estate = estate_type:dhimmi_estate
			mil = {
				40
				80
			}
			adm = {
				40
				80
			}
			dip = {
				40
				80
			}
			religion = scope:target_religion
			age = 30
			save_scope_as = target_character
			create_in_limbo = yes
		}

		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_ira.49.a

		custom_tooltip = {
			text = ira_convert_christian_people_tt
			every_pop = {
				limit = {
					owner = root
					religion.group = religion_group:christian
				}
				random_list = {
					35 = {
						split_pop = {
							fraction = 0.3
							religion = root.religion
						}
					}
					30 = {
						split_pop = {
							fraction = 0.4
							religion = root.religion
						}
					}
					25 = {
						split_pop = {
							fraction = 0.45
							religion = root.religion
						}
					}
					20 = {
						split_pop = {
							fraction = 0.5
							religion = root.religion
						}
					}
				}
				add_pop_satisfaction = pop_satisfaction_extreme_penalty
			}
		}

		change_societal_value = {
			type = spiritualist_vs_humanist
			value = societal_value_move_to_left
		}

		scope:target_character = {
			banish_character = yes
		}
	}

	option = {
		name = flavor_ira.49.b

		custom_tooltip = {
			text = ira_happier_christians_tt
			every_pop = {
				limit = {
					owner = root
					religion.group = religion_group:christian
				}
				add_pop_satisfaction = pop_satisfaction_extreme_bonus
			}
		}

		scope:target_character = {
			move_country = root
		}
	}
}

#Rise of the Safavids
flavor_ira.50 = {
	type = country_event
	title = flavor_ira.50.title
	desc = flavor_ira.50.desc

	dynamic_historical_event = {
		tag = ABL
		from = 1501.1.1
		to = 1560.1.1
		monthly_chance = 2
	}

	fire_only_once = yes

	trigger = {
		ruler_or_heir_if_regent ?= {
			has_dynasty = yes
			dynasty ?= dynasty:safavid_dynasty
			mil >= 75
		}

		country_rank_level = 1
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_ira.50.a

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_left
		}

		ruler_or_regent ?= {
			add_character_modifier = {
				mode = add
				modifier = ira_safavid_ambitions
				years = -1
			}
		}
	}

	option = {
		name = flavor_ira.50.b

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_right
		}

		add_all_estate_satisfaction = {
			value = estate_satisfaction_extreme_bonus
		}
	}
}

#Qajar Art

flavor_ira.51 = {
	type = country_event
	title = flavor_ira.51.title
	desc = flavor_ira.51.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1700.1.1
		to = 1821.1.1
		monthly_chance = 3
	}

	fire_only_once = yes

	trigger = {
		government_type = government_type:monarchy
		ruler_or_regent ?= {
			has_dynasty = yes
			dynasty ?= dynasty:qajar_dynasty
			OR = {
				dip >= 90
				has_trait = scholar
			}
		}
	}
	
	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	
	option = {
		name = flavor_ira.51.a

		culture ?= {
			add_cultural_influence = cultural_influence_severe_bonus
			add_cultural_tradition = cultural_tradition_severe_bonus
		}
	}

	option = {
		name = flavor_ira.51.b

		add_prestige = prestige_extreme_bonus

		add_all_estate_satisfaction = {
			value = estate_satisfaction_extreme_bonus
		}
	}

	option = {
		name = flavor_ira.51.c

		create_character = {
			adm = {
				30
				70
			}
			dip = {
				30
				70
			}
			mil = {
				30
				70
			}
			artist = painter
			artist_skill = {
				0.6
				0.9
			}
			age = 30
		}

		add_legitimacy = legitimacy_extreme_bonus
	}
}

### Persia-Ottoman Events ###
#Turko-Persian Tension
flavor_ira.1000 = {
	type = country_event
	title = flavor_ira.1000.title
	desc = flavor_ira.1000.desc
	historical_info = flavor_ira.1000.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1500.1.1
		to = 1700.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	trigger = {
		has_ruler = yes
		trigger_if = {
			limit = {
				is_situation_active = situation:rise_of_the_ottomans
				situation:rise_of_the_ottomans = { has_variable = strongest_beylik_variable }
			}
			situation:rise_of_the_ottomans = {
				var:strongest_beylik_variable = {
					has_ruler = yes
					is_neighbor_of = ROOT
					is_free_or_tributary_trigger = yes
					NOT = { is_allied_with = { target = ROOT } }
					NOT = { is_at_war_with = ROOT }
					OR = {
						is_rival_of = ROOT
						is_enemy_of = ROOT
						country_rank_level > 2
					}
				}
			}
		}
		trigger_else = {
			c:TUR = {
				has_ruler = yes
				is_neighbor_of = ROOT
				is_free_or_tributary_trigger = yes
				NOT = { is_allied_with = { target = ROOT } }
				NOT = { is_at_war_with = ROOT }
				OR = {
					is_rival_of = ROOT
					is_enemy_of = ROOT
					country_rank_level > 2
				}
			}
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		save_scope_as = root_country
		get_ottomans_equivalent_scope = {
			save_scope_as = target_country
		}
		ruler ?= { save_scope_as = root_character }
		scope:target_country = { ruler ?= { save_scope_as = target_character } }
	}

	option = {
		name = flavor_ira.1000.a
		historical_option = yes
		add_historical_rival_scripted = {
			target = scope:target_country
			trigger_recipient_event = no
		}
		custom_tooltip = flavor_ira.1000.a.tt
		add_effect_scaling_with_societal_value = {
			societal_value = belligerent_vs_conciliatory
			effect = stability
			operator = divide
			value = 10
		}
		change_societal_value = { type = belligerent_vs_conciliatory value = societal_value_large_move_to_left }
		scope:target_country = {
			show_as_tooltip = {
				add_historical_rival_scripted = {
					target = scope:root_country
			trigger_recipient_event = no
				}
			}
			trigger_event_silently = flavor_ira.1001
		}
	}
	option = {
		name = flavor_ira.1000.b
		add_effect_scaling_with_societal_value = {
			societal_value = belligerent_vs_conciliatory
			effect = stability
			operator = divide
			value = -5
		}
		change_societal_value = { type = belligerent_vs_conciliatory value = societal_value_large_move_to_right }
	}
}
flavor_ira.1001 = {
	type = country_event
	title = flavor_ira.1000.title
	desc = flavor_ira.1000.desc
	historical_info = flavor_ira.1000.historical_info
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	option = {
		name = flavor_ira.1001.a
		add_historical_rival_scripted = {
			target = scope:root_country
			trigger_recipient_event = no
		}
	}
}

#Qizilbash Uprisings in Anatolia
flavor_ira.1010 = {
	hide_portraits = yes
	type = country_event
	title = flavor_ira.1010.title
	desc = flavor_ira.1010.desc
	historical_info = flavor_ira.1010.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1450.1.1
		to = 1550.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	trigger = {
		religion = religion:shia
		has_historical_rivals = yes
		any_historical_rival = {
			country_exists = this
			is_neighbor_of = ROOT
			religion = religion:sunni
			NOT = { is_at_war_with = ROOT }
			any_owned_location = {
				dominant_religion = religion:shia
			}
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		save_scope_as = root_country
		random_historical_rival = {
			limit = {
				country_exists = this
				is_neighbor_of = ROOT
				religion = religion:sunni
				NOT = { is_at_war_with = ROOT }
				any_owned_location = {
					dominant_religion = religion:shia
				}
			}
			save_scope_as = target_country
			random_owned_location = {
				limit = { dominant_religion = religion:shia }
				save_scope_as = target_location
			}
			create_rebel = {
				category = religious
				religion = religion:shia
				name = qizilbash_uprising
				save_scope_as = target_rebel
			}
		}
	}

	option = {
		name = flavor_ira.1010.a
		historical_option = yes
		qizilbash_estate_satisfaction = { value = estate_satisfaction_severe_bonus }
		add_stability = stability_mild_bonus
		change_gold_effect = { scale = -6 }
		support_rebel = scope:target_rebel
		scope:target_country = {
			trigger_event_non_silently = { id = flavor_ira.1011 }
		}
	}
	option = {
		name = flavor_ira.1010.b
		qizilbash_estate_satisfaction = { value = estate_satisfaction_severe_penalty }
		add_stability = stability_severe_penalty
		reverse_add_opinion = { target = scope:target_country modifier = opinion_did_not_support_rebels }
		hidden_effect = {
			destroy_rebel = scope:target_rebel
		}
	}
}
flavor_ira.1011 = {
	type = country_event
	title = flavor_ira.1011.title
	desc = flavor_ira.1011.desc
	historical_info = flavor_ira.1010.historical_info
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		scope:target_location = {
			province = {
				save_scope_as = target_province
			}
		}
	}
	# Crush the Shia rebellion
	option = {
		name = flavor_ira.1011.a
		add_stability = stability_ultimate_penalty
		scope:target_province = {
			custom_tooltip = {
				text = flavor_ira.1011.a.tt
				every_location_in_province = {
					every_pop = {
						limit = { religion = religion:shia }
						add_pop_size = {
							value = pop_size
							multiply = -0.1
						}
						split_pop = {
							fraction = 1.0
							religion = religion:sunni
						}
					}
				}
			}
		}
		destroy_rebel = scope:target_rebel
		scope:root_country = {
			add_opinion = { target = ROOT modifier = opinion_crushed_shiite_revolt }
		}
	}
	# We can wait them out.
	option = {
		name = flavor_ira.1011.b
		historical_option = yes
		scope:target_province = {
			every_location_in_province = {
				every_pop = {
					limit = { religion = religion:shia }
					change_pop_allegiance = scope:target_rebel
				}
			}
		}
		scope:target_rebel = {
			add_rebel_progress = 0.4
		}
	}
	# Give in to their demands.
	option = {
		name = flavor_ira.1011.c
		destroy_rebel = scope:target_rebel
		add_prestige = prestige_extreme_penalty
		custom_tooltip = {
			text = flavor_ira.1011.c.tt
			scope:target_province = {
				area = {
					every_location_in_area = {
						limit = { owner = ROOT }
						change_control = control_ultimate_penalty
					}
				}
			}
		}
	}
}

# Murad III's campaigns against Persia
flavor_ira.1020 = {
	type = country_event
	title = flavor_ira.1020.title
	desc = flavor_ira.1020.desc
	historical_info = flavor_ira.1020.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = TUR
		from = 1550.1.1
		to = 1650.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	trigger = {
		has_ruler = yes
		has_historical_rivals = yes
		country_exists = c:IRA
		c:IRA = {
			is_historical_rival_of = ROOT
			is_neighbor_of = ROOT
			NOT = { religion = ROOT.religion }
			NOT = { is_at_war_with = ROOT }
			opinion = {
				target = ROOT
				value <= -50
			}
		}
		opinion = {
			target = c:IRA
			value <= -50
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		save_scope_as = root_country
		ruler_or_regent ?= { save_scope_as = root_character }
		c:IRA = {
			save_scope_as = target_country
			ruler_or_regent ?= { save_scope_as = target_character }
			random_owned_location = {
				limit = { is_neighbor_of = ROOT }
				province = { save_scope_as = target_province }
			}
		}
	}
	# Fan the Flames of War
	option = {
		name = flavor_ira.1020.a
		historical_option = yes
		add_effect_scaling_with_societal_value = {
			societal_value = belligerent_vs_conciliatory
			effect = stability
			operator = divide
			value = -10
		}
		add_casus_belli = {
			target = scope:target_country
			type = casus_belli:cb_conquer_province
			province = scope:target_province
		}
		scope:target_country = {
			add_opinion = { target = ROOT modifier = border_aggression }
			trigger_event_silently = { id = flavor_ira.1021 days = 10 }
		}
	}
	# Maintain Status quo
	option = {
		name = flavor_ira.1020.b
		add_prestige = prestige_weak_penalty
	}
	# Seek reconciliation
	option = {
		name = flavor_ira.1020.c
		add_diplomats = diplomats_weak_penalty
		add_effect_scaling_with_societal_value = {
			societal_value = belligerent_vs_conciliatory
			effect = stability
			operator = divide
			value = 10
		}
		remove_historical_rival_scripted = {
			target = scope:target_country
			trigger_recipient_event = yes
		}
		scope:target_country = {
			add_opinion = { target = ROOT modifier = opinion_attempts_of_reconciliation }
		}
	}
}
flavor_ira.1021 = {
	type = country_event
	title = flavor_ira.1020.title
	desc = flavor_ira.1020.desc
	historical_info = flavor_ira.1020.historical_info
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		scope:root_country = {
			random_owned_location = {
				limit = { is_neighbor_of = ROOT }
				province = {
					save_scope_as = target_province
				}
			}
		}
	}
	option = {
		name = flavor_ira.1021.a
		historical_option = yes
		add_effect_scaling_with_societal_value = {
			societal_value = belligerent_vs_conciliatory
			effect = stability
			operator = divide
			value = -10
		}
		add_casus_belli = {
			target = scope:root_country
			type = casus_belli:cb_conquer_province
			province = scope:target_province
		}
		add_all_estate_satisfaction = { value = estate_satisfaction_severe_bonus }
		scope:root_country = {
			add_opinion = { target = root modifier = border_aggression }
		}
	}
	option = {
		name = flavor_ira.1021.b
		add_prestige = prestige_weak_penalty
	}
	option = {
		name = flavor_ira.1021.c
		add_diplomats = diplomats_weak_penalty
		add_effect_scaling_with_societal_value = {
			societal_value = belligerent_vs_conciliatory
			effect = stability
			operator = divide
			value = 10
		}
		remove_historical_rival_scripted = {
			target = scope:root_country
			trigger_recipient_event = yes
		}
		scope:root_country = {
			add_opinion = { target = ROOT modifier = opinion_attempts_of_reconciliation }
		}
	}
}


### Ghilman Events ###
# Establishment of the Ghilman
flavor_ira.1100 = {
	type = country_event
	title = flavor_ira.1100.title
	desc = flavor_ira.1100.desc
	dynamic_historical_event = {
		tag = IRA
		from = 1550.1.1
		to = 1650.1.1
		monthly_chance = 5
	}
	fire_only_once = yes
	trigger = {
		has_ruler = yes
		has_advance = ira_the_ghilman
		total_effective_building_levels:ghilman_barracks > 0
		country_has_estate = estate_type:tribes_estate
	}
	illustration_tags = {
        10 = armed
        10 = exterior
    }
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:peasants_estate }
		ruler ?= { save_scope_as = target_character }
	}
	option = {
		name = flavor_ira.1100.a
		add_stability = stability_mild_bonus
		set_variable = { name = ira_ghilman_event value = scope:target_character }
	}
}
#The Aristocratic Split
flavor_ira.1101 = {
	hide_portraits = yes
	type = country_event
	title = flavor_ira.1101.title
	desc = flavor_ira.1101.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = IRA
		from = 1550.1.1
		to = 1800.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	trigger = {
		has_variable = ira_ghilman_event
		has_advance = ira_the_qizilbash
		has_advance = ira_the_ghilman
		country_has_estate = estate_type:tribes_estate
		country_has_estate = estate_type:nobles_estate
		has_ruler = yes
		NOT = { ruler = var:ira_ghilman_event }
		ruler ?= {
			total_abilities >= 200
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		save_scope_as = target_country
		var:ira_ghilman_event = { save_scope_as = origin_character }
		ruler ?= { save_scope_as = target_character }
		select_insignificant_gov_reform = { save_scope_as = target_reform }
	}
	after = {
		remove_variable = ira_ghilman_event
	}
	option = {
		name = flavor_ira.1101.a
		historical_option = yes
		unlock_government_reform_effect = {
			type = divided_persian_aristocracy
		}
		if = {
			limit = { exists = scope:target_reform }
			remove_reform = scope:target_reform
		}
		add_reform = government_reform:divided_persian_aristocracy
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_severe_penalty }
		add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_severe_penalty }
		change_societal_value = { type = centralization_vs_decentralization value = societal_value_minor_move_to_right }
	}
	option = {
		name = flavor_ira.1101.b
		unlock_government_reform_effect = {
			type = divided_persian_aristocracy
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_bonus }
		add_estate_satisfaction = { type = estate_type:tribes_estate value = estate_satisfaction_weak_bonus }
		change_societal_value = { type = aristocracy_vs_plutocracy value = societal_value_large_move_to_left }
	}
}


### Shia Migration Events ###
#[ROOT.GetCountry.GetAdjectiveWithNoTooltip] [ShowReligionNameWithNoTooltip('shia')]
flavor_ira.1200 = {
	type = country_event
	title = flavor_ira.1200.title
	desc = flavor_ira.1200.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1337.1.1
		to = 1630.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		has_ruler = yes
		NOT = { religion = religion:shia }
		OR = {
			any_owned_location = { dominant_religion = religion:shia }
			ruler = { religion = religion:shia }
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		ruler = { save_scope_as = target_ruler }
	}

	option = {
		name = flavor_ira.1200.a
		change_religion = religion:shia
		change_religion_for_ruler_and_family = { country = ROOT religion = religion:shia }
		add_country_modifier = { modifier = ira_shia_conversion_policy years = modifier_duration_years_normal mode = add_and_extend }
		trigger_event_silently = { id = flavor_ira.1201  months = { 12 60 } }
		trigger_event_silently = { id = flavor_ira.1202  months = { 12 60 } }
	}
	option = {
		name = flavor_ira.1200.b
		add_stability = stability_extreme_bonus
	}
}
#The Faith of the [ShowReligionAdjectiveWithNoTooltip('sunni')] [ROOT.GetCountry.GetGovernment.GetEstateNameWithNoTooltip('clergy_estate')]
flavor_ira.1201 = {
	type = country_event
	title = flavor_ira.1201.title
	desc = flavor_ira.1201.desc

	illustration_tags = {
        10 = angry
        10 = interior
    }
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}
	option = {
		name = flavor_ira.1201.a
		add_country_modifier = { modifier = ira_pragmatic_ulema years = modifier_duration_years_normal mode = add_and_extend }
	}
	option = {
		name = flavor_ira.1201.b
		add_country_modifier = { modifier = ira_conversion_of_the_clergy years = modifier_duration_years_short mode = add_and_extend }
	}
}
#[ShowReligionAdjectiveWithNoTooltip('shia')] Brain Drain
flavor_ira.1202 = {
	type = country_event
	fire_only_once = yes
	title = flavor_ira.1202.title
	desc = flavor_ira.1202.desc

	option = {
		name = flavor_ira.1202.a
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_tiny_move_to_right }
		custom_tooltip = {
			text = flavor_ira.1202.a.tt
			every_known_country = {
				limit = {
					OR = {
						religion = religion:shia
						any_owned_location = {
							dominant_religion = religion:shia
						}
					}
				}
				add_opinion = { target = c:IRA modifier = opinion_irritated }
			}
		}
		add_country_modifier = { modifier = ira_shiite_immigration years = modifier_duration_years_long mode = add_and_extend }
	}

	option = {
		name = flavor_ira.1202.b
		add_prestige = prestige_mild_bonus
		add_country_modifier = { modifier = ira_self_sufficiency years = modifier_duration_years_long mode = add_and_extend }
	}
}


### Expansion of Isfahan Events ###
#Isfahan
flavor_ira.1300 = {
	type = country_event
	title = flavor_ira.1300.title
	desc = flavor_ira.1300.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1580.1.1
		to = 1630.1.1
		monthly_chance = 5
	}

	fire_only_once = yes

	trigger = {
		owns = location:isfahan
		location:isfahan = {
			integration_level = core
			this != root.capital
		}
		religion = religion:shia
		gold >= { value = root.monthly_income_trade_and_tax multiply = 1.80 }
		at_war = no
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
		location:isfahan = { save_scope_as = target_location }
	}

	option = {
		name = flavor_ira.1300.a
		change_gold_effect = { scale = -1.80 }
		set_capital = location:isfahan
		location:isfahan = {
			add_location_modifier = { modifier = ira_building_isfahan years = modifier_duration_years_normal mode = add_and_extend }
		}
		trigger_event_silently = { id = flavor_ira.1301 months = { 120 240 } }
	}
	option = {
		name = flavor_ira.1300.b
		add_stability = stability_extreme_bonus
	}
}
#Isfahan Nesf-e-Jahān
flavor_ira.1301 = {
	type = country_event
	fire_only_once = yes
	title = flavor_ira.1301.title
	desc = flavor_ira.1301.desc

	trigger = {
		owns = location:isfahan
		location:isfahan = {
			integration_level = core
			this = root.capital
		}
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:isfahan = {
			save_scope_as = target_location
			if = {
				limit = {
					NOT = { location_rank = location_rank:city }
				}
				change_location_rank = location_rank:city
			}
		}
	}

	option = {
		name = flavor_ira.1301.a
		add_prestige = prestige_extreme_bonus
		location:isfahan = {
			add_location_modifier = { modifier = ira_isfahan_maidan months = modifier_duration_permanent mode = add_and_extend }
		}
	}
}

####
# European Diplomacy Events
####

#Reaching out to a Rival of the Ottomans
flavor_ira.1400 = {
	hide_portraits = yes
	type = country_event
	title = flavor_ira.1400.title
	desc = flavor_ira.1400.desc

	dynamic_historical_event = {
		tag = IRA
		from = 1520.1.1
		to = 1650.1.1
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		trigger_if = {
			limit = {
				is_situation_active = situation:rise_of_the_ottomans
				situation:rise_of_the_ottomans = { has_variable = strongest_beylik_variable }
			}
			situation:rise_of_the_ottomans = {
				var:strongest_beylik_variable = {
					has_ruler = yes
					is_neighbor_of = ROOT
					is_free_or_tributary_trigger = yes
					NOT = { is_allied_with = { target = ROOT } }
					NOT = { is_at_war_with = ROOT }
					OR = {
						is_rival_of = ROOT
						is_enemy_of = ROOT
						country_rank_level > 2
					}
					any_rival = {
						exists = capital
						capital.continent = continent:europe
						is_subject = no
					}
				}
			}
		}
		trigger_else = {
			c:TUR = {
				has_ruler = yes
				is_neighbor_of = ROOT
				is_free_or_tributary_trigger = yes
				NOT = { is_allied_with = { target = ROOT } }
				NOT = { is_at_war_with = ROOT }
				OR = {
					is_rival_of = ROOT
					is_enemy_of = ROOT
					country_rank_level > 2
				}
				any_rival = {
					exists = capital
					capital.continent = continent:europe
					is_subject = no
				}
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = {
				is_situation_active = situation:rise_of_the_ottomans
				situation:rise_of_the_ottomans = { has_variable = strongest_beylik_variable }
			}
			situation:rise_of_the_ottomans = {
				var:strongest_beylik_variable = {
					save_scope_as = shared_rival
				}
			}
		}
		else = {
			c:TUR = {
				save_scope_as = shared_rival
			}
		}

		scope:shared_rival = {
			ordered_rival = {
				order_by = great_power_score
				limit = {
					exists = capital
					capital.continent = continent:europe
					is_subject = no
				}
				max = 1
				save_scope_as = target_country
				ruler_or_regent ?= {
					save_scope_as = target_character
				}
			}
		}

		save_scope_as = target_country2
		ruler_or_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_ira.1400.a

		scope:target_country = {
			trigger_event_non_silently = flavor_ira.1401
		}

		transfer_yearly_gold = {
			value = 0.5
			target = scope:target_country
		}
	}

	option = {
		name = flavor_ira.1400.b

		change_societal_value = {
			type = outward_vs_inward
			value = societal_value_move_to_right
		}
	}
}

flavor_ira.1401 = {
	type = country_event
	title = flavor_ira.1401.title
	desc = flavor_ira.1401.desc
	major = yes

	major_trigger = {
		this = scope:target_country2
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = { #Accept these ties
		name = flavor_ira.1401.a

		create_relation = {
			first = scope:target_country
			second = scope:target_country2
			type = relation_type:alliance
		}

		add_opinion_mutual_effect = {
			modifier = ira_increased_ties
			target = scope:target_country
		}

		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_move_to_right
		}
	}

	option = { #Visit the Persian capital
		name = flavor_ira.1401.b

		scope:target_country2 = {
			trigger_event_non_silently = flavor_ira.1402
		}
	}

	option = { #Reject any alliance with the Persians
		name = flavor_ira.1401.c

		add_opinion_mutual_effect = {
			modifier = ira_rejected_persian_diplomats
			target = scope:target_country
		}

		add_prestige = prestige_mild_bonus

		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_move_to_left
		}
	}
}

flavor_ira.1402 = {
	type = country_event
	title = flavor_ira.1402.title
	desc = flavor_ira.1402.desc
	major = yes

	major_trigger = {
		this = scope:target_country
	}
	
	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	
	option = {
		name = flavor_ira.1402.a

		add_opinion_mutual_effect = {
			modifier = ira_visited_capital
			target = scope:target_country
		}
	}
}