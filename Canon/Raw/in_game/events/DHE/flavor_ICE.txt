namespace = flavor_ice

# which bishopric?
flavor_ice.10 = {
	type = country_event
	fire_only_once = yes	
	title = flavor_ice.10.title
	desc = flavor_ice.10.desc
	trigger = {
		tag = ICE
		is_subject = yes
		religion = religion:catholic
		location:holar = {
			owner = ROOT
			num_pop_type:clergy > 0.010
			dominant_religion = religion:catholic
		}
		location:skalholt = {
			owner = ROOT
			num_pop_type:clergy > 0.010
			dominant_religion = religion:catholic
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		location:holar = { 
			save_scope_as = target_location
		}
		location:skalholt = { save_scope_as = skalholt }
		overlord = { save_scope_as = overlord }
	}

	# support local
	option = {
		name = flavor_ice.10.a
		scope:target_location = {
			change_prosperity = prosperity_severe_bonus
		}
		overlord = {
			add_opinion = { target = root modifier = opinion_opposed_our_bishop }
		}
	}

	# support overlord
	option = {
		name = flavor_ice.10.b
		scope:skalholt = {
			change_prosperity = prosperity_severe_bonus
		}
		overlord = {
			add_opinion = { target = root modifier = opinion_supported_our_bishop }

			ordered_core_location = {
				order_by = { value = num_pop_type:clergy multiply = 1 }
				limit = {
					dominant_religion = root.religion
					dominant_culture = root.overlord.culture
				}
				max = 1

				add_migration = {
					owner = prev
					from = province_definition
					to = scope:skalholt.province_definition
					type = pop_type:clergy
					culture = root.overlord.culture
					religion = root.religion
					amount = 0.005
					months = 12
				}
			}
		}
	}
}


scripted_trigger location_ice_11_trigger = {
	area = area:iceland_area
	dominant_culture = culture:icelandic
	NOT = { has_building = building_type:parish_church }
	OR = {
		topography = mountains
		topography = hills
	}
}

# Huldufolk
flavor_ice.11 = {
	type = country_event
	fire_only_once = yes	
	title = flavor_ice.11.title
	desc = flavor_ice.11.desc
	trigger = {
		culture = culture:icelandic
		religion.group = religion_group:christian
		any_owned_location = {
			location_ice_11_trigger = yes
		}
	}

	illustration_tags = {
        10 = angry
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:clergy_estate }
		random_owned_location = {
			limit = {
				location_ice_11_trigger = yes
			}
			save_scope_as = target_location
		}
	}

	# abandon church
	option = {
		name = flavor_ice.11.a

		add_estate_satisfaction = { type = estate_type:peasants_estate 
			value = estate_satisfaction_mild_bonus
		}

		add_estate_satisfaction = { type = estate_type:clergy_estate 
			value = estate_satisfaction_mild_penalty
		}
	}

	# build church
	option = {
		name = flavor_ice.11.b
		scope:target_location = { 
			construct_building =
			{
				building_type = building_type:parish_church
				cost_multiplier = 0
				cost_multiplier_reason = "clergy_cheap_sponsorship"
			} 
		}

		culture = { add_cultural_tradition = cultural_tradition_ultimate_penalty }

		add_estate_satisfaction = { type = estate_type:clergy_estate 
			value = estate_satisfaction_mild_bonus
		}

		add_estate_satisfaction = { type = estate_type:peasants_estate 
			value = estate_satisfaction_mild_penalty
		}
	}
}