namespace = flavor_tim_governor

flavor_tim_governor.1 = {
	type = country_event
	title = flavor_tim_governor.1.title
	desc = flavor_tim_governor.1.desc

	trigger = {
		OR = {
			has_reform = government_reform:soyurghal_governor_banished_reform
			has_reform = government_reform:soyurghal_governor_effective_governor_reform
			has_reform = government_reform:soyurghal_governor_reform
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

    immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		overlord ?= {
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character2
			}
		}

		previous_ruler ?= {
			save_scope_as = target_character3
		}

		capital ?= {
			area = {
				save_scope_as = target_area
			}
		}

		save_scope_as = prev_country
	}

	option = {
		name = flavor_tim_governor.1.a

		overlord ?= {
			annex_country = {
				country = root
			}
		}
	}

	option = { #Banished Governor
		name = flavor_tim_governor.1.b

		trigger = {
			has_reform = government_reform:soyurghal_governor_banished_reform
			ruler != overlord.ruler
		}

		overlord ?= {
			trigger_event_non_silently = {
				id = flavor_tim_governor.2
			}
		}
	}
}

#Extension of Banished Governor
flavor_tim_governor.2 = {
	type = country_event
	title = flavor_tim_governor.2.title
	desc = flavor_tim_governor.2.desc

	option = {
		name = flavor_tim_governor.2.a

		annex_country = {
			country = scope:prev_country
		}
	}

	option = {
		name = flavor_tim_governor.2.b

		custom_tooltip = tim_governor_maintain_governance_tt

		scope:prev_country = {
			add_liberty_desire = -15
		}
	}
}

flavor_tim_governor.3 = {
	type = country_event
	title = flavor_tim_governor.3.title
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					exists = scope:target_character3
				}
				desc = flavor_tim_governor.3.desc.a
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = flavor_tim_governor.3.desc.b
			}
		}
	}

	trigger = {
		OR = {
			has_reform = government_reform:soyurghal_governor_banished_reform
			has_reform = government_reform:soyurghal_governor_effective_governor_reform
			has_reform = government_reform:soyurghal_governor_reform
		}
		overlord.ruler_or_regent ?= {
			has_dynasty = yes
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent ?= {
			save_scope_as = target_character2
		}

		save_scope_as = prev_country

		overlord = {
			save_scope_as = target_country
			ruler_or_regent ?= {
				save_scope_as = target_character
			}

			random_character ?= {
				limit = {
					in_cabinet = no
					is_adult = yes
					is_legally_male = yes
					NOT = { dynasty ?= scope:target_character.dynasty }
				}
				save_scope_as = target_character3
			}
		}
	}

	option = {
		name = flavor_tim_governor.3.a

		show_as_tooltip = {
			scope:target_country = {
				transfer_yearly_manpower = {
					target = root
					value = 1.5
				}
			}

			add_liberty_desire = -20
		}

		set_variable = timurid_governor_demand_manpower

		custom_tooltip = {
			text = tim_governor_overlord_must_accept_tt
			scope:target_country = {
				trigger_event_silently = flavor_tim_governor.4
			}
		}
	}

	option = {
		name = flavor_tim_governor.3.b

		show_as_tooltip = {
			scope:target_country = {
				transfer_yearly_gold = {
					target = root
					value = 1.5
				}
			}

			add_liberty_desire = -20
		}

		set_variable = timurid_governor_demand_gold

		custom_tooltip = {
			text = tim_governor_overlord_must_accept_tt
			scope:target_country = {
				trigger_event_silently = flavor_tim_governor.4
			}
		}
	}

	option = {
		name = flavor_tim_governor.3.c

		trigger = {
			exists = scope:target_character3
		}

		show_as_tooltip = {
			scope:target_character3 = {
				move_country = ROOT
			}
			add_liberty_desire = -20
		}

		set_variable = timurid_governor_demand_character

		custom_tooltip = {
			text = tim_governor_overlord_must_accept_tt
			scope:target_country = {
				trigger_event_silently = flavor_tim_governor.4
			}
		}
	}

	option = {
		name = flavor_tim_governor.3.d

		custom_tooltip = timurid_governor_no_demand_tt
	}
}

flavor_tim_governor.4 = {
	type = country_event
	title = flavor_tim_governor.4.title
	desc = flavor_tim_governor.4.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_tim_governor.4.a

		trigger = {
			scope:prev_country ?= {
				has_variable = timurid_governor_demand_manpower
			}
		}

		transfer_yearly_manpower = {
			target = scope:prev_country
			value = 1.5
		}

		scope:prev_country = {
			add_liberty_desire = -20
		}

	}

	option = {
		name = flavor_tim_governor.4.b

		trigger = {
			scope:prev_country ?= {
				has_variable = timurid_governor_demand_gold
			}
		}

		transfer_yearly_gold = {
			target = scope:prev_country
			value = 1.5
		}

		scope:prev_country = {
			add_liberty_desire = -20
		}

	}

	option = {
		name = flavor_tim_governor.4.c

		trigger = {
			scope:prev_country ?= {
				has_variable = timurid_governor_demand_character
			}
		}

		scope:target_character3 = {
			move_country = scope:prev_country
		}
		scope:prev_country = {
			add_liberty_desire = -20
		}

	}

	option = {
		name = flavor_tim_governor.4.d

		scope:prev_country = {
			add_liberty_desire = 5
		}
	}
}

#Advisor arrives in court
flavor_tim_governor.5 = {
	type = country_event
	title = flavor_tim_governor.5.title
	desc = flavor_tim_governor.5.desc

	trigger = {
		OR = {
			has_reform = government_reform:soyurghal_governor_banished_reform
			has_reform = government_reform:soyurghal_governor_effective_governor_reform
			has_reform = government_reform:soyurghal_governor_reform
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_present_religion_in_country = {
			save_scope_as = target_religion
		}

		random_present_culture_in_country = {
			save_scope_as = target_culture
		}

		create_character = {
			estate = estate_type:nobles_estate
			culture = scope:target_culture
			religion = scope:target_religion
			female = no
			adm = {
				30
				70
			}
			dip = {
				30
				70
			}
			mil = {
				30
				70
			}
			save_scope_as = target_character
			create_in_limbo = yes
		}
	}

	#Hire them
	option = {
		name = flavor_tim_governor.5.a

		scope:target_character = {
			move_country = ROOT
		}

		add_prestige = prestige_mild_penalty

		change_gold_effect = { scale = -0.25 }
	}

	#Tutorship Extra Option
	option = {
		name = flavor_tim_governor.5.b

		ruler_or_heir_if_regent ?= {
			random_list = {
				33 = {
					add_adm = 5
				}
				33 = {
					add_dip = 5
				}
				33 = {
					add_mil = 5
				}
			}
		}

		scope:target_character = {
			move_country = ROOT
			add_character_modifier = {
				mode = add_and_extend
				modifier = refuses_to_serve_in_cabinet
				years = -1
			}
		}

		change_gold_effect = { scale = -0.5 }
	}

	#Banished Extra Option
	option = {
		name = flavor_tim_governor.5.c

		scope:target_character = {
			move_country = ROOT
			add_mil = 5
		}

		add_liberty_desire = 5
	}

	#Normal Governor Extra Option
	option = {
		name = flavor_tim_governor.5.d

		scope:target_character = {
			move_country = ROOT
			add_adm = 5
			add_character_modifier = {
				mode = add_and_extend
				modifier = block_leading_armies_or_navies
				years = -1
			}
		}

		change_gold_effect = { scale = -0.5	}
	}

	#Exile them
	option = {
		name = flavor_tim_governor.5.e

		scope:target_character = {
			banish_character = yes
		}
	}
}

#################
####Tutorship Governor Events
#################

flavor_tim_governor.6 = {
	type = country_event
	title = flavor_tim_governor.6.title
	desc = flavor_tim_governor.6.desc

	trigger = {
		has_ruler = yes
		has_reform = government_reform:soyurghal_governor_reform
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }

		capital.area = {
			save_scope_as = target_area
		}

		ruler ?= {
			save_scope_as = target_character
		}

		overlord = {
			save_scope_as = target_country
		}
	}

	option = {
		name = flavor_tim_governor.6.a

		custom_tooltip = {
			text = timurid_governor_increase_development_in_area_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					change_development = development_weak_bonus
				}
			}
		}

		change_gold_effect = { scale = -1 }
	}

	option = {
		name = flavor_tim_governor.6.b


		scope:target_character = {
			add_adm = 3
		}
	}
}

flavor_tim_governor.7 = {
	type = country_event
	title = flavor_tim_governor.7.title
	desc = flavor_tim_governor.7.desc

	trigger = {
		has_ruler = yes
		has_reform = government_reform:soyurghal_governor_reform
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
		capital.area = {
			save_scope_as = target_area
		}

		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_tim_governor.7.a

		custom_tooltip = {
			text = timurid_governor_decrease_development_in_area_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					change_development = development_weak_penalty
				}
			}
		}
	}

	option = {
		name = flavor_tim_governor.7.b

		change_gold_effect = { scale = -0.5 }

		add_stability = stability_mild_penalty
	}
}

#################
####Banished Governor Events
#################

flavor_tim_governor.8 = {
	type = country_event
	title = flavor_tim_governor.8.title
	desc = flavor_tim_governor.8.desc

	trigger = {
		has_ruler = yes
		has_reform = government_reform:soyurghal_governor_banished_reform
	}

	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		ruler ?= {
			save_scope_as = target_character
		}

		capital.area = {
			save_scope_as = target_area
		}

		overlord = {
			save_scope_as = target_country
		}
	}

	option = {
		name = flavor_tim_governor.8.a

		add_army_tradition = army_tradition_mild_bonus
		change_societal_value = {
			type = quality_vs_quantity
			value = societal_value_minor_move_to_right
		}

		change_gold_effect = { scale = -2 }
	}

	option = {
		name = flavor_tim_governor.8.b

		change_societal_value = {
			type = belligerent_vs_conciliatory
			value = societal_value_minor_move_to_right
		}
	}
}

flavor_tim_governor.9 = {
	type = country_event
	title = flavor_tim_governor.9.title
	desc = flavor_tim_governor.9.desc

	trigger = {
		has_ruler = yes
		has_reform = government_reform:soyurghal_governor_banished_reform
	}

	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:peasants_estate }
		ruler ?= {
			save_scope_as = target_character
		}

		capital.area = {
			save_scope_as = target_area
		}

		overlord = {
			save_scope_as = target_country
			previous_ruler ?= {
				save_scope_as = target_character2
			}
			ruler_or_heir_if_regent ?= {
				save_scope_as = new_ruler
			}
		}
	}

	option = {
		name = flavor_tim_governor.9.a

		ai_chance = {
			base = 50
			modifier = {
                factor = 0
                army_size_percentage < scope:target_country.army_size_percentage #Weaker governor should never rebel
            }
		}

		declare_war_with_cb = {
			target = scope:target_country
			type = casus_belli:cb_claim_timurids
		}

	}

	option = {
		name = flavor_tim_governor.9.b

		add_liberty_desire = -5

		ai_chance = {
			base = 100
		}
	}
}

flavor_tim_governor.10 = {
	type = country_event
	title = flavor_tim_governor.10.title
	desc = flavor_tim_governor.10.desc

	trigger = {
		has_ruler = yes
		has_reform = government_reform:soyurghal_governor_banished_reform
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_active_estate = {
			save_scope_as = target_estate
		}

		overlord = {
			save_scope_as = target_country
		}

		ruler ?= {
			save_scope_as = target_character
		}

		create_character = {
			estate = scope:target_estate
			culture = scope:target_country.culture
			religion = scope:target_country.religion
			birth_location = scope:target_country.capital
			min_age = 20
			adm = {
				20
				60
			}
			dip = {
				10
				40
			}
			mil = {
				40
				50
			}
			create_in_limbo = yes
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_tim_governor.10.a

		add_opinion = {
			modifier = tim_governor_welcomed_exiled_character
			target = scope:target_country
		}

		scope:target_country = {
			add_opinion = {
				modifier = tim_governor_welcomed_exiled_character
				target = root
			}
		}

		scope:target_character2 = {
			move_country = ROOT
		}

		add_liberty_desire = 5
	}

	option = {
		name = flavor_tim_governor.10.b

		add_liberty_desire = -5

		kill_character = scope:target_character2

		add_opinion = {
			modifier = tim_governor_executed_traitor
			target = scope:target_country
		}

		scope:target_country = {
			add_opinion = {
				modifier = tim_governor_executed_traitor
				target = root
			}
		}
	}
}

#################
####Normal Governor Events
#################

flavor_tim_governor.11 = {
	type = country_event
	title = flavor_tim_governor.11.title
	desc = flavor_tim_governor.11.desc

	trigger = {
		has_reform = government_reform:soyurghal_governor_effective_governor_reform

		ruler ?= {
			total_abilities > 125
		}
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		ruler ?= {
			save_scope_as = target_character
		}

		capital.area = {
			save_scope_as = target_area
		}
	}

	option = {
		name = flavor_tim_governor.11.a

		custom_tooltip = {
			text = timurid_governor_increase_prosperity_and_satisfaction_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					change_prosperity = prosperity_weak_bonus
					every_pop = {
						limit = {
							owner = root
						}
						add_pop_satisfaction = pop_satisfaction_mild_bonus
					}
				}
			}
		}
	}

	option = {
		name = flavor_tim_governor.11.b

		add_stability = stability_extreme_bonus
	}
}

flavor_tim_governor.12 = {
	type = country_event
	title = flavor_tim_governor.12.title
	desc = flavor_tim_governor.12.desc

	trigger = {
		has_reform = government_reform:soyurghal_governor_effective_governor_reform

		ruler ?= {
			total_abilities < 70
		}
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		capital.area = {
			save_scope_as = target_area
		}

		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_tim_governor.12.a

		custom_tooltip = {
			text = timurid_governor_decrease_prosperity_and_satisfaction_in_area_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
					}
					change_prosperity = prosperity_weak_penalty

					every_pop = {
						limit = {
							owner = root
						}
						add_pop_satisfaction = pop_satisfaction_mild_penalty
					}
				}
			}
		}
	}

	option = {
		name = flavor_tim_governor.12.b

		change_gold_effect = { scale = -0.5 }

		add_stability = stability_mild_penalty
	}
}

flavor_tim_governor.13 = {
	type = country_event
	title = flavor_tim_governor.13.title
	desc = flavor_tim_governor.13.desc

	trigger = {
		has_reform = government_reform:soyurghal_governor_effective_governor_reform

		ruler ?= {
			dip >= 60
		}

		num_of_non_rural_ports >= 2
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		random_port_in_country = {
			limit = {
				NOT = { location_rank = location_rank:rural_settlement }
			}
			save_scope_as = target_location
		}

		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_tim_governor.13.a

		scope:target_location = {
			change_development = development_mild_bonus
			change_prosperity = prosperity_mild_bonus
		}

		change_societal_value = {
			type = land_vs_naval
			value = societal_value_minor_move_to_right
		}
	}

	option = {
		name = flavor_tim_governor.13.b

		change_gold_effect = { scale = 2 }

		change_societal_value = {
			type = land_vs_naval
			value = societal_value_minor_move_to_left
		}
	}
}

flavor_tim_governor.14 = {
	type = country_event
	title = flavor_tim_governor.14.title
	desc = flavor_tim_governor.14.desc

	trigger = {
		has_reform = government_reform:soyurghal_governor_effective_governor_reform

		ruler ?= {
			mil >= 60
		}

		any_owned_location = {
			count >= 1
			NOT = {
				has_building = building_type:castle
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
		ruler ?= {
			save_scope_as = target_character
		}

		random_owned_location = {
			limit = {
				NOT = {
					has_building = building_type:castle
				}
			}
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_tim_governor.14.a

		scope:target_location = {
			construct_building = {
				building_type = building_type:castle
				cost_multiplier = 0.5
				cost_multiplier_reason = military_cheap_sponsorship
			}
		}

		change_societal_value = {
			type = offensive_vs_defensive
			value = societal_value_minor_move_to_right
		}
	}

	option = {
		name = flavor_tim_governor.14.b

		add_army_tradition = army_tradition_mild_bonus

		change_societal_value = {
			type = offensive_vs_defensive
			value = societal_value_move_to_left
		}
	}
}