namespace = flavor_azt

flavor_azt.70 = {
	type = country_event
	title = flavor_azt.70.title
	desc = flavor_azt.70.desc
	historical_info = flavor_azt.70.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1550.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		num_of_non_rural >= 3
		is_subject = no
		owns = location:tenochtitlan
		religion = religion:nahuatl
		num_subjects > 0
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		unlock_building_effect = { type = great_temple_of_tenochtitlan }
	}

	option = {
		name = flavor_azt.70.a

		location:tenochtitlan = {
			construct_building = {
				building_type = building_type:great_temple_of_tenochtitlan
				instant = yes
			}
		}
	}

	option = {
		name = flavor_azt.70.b

		trigger = {
			num_subjects > 2
		}

		location:tenochtitlan = {
			construct_building = {
				building_type = building_type:great_temple_of_tenochtitlan
				cost_multiplier = 0.5
				cost_multiplier_reason = subject_contribution_reason
				instant = yes
			}
		}

		ordered_subject = {
			order_by = total_population
			check_range_bounds = no
			max = 2
			add_liberty_desire = liberty_desire_mild_plus
			add_opinion = {
				target = root
				modifier = opinion_forced_to_contribute_modifier
			}
		}
	}

	option = {
		name = flavor_azt.70.c

		custom_tooltip = we_will_be_able_to_construct_the_building_later_tt
	}
}


flavor_azt.80 = {
	type = country_event
	title = flavor_azt.80.title
	desc = flavor_azt.80.desc
	historical_info = flavor_azt.80.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1550.1.1
		monthly_chance = 2
	}

	trigger = {
		owns = location:tenochtitlan
		location:tenochtitlan = {
			has_building = building_type:great_temple_of_tenochtitlan
		}
		religion = religion:nahuatl
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = Tlacaelel
			adm = { 80 100 }
			dip = { 80 100 }
			mil = { 80 100 }
			age = 30
			save_scope_as = target_character
			script = azt_tlacaelel
		}

		random_religious_aspect = {
			save_scope_as = target_religious_aspect
		}
	}

	option = {	#Increase Militarism through Huitzilopochtli
		name = flavor_azt.80.a

		historical_option = yes

		add_army_tradition = army_tradition_extreme_bonus

		add_country_modifier = {
			modifier = mexica_period_of_expansion_modifier
			years = modifier_duration_years_long
			mode = replace
		}
	}

	option = {	#Focus on internal development with quetzalcoatl
		name = flavor_azt.80.b
		add_stability = stability_extreme_bonus

		add_country_modifier = {
			modifier = mexica_period_of_stability_modifier
			years = modifier_duration_years_long
			mode = replace
		}
	}

	option = {	#Focus on our people through tezcatlipoca_god
		name = flavor_azt.80.c
		ruler_or_regent = {
			add_adm = { 5 15 }
			add_dip = { 5 15 }
			add_mil = { 5 15 }
		}

		add_country_modifier = {
			modifier = mexica_period_of_passive_growth_modifier
			years = modifier_duration_years_long
			mode = replace
		}
	}
}


flavor_azt.90 = {
	type = country_event
	title = flavor_azt.90.title
	desc = flavor_azt.90.desc

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:slaves background = pop_type:peasants }
	}

	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1450.1.1
		to = 1460.1.1
		monthly_chance = 2
	}
	option = {
		name = flavor_azt.90.a
		add_stability = stability_extreme_penalty
	}

}

flavor_azt.110 = {
	type = country_event
	title = flavor_azt.110.title
	desc = flavor_azt.110.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1470.1.1
		to = 1500.1.1
		monthly_chance = 5
	}

	trigger = {
		num_of_non_rural >= 10
		is_subject = no

	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_azt.110.a
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
	}
	option = {
		name = flavor_azt.110.b
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_right
		}
	}
}

flavor_azt.120 = {
	type = country_event
	title = flavor_azt.120.title
	desc = flavor_azt.120.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1650.1.1
		monthly_chance = 10
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	
	trigger = {
		has_advance = codified_laws
	}

	option = {
		name = flavor_azt.120.a
		add_government_power = government_power_extreme_bonus
	}
	option = {
		name = flavor_azt.120.b
		add_stability = stability_mild_bonus
	}
}

flavor_azt.130 = {
	type = country_event
	title = flavor_azt.130.title
	desc = flavor_azt.130.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1600.1.1
		monthly_chance = 5
	}

	trigger = {
		religion = religion:nahuatl
		country_has_disease = disease:great_pestilence
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}

	option = {
		name = flavor_azt.130.a
		add_doom = doom_mild_penalty
	}
}

flavor_azt.140 = {
	type = country_event
	title = flavor_azt.140.title
	desc = flavor_azt.140.desc

	fire_only_once = yes
	
	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1600.1.1
		monthly_chance = 5
	}

	trigger = {
		religion = religion:nahuatl
		country_has_disease = disease:great_pestilence
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}

	option = {
		name = flavor_azt.140.a
		add_stability = stability_ultimate_penalty
	}
}

flavor_azt.150 = {
	type = country_event
	title = flavor_azt.150.title
	desc = flavor_azt.150.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1600.1.1
		monthly_chance = 5
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
	}

	trigger = {
		religion = religion:nahuatl
		country_has_disease = disease:great_pestilence
	}

	option = {
		name = flavor_azt.150.a

		custom_tooltip = {
			text = many_pops_will_perish_tt
			ordered_owned_location = {
				order_by = population
				max = {
					value = 1
					add = {
						value = num_provinces
						multiply = 0.2
					}
				}
				every_pop = {
					add_pop_size = { # CAESAR-1694 destroy_pop
						value = pop_size
						multiply = -0.1
					}
				}
			}
		}
	}
}

flavor_azt.160 = { #The Carving of a New Dynasty
	hide_portraits = yes
	type = country_event
	title = flavor_azt.160.title
	desc = flavor_azt.160.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = TNC
		from = 1337.1.1
		to = 1355.1.1
		monthly_chance = 10
	}

	trigger = {
		owns = location:tenochtitlan
		is_subject = no
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_azt.160.a

		add_government_power = government_power_mild_bonus
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_azt.160.b

		add_prestige = prestige_weak_bonus
		ruler ?= {
			if = {
				limit = {
					NOT = { has_trait = conqueror }
				}
				add_trait = trait:conqueror
			}
			else = { add_mil = 5 }
		}
	}
}

flavor_azt.170 = { #Our First 52 year Cycle
	type = country_event
	title = flavor_azt.170.title
	desc = flavor_azt.170.desc

	fire_only_once = yes

	image = "gfx/interface/illustrations/disaster/reform_society.dds"

	dynamic_historical_event = {
		tag = TNC
		from = 1337.11.1
		to = 1350.2.29
		monthly_chance = 1
	}
	trigger = {
		owns = location:tenochtitlan
	}

	immediate = {
		capital = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_azt.170.a

		trigger = {
			capital = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}
		}

		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.2
				}
				add_pop_satisfaction = pop_satisfaction_severe_penalty
			}
		}
		change_gold_effect = { scale = -3 }
		add_doom = doom_mild_bonus

		add_country_modifier = {
			modifier = renewal_of_life
			years = 10
			mode = add_and_extend
		}
	}

	option = {
		name = flavor_azt.170.b

		trigger = {
			capital = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}
		}

		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.15
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}
		change_gold_effect = { scale = -1 }

		add_doom = doom_mild_bonus
	}

	option = {
		name = flavor_azt.170.c

		add_doom = doom_extreme_penalty
	}

	option = {
		name = flavor_azt.170.d

		change_gold_effect = { scale = -6 }

		add_doom = doom_mild_bonus
	}
}

flavor_azt.180 = { #Our Second 52 year Cycle
	type = country_event
	title = flavor_azt.180.title
	desc = flavor_azt.180.desc

	fire_only_once = yes

	image = "gfx/interface/illustrations/disaster/reform_society.dds"

	dynamic_historical_event = {
		tag = TNC
		from = 1390.11.1
		to = 1391.2.29
		monthly_chance = 50
	}
	trigger = {
		owns = location:tenochtitlan
	}
	immediate = {
		capital = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_azt.180.a

		trigger = {
			capital = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}
		}

		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.2
				}
				add_pop_satisfaction = pop_satisfaction_severe_penalty
			}
		}
		change_gold_effect = { scale = -3 }
		add_doom = doom_mild_bonus

		add_country_modifier = {
			modifier = renewal_of_life
			years = 10
			mode = add_and_extend
		}
	}

	option = {
		name = flavor_azt.180.b

		trigger = {
			capital = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}
		}

		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.15
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}
		change_gold_effect = { scale = -1 }

		add_doom = doom_mild_bonus
	}

	option = {
		name = flavor_azt.180.c

		add_doom = doom_extreme_penalty
	}

	option = {
		name = flavor_azt.170.d

		change_gold_effect = { scale = -6 }

		add_doom = doom_mild_bonus
	}
}

flavor_azt.190 = { #Our Third 52 year Cycle
	type = country_event
	title = flavor_azt.190.title
	desc = flavor_azt.190.desc

	fire_only_once = yes

	image = "gfx/interface/illustrations/disaster/reform_society.dds"

	dynamic_historical_event = {
		tag = TNC
		from = 1443.11.1
		to = 1495.2.29
		monthly_chance = 50
	}
	trigger = {
		owns = location:tenochtitlan

	}

	immediate = {
		capital = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_azt.190.a

		trigger = {
			capital = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}
		}

		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.2
				}
				add_pop_satisfaction = pop_satisfaction_severe_penalty
			}
		}
		change_gold_effect = { scale = -3 }
		add_doom = doom_mild_bonus

		add_country_modifier = {
			modifier = renewal_of_life
			years = 10
			mode = add_and_extend
		}
	}

	option = {
		name = flavor_azt.190.b

		trigger = {
			capital = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}
		}

		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.15
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}
		change_gold_effect = { scale = -1 }

		add_doom = doom_mild_bonus
	}

	option = {
		name = flavor_azt.190.c

		add_doom = doom_extreme_penalty
	}

	option = {
		name = flavor_azt.170.d

		change_gold_effect = { scale = -6 }

		add_doom = doom_mild_bonus
	}
}

# The Reconstruction of the Great Temple of Tenōchtitlan
flavor_azt.200 = {
	type = country_event
	title = flavor_azt.200.title
	desc = flavor_azt.200.desc
	historical_info = flavor_azt.70.historical_info
	fire_only_once = yes

	dynamic_historical_event = {
		tag = TNC
		from = 1350.1.1
		to = 1425.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		location:tenochtitlan = {
			owner = ROOT
			has_building = building_type:great_temple_of_tenochtitlan
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		location:tenochtitlan = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_azt.200.a

		add_gold = -200
		if = {
			limit = {
				location:tenochtitlan = {
					"building(building_type:great_temple_of_tenochtitlan|owner)" = {
						building_level <= 6
					}
				}
			}
			location:tenochtitlan = {
				change_building_level_in_location = {
					building = building_type:great_temple_of_tenochtitlan
					value = 1
				}
			}
		}
		else = {
			location:tenochtitlan = {
				change_prosperity = prosperity_very_weak_bonus
			}
			add_doom = doom_mild_bonus
			add_stability = stability_mild_bonus
		}
		add_prestige = prestige_extreme_bonus
	}

	option = {
		name = flavor_azt.200.b

		add_doom = doom_mild_penalty

		add_all_estate_satisfaction = { value = estate_satisfaction_mild_penalty }
	}
}
# The Coronation of [ruler]
flavor_azt.210 = {
	hide_portraits = yes
	type = country_event
	title = flavor_azt.210.title
	desc = flavor_azt.210.desc

	trigger = {
		ruler ?= {
			NOT = { has_variable = aztec_coronation_variable }
		}
		religion = religion:nahuatl
		current_year > 1338
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:nobles_estate }
		ruler = {
			set_variable = aztec_coronation_variable
			save_scope_as = target_character
		}
		ordered_owned_location = {  
			limit = {
				any_pop = {
					pop_type = pop_type:slaves
				}
			}  
			order_by = num_pop_type:slaves 
			max = 1
			check_range_bounds = no  
			save_scope_as = target_location
		} 
	}

	option = {
		name = flavor_azt.210.a

		trigger = {
			exists = scope:target_location
		}

		scope:target_location = {
			random_pop = {
				limit = { pop_type = pop_type:slaves }
				add_pop_size = {
					value = pop_size
					multiply = -0.25
				}
			}
		}

		ruler = {
			add_character_modifier = {
				modifier = good_omen_modifier
				months = -1
				mode = add_and_extend
			}
		}
	}

	option = {
		name = flavor_azt.210.b

		add_doom = doom_extreme_penalty
	}

	option = {
		name = flavor_azt.210.c

		trigger = {
			ruler ?= {
				OR = {
					has_trait = zealot
					has_trait = cruel
					has_trait = sinner
				}
			}
			capital = {
				any_pop = {
					pop_size > 0.1
					pop_type = pop_type:nobles
				}
			}
		}

		custom_tooltip = coronation_sacrifice_tt
		hidden_effect = {
			capital = {
				random_pop = {
					limit = { pop_type = pop_type:nobles }
					add_pop_size = {
						value = pop_size
						multiply = -0.33
					}
				}
			}
		}

		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_radical_penalty
		}

		ruler = {
			add_character_modifier = {
				modifier = good_omen_modifier
				months = -1
				mode = add_and_extend
			}
		}
	}
}

# Lake Texcoco Floods the City
flavor_azt.220 = {
	type = country_event
	title = flavor_azt.220.title
	desc = flavor_azt.220.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = TNC
		from = 1430.1.1
		to = 1460.1.1
		monthly_chance = 1
	}

	trigger = {
		location:tenochtitlan = {
			owner = ROOT
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:peasants_estate }
		location:tenochtitlan = { save_scope_as = target_location }
		location:texcoco_lake = { save_scope_as = target_lake }
	}

	option = {
		name = flavor_azt.220.a

		location:tenochtitlan = {
			change_prosperity = prosperity_ultimate_penalty
			every_pop = {
				add_pop_size = {
					value = pop_size
					multiply = -0.2
				}
			}
		}
		add_doom = doom_extreme_penalty
	}

	option = {
		name = flavor_azt.220.b

		location:tenochtitlan = {
			change_prosperity = prosperity_extreme_penalty
			every_pop = {
				add_pop_size = {
					value = pop_size
					multiply = -0.2
				}
			}
		}
		change_gold_effect = { scale = -8 }
		add_doom = doom_mild_penalty
	}
}


# The Tzompantli of [target_location.GetName]
flavor_azt.230 = {
	type = country_event
	title = flavor_azt.230.title
	desc = flavor_azt.230.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = TNC
		from = 1337.1.1
		to = 1480.1.1
		monthly_chance = 1
	}

	trigger = {
		capital = {
			any_pop = {
				pop_size > 0.1
				pop_type = pop_type:slaves
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:clergy }
		capital = {
			save_scope_as = target_location
		}
	}

	#None shall question our rule!
	option = {
		name = flavor_azt.230.a

		add_prestige = prestige_extreme_bonus
		add_government_power = government_power_extreme_bonus
		add_stability = stability_mild_bonus
	}

	#Our foes will crumble, like dust in the wind...
	option = {
		name = flavor_azt.230.b

		drop_antagonism_bomb = {
			target = capital
			modifier = antagonism_tzompantli_further_aggression
		}
		add_army_tradition = army_tradition_extreme_bonus
		add_doom = doom_mild_bonus
	}
}

# The Rise of [target_character.GetNameWithNoTooltip]
flavor_azt.240 = {
	hide_portraits = yes
	type = country_event
	title = flavor_azt.240.title
	desc = flavor_azt.240.desc

	fire_only_once = yes
	historical_info = flavor_azt.240.historical_info
	dynamic_historical_event = {
		tag = TNC
		from = 1484.2.2
		to = 1520.1.1
		monthly_chance = 1
	}

	trigger = {
		government_type = government_type:monarchy
		at_war = no
		has_heir = yes
		has_ruler = yes
		heir = {
			total_abilities >= 150
			age_in_years > 15
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		heir = { save_scope_as = moctezuma_scope }
		ruler = { save_scope_as = target_character }
	}

	option = {
		name = flavor_azt.240.a

		historical_option = yes

		scope:moctezuma_scope = {
			add_adm = {
				value = scope:target_character.adm
				divide = 4
				add = 5
				ceiling = yes
			}
			add_adm = {
				value = scope:target_character.dip
				divide = 4
				add = 5
				ceiling = yes
			}
			add_adm = {
				value = scope:target_character.mil
				divide = 4
				add = 5
				ceiling = yes
			}
		}
		set_new_ruler = scope:moctezuma_scope
	}

	option = {
		name = flavor_azt.240.b

		add_stability = stability_mild_bonus
		add_doom = doom_mild_bonus
	}
}
