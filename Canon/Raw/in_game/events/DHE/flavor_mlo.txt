namespace = flavor_mlo

flavor_mlo.3 = {
	type = country_event
	title = flavor_mlo.3.title
	desc = flavor_mlo.3.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1456.1.1
		to = 1470.1.1
		monthly_chance = 10
	}

	trigger = {
		owns = location:milano
		at_war = no
		location:milano = {
			has_building_with_at_least_one_level = hospital
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mlo.3.a
		location:milano = {
			change_development  = development_severe_bonus
		}
	}
}

flavor_mlo.4 = {
	type = country_event
	title = flavor_mlo.4.title
	desc = flavor_mlo.4.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1450.1.1
		to = 1490.1.1
		monthly_chance = 10
	}

	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	trigger = {
		num_of_non_rural > 1
		at_war = no
		country_exists = c:NAP
		country_exists = c:VEN
		country_exists = c:FLO
		c:NAP = {
			num_of_non_rural > 1
			at_war = no
		}
		c:VEN = {
			num_of_non_rural > 1
			at_war = no
		}
		c:FLO = {
			num_of_non_rural > 1
			at_war = no
		}
	}

	option = {
		name = flavor_mlo.4.a
		historical_option = yes
		c:NAP = {
			add_opinion = { target = root modifier = mlo_peace_of_lodi }
		}
		c:VEN = {
			add_opinion = { target = root modifier = mlo_peace_of_lodi }
		}
		c:FLO = {
			add_opinion = { target = root modifier = mlo_peace_of_lodi }
		}
		hidden_effect = {
			c:NAP = {
				trigger_event_silently = { id = flavor_mlo.5 }
			}
			c:VEN = {
				trigger_event_silently = { id = flavor_mlo.5 }
			}
			c:FLO = {
				trigger_event_silently = { id = flavor_mlo.5 }
			}
		}
	}
	option = {
		name = flavor_mlo.4.b
		change_societal_value = { type = belligerent_vs_conciliatory value = societal_value_move_to_left }
	}
}

flavor_mlo.5 = {
	type = country_event
	title = flavor_mlo.5.title
	desc = flavor_mlo.5.desc
	
	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mlo.5.a
		if = {
			limit = {
				NOT = { root = c:FLO }
			}
			c:FLO = {
				add_opinion = { target = root modifier = mlo_peace_of_lodi }
			}
		}
		if = {
			limit = {
				NOT = { root = c:NAP }
			}
			c:NAP = {
				add_opinion = { target = root modifier = mlo_peace_of_lodi }
			}
		}
		if = {
			limit = {
				NOT = { root = c:VEN }
			}
			c:VEN = {
				add_opinion = { target = root modifier = mlo_peace_of_lodi }
			}
		}
		if = {
			limit = {
				NOT = { root = c:MLO }
			}
			c:MLO = {
				add_opinion = { target = root modifier = mlo_peace_of_lodi }
			}
		}

	}
}

flavor_mlo.6 = { #Leonardo da Vinci Paints the Last Supper
	type = country_event
	title = flavor_mlo.6.title
	desc = flavor_mlo.6.desc

	dynamic_historical_event = {
		tag = MLO
		from = 1470.1.1
		to = 1525.12.30
		monthly_chance = 1
	}

	fire_only_once = yes

	trigger = {
		character:mlo_leonardo_script ?= {
			is_alive = yes
			owner = ROOT
		}
		has_embraced_institution = institution:renaissance
	}

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	immediate = {
		character:mlo_leonardo_script = {
			save_scope_as = target_artist
		}
		capital = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.6.a
		historical_option = yes

		scope:target_location = {
			create_art = {
				quality = 85
				artist = scope:target_artist
				type = work_of_art_type:painting
				key = last_supper
			}
		}
		add_prestige = prestige_mild_bonus
		change_gold_effect = { scale = -5 }
	}

	option = {
		name = flavor_mlo.6.b

		add_prestige = prestige_weak_penalty
	}
}

flavor_mlo.9 = {
	type = country_event
	title = flavor_mlo.9.title
	desc = flavor_mlo.9.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1482.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	trigger = {
		owns = location:milano
		exists = character:mlo_leonardo_script
		character:mlo_leonardo_script.owner != ROOT
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:milano = { save_scope_as = target_location }
		character:mlo_leonardo_script.owner = {
			save_scope_as = target_old_country
		}
		character:mlo_leonardo_script = {
			save_scope_as = target_artist
		}
	}

	option = {
		name = flavor_mlo.9.a


		change_gold_effect = { scale = -4 }
		add_research_progress = research_progress_severe_bonus
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_right
		}
		character:mlo_leonardo_script = {
			move_country = ROOT
		}
		custom_tooltip = flo_target_artist_joins_our_court_tt
		hidden_effect = {
			scope:target_old_country = {
				trigger_event_silently = {
					id = flavor_flo.32
				}
			}
		}
	}


	option = {
		name = flavor_mlo.9.b

		add_prestige = prestige_weak_penalty
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_left
		}
	}
}

flavor_mlo.10 = {
	type = country_event
	title = flavor_mlo.10.title
	desc = flavor_mlo.10.desc
	fire_only_once = yes
	
	dynamic_historical_event = {
		tag = MLO
		from = 1500.1.1
		to = 1600.1.1
		monthly_chance = 10
	}

	trigger = {
		owns = location:milano
		location:milano.market = {
			is_produced_in_market = goods:fine_cloth
		}
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		location:milano = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.10.a
		location:milano = {
			change_development  = development_severe_bonus
		}
	}
}

flavor_mlo.11 = { #A Growing Power in Northern Italy
	type = country_event
	title = flavor_mlo.11.title
	desc = flavor_mlo.11.desc
	fire_only_once = yes
	
	dynamic_historical_event = {
		tag = MLO
		from = 1337.4.1
		to = 1339.12.30
		monthly_chance = 90
	}

	trigger = {
		owns = location:milano
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mlo.11.a
		historical_option = yes
		location:milano = {
			change_prosperity = prosperity_very_weak_bonus
		}
		change_societal_value = { type = centralization_vs_decentralization value = societal_value_minor_move_to_left }
	}

	option = {
		name = flavor_mlo.11.b

		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_bonus }
		change_societal_value = { type = centralization_vs_decentralization value = societal_value_minor_move_to_right }
	}
}

flavor_mlo.12 = { #The Visconti Family of Milan
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.12.title
	desc = flavor_mlo.12.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.4.1
		to = 1338.12.30
		monthly_chance = 90
	}

	trigger = {
		has_ruler = yes
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.12.a
		historical_option = yes

		add_estate_satisfaction = { 
			type = estate_type:nobles_estate 
			value = estate_satisfaction_mild_bonus 
		}

		add_stability = stability_extreme_bonus
		add_legitimacy = legitimacy_mild_bonus

		custom_tooltip = mlo_visconti_struggle
	}

	option = {
		name = flavor_mlo.12.b

		add_estate_satisfaction = { 
			type = estate_type:nobles_estate 
			value = estate_satisfaction_mild_penalty 
		}

		add_stability = stability_extreme_penalty
		
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_large_move_to_left
		}

		add_country_modifier = {
			modifier = dlh_restored_authority_modifier
			years = modifier_duration_years_normal
			mode = add_and_extend
		}
	}
}

flavor_mlo.13 = { #A United Realm
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.13.title
	desc = flavor_mlo.13.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.4.11
		to = 1550.12.30
		monthly_chance = 5
	}

	trigger = {
		has_estate_privilege = estate_privilege:visconti_city_states
		has_ruler = yes
		OR = {
			average_control_in_home_region > {
				value = 0.6
				subtract = {
					value = stability
					multiply = 0.001
				}
			}
			"estate_power(estate_type:crown_estate)" > "estate_power(estate_type:nobles_estate)"
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.13.a
		historical_option = yes

		trigger = {
			NOT = { uses_government_power = legitimacy }
		}

		if = {
			limit = {
				exists = international_organization:hre
				is_member_of_international_organization = international_organization:hre
			}
			international_organization:hre.leader_country = {
				trigger_event_non_silently = { id = flavor_mlo.27 }
			}
		}
		else = {
			change_government_type = government_type:monarchy
			if = {
				limit = {
					NOT = { has_advance = monarchy_reform_traditions_advance }
				}
				research_advance = advance_type:monarchy_reform_traditions_advance
			}
			add_reform = government_reform:autocracy
			revoke_estate_privilege = estate_privilege:visconti_city_states
			add_stability = stability_mild_penalty
			change_societal_value = {
				type = centralization_vs_decentralization
				value = societal_value_move_to_left
			}
		}
	}

	option = {
		name = flavor_mlo.13.c
		revoke_estate_privilege = estate_privilege:visconti_city_states
		custom_tooltip = mlo_every_location_italy_5_control_tt
		hidden_effect = {
			every_owned_location = {
				limit = {
					region = region:italy_region
				}
				change_control = control_weak_bonus
			}
		}
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
	}

	option = {
		name = flavor_mlo.13.b

		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_extreme_bonus }
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_right
		}
		add_government_power = government_power_extreme_bonus
	}
}

flavor_mlo.14 = { #Galvano Fiamma's Cronica Universalis
	type = country_event
	title = flavor_mlo.14.title
	desc = flavor_mlo.14.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1338.1.1
		to = 1350.12.30
		monthly_chance = 1
	}

	trigger = {
		character:mlo_galvano_fiamma ?= {
			owner = ROOT
			is_alive = yes
		}
		owns = location:milano
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:mlo_galvano_fiamma = {
			save_scope_as = target_character
		}
		location:milano = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.14.a

		scope:target_location = {
			create_art = {
				type = work_of_art_type:chronicle
				artist = character:mlo_galvano_fiamma
				quality = 78
				key = cronica_universalis
			}
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}

	option = {
		name = flavor_mlo.14.b

		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_extreme_bonus }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_left }
	}
}


flavor_mlo.15 = { #Lodrisio Visconti
	type = country_event
	title = flavor_mlo.15.title
	desc = flavor_mlo.15.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1340.12.30
		monthly_chance = 3
	}

	trigger = {
		character:mlo_lodrisio_visconti = {
			owner = ROOT
			is_alive = yes
		}
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:mlo_lodrisio_visconti = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.15.a
		historical_option = yes
		trigger = {
			any_rival = {
				NOT = { has_truce_with = ROOT }
				count > 0
			}
		}

		custom_tooltip = mlo_lodrisio_visconti_scorned_tt

		if = {
			limit = {
				c:VER = {
					OR = {
						is_rival_of = root
						is_enemy_of = root
					}
					NOT = { has_truce_with = ROOT }
				}
			}
			c:VER = {
				trigger_event_non_silently = flavor_mlo.16
			}
		}

		else = {
			random_rival = {
				limit = {
					NOT = { has_truce_with = ROOT }
				}
				trigger_event_non_silently = flavor_mlo.16
			}
		}
	}

	option = {
		name = flavor_mlo.15.b

		add_government_power = government_power_extreme_penalty
		add_prestige = prestige_mild_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		custom_tooltip = mlo_lodrisio_visconti_appeased_tt
	}

	option = {
		name = flavor_mlo.15.c

		kill_character = {
			target = scope:target_character
			reason = execution
			killer = ruler
		}
		add_stability = stability_mild_penalty
	}
}

flavor_mlo.16 = { #Lodrisio Visconti Approaches a Rival Court
	type = country_event
	title = flavor_mlo.16.title
	desc = flavor_mlo.16.desc

	fire_only_once = yes

	trigger = {
		character:mlo_lodrisio_visconti = {
			is_alive = yes
		}
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:mlo_lodrisio_visconti = {
			save_scope_as = target_character
		}
		c:MLO = {
			capital = {
				province = {
					save_scope_as = target_province
				}
			}
		}
		c:MLO = { save_scope_as = target_rival }
	}

	option = {
		name = flavor_mlo.16.a

		character:mlo_lodrisio_visconti = {
			move_country = ROOT
		}
		change_gold_effect = { scale = -10 }
		add_casus_belli = {
			target = c:MLO
			type = casus_belli:cb_claim_throne
			character = scope:target_character
		}
		hidden_effect = {
			trigger_event_silently = {
				id = flavor_mlo.17
				days = 7
			}
		}
	}

	option = {
		name = flavor_mlo.16.b

		character:mlo_lodrisio_visconti = {
			move_country = ROOT
		}
		change_gold_effect = { scale = -5 }
		add_casus_belli = {
			target = c:MLO
			type = casus_belli:cb_conquer_province
			province = scope:target_province
		}
		hidden_effect = {
			trigger_event_silently = {
				id = flavor_mlo.17
				days = 7
			}
		}
	}

	option = {
		name = flavor_mlo.16.c

		add_prestige = prestige_weak_bonus
		c:MLO = {
			add_opinion = {
				target = ROOT
				modifier = opinion_pleased
			}
		}
	}
}

flavor_mlo.17 = { #Lodrisio Visconti Assembles an Army
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.17.title
	desc = flavor_mlo.17.desc

	trigger = {
		character:mlo_lodrisio_visconti = {
			owner = ROOT
			is_alive = yes
		}
	}

	illustration_tags = {
        10 = armed
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		capital = {
			save_scope_as = target_location
		}
		capital = {
			area = { save_scope_as = target_area }
		}
		character:mlo_lodrisio_visconti = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.17.a

		add_army_tradition = army_tradition_ultimate_bonus
	change_gold_effect = { scale = -1
		}
	}

	option = {
		name = flavor_mlo.17.b

		add_prestige = prestige_weak_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
	}
}

flavor_mlo.18 = { #Pietro Azario writes the Liber Gestorum in Lombardy
	type = country_event
	title = flavor_mlo.18.title
	desc = flavor_mlo.18.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1358.1.1
		to = 1368.12.30
		monthly_chance = 1
	}

	trigger = {
		character:mlo_pietro_azario ?= {
			owner = ROOT
			is_alive = yes
		}
		owns = location:milano
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:mlo_pietro_azario = {
			save_scope_as = target_character
		}
		location:milano = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.18.a

		scope:target_location = {
			create_art = {
				type = work_of_art_type:chronicle
				artist = scope:target_character
				quality = 47
				key = liber_gestorum_in_lombardy
			}
		}

		add_government_power = government_power_weak_bonus
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}

	option = {
		name = flavor_mlo.18.b

		change_gold_effect = { scale = 3 }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_left }
	}
}

flavor_mlo.19 = { # Ponte Azzone Visconti Bridge
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.19.title
	desc = flavor_mlo.19.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1341.12.30
		monthly_chance = 5
	}

	trigger = {
		owns = location:lecco
		at_war = no
		gold >= 50
		has_ruler = yes
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
		location:lecco = { save_scope_as = target_location }
		ruler = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.19.a


		scope:target_location = {
			construct_building = { building_type = building_type:bridge_infrastructure }
			change_prosperity = prosperity_very_weak_bonus
		}
		add_estate_satisfaction = { type = estate_type:burghers_estate
			value = estate_satisfaction_weak_bonus
		}
	}

	option = {
		name = flavor_mlo.19.b


		add_estate_satisfaction = { type = estate_type:burghers_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}

flavor_mlo.20 = { # The Ark of Saint Peter Martyr
	type = country_event
	title = flavor_mlo.20.title
	desc = flavor_mlo.20.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1345.12.30
		monthly_chance = 4
	}

	trigger = {
		character:mlo_giovanni_balduccio = {
			owner = ROOT
			is_alive = yes
		}
	}

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	immediate = {
		character:mlo_giovanni_balduccio = {
			save_scope_as = target_character
		}
		capital = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.20.a

		change_gold_effect = { scale = -3 }
		scope:target_location = {
			create_art = {
				artist = scope:target_character
				quality = 62
				type = work_of_art_type:statue
				key = arca_di_san_pietro_martire
			}
		}
	}

	option = {
		name = flavor_mlo.20.b

		culture = {
			add_cultural_influence = cultural_influence_weak_penalty
			add_cultural_tradition = cultural_tradition_weak_penalty
		}
	}
}

flavor_mlo.21 = { # Public Water Statutes of [GetCurrentYear]
	type = country_event
	title = flavor_mlo.21.title
	desc = flavor_mlo.21.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1390.12.30
		monthly_chance = 1
	}

	trigger = {
		owns = location:milano
		at_war = no
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:milano = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.21.a

		change_gold_effect = { scale = -2 }
		scope:target_location = {
			add_location_modifier = {
				modifier = maintained_waterways_modifier
				years = 10
				mode = add_and_extend
			}
		}
		change_societal_value = { type = centralization_vs_decentralization value = societal_value_minor_move_to_left }
	}

	option = {
		name = flavor_mlo.21.b

		custom_tooltip = mlo_waterways_estates_pay_tt
		hidden_effect = {
			add_gold_to_estate = {
				estate_type = estate_type:burghers_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_gold_to_estate = {
				estate_type = estate_type:clergy_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_gold_to_estate = {
				estate_type = estate_type:nobles_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
			add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }
			add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
		}
		change_societal_value = { type = centralization_vs_decentralization value = societal_value_minor_move_to_right }
		scope:target_location = {
			add_location_modifier = {
				modifier = maintained_waterways_modifier
				years = 10
				mode = add_and_extend
			}
		}
	}

	option = {
		name = flavor_mlo.21.c

		scope:target_location = {
			change_development = development_mild_penalty
			change_prosperity = prosperity_severe_penalty
			hidden_effect = {
				every_pop = {
					limit = {
						owner = root
					}
					add_pop_satisfaction = pop_satisfaction_extreme_penalty
				}
			}
		}
		custom_tooltip = artist_events.21.tt
	}
}

flavor_mlo.22 = { #The University of Pavia
	type = country_event
	title = flavor_mlo.22.title
	desc = flavor_mlo.22.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1444.11.11
		monthly_chance = 1
	}

	trigger = {
		owns = location:pavia
		location:pavia = {
			has_building_with_at_least_one_level = university
		}
		at_war = no
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.22.a

		add_research_progress = research_progress_mild_bonus
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_tiny_move_to_right }
	}

	option = {
		name = flavor_mlo.22.b

		add_research_progress =research_progress_severe_bonus
		change_gold_effect = { scale = -2 }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}

	option = {
		name = flavor_mlo.22.c

		trigger = {
			ruler ?= {
				OR = {
					has_trait = free_thinker
					has_trait = scholar
				}
			}
		}

		add_research_progress = research_progress_extreme_bonus
		change_gold_effect = { scale = -3 }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}
}

scripted_trigger flavor_mlo_23_location_trigger = {
	integration_level = core
	any_buildings_in_location = {
		count = all
		OR = {
			building_produced_goods = goods:fine_cloth
			building_produced_goods = goods:silk
		}
	}
}
flavor_mlo.23 = { #The Cloth Industry of Milan
	type = country_event
	title = flavor_mlo.23.title
	desc = flavor_mlo.23.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_cloth.dds"

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1399.11.11
		monthly_chance = 1
	}

	major = yes
	major_trigger = {
		capital.region = region:italy_region
	}
	trigger = {
		owns = location:milano #If you are Milan and don't own Milano, you have problems
		any_owned_location = {
			development >= 20
			has_building_with_at_least_one_level = fine_cloth_guild
		}
		at_war = no
	}

	immediate = {
		location:milano = {
			save_scope_as = target_location
		}
		random_owned_location = {
			limit = {
				development >= 20
				has_building_with_at_least_one_level = fine_cloth_guild
			}
			save_scope_as = target_location2
		}
		every_owned_location = {
			limit = { flavor_mlo_23_location_trigger = yes }
			add_to_list = core_locations
		}
	}

	option = {
		name = flavor_mlo.23.a

		if = {
			limit = {
				NOT = { has_estate_privilege = estate_privilege:milanese_cloth_guilds_privileges }
			}
			grant_estate_privilege = estate_privilege:milanese_cloth_guilds_privileges
		}
		else_if = {
			limit = { has_estate_privilege = estate_privilege:milanese_cloth_guilds_privileges }
			change_gold_effect = { scale = -1 }
		}
		else = {
			change_gold_effect = { scale = -3 }
		}
		ordered_owned_location = {
			order_by = population
			limit = { flavor_mlo_23_location_trigger = yes }
			max = {
				every_in_list = {
					list = core_locations
					add = 1
				}
			}
			change_development = development_weak_bonus
			change_prosperity = prosperity_mild_bonus
		}
		scope:target_location = {
			change_building_level_in_location = {
				building = building_type:fine_cloth_guild
				value = 1
			}
			add_pop = {
				culture = root.culture
				religion = root.religion
				type = pop_type:burghers
				size = 0.1
			}
		}

		every_market_with_merchants = {
			limit = {
				location.continent = continent:europe
			}
			add_temporary_demand = {
				type = demand:italian_cloth
				months = 240
			}
		}
	}

	option = {
		name = flavor_mlo.23.b

		add_stability = stability_weak_bonus
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }
	}
}

flavor_mlo.24 = { #Duomo di Milano
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.24.title
	desc = flavor_mlo.24.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1821.11.11
		monthly_chance = 10
	}

	trigger = {
		owns = location:milano #If you are Milan and don't own Milano, you have problems
		location:milano = {
			has_building_with_at_least_one_level = cathedral
		}
		peaceful_and_rich = yes
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		location:milano = {
			save_scope_as = target_location
		}

		create_character = {
			first_name = name_simeon
			last_name = Orsenigo
			culture = culture:lombard
			age = 45
			artist_skill = 0.79
			artist = architect
			estate = estate_type:burghers_estate
			save_scope_as = target_character
			create_in_limbo = yes
		}
	}

	option = {
		name = flavor_mlo.24.a

		scope:target_character = { move_country = root }
		scope:target_location = {
			create_art = {
				artist = scope:target_character
				quality = 85
				type = work_of_art_type:monument
				key = milan_cathedral
			}
		}
		change_gold_effect = { scale = -3 }
	}

	option = {
		name = flavor_mlo.24.b

		scope:target_character = { banish_character = yes }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
	}
}

flavor_mlo.25 = { #The Influence of Giotto
	type = country_event
	title = flavor_mlo.25.title
	desc = flavor_mlo.25.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1340.1.1
		monthly_chance = 3
	}

	trigger = {
		owns = location:milano
		character:mlo_azzone_i_visconti = {
			owner = ROOT
			is_alive = yes
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:milano = {
			save_scope_as = target_location
		}
		character:mlo_azzone_i_visconti = {
			save_scope_as = target_character
		}

		culture = { save_scope_as = target_culture }
	}

	option = {
		name = flavor_mlo.25.a

		historical_option = yes

		add_gold = scope:target_culture.cultural_tradition
	}

	option = {
		name = flavor_mlo.25.b
		culture = {
			add_cultural_influence = cultural_influence_weak_bonus
			add_cultural_tradition = cultural_tradition_weak_bonus
		}
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_tiny_move_to_right }
		scope:target_location = {
			construct_building = { 
				building_type = building_type:art_school 
				cost_multiplier = 0.1
				cost_multiplier_reason = "royal_sponsorship"
				instant = yes
			}
		}
	}
}

flavor_mlo.26 = { #Reviving the Kingdom of Lombardy
	type = country_event
	title = flavor_mlo.26.title
	desc = flavor_mlo.26.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1340.1.1
		to = 1415.12.30
		monthly_chance = 10
	}

	trigger = {
		owns = location:pavia
		at_war = no
		war_exhaustion <= 4
		location:pavia = {
			is_capital = no
			is_core_of = ROOT
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.26.a

		ai_will_select = { value = 1 }

		set_variable = {
			name = lombard_ambitions_variable
			years = 30
		}
		set_capital = scope:target_location
		scope:target_location = {
			change_development = development_ultimate_bonus

			add_location_modifier = {
				modifier = new_capital_modifier
				years = modifier_duration_years_normal
				mode = replace
			}

			if = {
				limit = {
					ROOT = { government_type = government_type:monarchy }
				}
				construct_building = {  
					building_type = building_type:royal_court
					cost_multiplier = 0
					cost_multiplier_reason = "royal_sponsorship"
					instant = yes
				}
			}
		}
		custom_tooltip = mlo_access_restore_kingdom_lombardy_cabinet_action_tt
	}

	option = {
		name = flavor_mlo.26.b

		ai_will_select = { value = 1 }

		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
		ordered_owned_non_rural_location = {
			order_by = development
			max = 4
			check_range_bounds = no
			change_prosperity = prosperity_severe_bonus
		}

	}
}

flavor_mlo.27 = { #Milan Demands the Ducal Title
	type = country_event
	title = flavor_mlo.27.title
	desc = flavor_mlo.27.desc

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:MLO = {
			ruler_or_regent = {
				save_scope_as = target_character
			}
		}
		c:MLO = { save_scope_as = target_country }
	}

	option = {
		name = flavor_mlo.27.a
		historical_option = yes

		add_government_power = government_power_extreme_bonus
		add_prestige = prestige_weak_bonus

		c:MLO = {
			trigger_event_non_silently = flavor_mlo.35
		}
	}

	option = {
		name = flavor_mlo.27.b
		c:MLO = {
			trigger_event_non_silently = flavor_mlo.28
		}
		add_opinion = {
			target = c:MLO
			modifier = opinion_declined_to_recognize_monarchy_modifier
		}
	}
}

flavor_mlo.28 = { #The Emperor Refuses to Recognize our Demands
	type = country_event
	title = flavor_mlo.28.title
	desc = flavor_mlo.28.desc
	#major = yes
	#major_trigger = {
	#	is_member_of_international_organization = international_organization:hre
	#}
	fire_only_once = yes
	
	illustration_tags = {
        10 = angry
        10 = interior
    }	
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		international_organization:hre.leader_country = {
			ruler = {
				save_scope_as = target_character
			}
		}
		c:MLO = { save_scope_as = target_country }
	}

	option = {
		name = flavor_mlo.28.a

		change_government_type = government_type:monarchy
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_advance = monarchy_reform_traditions_advance }
				}
				research_advance = advance_type:monarchy_reform_traditions_advance
			}
		}
		
		add_reform = government_reform:autocracy
		revoke_estate_privilege = estate_privilege:visconti_city_states
		add_stability = stability_extreme_penalty
		add_prestige = prestige_severe_penalty

		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_large_move_to_left
		}
	}

	option = {
		name = flavor_mlo.28.b

		revoke_estate_privilege = estate_privilege:visconti_city_states
	}
}

flavor_mlo.29 = { #Petrarch visits Milano
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.29.title
	desc = flavor_mlo.29.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1339.1.1
		to = 1360.12.30
		monthly_chance = 1
	}

	trigger = {
		peaceful_and_rich = yes
		character:pap_francesco_petrarca = {
			is_alive = yes
			NOT = { owner = ROOT }
		}
		character:pap_francesco_petrarca.owner = {
			NOR = {
				is_rival_of = ROOT
				is_enemy_of = ROOT
				opinion = {
					target = ROOT
					value <= 10
				}
			}
		}
		has_ruler = yes
		ruler = {
			NOT = { has_character_modifier = excommunicated }
		}
		owns = location:milano
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:milano = { save_scope_as = target_location }
		character:pap_francesco_petrarca = {
			save_scope_as = target_character
		}
		ruler = { save_scope_as = target_ruler }
	}

	option = {
		name = flavor_mlo.29.a

		scope:target_character = {
			move_country = ROOT
		}
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_move_to_right }
		change_gold_effect = { scale = -3 }
	}

	option = {
		name = flavor_mlo.29.b

		add_prestige = prestige_weak_penalty
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_move_to_left }
	}
}

flavor_mlo.30 = { #The Metallurgical Center of Milano
	type = country_event
	title = flavor_mlo.30.title
	desc = flavor_mlo.30.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1340.1.1
		to = 1390.12.30
		monthly_chance = 1
	}

	trigger = {
		owns = location:milano
		peaceful_and_rich = yes
		OR = {
			produced_in_country:iron > 0
			produced_in_country:copper > 0
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		random_owned_location = {
			limit = { has_good_mining_raw_material = yes }
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.30.a
		historical_option = yes

		scope:target_location = {
			change_max_raw_material_workers = 1
			add_pop = {
				culture = root.culture
				religion = root.religion
				type = pop_type:peasants
				size = 1
			}
			change_prosperity = prosperity_severe_bonus
		}

		change_gold_effect = { scale = -1 }
	}

	option = {
		name = flavor_mlo.30.b

		scope:target_location = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_mild_bonus
			}
			change_prosperity = prosperity_very_weak_bonus
		}
	}
}

flavor_mlo.32 = { #Francesco Sforza
	type = country_event
	title = flavor_mlo.32.title
	desc = flavor_mlo.32.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1420.1.1
		to = 1466.12.30
		monthly_chance = 5
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_named_dynasty = sforza_dynasty
		create_character = {
			first_name = name_francis
			culture = culture:tuscan
			adm = 85
			dip = 85
			mil = 95
			birth_date = 1401.7.23
			birth_location = location:poggibonsi
			estate = estate_type:nobles_estate

			dynasty = dynasty:sforza_dynasty
			script = mlo_sforza_script
			save_scope_as = target_character
		}
		random_neighbor_country = {
			limit = {
				OR = {
					has_truce_with = ROOT
					is_rival_of = ROOT
					is_enemy_of = ROOT
				}
			}
			save_scope_as = target_neighbor_country
		}
	}

	option = {
		name = flavor_mlo.32.a
		historical_option = yes

		custom_tooltip = mlo_sforza_joins_tt
	}

	option = {
		name = flavor_mlo.32.b

		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
		add_prestige = prestige_mild_bonus
		if = {
			limit = {
				exists = scope:target_neighbor_country
			}
			scope:target_character = {
				move_country = scope:target_neighbor_country
			}
		}
		else = {
			hidden_effect = { kill_character_silently = scope:target_character }
		}
	}
}

flavor_mlo.33 = { #Renovating the Palazzo Ducale
	type = country_event
	title = flavor_mlo.33.title
	desc = flavor_mlo.33.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1444.1.1
		to = 1504.12.30
		monthly_chance = 1
	}

	trigger = {
		owns = location:milano
		location:milano = {
			OR = {
				has_building_with_at_least_one_level = republican_assembly
				has_building_with_at_least_one_level = royal_court
			}
		}
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:milano = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.33.a
		historical_option = yes

		add_prestige = prestige_severe_bonus
		add_government_power = government_power_extreme_bonus
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
		scope:target_location = {
			change_development = development_weak_bonus
		}
		change_gold_effect = { scale = -3 }
	}

	option = {
		name = flavor_mlo.33.b

		add_prestige = prestige_weak_penalty
		add_government_power = government_power_mild_penalty
	}
}

flavor_mlo.34 = { #The Equestrian Statue of Leonardo da Vinci
	type = country_event
	title = flavor_mlo.34.title
	desc = flavor_mlo.34.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1497.1.1
		to = 1515.12.30
		monthly_chance = 1
	}

	trigger = {
		owns = location:milano
		character:mlo_leonardo_script = {
			owner = ROOT
			is_alive = yes
		}
	}

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	immediate = {
		location:milano = {
			save_scope_as = target_location
		}
		character:mlo_leonardo_script = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.34.a


		change_gold_effect = { scale = -3 }
		scope:target_location = {
			create_art = {
				artist = scope:target_character
				quality = 85
				type = work_of_art_type:monument
				key = equestrian_statue
			}
		}
	}

	option = {
		name = flavor_mlo.34.b

		add_government_power = government_power_mild_penalty
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_minor_move_to_left
		}
	}
}

flavor_mlo.35 = { #The Emperor Grants us the Monarchical Crown of Milan
	type = country_event
	title = flavor_mlo.35.title
	desc = flavor_mlo.35.desc

	fire_only_once = yes #This is a simple notification event because we have no pop-ups

	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		international_organization:hre.leader_country = {
			ruler = {
				save_scope_as = target_character
			}
		}
		capital = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.35.a

		change_government_type = government_type:monarchy
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_advance = monarchy_reform_traditions_advance }
				}
				research_advance = advance_type:monarchy_reform_traditions_advance
			}
		}
		add_reform = government_reform:autocracy
		revoke_estate_privilege = estate_privilege:visconti_city_states
		if = {
			limit = { country_rank_level < 2 }
			set_country_rank_effect = { rank = country_rank:rank_duchy }
		}
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_large_move_to_left
		}
	}
}

flavor_mlo.36 = { ##The Palazzo Reale di Milano
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.36.title
	desc = flavor_mlo.36.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1400.12.30
		monthly_chance = 10
	}

	trigger = {
		peaceful_and_rich = yes
		owns = location:milano #If you are Milan and don't own Milano, you have problems
		location:milano = {
			OR = {
				has_building_with_at_least_one_level = republican_assembly
				has_building_with_at_least_one_level = royal_court
			}
		}
		any_artist = {
			artist_type = architect
		}
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:milano = {
			save_scope_as = target_location
		}
		random_artist = {
			limit = { artist_type = architect }
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.36.a

		add_government_power = government_power_mild_bonus
		scope:target_location = {
			create_art = {
				quality = 65
				artist = scope:target_character
				type = work_of_art_type:palace
				key = palazzo_reale_di_milano
			}
		}
		change_gold_effect = { scale = -3 }
	}

	option = {
		name = flavor_mlo.36.b

		add_prestige = prestige_weak_penalty
	}
}

flavor_mlo.37 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.37.title
	desc = flavor_mlo.37.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1430.1.1
		to = 1480.12.30
		monthly_chance = 5
	}

	trigger = {
		character:mlo_sforza_script ?= {
			is_alive = yes
			is_ruler = no
			is_heir = no
			is_married = no
		}
		ruler = {
			any_child = {
				is_alive = yes
				is_adult = yes
				is_female = yes
				is_married = no
				character_age <= 40
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler = {
			random_child = {
				limit = {
					is_alive = yes
					is_adult = yes
					is_female = yes
					is_married = no
					character_age <= 40
				}
				save_scope_as = target_spouse
			}
		}
		character:mlo_sforza_script = { save_scope_as = target_character}
	}

	option = { #Marry them
		name = flavor_mlo.37.a
		character:mlo_sforza_script = {
			marry_character = scope:target_spouse
		}

		custom_tooltip = {
			text = flavor_mlo.37.tt
			set_as_designated_heir = {
				target = character:mlo_sforza_script
				reason = married_into_ruling_dynasty
			}
		}

		trigger_event_silently = {
			id = ambrosian_republic_disaster.7
			days = { 30 200 }
		}
	}

	option = { #Refuse
		name = flavor_mlo.37.b
		add_stability = stability_weak_bonus
		add_prestige = prestige_weak_bonus
	}
}

# Integration of the Alessandria and Tortona polities
flavor_mlo.40 = {
	type = country_event
	title = flavor_mlo.40.title
	desc = flavor_mlo.40.desc
	historical_info = flavor_mlo.40.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1340.1.1
		to = 1380.1.1
		monthly_chance = 10
	}

	trigger = {
		has_ruler = yes
		at_war = no
		ruler = { has_dynasty = yes }
		prestige >= 40
		location:alessandria = {
			NOT = { owner = ROOT }
			any_neighbor_location = {
				owner = ROOT
			}
		}
		location:tortona = {
			NOT = { owner = ROOT }
			any_neighbor_location = {
				owner = ROOT
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:alessandria = { save_scope_as = target_location }
		location:tortona = { save_scope_as = target_location2 }
		ruler = { save_scope_as = target_character }
	}

	#Make a move.
	option = {
		name = flavor_mlo.40.a

		historical_option = yes

		add_casus_belli =  { type = casus_belli:cb_conquer_province target = scope:target_location.owner province = scope:target_location.province }
		add_casus_belli =  { type = casus_belli:cb_conquer_province target = scope:target_location2.owner province = scope:target_location2.province }

		drop_antagonism_bomb = {
			target = scope:target_location
			modifier = antagonism_pressed_claim
			value = 3
		}
	}

	#Leave them be.
	option = {
		name = flavor_mlo.40.b

		add_stability = stability_mild_bonus
	}
}

# Navigliaccio
flavor_mlo.41 = {
	type = country_event
	title = flavor_mlo.41.title
	desc = flavor_mlo.41.desc
	historical_info = flavor_mlo.41.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1360.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	trigger = {
		peaceful_and_rich = yes
		owns = location:milano
		owns = location:pavia
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		location:milano = {
			save_scope_as = target_location
		}
		location:pavia = {
			save_scope_as = target_location2
		}
	}

	option = {
		name = flavor_mlo.41.a

		historical_option = yes

		add_gold = {
			value = scope:target_location.location_tax_base
			add = {
				value = scope:target_location2.location_tax_base
			}
			multiply = -6.00
		}
		scope:target_location = {
			add_road_to = {
				target = scope:target_location2
				type = paved_road
			}
		}
		scope:target_location = {
			add_location_modifier = {
				modifier = mlo_naviglaccio
				years = -1
			}
		}
		scope:target_location2 = {
			add_location_modifier = {
				modifier = mlo_naviglaccio
				years = -1
			}
		}
	 }

	option = {
		name = flavor_mlo.41.b

		add_stability = stability_mild_bonus
	}
}

# Acquiring land for Park Visconti
flavor_mlo.42 = {
	type = country_event
	title = flavor_mlo.42.title
	desc = flavor_mlo.42.desc
	historical_info = flavor_mlo.42.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1360.1.1
		to = 1400.1.1
		monthly_chance = 10
	}

	trigger = {
		owns = location:pavia
		peaceful_and_rich = yes
		location:pavia = {
			any_work_of_art_in_location = { this = work_of_art:visconti_palace }
		}
		has_ruler = yes
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
		ruler = {
			save_scope_as = target_ruler
		}
	}

	option = {
		name = flavor_mlo.42.a

		historical_option = yes

		trigger_event_non_silently = flavor_mlo.43

		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_severe_penalty
		}

		scope:target_location = {
			add_location_modifier = {
				modifier = mlo_royal_park
				years = -1
			}
		}
	}

	option = {
		name = flavor_mlo.42.b

		add_gold = {
			value = scope:target_location.location_tax_base
			multiply = -24.00
		}

		scope:target_location = {
			add_location_modifier = {
				modifier = mlo_royal_park
				years = -1
			}
		}
	}

	option = {
		name = flavor_mlo.42.c

		add_prestige = prestige_mild_penalty
	}
}

flavor_mlo.43 = {
	type = country_event
	title = flavor_mlo.43.title
	desc = flavor_mlo.43.desc
	historical_info = flavor_mlo.43.historical_info

	illustration_tags = {
        10 = armed
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mlo.43.a

		historical_option = yes

		add_stability = stability_severe_penalty
		add_legitimacy = legitimacy_extreme_penalty
	}

	option = {
		name = flavor_mlo.43.b

		kill_character = ROOT.ruler
	}
}
# Jacopo Dal Verme
flavor_mlo.44 = {
	type = country_event
	title = flavor_mlo.44.title
	desc = flavor_mlo.44.desc
	historical_info = flavor_mlo.44.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1369.1.1
		to = 1400.1.1
		monthly_chance = 10
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	trigger = { peaceful_and_rich = yes }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						dynasty_exists = dal_verme_dynasty
					}
				}
				location:verona = { create_dynasty_from_location = dal_verme_dynasty }
			}
		}
		create_character = {
			first_name = name_james
			dynasty = dynasty:dal_verme_dynasty
			adm = {
				40 60
			}
			dip = {
				50 60
			}
			mil = {
				85 95
			}
			estate = estate_type:nobles_estate
			birth_date = 1350.5.3
			birth_location = location:verona
			create_in_limbo = yes
			save_scope_as = mlo_dal_verme_scope
		}
	}

	option = {
		name = flavor_mlo.44.a

		historical_option = yes

		scope:mlo_dal_verme_scope = {
			move_country = ROOT
		}
		change_gold_effect = { scale = -3 }
		change_societal_value = {
			type = aristocracy_vs_plutocracy
			value = societal_value_minor_move_to_left
		}
	}

	option = {
		name = flavor_mlo.44.b

		add_prestige = prestige_mild_bonus
		hidden_effect = {
			kill_character_silently = {
				target = scope:mlo_dal_verme_scope
				reason = vanished
			}
		}
	}
}

# Bernardino Corio
flavor_mlo.45 = {
	type = country_event
	title = flavor_mlo.45.title
	desc = flavor_mlo.45.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1479.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						dynasty_exists = corio_dynasty
					}
				}
				location:milano = { create_dynasty_from_location = corio_dynasty }
			}
		}
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = name_bernard
			dynasty = dynasty:corio_dynasty
			adm = {
				20 30
			}
			dip = {
				40 50
			}
			mil = {
				30 40
			}
			birth_date = 1459.3.8
			birth_location = location:milano
			artist = writer
			estate = estate_type:nobles_estate
			artist_skill = { 0.65 0.75 }
			save_scope_as = mlo_bernardino_corio_scope
			script = mlo_bernardino_corio
			create_in_limbo = yes
		}
	}

	option = {
		name = flavor_mlo.45.a

		historical_option = yes

		change_gold_effect = { scale = -3 }
		scope:mlo_bernardino_corio_scope = {
			move_country = ROOT
		}
	 }

	option = {
		name = flavor_mlo.45.b

		add_legitimacy = legitimacy_mild_penalty
		kill_character_silently = scope:mlo_bernardino_corio_scope
	}
}

# Historia Milano
flavor_mlo.46 = {
	type = country_event
	title = flavor_mlo.46.title
	desc = flavor_mlo.46.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1500.1.1
		to = 1510.1.1
		monthly_chance = 10
	}

	trigger = {
		character:mlo_bernardino_corio ?= {
			is_alive = yes
			owner = ROOT
		}
	}

	illustration_tags = {
        10 = happy
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:mlo_bernardino_corio = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.46.a

		historical_option = yes

		change_gold_effect = { scale = -3 }
		capital = {
			create_art = {
				type = work_of_art_type:chronicle
				artist = scope:target_character
				quality = { 70 80 }
				key = mlo_historia_patria
			}
		}
		add_legitimacy = legitimacy_severe_bonus
	}

	option = {
		name = flavor_mlo.46.b

		add_prestige = prestige_mild_penalty
	}
}

# Parma falls into Milanese Sphere of Influence
flavor_mlo.47 = {
	type = country_event
	title = flavor_mlo.47.title
	desc = flavor_mlo.47.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1345.1.1
		to = 1355.1.1
		monthly_chance = 10
	}

	trigger = {
		NOT = {
			owns = location:parma
		}
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:parma = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.47.a

		add_country_modifier = {
			modifier = MLO_recent_diplomatic_play
			years = 5
			mode = add_and_extend
		}
		add_casus_belli = { type = casus_belli:cb_conquer_province target = scope:target_location.owner province = scope:target_location.province }
	}
	option = {
		name = flavor_mlo.47.b

		add_legitimacy = legitimacy_mild_bonus
	}
}

# Anti Scaligeri League
flavor_mlo.48 = {
	type = country_event
	title = flavor_mlo.48.title
	desc = flavor_mlo.48.desc
	historical_info = flavor_mlo.48.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1340.1.1
		monthly_chance = 75
	}

	trigger = {
		country_exists = c:VER
		dynasty_exists = scala_dynasty
		OR = {
			country_exists = c:FLO
			country_exists = c:VEN
			country_exists = c:FER
			country_exists = c:MAN
		}
	}

	illustration_tags = {
		10 = armed
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:FLO ?= {
			add_to_list = anti_scaligeri_league
		}
		c:VEN ?= {
			add_to_list = anti_scaligeri_league
		}
		c:FER ?= {
			add_to_list = anti_scaligeri_league
		}
		c:MAN ?= {
			add_to_list = anti_scaligeri_league
		}
		dynasty:scala_dynasty = {
			save_scope_as = target_dynasty
		}
	}

	option = {
		name = flavor_mlo.48.a

		add_casus_belli = {
			target = c:VER
			type = casus_belli:cb_cut_down_in_size
			years = 15
		}

		add_army_tradition = army_tradition_extreme_bonus

		c:VER = {
			trigger_event_silently = flavor_mlo.50
		}

		every_in_list = {
			list = anti_scaligeri_league
			trigger_event_non_silently = flavor_mlo.49
		}

		custom_tooltip = should_at_least_2_accept_we_will_declare_war_within_a_year_tt
	}
}

# Anti Scaligeri League
flavor_mlo.49 = {
	type = country_event
	title = flavor_mlo.49.title
	desc = flavor_mlo.49.desc
	historical_info = flavor_mlo.49.historical_info

	trigger = {
		country_exists = c:VER
	}

	illustration_tags = {
		10 = armed
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mlo.49.a

		historical_option = yes

		ai_will_select = { value = 1 }

		add_casus_belli = {
			target = c:VER
			type = casus_belli:cb_cut_down_in_size
			years = 15
		}

		add_country_modifier = {
			modifier = war_against_verona_modifier
			years = modifier_duration_years_very_short
			mode = replace
		}

		c:VER = {
			drop_antagonism_bomb = {
				target = c:VER.capital
				modifier = antagonism_anti_scaligeri_league
			}
		}

		add_opinion_mutual_effect = {
			target = c:VER
			modifier = opinion_anti_scaligeri_league
		}

		add_army_tradition = army_tradition_extreme_bonus

		custom_tooltip = should_we_accept_we_will_automatically_join_the_upcoming_war_within_next_year_tt
	}

	option = {
		name = flavor_mlo.49.b

		ai_will_select = { value = 0 }

		add_legitimacy = legitimacy_extreme_penalty
	}
}

# Anti Scaligeri League - Verona
flavor_mlo.50 = {
	type = country_event
	title = flavor_mlo.50.title
	desc = flavor_mlo.50.desc
	historical_info = flavor_mlo.50.historical_info

	illustration_tags = {
		10 = armed
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mlo.50.a

		add_army_tradition = army_tradition_extreme_bonus

		show_as_tooltip = {
			every_in_list = {
				list = anti_scaligeri_league
				add_casus_belli = {
					target = c:VER
					type = casus_belli:cb_cut_down_in_size
					years = 15
				}

				add_army_tradition = army_tradition_extreme_bonus
			}

			c:MLO = {
				add_casus_belli = {
					target = c:VER
					type = casus_belli:cb_cut_down_in_size
					years = 15
				}

				add_army_tradition = army_tradition_extreme_bonus
			}
		}
	}
}

# Visconti Palace in Pavia
# https://en.wikipedia.org/wiki/Visconti_Castle_(Pavia)
flavor_mlo.51 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.51.title
	desc = flavor_mlo.51.desc
	historical_info = flavor_mlo.51.historical_info

	illustration_tags = {
		10 = happy
		10 = interior
	}

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1350.1.1
		to = 1375.1.1
		monthly_chance = 20
	}

	trigger = {
		peaceful_and_rich = yes
		owns = location:pavia
		has_ruler = yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
		location:milano = {
			save_scope_as = milan_location
		}
		ruler = {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mlo.51.a

		change_gold_effect = { scale = -2 }

		scope:target_location = {
			create_art = {
				quality = { 70 80 }
				type = work_of_art_type:palace
				key = visconti_palace
			}
		}

		add_prestige = prestige_severe_bonus
	}

	option = {
		name = flavor_mlo.51.b

		add_legitimacy = legitimacy_mild_penalty
	}
}

# Visconti-Sforza Library
flavor_mlo.52 = {
	type = country_event
	title = flavor_mlo.52.title
	desc = flavor_mlo.52.desc

	illustration_tags = {
		10 = regular
		10 = interior
	}

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MLO
		from = 1375.1.1
		to = 1400.1.1
		monthly_chance = 20
	}

	trigger = {
		owns = location:pavia
		work_of_art_exists = { work_of_art = work_of_art:visconti_palace }
		location:pavia = {
			any_work_of_art_in_location = { this = work_of_art:visconti_palace }
		}
		has_ruler = yes
		ruler = { has_dynasty = yes }
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
		ruler = {
			save_scope_as = target_character
		}
	}

	#focus on knowledge
	option = {
		name = flavor_mlo.52.a

		add_research_progress = research_progress_extreme_bonus
		culture = {
			add_cultural_tradition = cultural_influence_mild_bonus
		}
		scope:target_location = {
			add_location_modifier = {
				modifier = MLO_library_research
				years = -1
			}
		}
		custom_tooltip = MLO_can_be_seized_and_must_be_protected
	}
	#focus on literature
	option = {
		name = flavor_mlo.52.b

		add_research_progress = research_progress_mild_bonus
		culture = {
			add_cultural_tradition = cultural_influence_severe_bonus
		}
		scope:target_location = {
			add_location_modifier = {
				modifier = MLO_library_arts
				years = -1
			}
		}
		custom_tooltip = MLO_can_be_seized_and_must_be_protected
	}
	after = {
		scope:target_location = {
			set_variable = MLO_local_library
		}
	}
}

# Visconti-Sforza Library - Seizure of Assets
flavor_mlo.53 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mlo.53.title
	desc = flavor_mlo.53.desc

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
		save_scope_as = library_ruiner
		scope:target_location = {
			remove_variable = MLO_local_library
			set_variable = MLO_deciding_fate_of_library
		}
	}

	#Loot it
	option = {
		name = flavor_mlo.53.a

		historical_option = yes

		add_research_progress = research_progress_extreme_bonus
		culture = {
			add_cultural_tradition = cultural_influence_severe_bonus
		}
		scope:target_location = {
			show_as_tooltip = {
				if = {
					limit = {
						has_location_modifier = MLO_library_research
					}
					remove_location_modifier = MLO_library_research
				}
				if = {
					limit = {
						has_location_modifier = MLO_library_arts
					}
					remove_location_modifier = MLO_library_arts
				}
			}
		}

		drop_antagonism_bomb = {
			target = scope:target_location
			modifier = antagonism_looting
		}

		scope:target_location = {
			remove_variable = MLO_deciding_fate_of_library
		}

		scope:target_location.owner = {
			trigger_event_non_silently = flavor_mlo.54
		}
	}
	# Focus on surroundings
	option = {
		name = flavor_mlo.53.b

		scope:target_location = {
			remove_variable = MLO_deciding_fate_of_library
			set_variable = MLO_local_library
		}

		add_gold = {
			value = scope:target_location.owner.monthly_income_trade_and_tax multiply = 6
		}
	}
}

# Visconti-Sforza Library - Seizure of Assets - Notification
flavor_mlo.54 = {
	type = country_event
	title = flavor_mlo.54.title
	desc = flavor_mlo.54.desc

	illustration_tags = {
		10 = armed
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:pavia = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mlo.54.a

		scope:target_location = {
			if = {
				limit = {
					has_location_modifier = MLO_library_research
				}
				remove_location_modifier = MLO_library_research
			}
			if = {
				limit = {
					has_location_modifier = MLO_library_arts
				}
				remove_location_modifier = MLO_library_arts
			}
		}

		add_prestige = prestige_mild_penalty
	}
}

flavor_mlo.55 = {
	type = country_event
	title = flavor_mlo.55.title
	desc = flavor_mlo.55.desc
	historical_info = flavor_mlo.50.historical_info
	fire_only_once = yes

	dynamic_historical_event = {
		tag = MLO
		from = 1337.1.1
		to = 1367.1.1
		monthly_chance = 100
	}

	illustration_tags = {
		10 = armed
		10 = interior
	}

	major = yes
	major_trigger = {
		OR = {
			tag = VER
			is_in_list = anti_scaligeri_league_list_2
		}
	}

	trigger = {
		country_exists = c:VER
		dynasty_exists = scala_dynasty
		at_war = no
		calc_true_if = {
			amount >= 2
			1 = {
				c:FLO = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
			}
			1 = {
				c:VEN = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
			}
			1 = {
				c:FER = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
			}
			1 = {
				c:MAN = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		ruler_or_regent = { save_scope_as = target_character1 }
		c:VER = {
			save_scope_as = target_enemy_country
			capital = { save_scope_as = target_location }
		}
		dynasty:scala_dynasty = {
			save_scope_as = target_dynasty
			dynasty_head = { save_scope_as = target_character2 }
		}
		c:FLO ?= {
			if = {
				limit = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
				add_to_list = anti_scaligeri_league_list_2
			}
		}
		c:VEN ?= {
			if = {
				limit = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
				add_to_list = anti_scaligeri_league_list_2
			}
		}
		c:FER ?= {
			if = {
				limit = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
				add_to_list = anti_scaligeri_league_list_2
			}
		}
		c:MAN ?= {
			if = {
				limit = {
					can_declare_war_on = c:VER
					at_war = no
					has_casus_belli_of_type_on = { 
						type = casus_belli:cb_cut_down_in_size 
						target = c:VER
					}
				}
				add_to_list = anti_scaligeri_league_list_2
			}
		}

		ordered_in_list = {
			list = anti_scaligeri_league_list_2
			order_by = great_power_score
			position = 0
			check_range_bounds = no
			save_scope_as = target_country_1
		}

		ordered_in_list = {
			list = anti_scaligeri_league_list_2
			order_by = great_power_score
			position = 1
			check_range_bounds = no
			save_scope_as = target_country_2
		}
	}

	option = {
		name = flavor_mlo.55.a

		add_country_modifier = {
			modifier = war_against_verona_modifier
			years = modifier_duration_years_very_short
			mode = replace
		}

		declare_war_with_cb = {
			target = c:VER
			type = casus_belli:cb_cut_down_in_size
		}

		custom_tooltip = {
			text = those_who_pledged_will_join_tt
				random_current_war = {
				save_temporary_scope_as = target_war
			}
			every_in_list = {
				list = anti_scaligeri_league_list_2
				join_war_as_attacker = {
					war = scope:target_war
					call_in_subjects = yes
				}
			}
		}
	}
}