namespace = flavor_gen

scripted_trigger is_corsica = {
	OR = {
		province_definition = province_definition:cismonte_province
		province_definition = province_definition:pumonte_province
	}
}

scripted_trigger owns_corsica = {
	any_owned_location = {
		is_corsica = yes
	}
}

scripted_effect create_corsican_rebels = {
	if = {
		limit = { NOT = { any_rebel = { rebel_name_key = corsican_independence_fighter } } }
		create_rebel = {
			category = nationalist
			name = corsican_independence_fighter
			save_scope_as = corsican_independence_fighter
			culture = culture:corsican
		}
	}
	else = {
		scope:corsican_independence_fighter = {
			add_rebel_progress = 0.05
		}
	}
}

#Founding of the Merchant Republic
flavor_gen.1 = {
	hide_portraits = yes
	type = country_event
	title = flavor_gen.1.title
	desc = flavor_gen.1.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1339.1.1
		to = 1363.3.14
		monthly_chance = 25	#We want this to happen almost guaranteed
	}
	
	trigger = {
		has_reform = government_reform:diarchy_republic
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		if = {
			limit = {
				exists = character:gen_simone_boccanegra
				character:gen_simone_boccanegra = {
					owner = root
					is_alive = yes
				}
			}
			character:gen_simone_boccanegra = { save_scope_as = target_character }
		}
		else = {
			create_character = {
				estate = estate_type:burghers_estate
				adm = { 50 70 }
				dip = { 50 70 }
				mil = { 50 70 }
				birth_location = location:genoa
				culture = root.culture
				religion = root.religion
				save_scope_as = target_character
			}
		}
	}

	option = {
		name = flavor_gen.1.a
		historical_option = yes
		add_government_power = government_power_mild_bonus
		remove_current_major_government_reform = yes
		add_reform = government_reform:merchant_republic
		change_heir_selection = heir_selection:doge_election
		set_new_ruler = scope:target_character
		ai_chance = {
			factor = 95
		}
	}
	option = {
		name = flavor_gen.1.b
		add_government_power = government_power_mild_penalty
		ai_chance = {
			factor = 5
		}
		if = {
			limit = {
				character:gen_simone_boccanegra ?= {
					OR = {
						owner != root
						is_alive = no
					}
				}
			}
			kill_character_silently = scope:target_character
		}
	}
}

#The Liber Gazerie
flavor_gen.2 = {
	type = country_event
	title = flavor_gen.2.title
	desc = flavor_gen.2.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1340.1.1
		to = 1450.1.1
		monthly_chance = 5
	}
	trigger = {
		owns = location:kaffa
		capital.sub_continent = sub_continent:western_europe
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		area:crimea_area = {
			random_location_in_area = {
				limit = {
					has_owner = yes
					owner = root
				}
				save_scope_as = target_location_for_loc
				random_pop = {
					limit = { owner = root }
					save_scope_as = target_pop_for_loc
				}
			}
		}
	}
	option = {
		name = flavor_gen.2.a
		historical_option = yes
		hidden_effect = {
			set_variable = {
				name = codified_liber_gazerie
				value = 1
			}
		}
		add_yearly_gold = -0.5
		area:crimea_area = {
			custom_tooltip = {
				text = flavor_gen.2.a.tt
				every_location_in_area = {
					limit = {
						owner ?= ROOT
					}
					change_control = control_radical_bonus
					every_pop = {
						limit = {
							owner = root
						}
						add_pop_satisfaction = pop_satisfaction_mild_bonus
					}
				}
			}
		}
	}
	option = {
		name = flavor_gen.2.b
		add_government_power = government_power_weak_bonus
	}
}

#Fall of Constantinople
flavor_gen.3 = {
	type = country_event
	title = flavor_gen.3.title
	desc = flavor_gen.3.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1300.1.1
		to = 1550.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		set_variable = {
			name = gen_had_fall_of_constantinople
			value = 1
		}
	}
	
	
	trigger = {
		has_reform = government_reform:merchant_republic
		country_exists = c:TUR
		location:constantinople = {
			owner = c:TUR
		}
		
		any_market_with_merchants = {
			location.area = area:crimea_area
		}
		
		NOT = {
			capital.area = area:crimea_area
		}
	}

	option = {
		name = flavor_gen.3.a
		historical_option = yes
		custom_tooltip = flavor_gen.3.a.tt

		c:TUR = {
			trigger_event_silently = { id = flavor_gen.4 days = 23 }
		}
	}
	option = {
		name = flavor_gen.3.b
		add_prestige = prestige_extreme_penalty
	}
}

#Demands from Genoa
flavor_gen.4 = {
	type = country_event
	title = flavor_gen.4.title
	desc = flavor_gen.4.desc
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:GEN = {
			random_owned_location = {
				limit = {
					area = area:crimea_area
				}
				save_scope_as = target_location
			}
		}
	}
	
	option = {
		name = flavor_gen.4.a
		historical_option = yes
		c:GEN = {
			add_opinion = { target = root modifier = gen_trade_access_denied }
			hidden_effect = {
				trigger_event_silently = { id = flavor_gen.5 days = 32 }
			}
		}
		if = {
			limit = {
				exists = scope:target_location
			}
			add_casus_belli =  { type = casus_belli:cb_conquer_province province = scope:target_location.province target = c:GEN }
		}
	}
	option = {
		name = flavor_gen.4.b
		custom_tooltip = flavor_gen.4.b.tt
		c:GEN = {
			add_opinion = { target = root modifier = gen_trade_given }
			trigger_event_silently = { id = flavor_gen.6 days = 32 }
		}
	}
}

#The Ottomans refuse!
flavor_gen.5 = {
	type = country_event
	title = flavor_gen.5.title
	desc = flavor_gen.5.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = { 
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	option = {
		name = flavor_gen.5.a
		c:TUR = {
			add_opinion = { target = root modifier = gen_trade_access_denied }
		}
		add_prestige = prestige_mild_penalty
	}
}

#Privileged Trade Granted!
flavor_gen.6 = {
	type = country_event
	title = flavor_gen.6.title
	desc = flavor_gen.6.desc
	illustration_tags = {
		10 = happy
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	option = {
		name = flavor_gen.6.a
		create_relation = {
			first = this
			second = c:TUR
			type = relation_type:sound_toll_exemption
		}
	}
}

#The Statuta Gazerie
flavor_gen.7 = {
	type = country_event
	title = flavor_gen.7.title
	desc = flavor_gen.7.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1441.1.1
		to = 1537.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	trigger = {
		owns = location:kaffa
		capital.sub_continent = sub_continent:western_europe
		has_variable = codified_liber_gazerie
	}
	option = {
		name = flavor_gen.7.a
		historical_option = yes
		change_gold_effect = { scale = -5 }
		area:crimea_area = {
			every_location_in_area = {
				limit = {
					owner ?= ROOT
				}
				change_control = control_radical_bonus
				every_pop = {
					limit = {
						owner = root
					}
					add_pop_satisfaction = pop_satisfaction_mild_bonus
				}
			}
		}
		add_stability = stability_mild_bonus
	}
	option = {
		name = flavor_gen.7.b
		add_government_power = government_power_weak_bonus
	}
	after = {
		remove_variable = codified_liber_gazerie
	}
}

#Bankruptcy of the Casa San Giorgio
flavor_gen.8 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.8.title
	desc = flavor_gen.8.desc
	
	dynamic_historical_event = {
		tag = GEN
		from = 1444.1.1
		to = 1446.1.1
		monthly_chance = 20
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}	
	option = {
		name = flavor_gen.8.a
		historical_option = yes
		add_inflation = inflation_severe_penalty
	}
	option = {
		name = flavor_gen.8.b
		add_government_power = government_power_extreme_penalty
	}
}

#The Guelph-Ghibelline Feud
flavor_gen.9 = {
	type = country_event
	title = flavor_gen.9.title
	desc = flavor_gen.9.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1400.1.1
		to = 1550.1.1
		monthly_chance = 2
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	trigger = {
		country_exists = c:FRA
		government_type = government_type:republic
		NOT = { c:FRA = international_organization:hre.leader_country }

		c:FRA = {
			num_of_non_rural >= 10
		}
	}

	option = {
		name = flavor_gen.9.a
		historical_option = yes
		c:FRA = { add_opinion = { target = root modifier = gen_pro_guelph }	}
		international_organization:hre.leader_country = {	add_opinion = { target = root modifier = gen_anti_ghibellines }	}
	}
	option = {
		name = flavor_gen.9.b
		international_organization:hre.leader_country = {	add_opinion = { target = root modifier = gen_pro_ghibellines } 	}
		c:FRA = {	add_opinion = { target = root modifier = gen_anti_guelph } }
	}
}

#The Admiral Andrea Doria
flavor_gen.10 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.10.title
	desc = flavor_gen.10.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1520.1.1
		to = 1540.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = name_andrea
			dynasty = dynasty:doria_dynasty
			estate = estate_type:nobles_estate
			adm = 85
			dip = 80
			mil = 95
			add_trait = trait:ironside
			birth_date = 1466.11.30
			script = gen_andrea_doria
			create_in_limbo = yes
			save_scope_as = target_character
		}
	}
	
	trigger = {
		government_type = government_type:republic
		navy_tradition >= 40
	}

	option = {
		name = flavor_gen.10.a
		historical_option = yes
		scope:target_character = {
			move_country = root
		}
	}
	option = {
		name = flavor_gen.10.b
		add_government_power = government_power_mild_bonus
	}
}

#[ROOT.GetCountry.GetGovernment.GetRulerTitle] Andrea Doria
flavor_gen.11 = {
	hide_portraits = yes
	type = country_event
	fire_only_once = yes
	title = flavor_gen.11.title
	desc = flavor_gen.11.desc
	
	dynamic_historical_event = {
		tag = GEN
		from = 1520.1.1
		to = 1699.1.1
		monthly_chance = 5
	}	
	trigger = {
		government_type = government_type:republic
		exists = character:gen_andrea_doria
		character:gen_andrea_doria = {
			is_alive = yes
			owner = root
		}
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:gen_andrea_doria = {
			save_scope_as = target_char
		}
		
	}
	option = {
		name = flavor_gen.11.b
		historical_option = yes
		add_stability = stability_extreme_bonus
		add_reform = government_reform:great_and_minor_councils_of_genoa
		change_heir_selection = heir_selection:republic_2_year_terms
	}
	option = {
		name = flavor_gen.11.a
		add_government_power = government_power_extreme_penalty
		set_new_ruler = scope:target_char
	}
}

#The decision of Genoa
flavor_gen.12 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.12.title
	desc = flavor_gen.12.desc
	
	dynamic_historical_event = {
		tag = GEN
		from = 1540.1.1
		to = 1699.1.1
		monthly_chance = 5
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	
	trigger = {
		government_type = government_type:republic
		region:italy_region = {
			any_location_in_region = {
				OR = {
					AND = {
						country_exists = c:FRA
						owner ?= c:FRA
					}
					AND = {
						country_exists = c:CAS
						owner ?= c:CAS
					}
				}
			}
			
		}
	}

	option = {
		name = flavor_gen.12.a
		historical_option = yes
		c:FRA = {
			add_opinion = { target = root modifier = gen_andrea_doria_reform }
		}
		add_prestige = prestige_weak_bonus
	}
	option = {
		name = flavor_gen.12.b
		c:CAS = {
			add_opinion = { target = root modifier = gen_andrea_doria_reform }
		}
		add_religious_influence = religious_influence_mild_bonus
	}
}

#The Golden Age of Genoese Bankers
flavor_gen.13 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.13.title
	desc = flavor_gen.13.desc
	
	dynamic_historical_event = {
		tag = GEN
		from = 1557.1.1
		to = 1627.1.1
		monthly_chance = 2
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	
	trigger = {
		num_loans = 0
		is_during_bankruptcy = no
		monthly_trade_income > 1
	}

	option = {
		name = flavor_gen.13.a
		historical_option = yes
		location:genoa = {
			change_development  = development_severe_bonus
			change_prosperity  = prosperity_mild_bonus
		}
		add_inflation = inflation_extreme_bonus
		change_gold_effect = { scale = 3 }
	}
}

#The Fate of Gazaria
flavor_gen.14 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.14.title
	desc = flavor_gen.14.desc
	
	dynamic_historical_event = {
		tag = GEN
		from = 1337.1.1
		to = 1537.1.1
		monthly_chance = 2
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}	
	trigger = {
		owns = location:kaffa
		has_variable = gen_had_fall_of_constantinople
		location:constantinople = {
			owner = {
				NOT = { religion.group = religion_group:christian }
			}
		}
		monthly_trade_income > 1
	}

	#Cede it to Casa San Giorgio
	option = {
		name = flavor_gen.14.a
		historical_option = yes
		change_gold_effect = { scale = 12 }
		area:crimea_area = {
			every_location_in_area = {
				limit = {
					owner ?= ROOT
				}
				change_control = control_ultimate_penalty
			}
		}
	}

	#Keep it under direct control
	option = {
		name = flavor_gen.14.b
		add_government_power = government_power_mild_bonus
	}
}

#The Maona of Chios and Phocaea
flavor_gen.15 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.15.title
	desc = flavor_gen.15.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1337.1.1
		to = 1341.6.15
		monthly_chance = 20
	}
	trigger = {
		country_exists = c:BYZ
		c:BYZ = { has_ruler = yes }
		location:chios = {
			owner = c:BYZ
		}
		estate_tax_base:burghers_estate >= 10
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	#Option
	option = {
		name = flavor_gen.15.a
		historical_option = yes
		hidden_effect = {
			set_variable = {
				name = gen_has_maona_event
				value = 1
			}
		}
		add_gold = { value = root.estate_tax_base:burghers_estate	multiply = -5 }
		add_gold_to_estate = {
			estate_type = estate_type:burghers_estate
			value = { value = root.estate_tax_base:burghers_estate multiply = 5 }
		}
	}
	#Option
	option = {
		name = flavor_gen.15.b
		add_prestige = prestige_weak_penalty
	}
}

#The Reconquest of Chios
flavor_gen.16 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.16.title
	desc = flavor_gen.16.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1337.1.1
		to = 1453.1.1
		monthly_chance = 10
	}
	trigger = {
		has_variable = gen_has_maona_event
		country_exists = c:BYZ
		c:BYZ = {
			owns = location:chios
			has_any_active_disaster = yes
		}
	}

	major = yes
	major_trigger = {
		tag = BYZ
	}
	illustration_tags = {
		10 = armed
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	#Excellent
	option = {
		name = flavor_gen.16.a
		historical_option = yes
		add_location_as_core = location:chios
		location:chios = {
			change_location_owner = root
			change_control = control_radical_penalty
		}
		c:BYZ = {
			add_opinion = { target = root modifier = gen_has_taken_chios_from_us }
		}
	}
	#We should not anger the Greeks and return the island.
	option = {
		name = flavor_gen.16.b
		c:BYZ = {
			add_opinion = { target = root modifier = gen_has_returned_chios_to_us }
		}
	}
}

#Arrigo della Rocca
flavor_gen.17 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.17.title
	desc = flavor_gen.17.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1362.1.1
		to = 1401.1.1
		monthly_chance = 5
	}
	trigger = {
		owns_corsica = yes
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		create_character = {
			first_name = name_henry
			dynasty = dynasty:della_rocca_dynasty
			estate = estate_type:nobles_estate
			adm = 45
			dip = 60
			mil = 70
			birth_date = 1340.1.1
			birth_location = location:cairo_montenotte
			save_scope_as = arrigo_della_rocca
		}
		create_corsican_rebels = yes
	}
	#Grant him the Maona di Corsica
	option = {
		name = flavor_gen.17.a
		historical_option = yes
		province_definition:pumonte_province = {
			every_location_in_province_definition = {
				limit = {
					owner ?= root
				}
				change_control = control_radical_penalty
				every_pop = {
					limit = {
						owner = root
						culture = culture:corsican
					}
					add_pop_satisfaction = pop_satisfaction_radical_bonus
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
		province_definition:cismonte_province = {
			every_location_in_province_definition = {
				limit = {
					owner ?= root
				}
				change_control = control_radical_penalty
				every_pop = {
					limit = {
						owner = root
						culture = culture:corsican
					}
					add_pop_satisfaction = pop_satisfaction_radical_bonus
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
	}
	#Fight him off!
	option = {
		name = flavor_gen.17.b
		scope:arrigo_della_rocca = {
			change_character_allegiance = scope:corsican_independence_fighter
		}
		custom_tooltip = {
			text = arrigo_della_rocca_support_nobles_joining
			every_owned_location = {
				limit = {
					is_corsica = yes
				}
				every_pop = {
					limit = {
						owner = root
						culture = culture:corsican
						pop_type = pop_type:nobles
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
	}
}

#Sambucuccio d'Alando
scripted_trigger location_gen_18_trigger = {
	owner ?= root
	not = { controller = root }
	controller = {
		OR = {
			government_type = government_type:monarchy
			societal_value:serfdom_vs_free_subjects > 40
		}
	}
}
flavor_gen.18 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.18.title
	desc = flavor_gen.18.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1347.1.1
		to = 1370.1.1
		monthly_chance = 80
	}
	trigger = {
		owns_corsica = yes
		OR = {
			province_definition:cismonte_province = {
				any_location_in_province_definition = {
					location_gen_18_trigger = yes
				}
			}
			province_definition:pumonte_province = {
				any_location_in_province_definition = {
					location_gen_18_trigger = yes
				}
			}
		}
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:corte = {
			create_dynasty_from_location = dalando_dynasty
		}
		create_character = {
			first_name = Sambucuccio
			dynasty = dynasty:dalando_dynasty
			estate = estate_type:peasants_estate
			adm = 35
			dip = 40
			mil = 70
			birth_date = 1325.1.1
			birth_location = location:corte
			save_scope_as = sambucuccio_dalando
		}
		create_rebel = {
			category = nationalist
			name = anti_feudal_revolters
			save_scope_as = anti_feudal_revolters
			culture = culture:corsican
		}
		random_owned_location = {
			limit = {
				OR = {
					province_definition = province_definition:cismonte_province
					province_definition = province_definition:pumonte_province
				}
				location_gen_18_trigger = yes
			}
			save_scope_as = rebel_location
		}
	}
	#May the revolters repel our enemies.
	option = {
		name = flavor_gen.18.a
		historical_option = yes
		scope:sambucuccio_dalando = {
			change_character_allegiance = scope:anti_feudal_revolters
		}
		scope:rebel_location = {
			every_pop = {
				change_pop_allegiance = scope:anti_feudal_revolters
			}
		}
	}
	#We need [sambucuccio_dalando.GetName] as our general!
	option = {
		name = flavor_gen.18.b
		scope:sambucuccio_dalando = { move_country = root }
	}
}

#The Foundation of Bastia
flavor_gen.19 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.19.title
	desc = flavor_gen.19.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 3
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
	}
	trigger = {
		owns = location:bastia
		controls = location:bastia
		at_war = no
		location:bastia = {
			NOT = { location_rank = location_rank:town }
			NOT = { location_rank = location_rank:city }
			NOT = { has_building = building_type:castle }
		}
	}
	#Grant the Maona their needed support.
	option = {
		name = flavor_gen.19.a
		historical_option = yes
		location:bastia = {
			change_location_rank = location_rank:town
			change_building_level_in_location = {
				building = building_type:castle
				value = 1
			}
		}
		change_gold_effect = { scale = -3 }
	}
	#A castle alone is more than enough.
	option = {
		name = flavor_gen.19.b
		location:bastia = {
			change_building_level_in_location = {
				building = building_type:castle
				value = 1
			}
		}
	}
}

#The House of Doria Condottieri
flavor_gen.20 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.20.title
	desc = flavor_gen.20.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1337.1.1
		to = 1837.1.1
		monthly_chance = 5
	}
	trigger = {
		any_rented_out_mercenary = {
			any_mercenary_sub_unit = {
				sub_unit_type = unit_type:a_genoese_crossbowmen
			}
		}
		owns = location:genoa
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
		create_character = {
			dynasty = dynasty:doria_dynasty
			estate = estate_type:nobles_estate
			mil = 90
			min_age = 30
			birth_location = location:genoa
			culture = root.culture
			religion = root.religion
			save_scope_as = doria_commander
		}
		random_rented_out_mercenary = {
			limit = {
				any_mercenary_sub_unit = {
					sub_unit_type = unit_type:a_genoese_crossbowmen
				}
			}
			save_scope_as = merc_army
		}
	}
	#Let him command our troops.
	option = {
		name = flavor_gen.20.a
		historical_option = yes
		scope:merc_army = {
			every_mercenary_sub_unit = {
				add_subunit_experience = 10
			}
			owner = {
				scope:doria_commander = { move_country = PREV }
			}
		}
		add_gold = { value = scope:merc_army.monthly_cost add = 10 multiply = 6 }
		add_army_tradition = army_tradition_mild_bonus
	}
	#We need his experience for all of our armies.
	option = {
		name = flavor_gen.20.b
		scope:doria_commander = {
			add_trait = trait:unsuited_for_army_command
			add_trait = trait:unsuited_for_naval_command
		}
		add_army_tradition = army_tradition_extreme_bonus
	}
}

#The Genoese Crossbowmen
flavor_gen.21 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.21.title
	desc = flavor_gen.21.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1337.1.1
		to = 1837.1.1
		monthly_chance = 1
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	trigger = {
		any_unit = {
			any_sub_unit = {
				sub_unit_type = unit_type:a_genoese_crossbowmen
			}
			count = 1
		}
	}
	#They shall shape the battlefields of our time.
	option = {
		name = flavor_gen.21.a
		historical_option = yes
		add_army_tradition = army_tradition_extreme_bonus
	}
	#The crossbowmen bring glory to [ROOT.GetCountry.GetName].
	option = {
		name = flavor_gen.21.b
		add_prestige = prestige_extreme_bonus
	}
}

#[ROOT.GetCountry.GetAdjective] Business Opportunities
flavor_gen.22 = {
	hide_portraits = yes
	type = country_event
	fire_only_once = yes
	title = flavor_gen.22.title
	desc = flavor_gen.22.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1337.1.1
		to = 1453.1.1
		monthly_chance = 1
	}
	trigger = {
		country_exists = c:FRA
		country_exists = c:ENG
		c:FRA = {
			is_at_war_with = c:ENG
		}
		NOT = { is_at_war_with = c:ENG }
		NOT = { is_at_war_with = c:FRA }
		situation:hundred_years_war = {
			situation_is_active = yes
		}
		any_unit = {
			any_sub_unit = {
				sub_unit_type = unit_type:a_genoese_crossbowmen
				count >= 5
			}
		}
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		random_unit = {
			limit = {
				any_sub_unit = {
					sub_unit_type = unit_type:a_genoese_crossbowmen
					count >= 5
				}
			}
			save_scope_as = crossbowmen_unit
		}
		save_scope_as = genoese_crossbowmen_seller
		c:FRA = { save_scope_as = target_country }
		c:ENG = { save_scope_as = target_country2 }		
	}
	#Let us support the [GetCountry('FRA').GetAdjective].
	option = {
		name = flavor_gen.22.a
		historical_option = yes
		reverse_add_opinion = { modifier = gen_offered_crossbowmen target = c:FRA }
		reverse_add_opinion = { modifier = gen_offered_opponent_crossbowmen target = c:ENG }
		custom_tooltip = {
			text = flavor_gen.22.a.tt
			c:FRA = {
				save_scope_as = genoese_crossbowmen_buyer
				trigger_event_silently = {
					id = flavor_gen.23
					days = 10
				}
			}
		}
	}
	#The [GetCountry('ENG').GetAdjective] will pay nicely.
	option = {
		name = flavor_gen.22.b
		reverse_add_opinion = { modifier = gen_offered_crossbowmen target = c:ENG }
		reverse_add_opinion = { modifier = gen_offered_opponent_crossbowmen target = c:FRA }
		custom_tooltip = {
			text = flavor_gen.22.b.tt
			c:ENG = {
				save_scope_as = genoese_crossbowmen_buyer
				trigger_event_silently = {
					id = flavor_gen.23
					days = 10
				}
			}
		}
	}
	#We should not antagonize either of these powers.
	option = {
		name = flavor_gen.22.c

		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_minor_move_to_right }
		}
		else = {
			change_societal_value = {
				type = belligerent_vs_conciliatory
				value = societal_value_minor_move_to_right
			}
		}
	}
}

#Offer from [genoese_crossbowmen_seller.GetName]
flavor_gen.23 = {
	hide_portraits = yes
	type = country_event
	fire_only_once = yes
	title = flavor_gen.23.title
	desc = flavor_gen.23.desc
	illustration_tags = {
		10 = regular
		10 = interior
	}	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = {
				tag = FRA
			}
			c:ENG = { save_scope_as = the_enemy }
		}
		else = {
			c:FRA = { save_scope_as = the_enemy }	#France is by default always the enemy
		}
		save_scope_as = genoese_crossbowmen_buyer
	}
	#We must take this offer!
	option = {
		name = flavor_gen.23.a
		historical_option = yes
		show_as_tooltip = {
			transfer_yearly_gold = {
				value = 0.25
				target = scope:genoese_crossbowmen_seller
			}
			custom_tooltip = {
				text = gain_10_a_genoese_crossbowmen
			}
		}
		hidden_effect = {
			scope:genoese_crossbowmen_seller = {
				trigger_event_silently = {
					id = flavor_gen.24
				}
			}
		}
		ai_chance = {
			factor = 9
			modifier = {
				factor = 0
				at_war = no
			}
			modifier = {
				factor = 0
				is_during_bankruptcy = yes
			}
			modifier = {
				factor = 0.5
				num_loans > 5
			}
			modifier = {
				factor = 0
				num_loans > 10
			}
		}
	}
	#We cannot afford it.
	option = {
		name = flavor_gen.23.b
		add_prestige = prestige_weak_penalty
		hidden_effect = {
			scope:genoese_crossbowmen_seller = {
				set_variable = {
					name = gen_rejected_offer
					value = 1
				}
				trigger_event_silently = {
					id = flavor_gen.24
				}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				num_loans > 5
			}
		}
	}
}

#Offer was accepted / rejected
flavor_gen.24 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.24.title
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					NOT = { has_variable = gen_rejected_offer }
				}
				desc = flavor_gen.24.desc.a
			}
			triggered_desc = {
				trigger = {
					has_variable = gen_rejected_offer
				}
				desc = flavor_gen.24.desc.b
			}
		}
	}
	#Excellent!
	option = {
		name = flavor_gen.24.a
		trigger = {
			NOT = { has_variable = gen_rejected_offer }
		}
		scope:genoese_crossbowmen_buyer = {
			transfer_yearly_gold = {
				value = 1
				target = root
			}
			custom_tooltip = {
				text = gain_10_a_genoese_crossbowmen
				capital = {
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
					create_sub_unit = unit_type:a_genoese_crossbowmen
				}
			}
		}
		scope:crossbowmen_unit = {
			ordered_sub_unit = {
				limit = {
					sub_unit_type = unit_type:a_genoese_crossbowmen
				}
				max = 10
				destroy_subunit = yes
			}
		}
	}
	#These fools do not like winning.
	option = {
		name = flavor_gen.24.b
		trigger = {
			has_variable = gen_rejected_offer
		}
		add_prestige = prestige_weak_penalty
		hidden_effect = {
			if = {
				limit = {
					has_variable = gen_rejected_offer
				}
				remove_variable = gen_rejected_offer
			}
		}
	}
}

#The War of the Straits
flavor_gen.25 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.25.title
	desc = flavor_gen.25.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1340.1.1
		to = 1380.1.1
		monthly_chance = 10
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	trigger = {
		country_exists = c:VEN
		owns = location:chios
		NOT = { is_allied_with = { target = c:VEN } }
		has_reform = government_reform:merchant_republic
		c:VEN = {
			has_reform = government_reform:merchant_republic
		}
		any_owned_location = {
			OR = {
				region = region:anatolia_region
				region = region:steppes_region
			}
		}
	}
	#To arms!
	option = {
		name = flavor_gen.25.a
		historical_option = yes
		add_casus_belli = {
			target = c:VEN
			type = casus_belli:cb_maritime_dominance
		}
		c:VEN = {
			add_casus_belli = {
				target = root
				type = casus_belli:cb_maritime_dominance
			}
		}
		hidden_effect = {
			set_variable = {
				name = gen_war_of_straits
				value = 1
			}
		}
	}
	#Maybe this time peace can be secured.
	option = {
		name = flavor_gen.25.b
		add_prestige = prestige_mild_bonus
	}
}

#The War of Chioggia
flavor_gen.26 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.26.title
	desc = flavor_gen.26.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1370.1.1
		to = 1410.1.1
		monthly_chance = 20
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	trigger = {
		has_variable = gen_war_of_straits
		country_exists = c:VEN
		NOT = { is_allied_with = { target = c:VEN } }
		has_reform = government_reform:merchant_republic
		c:VEN = {
			has_reform = government_reform:merchant_republic
		}
		OR = {
			is_rival_of = c:VEN
			is_enemy_of = c:VEN
		}
		OR = {
			location:cape_lecton = {
				location_maritime_presence_power = {
					country = c:VEN
					value >= 50
				}
			}
			location:dardanelles = {
				location_maritime_presence_power = {
					country = c:VEN
					value >= 50
				}
			}
			location:gulf_izmit = {
				location_maritime_presence_power = {
					country = c:VEN
					value >= 50
				}
			}
			location:bosphorus = {
				location_maritime_presence_power = {
					country = c:VEN
					value >= 50
				}
			}
		}
		any_owned_location = {
			OR = {
				region = region:anatolia_region
				region = region:steppes_region
			}
		}
	}
	#Fortune favors the bold!
	option = {
		name = flavor_gen.19.a
		historical_option = yes
		change_societal_value = { type = belligerent_vs_conciliatory value = societal_value_move_to_left }
		add_casus_belli = {
			target = c:VEN
			type = casus_belli:cb_maritime_dominance
		}
		c:VEN = {
			add_casus_belli = {
				target = root
				type = casus_belli:cb_maritime_dominance
			}
		}
	}
	#It might be too risky to keep this conflict open.
	option = {
		name = flavor_gen.19.b
		change_societal_value = { type = belligerent_vs_conciliatory value = societal_value_move_to_right }
	}
	after = {
		remove_variable = gen_war_of_straits
	}
}

#The Siege of Caffa
flavor_gen.27 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.27.title
	desc = flavor_gen.27.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1340.1.1
		to = 1400.1.1
		monthly_chance = 25
	}
	trigger = {
		owns = location:kaffa
		location:kaffa = {
			has_siege = yes
			siege = {
				any_besieging_unit = {
					owner = {
						government_type = government_type:steppe_horde
					}
					count >= 1
				}
			}
		}
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:kaffa = {
			siege = {
				random_besieging_unit = {
					limit = {
						owner = {
							government_type = government_type:steppe_horde
						}
					}
					save_scope_as = sieging_units
					owner = { save_scope_as = sieging_country }
				}
			}
			save_scope_as = origin_location
		}
		capital = {
			save_scope_as = target_location
		}
	}
	#Try to save our people from plague and war!
	option = {
		name = flavor_gen.27.a
		historical_option = yes
		if = {
			limit = {
				OR = {
					disease_is_active = disease:bubonic_plague
					current_date < 1350.1.1
				}
			}
			custom_tooltip = {
				text = flavor_gen.27.a.tt
				set_variable = {
					name = genoese_plague_bringer
					value = yes
				}
			}
		}
		if = {
			limit = {
				exists = scope:origin_location
			}
			add_migration = {
				owner = root
				from = scope:origin_location.province.province_definition
				to = scope:target_location.province.province_definition
				amount = 5
				months = 24
			}
		}
		else = {
			add_government_power = government_power_mild_penalty
		}
	}
	#Famine and death might be the only sensible course of action.
	option = {
		name = flavor_gen.27.b
		scope:origin_location = {
			every_pop = {
				limit = {
					owner = root
				}
				add_pop_satisfaction = pop_satisfaction_extreme_penalty
			}
			province = {
				change_province_food = -50
			}
		}
	}
}

#The Rock of Monaco
flavor_gen.28 = {
	hide_portraits = yes
	type = country_event
	fire_only_once = yes
	title = flavor_gen.28.title
	desc = flavor_gen.28.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1400.1.1
		to = 1440.1.1
		monthly_chance = 5
	}
	trigger = {
		OR = {
			owns = location:nice
			location:nice = {
				owner = {
					NOT = { is_at_war_with = root }
				}
			}
		}
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:nice = {
			owner = {
				save_scope_as = nice_owner
			}
			create_dynasty_from_location = grimaldi_dynasty
		}
	}
	#Let the Grimaldi continue their business.
	option = {
		name = flavor_gen.28.a
		historical_option = yes
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
	}
	#That Rock belongs to us!
	option = {
		name = flavor_gen.28.b
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_extreme_penalty
		}
		location:nice = {
			change_building_level_in_location = {
				building = building_type:rock_of_monaco
				value = 1
				owner = root
			}
		}
	}
}

#Casa San Giorgio's Golden Year
flavor_gen.29 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.29.title
	desc = flavor_gen.29.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1407.1.1
		to = 1805.1.1
		monthly_chance = 1
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	trigger = {
		has_advance = bank_of_saint_george
		is_during_bankruptcy = no
		monthly_balance > 0
		stability > 20
	}
	#Wonderful!
	option = {
		name = flavor_gen.29.a
		historical_option = yes
		add_yearly_gold = 1
		add_inflation = inflation_extreme_bonus
	}
}

#Casa San Giorgio's Financial Problems
flavor_gen.30 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.30.title
	desc = flavor_gen.30.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1407.1.1
		to = 1805.1.1
		monthly_chance = 1
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	trigger = {
		has_advance = bank_of_saint_george
	}
	#Concerning...
	option = {
		name = flavor_gen.30.a
		historical_option = yes
		add_government_power = government_power_mild_penalty
		add_yearly_gold = -0.5
	}
}

#The University of Genoa
flavor_gen.31 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.31.title
	desc = flavor_gen.31.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1475.1.1
		to = 1485.1.1
		monthly_chance = 10
	}
	illustration_tags = {
		10 = exterior
	}
	immediate = {
		event_illustration_estate_background_effect = { background = estate_type:clergy_estate }
	}
	trigger = {
		owns = location:genoa
		country_exists = c:PAP
		c:PAP = { has_ruler = yes }
	}
	#Excellent
	option = {
		name = flavor_gen.31.a
		historical_option = yes
		location:genoa = {
			if = {
				limit = {
					NOT = { has_building_with_at_least_one_level = university }
				}
				change_building_level_in_location = {
					building = building_type:university
					value = 1
				}
			}
			else = {
				change_development = development_mild_bonus
			}
		}
	}
	#Support the university
	option = {
		name = flavor_gen.31.b
		location:genoa = {
			if = {
				limit = {
					NOT = { has_building_with_at_least_one_level = university }
				}
				change_building_level_in_location = {
					building = building_type:university
					value = 1
				}
			}
			else = {
				change_development = development_mild_bonus
			}
		}
		change_gold_effect = { scale = -3 }
		add_research_progress = research_progress_mild_bonus
	}
}

#Sampiero Corso
flavor_gen.32 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.32.title
	desc = flavor_gen.32.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1520.1.1
		to = 1567.1.1
		monthly_chance = 1
	}
	trigger = {
		owns_corsica = yes
		any_neighbor_country = {
			NOT = { is_allied_with = { target = root } }
			NOT = { in_union_with = root }
			is_subject = no
			total_population >= root.total_population
		}
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_neighbor_country = {
			limit = {
				NOT = { is_allied_with = { target = root } }
				NOT = { in_union_with = root }
				is_subject = no
				total_population >= root.total_population
			}
			save_scope_as = target_country
		}
		random_neighbor_country = {
			limit = {
				NOT = { is_allied_with = { target = root } }
				NOT = { in_union_with = root }
				is_subject = no
				total_population >= root.total_population
				religion.group = religion_group:christian
			}
			save_scope_as = target_country
		}
		location:bastia = {
			create_dynasty_from_location = corso_dynasty
		}
		create_character = {
			first_name = Sampieru
			dynasty = dynasty:corso_dynasty
			estate = estate_type:peasants_estate
			adm = 44
			dip = 34
			mil = 52
			birth_date = 1498.1.1
			birth_location = location:bastia
			save_scope_as = sampieru_corso
			script = sampieru_corso
		}
		create_corsican_rebels = yes
	}
	#Who knows what might happen...
	option = {
		name = flavor_gen.32.a
		historical_option = yes
		scope:sampieru_corso = {
			move_country = scope:target_country
		}
		hidden_effect = {
			set_variable = {
				name = exiled_sampieru
			}
		}
	}
	#Let him return prematurely. We shall crush his revolt before it becomes a threat.
	option = {
		name = flavor_gen.32.b
		scope:sampieru_corso = {
			change_character_allegiance = scope:corsican_independence_fighter
		}
		custom_tooltip = {
			text = arrigo_della_rocca_support_nobles_joining
			every_owned_location = {
				limit = {
					is_corsica = yes
				}
				every_pop = {
					limit = {
						owner = root
						culture = culture:corsican
						pop_type = pop_type:nobles
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
	}
}

#The Troubles of Corsica - Start
flavor_gen.33 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.33.title
	desc = flavor_gen.33.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1700.1.1
		to = 1837.1.1
		monthly_chance = 1
	}
	trigger = {
		owns_corsica = yes
		any_owned_location = {
			is_corsica = yes
			num_pop_type:nobles > 0.5
			any_pop = {
				culture = culture:corsican
				pop_type = pop_type:nobles
			}
		}
		NOT = { country_exists = c:COR }
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		location:bastia = {
			create_dynasty_from_location = giafferi_dynasty
		}
		create_character = {
			first_name = Luiggi
			dynasty = dynasty:giafferi_dynasty
			estate = estate_type:nobles_estate
			adm = 44
			dip = 34
			mil = 52
			age = 30
			birth_location = location:bastia
			save_scope_as = luiggi_giafferi
		}
		create_corsican_rebels = yes
	}
	#End these revolts.
	option = {
		name = flavor_gen.33.a
		historical_option = yes
		scope:luiggi_giafferi = {
			change_character_allegiance = scope:corsican_independence_fighter
		}
		custom_tooltip = {
			text = arrigo_della_rocca_support_nobles_joining
			every_owned_location = {
				limit = {
					is_corsica = yes
				}
				every_pop = {
					limit = {
						owner = root
						culture = culture:corsican
						pop_type = pop_type:nobles
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
		hidden_effect = {
			set_variable = { name = corsican_revolt }
		}
	}
	#Grant them their independence.
	option = {
		name = flavor_gen.33.b
		every_owned_location = {
			limit = {
				is_corsica = yes
			}
			add_core = c:COR
			if = {
				limit = {
					is_core_of = root
				}
				remove_core = root
			}
			change_location_owner = c:COR
		}
		c:COR = {
			set_new_ruler = scope:luiggi_giafferi
			change_government_type = government_type:republic
		}
	}
}

#The Troubles of Corsica - It got worse
flavor_gen.34 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.34.title
	desc = flavor_gen.34.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1750.1.1
		to = 1837.1.1
		monthly_chance = 1
	}
	trigger = {
		has_variable = corsican_revolt
		owns_corsica = yes
		any_owned_location = {
			is_corsica = yes
			any_pop = {
				culture = culture:corsican
			}
		}
		NOT = { country_exists = c:COR }
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		create_character = {
			first_name = name_paschal
			dynasty = dynasty:paoli_dynasty
			estate = estate_type:peasants_estate
			adm = 60
			dip = 50
			mil = 75
			age = 25
			birth_location = location:bastia
			save_scope_as = pasquale_paoli
			script = pasquale_paoli
		}
		create_corsican_rebels = yes
	}
	#Crush the revolutionaries!
	option = {
		name = flavor_gen.34.a
		historical_option = yes
		scope:pasquale_paoli = {
			change_character_allegiance = scope:corsican_independence_fighter
		}
		custom_tooltip = {
			text = flavor_gen.45.a.tt
			every_owned_location = {
				limit = {
					is_corsica = yes
				}
				every_pop = {
					limit = {
						owner = root
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
		hidden_effect = {
			set_variable = { name = corsican_republic }
		}
	}
	#Grant them their independence.
	option = {
		name = flavor_gen.34.b
		every_owned_location = {
			limit = {
				is_corsica = yes
			}
			add_core = c:COR
			if = {
				limit = {
					is_core_of = root
				}
				remove_core = root
			}
			change_location_owner = c:COR
		}
		c:COR = {
			set_new_ruler = scope:pasquale_paoli
			change_government_type = government_type:republic
		}
	}
	after = {
		remove_variable = corsican_revolt
	}
}

#The Troubles of Corsica - Rise of the Corsican Republic
flavor_gen.35 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.35.title
	desc = flavor_gen.35.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1755.1.1
		to = 1837.1.1
		monthly_chance = 1
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	trigger = {
		has_variable = corsican_republic
		owns_corsica = yes
		any_owned_location = {
			is_corsica = yes
			any_pop = {
				culture = culture:corsican
			}
		}
		exists = character:pasquale_paoli
		character:pasquale_paoli = { is_alive = yes }
		NOT = { country_exists = c:COR }
	}
	#This island is more curse than blessing...
	option = {
		name = flavor_gen.35.a
		historical_option = yes
		every_owned_location = {
			limit = {
				is_corsica = yes
			}
			add_core = c:COR
			change_control = control_radical_penalty
			every_pop = {
				limit = {
					owner = root
				}
				add_pop_satisfaction = pop_satisfaction_radical_penalty
			}
		}
		custom_tooltip = {
			text = can_sell_corsica_via_diplo_action
			set_variable = { name = yeet_corsica }
			set_global_variable = {
				name = saved_pumonte
				value = location:ajaccio.province
			}
		}
	}
	#Grant them their independence.
	option = {
		name = flavor_gen.35.b
		every_owned_location = {
			limit = {
				is_corsica = yes
			}
			add_core = c:COR
			if = {
				limit = {
					is_core_of = root
				}
				remove_core = root
			}
			change_location_owner = c:COR
		}
		c:COR = {
			if = {
				limit = {
					exists = character:pasquale_paoli
					character:pasquale_paoli = { is_alive = yes }
				}
				set_new_ruler = character:pasquale_paoli
			}
			change_government_type = government_type:republic
		}
	}
	after = {
		remove_variable = corsican_republic
	}
}

#The Troubles of Corsica - Sell Corsica
flavor_gen.36 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.36.title
	desc = flavor_gen.36.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	#Good riddance!
	option = {
		name = flavor_gen.36.a
		historical_option = yes
		scope:corsica_buyer = {
			transfer_yearly_gold = {
				value = 3
				target = root
			}
		}
	}
}

#The Construction of Doge's Palace
flavor_gen.37 = {
	hide_portraits = yes
	type = country_event
	title = flavor_gen.37.title
	desc = flavor_gen.37.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1339.1.1
		to = 1363.3.14
		monthly_chance = 10
	}

	trigger = {
		owns = location:genoa
		has_reform = government_reform:merchant_republic
		succession_law = heir_selection:doge_election
		any_artist = {
			artist_type = architect
		}
		has_ruler = yes
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		random_artist = {
			limit = {
				artist_type = architect
			}
			save_scope_as = target_artist
		}
		ruler = { save_scope_as = target_ruler }
	}

	#Our Doge deserves a palace!
	option = {
		name = flavor_gen.37.a
		culture = {
			add_cultural_influence = cultural_influence_mild_bonus
		}
		add_prestige = legitimacy_weak_bonus
		location:genoa = {
			create_art = {
				quality = 60
				type = work_of_art_type:palace
				key = doges_palace_genoa
				artist = scope:target_artist
			}
		}
	}

	#The Doge shall not be over the traditions of the Republic!
	option = {
		name = flavor_gen.37.b
		culture = {
			add_cultural_tradition = cultural_tradition_mild_bonus
		}
		add_government_power = government_power_mild_bonus
	}
}

#Galeazzo Alessi
flavor_gen.38 = {
	type = country_event
	title = flavor_gen.38.title
	desc = flavor_gen.38.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1542.1.1
		to = 1572.12.30
		monthly_chance = 5
	}
	
	trigger = {
		owns = location:genoa
	}
	image = "gfx/interface/illustrations/institutions/renaissance.dds"
	immediate = {
		create_character = {
			first_name = name_galahad
			last_name = Alessi
			estate = estate_type:burghers_estate
			adm = 17
			dip = 18
			mil = 18
			birth_date = 1512.1.1
			birth_location = location:perugia
			artist_skill = 0.80
			artist = architect
			save_scope_as = artist_character
			create_in_limbo = yes
		}
	}

	#Excellent
	option = {
		name = flavor_gen.38.a
		scope:artist_character = {
			move_country = root
		}
	}
}

#Bartolomeo Bianco
flavor_gen.39 = {
	type = country_event
	title = flavor_gen.39.title
	desc = flavor_gen.39.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1620.1.1
		to = 1657.1.1
		monthly_chance = 5
	}
	image = "gfx/interface/illustrations/institutions/renaissance.dds"
	trigger = {
		owns = location:genoa
	}

	immediate = {
		create_character = {
			first_name = name_bartholomew
			last_name = Bianco
			estate = estate_type:burghers_estate
			adm = 17
			dip = 18
			mil = 18
			birth_date = 1590.1.1
			birth_location = location:como
			artist_skill = 0.70
			artist = architect
			save_scope_as = artist_character
			create_in_limbo = yes
		}
	}

	#Excellent
	option = {
		name = flavor_gen.39.a
		scope:artist_character = {
			move_country = root
		}
	}
}

#Bernardo Strozzi
flavor_gen.40 = {
	type = country_event
	title = flavor_gen.40.title
	desc = flavor_gen.40.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1596.1.1
		to = 1644.8.2
		monthly_chance = 5
	}
	
	trigger = {
		owns = location:genoa
	}
	
	image = "gfx/interface/illustrations/institutions/renaissance.dds"
	
	immediate = {
		create_character = {
			first_name = name_bernard
			last_name = Strozzi
			estate = estate_type:burghers_estate
			adm = 17
			dip = 18
			mil = 18
			birth_date = 1581.5.7
			birth_location = location:genoa
			artist_skill = 0.90
			artist = painter
			save_scope_as = artist_character
			create_in_limbo = yes
		}
	}

	#Excellent
	option = {
		name = flavor_gen.40.a
		scope:artist_character = {
			move_country = root
		}
	}
}

#Giovanni Benedetto Castiglione
flavor_gen.41 = {
	type = country_event
	title = flavor_gen.41.title
	desc = flavor_gen.41.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1645.1.1
		to = 1664.5.5
		monthly_chance = 5
	}
	
	trigger = {
		owns = location:genoa
		has_advance = genoese_school
	}
	
	image = "gfx/interface/illustrations/institutions/renaissance.dds"
	
	immediate = {
		create_character = {
			first_name = name_john
			last_name = Castiglione
			estate = estate_type:burghers_estate
			adm = 17
			dip = 18
			mil = 18
			birth_date = 1609.3.23
			birth_location = location:genoa
			artist_skill = 0.80
			artist = painter
			save_scope_as = artist_character
			create_in_limbo = yes
		}
	}

	#Excellent
	option = {
		name = flavor_gen.41.a
		scope:artist_character = {
			move_country = root
		}
	}
}

#Valerio Castello
flavor_gen.42 = {
	type = country_event
	title = flavor_gen.42.title
	desc = flavor_gen.42.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1645.1.1
		to = 1659.10.1
		monthly_chance = 5
	}
	
	trigger = {
		owns = location:genoa
		has_advance = genoese_school
	}

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	immediate = {
		create_character = {
			first_name = Valerio
			last_name = Castello
			estate = estate_type:burghers_estate
			adm = 17
			dip = 18
			mil = 18
			birth_date = 1624.5.7
			birth_location = location:genoa
			artist_skill = 0.60
			artist = painter
			save_scope_as = artist_character
			create_in_limbo = yes
		}
	}

	#Excellent
	option = {
		name = flavor_gen.42.a
		scope:artist_character = {
			move_country = root
		}
	}
}

#Alessandro Magnasco
flavor_gen.43 = {
	type = country_event
	title = flavor_gen.43.title
	desc = flavor_gen.43.desc
	
	fire_only_once = yes
	dynamic_historical_event = {
		tag = GEN
		from = 1735.1.1
		to = 1749.3.12
		monthly_chance = 5
	}
	
	trigger = {
		owns = location:genoa
		has_advance = genoese_school
	}

	image = "gfx/interface/illustrations/institutions/renaissance.dds"

	immediate = {
		create_character = {
			first_name = name_alexander
			last_name = Magnasco
			estate = estate_type:burghers_estate
			adm = 17
			dip = 18
			mil = 18
			birth_date = 1667.2.4
			birth_location = location:genoa
			artist_skill = 0.90
			artist = painter
			save_scope_as = artist_character
			create_in_limbo = yes
		}
	}

	#Excellent
	option = {
		name = flavor_gen.43.a
		scope:artist_character = {
			move_country = root
		}
	}
}

#The Black Death spreads!
flavor_gen.44 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.44.title
	desc = flavor_gen.44.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1340.1.1
		to = 1400.1.1
		monthly_chance = 10
	}
	image = "gfx/interface/illustrations/situation/black_death.dds"
	trigger = {
		has_variable = genoese_plague_bringer
		disease_is_active = disease:bubonic_plague
	}
	#The end is nigh...
	option = {
		name = flavor_gen.44.a
		historical_option = yes
		location:genoa = {
			set_disease_presence = {
				disease_outbreak = disease:bubonic_plague.original_outbreak
				value = 1
			}
		}
		location:constantinople = {
			set_disease_presence = {
				disease_outbreak = disease:bubonic_plague.original_outbreak
				value = 1
			}
		}
		location:messina = {
			set_disease_presence = {
				disease_outbreak = disease:bubonic_plague.original_outbreak
				value = 1
			}
		}
		hidden_effect = {
			remove_variable = genoese_plague_bringer
		}
	}
}

#Sampiero strikes!
flavor_gen.45 = {
	type = country_event
	fire_only_once = yes
	title = flavor_gen.45.title
	desc = flavor_gen.45.desc
	dynamic_historical_event = {
		tag = GEN
		from = 1520.1.1
		to = 1567.1.1
		monthly_chance = 10
	}
	trigger = {
		has_variable = exiled_sampieru
		owns_corsica = yes
		exists = character:sampieru_corso
		character:sampieru_corso = { is_alive = yes }
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		character:sampieru_corso ?= {
			save_scope_as = sampieru_corso
			move_country = root
		}
		create_corsican_rebels = yes
	}
	#The Corsicans are rising once again
	option = {
		name = flavor_gen.45.a
		historical_option = yes
		if = {
			limit = {
				exists = character:sampieru_corso
				character:sampieru_corso = { is_alive = yes }
			}
			character:sampieru_corso = {
				change_character_allegiance = scope:corsican_independence_fighter
			}
		}
		custom_tooltip = {
			text = flavor_gen.45.a.tt
			every_owned_location = {
				limit = {
					is_corsica = yes
				}
				every_pop = {
					limit = {
						owner = root
						culture = culture:corsican
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					change_pop_allegiance = scope:corsican_independence_fighter
				}
			}
		}
	}
}