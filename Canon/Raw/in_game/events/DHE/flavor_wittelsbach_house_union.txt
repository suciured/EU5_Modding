namespace = flavor_wittelsbach_house_union

flavor_wittelsbach_house_union.1 = { #Treaty of Pavia Follow Up
	type = country_event
	title = flavor_wittelsbach_house_union.1.title
	desc = flavor_wittelsbach_house_union.1.desc
	historical_info = flavor_wittelsbach_house_union.1.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = UBV
		from = 1337.1.1
		to = 1345.1.1
		monthly_chance = 6
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		ruler ?= {
			save_scope_as = target_ruler
		}
		c:PAL.ruler ?= {
			save_scope_as = target_character
		}
		set_global_variable = wittelsbach_treaty_pavia_undecided
	}

	trigger = {
		has_ruler = yes
		ruler.dynasty ?= dynasty:wittelsbach_dynasty
		is_leader_of_international_organization = international_organization:hre
		c:PAL = {
			has_ruler = yes
			ruler.dynasty ?= dynasty:wittelsbach_dynasty
		}
	}

	option = {
		name = flavor_wittelsbach_house_union.1.a
		historical_option = yes

		custom_tooltip = flavor_wittelsbach_house_union.1.a.tt
		add_opinion = {
			target = c:PAL
			modifier = careful_diplomatic_manouvering
		}
		set_global_variable = wittelsbach_treaty_pavia_yes
	}

	option = {
		name = flavor_wittelsbach_house_union.1.b

		add_stability = stability_severe_penalty
		drop_antagonism_bomb = {
			target = c:PAL.capital
			modifier = antagonism_pressed_claim
			value = 15
		}
		add_legitimacy = legitimacy_severe_penalty
		add_casus_belli =  { type = casus_belli:cb_annex target = c:PAL }
		remove_global_variable = wittelsbach_treaty_pavia_undecided
	}
}

flavor_wittelsbach_house_union.2 = { #Palatinate Event for Treaty of Pavia
	hide_portraits = yes
	type = country_event
	title = flavor_wittelsbach_house_union.2.title
	desc = flavor_wittelsbach_house_union.2.desc
	historical_info = flavor_wittelsbach_house_union.1.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = PAL
		from = 1337.1.1
		to = 1346.1.1
		monthly_chance = 100
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		ruler ?= {
			save_scope_as = target_ruler
		}
		c:UBV.ruler ?= {
			save_scope_as = target_character
		}
	}

	trigger = {
		ruler.dynasty ?= dynasty:wittelsbach_dynasty
		c:PAL = {
			ruler.dynasty ?= dynasty:wittelsbach_dynasty
		}
		has_global_variable = wittelsbach_treaty_pavia_undecided
	}

	option = {
		name = flavor_wittelsbach_house_union.2.a
		historical_option = yes

		custom_tooltip = flavor_wittelsbach_house_union.1.a.tt
		add_opinion = {
			target = c:UBV
			modifier = careful_diplomatic_manouvering
		}
		remove_global_variable = wittelsbach_treaty_pavia_undecided
	}

	option = {
		name = flavor_wittelsbach_house_union.2.b

		add_stability = stability_severe_penalty
		drop_antagonism_bomb = {
			target = c:UBV.capital
			modifier = antagonism_pressed_claim
			value = 15
		}
		add_legitimacy = legitimacy_severe_penalty
		add_casus_belli =  { type = casus_belli:cb_annex target = c:UBV }
		remove_global_variable = wittelsbach_treaty_pavia_undecided
		remove_global_variable = wittelsbach_treaty_pavia_yes
	}
}

flavor_wittelsbach_house_union.3 = { #Palatinate Line dies out
	type = country_event
	title = flavor_wittelsbach_house_union.3.title
	desc = flavor_wittelsbach_house_union.3.desc
	historical_info = flavor_wittelsbach_house_union.3.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = BAV
		from = 1360.1.1
		to = 1837.1.1
		monthly_chance = 100
	}

	illustration_tags = {
		10 = angry
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		ruler ?= {
			save_scope_as = target_ruler
		}
		c:PAL = {
			previous_ruler = {
				save_scope_as = target_character
			}
		}
	}

	trigger = {
		has_ruler = yes
		ruler.dynasty ?= dynasty:wittelsbach_dynasty
		c:PAL = {
			has_regent = yes
			NOT = {
				regency_type = regency_type:consort_regency
			}
			is_human = no
		}
		has_global_variable = wittelsbach_treaty_pavia_yes
	}

	option = {
		name = flavor_wittelsbach_house_union.3.a
		historical_option = yes

		c:PAL = {
			every_core_location = {
				add_core = c:BAV
			}
		}
		annex_country = { country = c:PAL }
		if = {
			limit = {
				c:PAL = {
					has_special_status_in_international_organization = {
						type = special_status:elector
						international_organization = international_organization:hre
					}
				}
				c:BAV = {
					NOT = {
						has_special_status_in_international_organization = {
							type = special_status:elector
							international_organization = international_organization:hre
						}
					}
				}
			}
			international_organization:hre = {
				international_organization_add_special_status = {
					type = special_status:elector
					country = c:BAV
				}
			}
		}
	}
}

flavor_wittelsbach_house_union.4 = { #Bavarian Line dies out
	hide_portraits = yes
	type = country_event
	title = flavor_wittelsbach_house_union.4.title
	desc = flavor_wittelsbach_house_union.4.desc
	historical_info = flavor_wittelsbach_house_union.3.historical_info

	fire_only_once = yes
	dynamic_historical_event = {
		tag = PAL
		from = 1360.1.1
		to = 1837.1.1
		monthly_chance = 100
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		ruler ?= {
			save_scope_as = target_ruler
		}
		c:BAV = {
			previous_ruler = {
				save_scope_as = target_character
			}
		}
	}

	trigger = {
		has_ruler = yes
		ruler.dynasty ?= dynasty:wittelsbach_dynasty
		c:BAV ?= {
			has_regent = yes
			NOT = {
				regency_type = regency_type:consort_regency
			}
			is_human = no
		}
		has_global_variable = wittelsbach_treaty_pavia_yes
	}

	option = {
		name = flavor_wittelsbach_house_union.4.a
		historical_option = yes

		c:BAV = {
			every_core_location = {
				add_core = c:PAL
			}
		}
		annex_country = { country = c:BAV }
		if = {
			limit = {
				c:BAV = {
					has_special_status_in_international_organization = {
						type = special_status:elector
						international_organization = international_organization:hre
					}
				}
				c:PAL = {
					NOT = {
						has_special_status_in_international_organization = {
							type = special_status:elector
							international_organization = international_organization:hre
						}
					}
				}
			}
			international_organization:hre = {
				international_organization_add_special_status = {
					type = special_status:elector
					country = c:PAL
				}
			}
		}
	}
}

# Palatinate Line is subjugated
flavor_wittelsbach_house_union.5 = { 
	hide_portraits = yes
	type = country_event
	title = flavor_wittelsbach_house_union.5.title
	desc = flavor_wittelsbach_house_union.5.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = BAV
		from = 1400.1.1
		to = 1837.1.1
		monthly_chance = 2.5
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	trigger = {
		has_ruler = yes
		ruler.dynasty ?= dynasty:wittelsbach_dynasty
		NOT = {
			has_special_status_in_international_organization = {
				type = special_status:elector
				international_organization = international_organization:hre
			}
		}
		c:PAL = {
			is_subject_of = root
			has_special_status_in_international_organization = {
				type = special_status:elector
				international_organization = international_organization:hre
			}
		}
		has_global_variable = wittelsbach_treaty_pavia_yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		save_scope_as = bavaria_country
		ruler ?= { save_scope_as = bavaria_ruler }
		c:PAL = {
			save_scope_as = palatine_country
			ruler ?= { save_scope_as = palatine_ruler }
		}
	}

	option = {
		name = flavor_wittelsbach_house_union.5.a

		international_organization:hre = {
			international_organization_remove_special_status = {
				type = special_status:elector
				country = c:PAL
			}
		}
		international_organization:hre = {
			international_organization_add_special_status = {
				type = special_status:elector
				country = c:BAV
			}
		}
	}
}

# Bavarian Line is Subjugated
flavor_wittelsbach_house_union.6 = { 
	hide_portraits = yes
	type = country_event
	title = flavor_wittelsbach_house_union.6.title
	desc = flavor_wittelsbach_house_union.6.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = PAL
		from = 1400.1.1
		to = 1837.1.1
		monthly_chance = 2.5
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	trigger = {
		has_ruler = yes
		ruler.dynasty ?= dynasty:wittelsbach_dynasty
		NOT = {
			has_special_status_in_international_organization = {
				type = special_status:elector
				international_organization = international_organization:hre
			}
		}
		c:BAV = {
			is_subject_of = root
			has_special_status_in_international_organization = {
				type = special_status:elector
				international_organization = international_organization:hre
			}
		}
		has_global_variable = wittelsbach_treaty_pavia_yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }

		save_scope_as = palatine_country
		ruler ?= { save_scope_as = palatine_ruler }
		c:BAV = {
			save_scope_as = bavaria_country
			ruler ?= { save_scope_as = bavaria_ruler }
		}
	}

	option = {
		name = flavor_wittelsbach_house_union.6.a

		international_organization:hre = {
			international_organization_remove_special_status = {
				type = special_status:elector
				country = c:BAV
			}
		}
		international_organization:hre = {
			international_organization_add_special_status = {
				type = special_status:elector
				country = c:PAL
			}
		}
	}
}
