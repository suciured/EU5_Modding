namespace = flavor_mam

flavor_mam.1 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.1.title
	desc = flavor_mam.1.desc
	image = "gfx/interface/illustrations/situation/rise_of_the_ottomans.dds"

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1500.1.1
		monthly_chance = 50
	}


	trigger = {
		NOR = {
			is_rival_of = c:TUR
			is_enemy_of = c:TUR
		}
		c:TUR = {
			owns = location:constantinople
		}
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		c:TUR = { ruler_or_regent ?= { save_scope_as = target_character2 } }
	}

	option = {
		name = flavor_mam.1.a
		historical_option = yes
		c:TUR = {
			add_opinion = { target = root modifier = mam_poem_recieved }
		}
	}
	option = {
		name = flavor_mam.1.b
		add_stability = stability_mild_bonus
	}
}


flavor_mam.2 = {
	type = country_event
	title = flavor_mam.2.title
	desc = flavor_mam.2.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1457.1.1
		to = 1458.1.1
		monthly_chance = 50
	}


	trigger = {
		ruler ?= { is_female = no }
		owns = location:cairo
	}

	option = {
		name = flavor_mam.2.a
		location:cairo = {
			change_development = development_mild_bonus
		}
	}
}

flavor_mam.3 = {
	type = country_event
	title = flavor_mam.3.title
	desc = flavor_mam.3.desc
	image = "gfx/interface/illustrations/government/throne_rooms/throne_room_syrian.dds"


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1458.1.1
		to = 1470.1.1
		monthly_chance = 5
	}

	trigger = {
		at_war = no
		country_exists = c:CYP

		c:CYP = {
			is_subject = no
			at_war = no
			religion.group = religion_group:christian
			own_entire_province = province_definition:cyprus_province
			government_type = government_type:monarchy
			OR = {
				ruler ?= { is_female = yes }
				has_regent = yes
			}
		}
	}

	option = {
		name = flavor_mam.3.a
		historical_option = yes
		c:CYP = {
			trigger_event_silently = { id = flavor_mam.4 }
		}
		add_prestige = prestige_mild_penalty
	}
	option = {
		name = flavor_mam.3.b
		add_prestige = prestige_mild_bonus
	}
}

flavor_mam.4 = {
	type = country_event
	title = flavor_mam.4.title
	desc = flavor_mam.4.desc
	image = "gfx/interface/illustrations/government/throne_rooms/throne_room_syrian.dds"


	immediate = {

		create_character = {
			first_name = name_james
			dynasty = dynasty:lusignan_dynasty
			adm = 65
			dip = 70
			mil = 68

			save_scope_as = target_character
		}

	}

	option = {
		name = flavor_mam.4.a
		historical_option = yes
		c:MAM = {
			trigger_event_silently = { id = flavor_mam.5 }
		}
		add_prestige = prestige_mild_penalty

		set_new_ruler = scope:target_character
	}
	option = {
		name = flavor_mam.4.b
		change_gold_effect = { scale = -12 }
		c:MAM = {
			trigger_event_silently = { id = flavor_mam.6 }
		}
	}
	option = {
		name = flavor_mam.4.c
		add_prestige = prestige_mild_penalty
		c:MAM = {
			trigger_event_silently = { id = flavor_mam.7 }
			add_opinion = { target = root modifier = mam_refused_james }
		}
	}
}

flavor_mam.5 = {
	type = country_event
	title = flavor_mam.5.title
	desc = flavor_mam.5.desc

	illustration_tags = {
 		10 = happy
 		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.5.a
		c:CYP = {
			add_opinion = { target = root modifier = mam_installed_ruler }
			make_subject_of = {  target = c:MAM type = subject_type:vassal }
		}
		add_prestige = prestige_extreme_bonus
	}
}

flavor_mam.6 = { 
	type = country_event
	title = flavor_mam.6.title
	desc = flavor_mam.6.desc

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:burghers_estate }
	}

	option = {
		name = flavor_mam.6.a
		change_gold_effect = { scale = 3 }
		add_prestige = prestige_weak_bonus
	}
}

flavor_mam.7 = {
	type = country_event
	title = flavor_mam.7.title
	desc = flavor_mam.7.desc

	illustration_tags = {
		10 = angry
		10 = interior
	}
	
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.7.a
		add_casus_belli =  { type = casus_belli:cb_conquer_province target = c:CYP province = location:nicosia_cyp.province }
	}
}

flavor_mam.8 = {
	type = country_event
	title = flavor_mam.8.title
	desc = flavor_mam.8.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1440.1.1
		to = 1470.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		create_character = {
			first_name = name_jamal
			last_name = ibn_Taghribirdi
			adm = {50 80}
			dip = {50 80}
			mil = {50 80}
			birth_date = 1411.2.2
			birth_location = location:cairo
			artist_skill = 0.95
			artist = writer
			estate = estate_type:burghers_estate
			save_scope_as = target_artist
			create_in_limbo = yes
		}
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }

	}

	option = {
		name = flavor_mam.8.a
		historical_option = yes

		scope:target_artist = { move_country = root }
		location:cairo = {
			create_art = {
				artist = scope:target_artist
				quality = 100
				type = work_of_art_type:chronicle
				key = chronicle_of_egypt
			}
		}
		change_gold_effect = { scale = -2 }
	}
	option = {
		name = flavor_mam.8.b
		add_prestige = prestige_mild_penalty
		scope:target_artist = { banish_character = yes }
	}
}


flavor_mam.10 = {
	type = country_event
	title = flavor_mam.10.title
	desc = flavor_mam.10.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1480.1.1
		to = 1490.1.1
		monthly_chance = 2
	}

	trigger = {
		owns = location:medina
	}

	immediate = {
		location:medina = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mam.10.a
		historical_option = yes

		add_gold = {
			value = location:medina.num_buildings
			multiply = -50
		}
	}
	option = {
		name = flavor_mam.10.b

		location:medina = {
			ordered_buildings_in_location = {
				order_by = building_level
				max = {
					value = 1

					add = {
						value = num_buildings
						divide = 5
					}
				}

				location = { major_destroy_building_levels_in_location = yes }
			}
		}
	}
}

flavor_mam.11 = {
	type = country_event
	title = flavor_mam.11.title
	desc = flavor_mam.11.desc


	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1450.1.1
		to = 1500.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = happy
		10 = interior
	}

	trigger = {
		country_exists = c:TUR
		c:TUR.expected_army_size > expected_army_size
		c:TUR = {
			owns = location:constantinople
		}
		any_known_country = {
			religion.group = religion_group:christian
			country_rank_level >= 3
			capital = {
				OR = {
					region = region:iberia_region
					region = region:italy_region
				}
			}
		}
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.11.a

		ordered_known_country = {
			limit = {
				religion.group = religion_group:christian
				country_rank_level >= 3
				capital = {
				OR = {
					region = region:iberia_region
					region = region:italy_region
				}
			}
			}
			order_by = expected_army_size
			max = 3
			add_opinion = { target = root modifier = mam_anti_ottoman_friends }
			trigger_event_silently = { id = flavor_mam.12 }
		}
	}
}

flavor_mam.12 = {
	type = country_event
	title = flavor_mam.12.title
	desc = flavor_mam.12.desc

	illustration_tags = {
		10 = happy
		10 = interior
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.12.a
		c:MAM = {
			add_opinion = { target = root modifier = mam_anti_ottoman_friends }
		}
	}
}

flavor_mam.15 = {
	type = country_event
	title = flavor_mam.15.title
	desc = flavor_mam.15.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1400.1.1
		to = 1600.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = angry
		10 = exterior
	}

	trigger = {
		owns = location:suez
		owns = location:alexandria
		c:POR ?= {
			any_market_with_merchants = {
				location = {
					OR = {
						region = region:somalia_region
						area = area:north_yemen_area
						area = area:south_yemen_area
					}
				}
			}
		}
		country_exists = c:POR
		manpower_percentage >= 0.50
	}
	immediate = {
		c:POR ?= {
			random_market_with_merchants = {
				limit = {
					location = {
						OR = {
							region = region:somalia_region
							area = area:north_yemen_area
							area = area:south_yemen_area
						}
					}
				}
				save_scope_as = target_market
			}
		}
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}

	option = {
		name = flavor_mam.15.a
		historical_option = yes
		set_variable = MAM_POR_conflict
		c:POR = {
			add_opinion = { target = root modifier = mam_por_confronted }
			trigger_event_silently = { id = flavor_mam.16 }
		}
	}
	option = {
		name = flavor_mam.15.b
		add_prestige = prestige_mild_penalty
		scope:target_market = {
			add_merchant_power = {
				country = root
				key = surrender_the_trade
				months = 120
				power = merchant_power_mild_penalty
			}
		}
	}
}

flavor_mam.16 = {
	type = country_event
	title = flavor_mam.16.title
	desc = flavor_mam.16.desc

	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_mam.16.a
		add_casus_belli = {	target = c:MAM	type = casus_belli:cb_trade_war_triggered	}
	}
}

flavor_mam.17 = {
	type = country_event
	title = flavor_mam.17.title
	desc = flavor_mam.17.desc

	immediate = {
		random_owned_location = {
			limit = {
				OR = {
					location_rank = location_rank:city
					location_rank = location_rank:town
					location_rank = location_rank:rural_settlement
				}
			}
			save_scope_as = target_location
		}
		capital = { save_scope_as = target_capital }
		random_list = {
			1 = { culture:circassian_culture = { save_scope_as = target_culture } }
			1 = { culture:abkhazian_culture = { save_scope_as = target_culture } }
			1 = { culture:georgian_culture = { save_scope_as = target_culture } }
			1 = { culture:armenian_culture = { save_scope_as = target_culture } }
			1 = { culture:crimean = { save_scope_as = target_culture } }
			1 = { culture:halychian_culture = { save_scope_as = target_culture } }
			1 = { culture:ruthenian = { save_scope_as = target_culture } }
			1 = { culture:muscovite = { save_scope_as = target_culture } }
			1 = { culture:novgorodian = { save_scope_as = target_culture } }
			1 = { culture:turkish_culture = { save_scope_as = target_culture } }
			1 = { culture:turkoman_culture = { save_scope_as = target_culture } }
			1 = { culture:turkmen_culture = { save_scope_as = target_culture } }
			1 = { culture:khorasani_culture = { save_scope_as = target_culture } }
		}

		save_scope_as = target_country
		create_character = {
			adm = {
				value = { 25 75 }
				add = {
					value = root.army_tradition
					divide = 4
				}
			}
			dip = {
				value = { 25 75 }
				add = {
					value = root.army_tradition
					divide = 4
				}
			}
			mil = {
				value = { 25 75 }
				add = {
					value = root.army_tradition
					divide = 4
				}
			}
			save_scope_as = target_character
			culture = scope:target_culture
			create_in_limbo = yes
			add_trait = trait:mamluk
		}
		create_character = {
			adm = {
				value = { 25 75 }
				add = {
					value = root.army_tradition
					divide = 4
				}
			}
			dip = {
				value = { 25 75 }
				add = {
					value = root.army_tradition
					divide = 4
				}
			}
			mil = {
				value = { 25 75 }
				add = {
					value = root.army_tradition
					divide = 4
				}
			}
			save_scope_as = target_character2
			culture = scope:target_culture
			create_in_limbo = yes
			add_trait = trait:mamluk
		}
	}
	option = {
		name = flavor_mam.17.a

		scope:target_character = {
			move_country = root
			change_character_estate = estate_type:nobles_estate
			if = {
				limit  = { has_dynasty = no }
				custom_tooltip = found_dynasty_target_location_tt
				hidden_effect = {
					scope:target_location = {
						create_dynasty_from_location = random
						last_dynasty_in_location = { save_scope_as = target_dynasty }
					}
					change_dynasty = scope:target_dynasty
				}
			}
		}
   		kill_character_silently = scope:target_character2
	}

	option = {
		name = flavor_mam.17.b
		scope:target_character2 = {
			move_country = root
			change_character_estate = estate_type:nobles_estate
			if = {
				limit  = { has_dynasty = no }
				custom_tooltip = found_dynasty_target_location_tt
				hidden_effect = {
					scope:target_location = {
						create_dynasty_from_location = random
						last_dynasty_in_location = { save_scope_as = target_dynasty }
					}
					change_dynasty = scope:target_dynasty
				}
			}
		}
   		kill_character_silently = scope:target_character
	}
}

flavor_mam.18 = {
	type = country_event
	title = flavor_mam.18.title
	desc = flavor_mam.18.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		any_character = {
			count >= 1
			is_ruler = no
			is_regent = no
			is_heir = no
			has_trait = mamluk
		}
	}

	illustration_tags = {
		10 = interior
		10 = angry
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		set_variable = {
			name = mamluk_count_var
			value = 1	#Cannot be 0
		}
		if = {
			limit = {
				any_character = {
					count > 4
					is_ruler = no
					is_regent = no
					is_heir = no
					has_trait = mamluk
				}
			}
		}
		every_character = {
			limit = {
				is_ruler = no
				is_regent = no
				is_heir = no
				has_trait = mamluk
			}
			owner = {
				change_variable = {
					name = mamluk_count_var
					add = 1
				}
			}
		}
		if = {
			limit = {
				var:mamluk_count_var > 4
			}
			random_list = {
				1 = {
					change_variable = {
						name = mamluk_count_var
						divide = 3	#We do not want to kill ALL the mamluk characters, only a third
					}
				}
				1 = {
					change_variable = {
						name = mamluk_count_var
						divide = 2	#We do not want to kill ALL the mamluk characters, only half
					}
				}
				1 = { }	#Murder them all!
			}
			while = {
				limit = { var:mamluk_count_var > 0 }
				change_variable = {
					name = mamluk_count_var
					subtract = 1
				}
				random_character = {
					limit = {
						is_ruler = no
						is_regent = no
						is_heir = no
						has_trait = mamluk
					}
					set_variable = potential_mamluk_var
				}
			}
		}
		else = {
			every_character = {
				limit = {
					is_ruler = no
					is_regent = no
					is_heir = no
					has_trait = mamluk
				}
				set_variable = potential_mamluk_var
			}
		}
		set_variable = {
			name = mamluk_purge_side_effect_variable
			value = 0
		}
		every_character = {
			limit = {
				has_variable = potential_mamluk_var
			}
			owner = {
				change_variable = {
					name = mamluk_purge_side_effect_variable
					add = 0.1
				}
			}
		}
		event_illustration_government_estate_effect = yes
	}
	option = {
		name = flavor_mam.18.a

		trigger = {
			manpower_percentage > 0.2
		}

		add_yearly_manpower = {
			value = 1
			add = {
				value = manpower
				divide = 5
			}
			multiply = {
				value = 1
				add = var:mamluk_purge_side_effect_variable
			}
			multiply = -1
		}
		add_army_tradition = {
			value = army_tradition_mild_penalty
			add = {
				value = army_tradition_mild_penalty
				multiply = var:mamluk_purge_side_effect_variable
			}
		}
		every_character = {
			limit = {
				has_variable = potential_mamluk_var
			}
			kill_character = this
		}
	}

	option = {
		name = flavor_mam.18.b

		add_government_power = {
			value = government_power_extreme_penalty
			multiply = {
				value = 1
				add = var:mamluk_purge_side_effect_variable
			}
		}
		custom_tooltip = mam_backstabs_later_tt
	}

	after = {
		remove_variable = mamluk_purge_side_effect_variable
		remove_variable = mamluk_count_var
		every_character = {
			limit = { has_variable = potential_mamluk_var }
			remove_variable = potential_mamluk_var
			set_variable = rebelling_mamluk_var
		}
	}
}

flavor_mam.19 = {
	type = country_event
	title = flavor_mam.19.title
	desc = flavor_mam.19.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		any_character = {
			is_ruler = no
			is_heir = no
			is_regent = no
			has_trait = mamluk
			has_variable = rebelling_mamluk_var
		}
	}

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = {
		ordered_character = {
			limit = { has_variable = rebelling_mamluk_var }
			order_by = {
				value = total_abilities
				if = {
					limit = { in_cabinet = yes }
					add = 50
				}
				if = {
					limit = { is_general = yes }
					add = 100
				}
			}
			max = 1
			check_range_bounds = no
			remove_variable = rebelling_mamluk_var
			save_scope_as = target_character
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
		previous_ruler ?= { save_scope_as = target_character3 }
		
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate } 
	}

	option = {
		name = flavor_mam.19.a

		add_stability = stability_extreme_penalty
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_extreme_penalty }
	}

	option = {
		name = flavor_mam.19.b

		create_character = {
			estate = estate_type:nobles_estate
			dynasty = scope:target_character.dynasty
			adm = { 0 50 }
			dip = { 0 50 }
			mil = { 0 65 }
			add_trait = trait:mamluk
		}
		change_societal_value = {
			type = aristocracy_vs_plutocracy
			value = societal_value_minor_move_to_left
		}
	}

	option = {
		name = flavor_mam.19.c

		kill_character = scope:target_character
		add_government_power = government_power_extreme_penalty
	}
}

flavor_mam.20 = {	#$mamluk$ Clashes with Nobles
	type = country_event
	title = flavor_mam.20.title
	desc = flavor_mam.20.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		any_character = {
			is_ruler = no
			is_heir = no
			is_regent = no
			has_trait = mamluk
			has_variable = rebelling_mamluk_var
		}
	}

	illustration_tags = {
		10 = exterior
		10 = armed
	}

	immediate = {
		random_character = {
			limit = {
				is_ruler = no
				is_heir = no
				is_regent = no
				has_trait = mamluk
				has_variable = rebelling_mamluk_var
			}
			save_scope_as = target_character
			remove_variable = rebelling_mamluk_var
			birth_location = {
				save_scope_as = target_location
				province = {
					save_scope_as = target_province
				}
			}
		}
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	option = {
		name = flavor_mam.20.a

		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_bonus }
		kill_character = scope:target_character
		if = {
			limit = {
				scope:target_character.birth_location.owner = root
			}
			custom_tooltip = {
				text = people_in_bl_will_dislike_that_tt
				scope:target_character.birth_location = {
					province = {
						every_location_in_province = {
							every_pop = {
								limit = {
									owner = root
								}
								add_pop_satisfaction = pop_satisfaction_extreme_penalty
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = flavor_mam.20.b

		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_extreme_penalty }
		add_government_power = government_power_extreme_penalty
	}
}

flavor_mam.21 = {
	type = country_event
	title = flavor_mam.21.title
	desc = flavor_mam.21.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		any_character = {
			is_ruler = no
			is_heir = no
			is_regent = no
			has_trait = mamluk
			has_variable = rebelling_mamluk_var
			birth_location.owner = root
		}
	}
	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = {
		random_character = {
			limit = {
				is_ruler = no
				is_heir = no
				is_regent = no
				has_trait = mamluk
				has_variable = rebelling_mamluk_var
			}
			save_scope_as = target_character
			remove_variable = rebelling_mamluk_var
			birth_location = {
				save_scope_as = target_location
				province = {
					save_scope_as = target_province
				}
			}
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {
		name = flavor_mam.21.a

		custom_tooltip = {
			text = target_province_local_abuses_modifier_tt
			scope:target_location = {
				province = {
					every_location_in_province = {
						add_location_modifier = {
							modifier = local_abuses_modifier
							years = 5
							mode = add_and_extend
						}
						every_pop = {
							limit = {
								owner = root
							}
							add_pop_satisfaction = pop_satisfaction_severe_penalty
						}
					}
				}
			}
		}
	}

	option = {
		name = flavor_mam.21.b

		kill_character = scope:target_character
		add_government_power = government_power_extreme_penalty
	}
}

flavor_mam.22 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.22.title
	desc = flavor_mam.22.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		any_character = {
			is_ruler = no
			is_heir = no
			is_regent = no
			has_trait = mamluk
			has_variable = rebelling_mamluk_var
		}
		any_character = {
			is_ruler = no
			is_heir = no
			is_regent = no
			has_trait = mamluk
			NOT = { has_variable = rebelling_mamluk_var }
		}
	}
	illustration_tags = {
		10 = exterior
		10 = angry
	}

	immediate = {
		random_character = {
			limit = {
				is_ruler = no
				is_heir = no
				is_regent = no
				has_trait = mamluk
				has_variable = rebelling_mamluk_var
			}
			save_scope_as = target_character
		}
		random_character = {
			limit = {
				is_ruler = no
				is_heir = no
				is_regent = no
				has_trait = mamluk
				NOT = { has_variable = rebelling_mamluk_var }
			}
			save_scope_as = target_character2
		}
		ruler_or_regent ?= { save_scope_as = target_character3 }
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.22.a

		custom_tooltip = based_on_target_character2_importance_tt
		add_government_power = {
			value = government_power_mild_penalty
			add = {
				value = scope:target_character2.total_abilities
				subtract = scope:target_character.total_abilities
				divide = 10
			}
			if = {
				limit = {
					scope:target_character = { modifier:is_head_of_cabinet = yes }
				}
				add = government_power_extreme_penalty
			}
		}
		add_army_tradition = {
			value = army_tradition_weak_bonus
			add = {
				value = scope:target_character2.total_abilities
				subtract = {
					if = {
						limit = {
							scope:target_character = { modifier:is_head_of_cabinet = yes }
						}
						value = {
							add = scope:target_character.total_abilities
							add = 100
						}
					}
					else = {
						value = scope:target_character.total_abilities
					}
				}
				divide = 10
			}
		}
	}

	option = {
		name = flavor_mam.22.b

		kill_character = scope:target_character
		custom_tooltip = based_on_target_character2_importance_tt
		add_stability = {
			value = stability_mild_penalty
			add = {
				value = scope:target_character2.total_abilities
				subtract = scope:target_character.total_abilities
				divide = 10
			}
			if = {
				limit = {
					scope:target_character = { modifier:is_head_of_cabinet = yes }
				}
				add = stability_mild_penalty
			}
		}

	}
}


flavor_mam.23 = {
	type = country_event
	title = flavor_mam.23.title
	desc = flavor_mam.23.desc
	historical_info = flavor_mam.23.historical_info
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1330.1.1
		to = 1375.1.1
		monthly_chance = 2
	}

	illustration_tags = {
		10 = exterior
		10 = happy
	}

	trigger = {
		at_war = no
		is_during_bankruptcy = no
		location:cairo = {
			owner = root
			has_building = building_type:madrasa
			has_building = building_type:temple
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		location:cairo = {
			save_scope_as = target_location
		}
		ruler_or_regent ?= { save_scope_as = target_character }
	}

	option = {
		name = flavor_mam.23.a

		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_tiny_move_to_right }
		add_research_progress = research_progress_mild_bonus
	}
}

flavor_mam.24 = { #GRAVEYARD
	type = country_event
	title = flavor_mam.24.title
	desc = flavor_mam.24.desc
	fire_only_once = yes
	historical_info = flavor_mam.24.historical_info
	dynamic_historical_event = {
		tag = MAM
		from = 1330.1.1
		to = 1365.1.1
		monthly_chance = 10
	}

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	trigger = {
		has_regent = yes
		government_power < 50
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		previous_ruler ?= { save_scope_as = target_character2 }
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.24.a

		add_country_modifier = {
			modifier = mam_political_instability_modifier
			years = 25
			mode = add_and_extend
		}
		custom_tooltip = modifier_goes_away_if_90_legitimacy_tt
		add_stability = stability_extreme_penalty
		add_government_power = government_power_extreme_penalty
	}
}

flavor_mam.25 = {
	type = country_event
	title = flavor_mam.25.title
	desc = flavor_mam.25.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1330.1.1
		to = 1400.1.1
		monthly_chance = 50
	}

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	trigger = {
		has_country_modifier = mam_political_instability_modifier
		government_power >= 90
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.25.a

		remove_country_modifier = mam_political_instability_modifier
		add_stability = stability_mild_bonus
	}
}

flavor_mam.26 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.26.title
	desc = flavor_mam.26.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1330.1.1
		to = 1400.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = exterior
		10 = happy
	}

	trigger = {
		at_war = no
		is_during_bankruptcy = no
		location:cairo = {
			owner = root
			total_building_levels >= 35
		}
	}

	immediate = {
		set_variable = enable_ablaq_palace_variable
		ruler_or_regent ?= { save_scope_as = target_character }
		location:cairo = { save_scope_as = target_location }
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:burghers_estate }
	}

	option = {
		name = flavor_mam.26.a

		change_gold_effect = { scale = -2 }
		location:cairo = {
			change_prosperity = prosperity_extreme_bonus
			construct_building = {
				building_type = building_type:ablaq_palace
			}
		}
		add_government_power = government_power_severe_bonus
	}

	option = {
		name = flavor_mam.26.b

		add_government_power = government_power_severe_penalty
	}
}

flavor_mam.27 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.27.title
	desc = flavor_mam.27.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1337.1.1
		to = 1437.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		at_war = no
		is_during_bankruptcy = no
		total_sub_unit_type_count:a_mamluk_unit_renaissance > 0
		has_reform = government_reform:mamluk_government
	}

	immediate = {
		set_variable = enables_awlad_al_nas_variable
		ruler_or_regent ?= { save_scope_as = target_character }
		location:cairo = { save_scope_as = target_location }
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_mam.27.a

		add_policy = policy:awlad_al_nas_policy
		add_stability = {
			value = stability_ultimate_penalty
			multiply = {
				value = {
					add = 1
					add = root.modifier:change_policy_cost_modifier
				}
			}
		}
		add_army_tradition = army_tradition_extreme_bonus
	}

	option = {
		name = flavor_mam.27.b

		custom_tooltip = enables_awlad_al_nas
		add_government_power = government_power_ultimate_penalty
		add_army_tradition = army_tradition_extreme_penalty
	}
}

flavor_mam.28 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.28.title
	desc = flavor_mam.28.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1345.1.1
		to = 1380.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		at_war = no
		has_reform = government_reform:mamluk_government
		NOT = { has_policy = ajnad_al_halqa }
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_mam.28.a
		add_policy = policy:ajnad_al_halqa
		add_stability = {
			value = stability_ultimate_penalty
			multiply = {
				value = {
					add = 1
					add = root.modifier:change_policy_cost_modifier
				}
			}
		}
		add_army_tradition = army_tradition_extreme_bonus
	}

	option = {
		name = flavor_mam.28.b

		add_yearly_manpower = {
			value = 1
			add = {
				value = manpower
				divide = 5
			}
			multiply = -1
		}
		add_government_power = government_power_ultimate_penalty
	}
}

flavor_mam.29 = { #Mamluk Administration - The Offices of the Court
	hide_portraits = yes
	type = country_event
	title = flavor_mam.29.title
	desc = flavor_mam.29.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1337.1.1
		to = 1395.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = interior
		10 = regular
	}

	trigger = {
		at_war = no
		is_during_bankruptcy = no
		any_cabinet_character = {
			count > 2
		}
		capital = {
			has_building = building_type:chancery
		}
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character99 }
		ordered_cabinet_character = {
			order_by = total_abilities
			max = 1
			check_range_bounds = no
			save_scope_as = target_character1
		}
		ordered_cabinet_character = {
			order_by = total_abilities
			limit = {
				this != scope:target_character1
			}
			max = 1
			check_range_bounds = no
			save_scope_as = target_character2
		}
		ordered_cabinet_character = {
			order_by = total_abilities
			limit = {
				this != scope:target_character1
				this != scope:target_character2
			}
			max = 1
			check_range_bounds = no
			save_scope_as = target_character3
		}
		set_variable = {
			name = adm_cabinet_skills_variable
			value = {
				add = scope:target_character1.adm
				add = scope:target_character2.adm
				add = scope:target_character3.adm
				divide = 10
			}
		}
		set_variable = {
			name = dip_cabinet_skills_variable
			value = {
				add = scope:target_character1.dip
				add = scope:target_character2.dip
				add = scope:target_character3.dip
				divide = 10
			}
		}
		set_variable = {
			name = mil_cabinet_skills_variable
			value = {
				add = scope:target_character1.mil
				add = scope:target_character2.mil
				add = scope:target_character3.mil
				divide = 10
			}
		}
		ordered_cabinet_character = {
			order_by = adm
			position = 1
			check_range_bounds = no
			save_scope_as = target_character4
		}
		ordered_cabinet_character = {
			order_by = dip
			limit = {
				this != scope:target_character4
			}
			position = 1
			check_range_bounds = no
			save_scope_as = target_character5
		}
		ordered_cabinet_character = {
			order_by = mil
			limit = {
				this != scope:target_character4
				this != scope:target_character5
			}
			position = 1
			check_range_bounds = no
			save_scope_as = target_character6
		}
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.29.a

		scope:target_character4 = {
			add_character_modifier = {
				modifier = elevated_official_modifier
				years = -1
				mode = add_and_extend
			}
			add_adm = 5
			if = {
				limit = {
					NOT = { has_trait = mamluk }
					has_estate = estate_type:nobles_estate
					is_heir = no
					is_female = no
				}
				add_trait = trait:mamluk
			}
		}
		custom_tooltip = based_on_average_adm_cabinet_character_total_abilities_tt
		add_research_progress = {
			value = root.var:adm_cabinet_skills_variable
			divide = 3
			round = yes
		}
		
		
		add_gold = {
			value = root.monthly_income_trade_and_tax
			multiply = -4

			multiply = {
				value = var:adm_cabinet_skills_variable
				divide = 12
			}
		}
	}

	option = {
		name = flavor_mam.29.b

		scope:target_character5 = {
			add_character_modifier = {
				modifier = elevated_official_modifier
				years = -1
				mode = add_and_extend
			}
			if = {
				limit = {
					NOT = { has_trait = mamluk }
					has_estate = estate_type:nobles_estate
					is_heir = no
					is_female = no
				}
				add_trait = trait:mamluk
			}
			add_dip = 5
		}
		custom_tooltip = based_on_average_dip_cabinet_character_total_abilities_tt
		culture = {
			add_cultural_tradition = {
				value = root.var:dip_cabinet_skills_variable
				round = yes
			}
		}
		
		add_gold = {
			value = monthly_income_trade_and_tax
			multiply = -4
			multiply = {
				value = var:dip_cabinet_skills_variable
				divide = 12
			}
		}
	}

	option = {
		name = flavor_mam.29.c

		scope:target_character6 = {
			add_character_modifier = {
				modifier = elevated_official_modifier
				years = -1
				mode = add_and_extend
			}
			if = {
				limit = {
					NOT = { has_trait = mamluk }
					has_estate = estate_type:nobles_estate
					is_heir = no
					is_female = no
				}
				add_trait = trait:mamluk
			}
			add_mil = 5
		}
		custom_tooltip = based_on_average_mil_cabinet_character_total_abilities_tt
		add_army_tradition = {
			value = root.var:mil_cabinet_skills_variable
			round = yes
		}
		add_gold = {
			value = monthly_income_trade_and_tax
			multiply = -4
			multiply = {
				value = var:mil_cabinet_skills_variable
				divide = 12
			}
		}
	}

	after = {
		remove_variable = adm_cabinet_skills_variable
		remove_variable = dip_cabinet_skills_variable
		remove_variable = mil_cabinet_skills_variable
	}
}

flavor_mam.30 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.30.title
	desc = flavor_mam.30.desc
	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1375.1.1
		to = 1437.1.1
		monthly_chance = 1
	}
	image = "gfx/interface/illustrations/institutions/banking.dds"

	trigger = {
		at_war = no
		has_presence_in = area:levant_area
		has_presence_in = region:egypt_region
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.30.a

		add_government_power = government_power_extreme_bonus
		add_country_modifier = {
			modifier = mam_division_of_egypt_modifier
			years = 15
			mode = add_and_extend
		}
		change_gold_effect = { scale = -6 }
		custom_tooltip = cost_scale_with_num_locations_tt
	}

	option = {
		name = flavor_mam.30.b

		add_government_power = government_power_ultimate_penalty
	}
}

flavor_mam.31 = {
	type = country_event
	title = flavor_mam.31.title
	desc = flavor_mam.31.desc
	fire_only_once = yes
	historical_info = flavor_mam.31.historical_info
	dynamic_historical_event = {
		tag = MAM
		from = 1337.1.1
		to = 1453.6.1
		monthly_chance = 5
	}

	illustration_tags = {
		10 =interior
		10 = angry
	}

	trigger = {
		num_loans >= 5
	}

	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.31.a

		add_stability = stability_extreme_penalty
		custom_tooltip = {
			text = extreme_fiscal_reforms_tt
			every_province = {
				change_province_food_percentage = -0.25
				every_location_in_province = {
					change_prosperity = prosperity_severe_penalty
					every_pop = {
						limit = {
							owner = root
						}
						add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					}
				}
			}
		}
		add_gold = {
			value = country_tax_base
			multiply = 5
		}
	}

	option = {
		name = flavor_mam.31.b

		add_stability = stability_mild_penalty
		custom_tooltip = {
			text = mild_fiscal_reforms_tt
			every_province = {
				change_province_food_percentage = -0.2
				every_location_in_province = {
					change_prosperity = prosperity_mild_penalty
					every_pop = {
						limit = {
							owner = root
						}
						add_pop_satisfaction = pop_satisfaction_severe_penalty
					}
				}
			}
		}
		add_gold = {
			value = country_tax_base
			multiply = 2
		}
	}

	option = {
		name = flavor_mam.31.c

		add_government_power = government_power_ultimate_penalty
	}
}

#Refining the Furusiyya
flavor_mam.32 = {
	type = country_event
	title = flavor_mam.32.title
	desc = flavor_mam.32.desc
	image = "gfx/interface/illustrations/units/army_cavalry_4_middle_east_gfx.dds"

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	trigger = {
		army_tradition >= 50
		is_during_bankruptcy = no
		at_war = no
	}

	option = {
		name = flavor_mam.32.a
		change_gold_effect = { scale = -6 }
		add_army_tradition = army_tradition_mild_bonus
		unlock_estate_privilege_effect = { type = mam_refined_furusiyya }
		grant_estate_privilege = estate_privilege:mam_refined_furusiyya
	}

	option = {
		name = flavor_mam.32.b
		add_army_tradition = army_tradition_mild_penalty
	}
}

#Arrival of Ibn Khaldun
flavor_mam.33 = {
	type = country_event
	title = flavor_mam.33.title
	desc = flavor_mam.33.desc

	fire_only_once = yes

	historical_info = flavor_mam.33.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1382.1.1
		to = 1406.1.1
		monthly_chance = 5
	}
	image = "gfx/interface/illustrations/government/throne_rooms/throne_room_syrian.dds"

	trigger = {
		is_during_bankruptcy = no
		owns = location:cairo
		character:ibn_khaldun_script ?= {
			is_alive = yes
			owner != root
		}
	}

	immediate = {
		character:ibn_khaldun_script = {
			owner ?= { save_scope_as = target_country }
			save_scope_as = target_character
		}
		save_scope_as = target_country_2
	}

	option = {
		name = flavor_mam.33.a
		historical_option = yes
		change_gold_effect = { scale = -3 }
		scope:target_country ?= { trigger_event_non_silently = flavor_mam.63 }
		scope:target_character = { move_country = root }

		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_right
		}
	}

	option = {
		name = flavor_mam.33.b
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_left
		}
	}
}

flavor_mam.34 = { #Ibn Khaldun's Family Tragedy  #GRAVEYARD
	type = country_event
	title = flavor_mam.34.title
	desc = flavor_mam.34.desc

	fire_only_once = yes

	historical_info = flavor_mam.34.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1370.1.1
		to = 1390.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	trigger = {
		character:ibn_khaldun_script ?= {
			is_alive = yes
			owner = root
		}
		owns = location:alexandria
		owns = location:cairo
		country_exists = c:TUN
	}

	immediate = {
		character:ibn_khaldun_script ?= { save_scope_as = khaldun }
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_mam.34.a
		historical_option = yes
		scope:khaldun = {
			add_character_modifier = { modifier = ibn_khaldun_mourning days = 30 mode = add_and_extend }
		}
	}

	option = {
		name = flavor_mam.34.b
		add_prestige = prestige_weak_penalty
	}
}

flavor_mam.35 = { #Ibn Khaldun Requests Funding
	type = country_event
	title = flavor_mam.35.title
	desc = flavor_mam.35.desc

	fire_only_once = yes

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	dynamic_historical_event = {
		tag = MAM
		from = 1370.1.1
		to = 1390.1.1
		monthly_chance = 1
	}

	immediate = {
		character:ibn_khaldun_script ?= { save_scope_as = khaldun }
		ruler = {
			save_scope_as = target_ruler
		}
		event_illustration_government_estate_effect = yes
	}

	trigger = {
		has_ruler = yes
		character:ibn_khaldun_script ?= {
			is_alive = yes
		}
	}

	option = {
		name = flavor_mam.35.a
		change_gold_effect = { scale = -3 }
		set_variable = ibn_khaldun_work_of_art
	}

	option = {
		name = flavor_mam.35.b
		add_prestige = prestige_weak_penalty
	}
}

flavor_mam.36 = { #Ibn Khaldun Finishes the Kitāb al-ʻIbar
	type = country_event
	title = flavor_mam.36.title
	desc = flavor_mam.36.desc

	fire_only_once = yes

	historical_info = flavor_mam.36.historical_info

	illustration_tags = {
		10 = happy
		10 = exterior
	}

	dynamic_historical_event = {
		tag = MAM
		from = 1380.1.1
		to = 1390.1.1
		monthly_chance = 20
	}

	immediate = {
		character:ibn_khaldun_script ?= { save_scope_as = khaldun }
		event_illustration_government_estate_effect = yes
	}

	trigger = {
		character:ibn_khaldun_script ?= {
			is_alive = yes
		}
		has_variable = ibn_khaldun_work_of_art
		owns = location:cairo
	}

	option = {
		name = flavor_mam.36.a
		historical_option = yes
		add_prestige = prestige_mild_bonus
		scope:khaldun = {
			add_artist_skill = 0.1
		}
		location:cairo = {
			create_art = {
				quality = 80
				artist = scope:khaldun
				type = work_of_art_type:chronicle
				key = kitab_al_ibar
			}
		}
	}

	after = {
		remove_variable = ibn_khaldun_work_of_art
	}
}

flavor_mam.37 = { #al-Maqrizi
	type = country_event
	title = flavor_mam.37.title
	desc = flavor_mam.37.desc

	fire_only_once = yes

	illustration_tags = {
		10 = happy
		10 = interior
	}

	dynamic_historical_event = {
		tag = MAM
		from = 1400.1.1
		to = 1410.1.1
		monthly_chance = 10
	}

	trigger = {
		character:ibn_khaldun_script ?= {
			is_alive = yes
			owner = root
		}
	}

	immediate = {
		create_character = {
			estate = estate_type:clergy_estate
			first_name = name_taqi
			last_name = al_Maqrizi
			birth_date = 1364.8.3
			birth_location = location:cairo
			artist = writer
			artist_skill = 0.85
			adm = { 50 80 }
			dip = { 50 80 }
			mil = { 20 30 }
			script = al_maqrizi_script
			save_scope_as = target_character
			create_in_limbo = yes
		}
		character:ibn_khaldun_script = {
			save_scope_as = khaldun
		}
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.37.a
		scope:target_character = {
			move_country = root
		}
		add_research_progress = research_progress_mild_bonus
	}
}

flavor_mam.38 = { #Bedouin Warfare Disrupts Trade
	type = country_event
	title = flavor_mam.38.title
	desc = flavor_mam.38.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1350.1.1
		to = 1400.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = angry
		10 = interior
}

	trigger = {
		"culture_percentage_in_country(culture:bedouin_culture)" > 0
		culture != culture:bedouin_culture
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}

	option = {
		name = flavor_mam.38.a
		change_gold_effect = { scale = -4 }
		custom_tooltip = {
			text = flavor_mam.38.a.tt
			every_owned_location = {
				every_pop = {
					limit = {
						owner = root
						culture = culture:bedouin_culture
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
				}
			}
		}
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_bonus }
		add_country_modifier = {
			modifier = mam_bedoin_warfare
			years = 10
			mode = add_and_extend
		}
	}

	option = {
		name = flavor_mam.38.b
		add_stability = stability_extreme_penalty
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_extreme_penalty }
		add_country_modifier = {
			modifier = mam_bedoin_warfare_severe
			years = 10
			mode = add_and_extend
		}
	}

	after = {
		set_variable = mam_relocate_bedouins
	}
}

flavor_mam.39 = { #Relocating the Bedouins
	type = country_event
	title = flavor_mam.39.title
	desc = flavor_mam.39.desc

	fire_only_once = yes

	historical_info = flavor_mam.39.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1380.1.1
		to = 1450.1.1
		monthly_chance = 1
	}

	trigger = {
		has_variable = mam_relocate_bedouins
		own_entire_area = area:hedjaz_area
		"culture_percentage_in_country(culture:bedouin_culture)" > 0
		culture != culture:bedouin_culture
		area:hedjaz_area = {
			any_location_in_area = {
				dominant_culture = culture:bedouin_culture
			}
		}
		own_entire_province = province_definition:qusiyya_province
		own_entire_province = province_definition:asyut_province
	}

	immediate = {
		area:hedjaz_area = {
			ordered_location_in_area = {
				limit = {
					dominant_culture = culture:bedouin_culture
				}
				order_by = population
				max = 1
				save_scope_as = source_location
			}
		}
	}

	option = {
		name = flavor_mam.39.a
		historical_option = yes
		culture:bedouin_culture = {
			change_cultural_view = {
				target = root.culture
				change = -1
			}
		}
		add_migration = {
			owner = this
			from = scope:source_location.province_definition
			to = province_definition:qusiyya_province
			culture = culture:bedouin_culture
			amount = 0.1
			months = 120
		}

		add_migration = {
			owner = this
			from = scope:source_location.province_definition
			to = province_definition:asyut_province
			culture = culture:bedouin_culture
			amount = 0.1
			months = 120
		}
	}

	option = {
		name = flavor_mam.39.b
		add_prestige = prestige_mild_penalty
	}

	after = {
		remove_variable = mam_relocate_bedouins
	}
}

flavor_mam.40 = { #The Pride of Alexandria
	type = country_event
	title = flavor_mam.40.title
	desc = flavor_mam.40.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1380.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	trigger = {
		owns = location:alexandria
	}

	immediate = {
			location:alexandria = {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mam.40.a
		add_prestige = prestige_mild_bonus
		location:alexandria = {
			construct_building = {
				building_type = building_type:lighthouse_of_alexandria
			}
			change_prosperity = prosperity_severe_bonus
		}
	}

	option = {
		name = flavor_mam.40.b
		add_prestige = prestige_mild_penalty
	}
}

flavor_mam.41 = { #The Al Azhar Madrasa
	type = country_event
	title = flavor_mam.41.title
	desc = flavor_mam.41.desc

	fire_only_once = yes

	historical_info = flavor_mam.41.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1360.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	trigger = {
		owns = location:cairo
		location:cairo = {
			has_building = building_type:university
		}
	}

	immediate = {
		location:cairo = {
		save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mam.41.a
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_right
		}
		set_variable = unlocked_al_azhar_madrasa
		location:cairo = {
			construct_building = {
				building_type = building_type:al_azhar_madrasa
			}
		}
	}

	option = {
		name = flavor_mam.41.b
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_left
		}
	}
}

flavor_mam.42 = { #Conquest of Cyprus
	type = country_event
	title = flavor_mam.42.title
	desc = flavor_mam.42.desc

	fire_only_once = yes

	historical_info = flavor_mam.42.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1337.1.1
		to = 1836.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = happy
		10 = interior
	}

	trigger = {
		own_entire_province = province_definition:cyprus_province
		NOT = {
			country_exists = c:CYP
		}
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.42.a
		historical_option = yes
		custom_tooltip = {
			text = flavor_mam.42.a.tt
			province_definition:cyprus_province = {
				every_location_in_province_definition = {
					remove_core = root
					add_core = c:CYP
				}
			}
			create_country_from_cores_in_our_locations = c:CYP
			c:CYP = {
				make_subject_of = { target = root type = subject_type:vassal }
				change_religion = religion:catholic
				change_religion_for_ruler_and_family = { country = c:CYP religion = religion:catholic }
				change_country_color = map_cyprus
				change_government_type = government_type:monarchy
				add_all_estate_satisfaction = { value = estate_satisfaction_ultimate_bonus }
				change_government_type = government_type:monarchy
				every_owned_location = {
					change_control = control_ultimate_bonus
				}
				every_province = {
					limit = { any_location_in_province = { NOT = { integration_level = core } } }
					change_province_integration = core
				}
			}
		}
	}

	option = {
		name = flavor_mam.42.b
		province_definition:cyprus_province = {
			every_location_in_province_definition = {
				change_control = control_mild_bonus
			}
		}
	}
}

flavor_mam.43 = { #Uprooting Christianity
	type = country_event
	title = flavor_mam.43.title
	desc = flavor_mam.43.desc

	fire_only_once = yes

	historical_info = flavor_mam.43.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1350.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = angry
		10 = exterior
	}

	trigger = {
		religion = religion:sunni
		"religion_percentage_in_country(religion:orthodox)" > 0
		"religion_percentage_in_country(religion:miaphysite)" > 0
		"religion_percentage_in_country(religion:nestorianism)" > 0
		area:levant_area = {
			any_location_in_area = {
				count > 20
				owner ?= c:MAM
			}
		}
	}

	immediate = {
		random_pop  = { 
			limit = { 
				religion.group = religion_group:christian
				pop_type = pop_type:clergy
			}
			save_scope_as = target_pop_bckg
		}
		random_pop  = { 
			limit = { 
				religion.group = religion_group:muslim
				pop_type = pop_type:peasants
			}
			save_scope_as = target_pop_frg
		}
	}

	option = {
		name = flavor_mam.43.a
		historical_option = yes
		add_stability = stability_severe_penalty
		custom_tooltip = {
			text = flavor_mam.43.a.tt
			every_owned_location = {
				limit = {
					area = area:levant_area
				}
				every_pop = {
					limit = {
						owner = root
						NOT = { religion = religion:sunni }
					}
					split_pop = {
						fraction = 0.25
						religion = religion:sunni
					}
				}
			}
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_severe_bonus }
		add_estate_satisfaction = { type = estate_type:dhimmi_estate value = estate_satisfaction_severe_penalty }
	}

	option = {
		name = flavor_mam.43.b
		add_stability = stability_mild_penalty
		custom_tooltip = {
			text = flavor_mam.43.b.tt
			every_owned_location = {
				limit = {
					area = area:levant_area
				}
				every_pop = {
					limit = {
						NOT = { religion = religion:sunni }
					}
					split_pop = {
						fraction = 0.10
						religion = religion:sunni
					}
				}
			}
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
		add_estate_satisfaction = { type = estate_type:dhimmi_estate value = estate_satisfaction_mild_penalty }
	}

	option = {
		name = flavor_mam.43.c
		add_stability = stability_mild_bonus
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_severe_penalty }
		add_estate_satisfaction = { type = estate_type:dhimmi_estate value = estate_satisfaction_severe_bonus }
	}
}

flavor_mam.44 = { #Converting the Copts
	type = country_event
	title = flavor_mam.44.title
	desc = flavor_mam.44.desc

	fire_only_once = yes

	historical_info = flavor_mam.44.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	trigger = {
		religion = religion:sunni
		"religion_percentage_in_country(religion:miaphysite)" > 0
		area:lower_egypt_area = {
			any_location_in_area = {
				count > 15
				exists = owner
				owner = c:MAM
			}
		}
	}

	immediate = {
		random_pop  = { 
			limit = { 
				religion.group = religion_group:christian#miaphysite
				pop_type = pop_type:clergy
			}
			save_scope_as = target_pop_bckg
		}
		random_pop  = { 
			limit = { 
				religion.group = religion_group:muslim#miaphysite
				pop_type = pop_type:peasants
			}
			save_scope_as = target_pop_frg
		}
	}

	option = {
		name = flavor_mam.44.a
		historical_option = yes
		add_stability = stability_severe_penalty
		custom_tooltip = {
			text = flavor_mam.44.a.tt
			every_owned_location = {
				limit = {
					area = area:lower_egypt_area
				}
				every_pop = {
					limit = {
						religion = religion:miaphysite
					}
					split_pop = {
						fraction = 0.2
						religion = religion:sunni
					}
				}
			}
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_severe_bonus }
		add_estate_satisfaction = { type = estate_type:dhimmi_estate value = estate_satisfaction_severe_penalty }
	}

	option = {
		name = flavor_mam.44.b
		add_stability = stability_mild_bonus
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_severe_penalty }
		add_estate_satisfaction = { type = estate_type:dhimmi_estate value = estate_satisfaction_severe_bonus }
	}
}

flavor_mam.45 = { #Flooding of the Nile #DEVASTATION?
	type = country_event
	title = flavor_mam.45.title
	desc = flavor_mam.45.desc

	trigger = {
		tag = MAM
		own_entire_province = province_definition:sharqiyya_province
		own_entire_province = province_definition:gharbiyya_province
		own_entire_province = province_definition:buhayra_province
		NOT = {
			has_variable = mam_had_nile_flood
		}
	}

	immediate = {
		set_variable = { name = mam_had_nile_flood days = 18250 }
		province_definition:sharqiyya_province = {
			random_location_in_province_definition = {
				save_scope_as = target_location
			}
		}
		province_definition:gharbiyya_province = {
			random_location_in_province_definition = {
				save_scope_as = target_location_two
			}
		}
		province_definition:buhayra_province = {
			random_location_in_province_definition = {
				save_scope_as = target_location_three
			}
		}
	}

	option = {
		name = flavor_mam.45.a
		change_gold_effect = { scale = -8 }
		scope:target_location = {
			change_prosperity = prosperity_severe_penalty
		}
		scope:target_location_two = {
			change_prosperity = prosperity_severe_penalty
		}
		scope:target_location_three = {
			change_prosperity = prosperity_severe_penalty
		}
	}

	option = {
		name = flavor_mam.45.b
		scope:target_location = {
			change_prosperity = prosperity_radical_penalty
			every_pop = {
				add_pop_size = {
					value = pop_size
					multiply = -0.1
				}
			}
		}
		scope:target_location_two = {
			change_prosperity = prosperity_radical_penalty
			every_pop = {
				add_pop_size = {
					value = pop_size
					multiply = -0.1
				}
			}
		}
		scope:target_location_three = {
			change_prosperity = prosperity_radical_penalty
			every_pop = {
				add_pop_size = {
					value = pop_size
					multiply = -0.1
				}
			}
		}
	}
}

flavor_mam.46 = { #The Muhtasib Inspectors
	type = country_event
	title = flavor_mam.46.title
	desc = flavor_mam.46.desc

	fire_only_once = yes

	historical_info = flavor_mam.46.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}

	illustration_tags = {
		10 = exterior
		10 = angry
	}

	trigger = {
		has_markets = yes
	}

	option = {
		name = flavor_mam.46.a
		historical_option = yes
		change_gold_effect = { scale = -6 }
		unlock_estate_privilege_effect = {
			type = mam_muhtasibs
		}
		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_mam.46.b
		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_severe_penalty
		}
	}
}

flavor_mam.47 = { #Royal Mamluks
	hide_portraits = yes
	type = country_event
	title = flavor_mam.47.title
	desc = flavor_mam.47.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	illustration_tags = {
	10 = regular
	10 = exterior
	}

	trigger = {
		has_ruler = yes
		has_advance = royal_mamluks
	}

	immediate = {
		ruler = {
			save_scope_as = target_ruler
		}
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_mam.47.a
		add_army_tradition = army_tradition_extreme_bonus
	}
}

flavor_mam.48 = { #Printing Press
	type = country_event
	title = flavor_mam.48.title
	desc = flavor_mam.48.desc
	image = "gfx/interface/illustrations/institutions/printing_press.dds"

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1430.1.1
		to = 1560.1.1
		monthly_chance = 10
	}

	illustration_tags = {
		regular = 10
		interior = 10
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		if = {
			limit = {
				current_year < 1550
			}
			create_character = {
				birth_location = location:soncino
				religion = religion:judaism
				adm = { 20 70 }
				dip = { 20 70 }
				mil = { 20 40 }
				culture = culture:ashkenazi
				estate = estate_type:burghers_estate
				save_scope_as = target_character
				create_in_limbo = yes
			}
		}
		else = {
			create_character = {
				first_name = name_gershom
				last_name = bin_Eliezer_Soncino
				birth_date = 1513.4.5
				birth_location = location:soncino
				estate = estate_type:burghers_estate
				religion = religion:judaism
				adm = { 20 70 }
				dip = { 20 70 }
				mil = { 20 40 }
				culture = culture:ashkenazi
				save_scope_as = target_character
				create_in_limbo = yes
			}
		}
	}

	trigger = {
		knows_about_institution = institution:printing_press
		NOT = {	has_embraced_institution = institution:printing_press }
		owns = location:cairo
	}

	option = {
		name = flavor_mam.48.a
		scope:target_character = {
			move_country = root
		}
		location:cairo = {
			change_institution_progress = { type = institution:printing_press value = institution_progress_mild_bonus }
		}
	}

	option = {
		name = flavor_mam.48.b
		change_gold_effect = { scale = -4 }
		scope:target_character = {
			move_country = root
		}
		location:cairo = {
			change_institution_progress = { type = institution:printing_press value = institution_progress_ultimate_bonus }
		}
	}

	option = {
		name = flavor_mam.48.c
   		kill_character_silently = scope:target_character
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
	}
}

flavor_mam.49 = { #Europeans Circumnavigate Africa
	type = country_event
	title = flavor_mam.49.title
	desc = flavor_mam.49.desc

	fire_only_once = yes

	historical_info = flavor_mam.49.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1800.1.1
		monthly_chance = 10
	}

	illustration_tags = {
		10 = angry
		10 = exterior
	}

	trigger = {
		modifier:may_explore = yes
		sub_continent:western_europe = {
			any_present_country = {
				discovered_route_to_india = yes
			}
		}
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}


	option = {
		name = flavor_mam.49.a
		add_prestige = prestige_severe_penalty
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_severe_penalty }
	}

	option = {
		name = flavor_mam.49.b
		historical_option = yes
		custom_tooltip = flavor_mam.49.b.tt
		change_gold_effect = { scale = -4 }
		add_prestige = prestige_weak_penalty
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_penalty }
		create_character = {
			trait_category = explorer
		}
		set_variable = mam_enable_exploration_events
	}
}

flavor_mam.50 = { #Rising Demand of Ship Supplies
	type = country_event
	title = flavor_mam.50.title
	desc = flavor_mam.50.desc
	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_naval_supplies.dds"

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	trigger = {
		has_variable = mam_enable_exploration_events
		any_exploration_from_country = {
			has_leader = yes
		}
	}

	option = {
		name = flavor_mam.50.a
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_bonus }
		capital = {
			market = {
				add_temporary_demand = { type = demand:demands_of_ships months = 240 scale_with_pop = 0.002 }
			}
		}
	}

	option = {
		name = flavor_mam.50.b
		change_gold_effect = { scale = -4 }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_severe_bonus }
		capital = {
			market = {
				add_temporary_demand = { type = demand:demands_of_ships months = 240 scale_with_pop = 0.008 }
			}
		}
		custom_tooltip = {
			text = flavor_mam.50.b.tt
			every_owned_location = {
				if = {
					limit = {
						has_building = building_type:naval_supplies_guild
					}
					change_prosperity = prosperity_severe_bonus
				}
			}
		}
	}
}

flavor_mam.51 = { #Eclipsing Portugal
	hide_portraits = yes
	type = country_event
	title = flavor_mam.51.title
	desc = flavor_mam.51.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1800.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = happy
		10 = exterior
	}

	immediate = {
		ruler = {
			save_scope_as = target_ruler
		}
		c:POR ?= {
			ruler = {
				save_scope_as = target_ruler2
			}
		}
		 event_illustration_government_estate_effect = yes
	}

	trigger = {
		has_ruler = yes
		has_variable = mam_enable_exploration_events
		country_exists = c:POR
		c:POR ?= {
			is_rival_of = root
            navy_size < ROOT.navy_size
        }
	}

	option = {
		name = flavor_mam.51.a
		historical_option = yes
		add_navy_tradition = navy_tradition_severe_bonus
	}
}

flavor_mam.52 = { #Amir Husain Al-Kurdi
	type = country_event
	title = flavor_mam.52.title
	desc = flavor_mam.52.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1505.1.1
		to = 1520.1.1
		monthly_chance = 10
	}

	illustration_tags = {
	10 = regular
	10 = exterior
	}

	immediate = {
		location:midyat ?= {
			create_dynasty_from_location = kurdi_dynasty
		}
		create_character = {
			first_name = name_amir
			last_name = Hussain_al_Kurdi
			birth_date = 1480.2.9
			birth_location = location:midyat
			estate = estate_type:nobles_estate
			adm = 70
			dip = 30
			mil = 90
			dynasty = dynasty:kurdi_dynasty
			culture = culture:kurdish_culture
			save_scope_as = target_character
			create_in_limbo = yes
			religion = religion:sunni
		}
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	trigger = {
		has_variable = mam_enable_exploration_events
	}

	option = {
		name = flavor_mam.52.a
		scope:target_character = {
			move_country = root
			add_random_trait_from_category = admiral
			add_character_modifier = {
				modifier = refuses_to_serve_in_cabinet
				years = -1
				mode = add_and_extend
			}
		}
	}

	option = {
		name = flavor_mam.52.b
		scope:target_character = {
			move_country = root
			add_trait = trait:unsuited_for_naval_command
			add_trait = trait:unsuited_for_army_command
			remove_character_modifier = refuses_to_serve_in_cabinet
		}
	}

	option = {
		name = flavor_mam.52.c
		add_navy_tradition = navy_tradition_severe_bonus
   		kill_character_silently = scope:target_character
	}
}

flavor_mam.53 = { #The Red Sea Fleet
	type = country_event
	title = flavor_mam.53.title
	desc = flavor_mam.53.desc
	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_naval_supplies.dds"

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1600.1.1
		monthly_chance = 1
	}

	trigger = {
		own_entire_province = province_definition:red_sea_coast_province
		has_variable = mam_enable_exploration_events
		has_ruler = yes
	}

	immediate = {
		province_definition:red_sea_coast_province = {
			random_location_in_province_definition = {
				limit = {
					owner = root
					is_port = yes
				}
				save_scope_as = target_location
			}
		}
	}

	option = {
		name = flavor_mam.53.a
		scope:target_location = {
			create_sub_unit_of_category = sub_unit_category:navy_galley
			create_sub_unit_of_category = sub_unit_category:navy_galley
			create_sub_unit_of_category = sub_unit_category:navy_galley
			create_sub_unit_of_category = sub_unit_category:navy_galley
			create_sub_unit_of_category = sub_unit_category:navy_galley
		}
	}

	option = {
		name = flavor_mam.53.b
		scope:target_location = {
			create_sub_unit_of_category = sub_unit_category:navy_transport
			create_sub_unit_of_category = sub_unit_category:navy_transport
			create_sub_unit_of_category = sub_unit_category:navy_transport
			create_sub_unit_of_category = sub_unit_category:navy_transport
			create_sub_unit_of_category = sub_unit_category:navy_transport
		}
	}
}

flavor_mam.54 = { #The Rise of Barquq
	type = country_event
	fire_only_once = yes
	title = flavor_mam.54.title
	desc = flavor_mam.54.desc
	image = "gfx/interface/illustrations/government/throne_rooms/throne_room_syrian.dds"

	historical_info = flavor_mam.54.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1380.1.1
		to = 1400.1.1
		monthly_chance = 10
	}

	trigger = {
		ruler_or_heir_if_regent ?= {
			total_abilities <= 100
		}
		has_heir = no
		location:cairo = {
			owner = root
			controller = root
		}
		stability < 0
	}

	immediate = {
		ruler_or_heir_if_regent = {
			save_scope_as = target_ruler
		}
		location:cairo = {
			create_dynasty_from_location = barquq_dynasty
		}
		create_character = {
			first_name = name_al_malik
			dynasty = dynasty:barquq_dynasty
			estate = estate_type:nobles_estate
			adm = 80
			dip = 40
			mil = 90
			birth_date = 1336.1.1
			culture = culture:circassian_culture
			religion = religion:sunni
			birth_location = location:tuapse
			save_scope_as = scope_barquq
			script = mam_barquq
			add_trait = trait:mamluk
		}
		create_rebel = {
			category = pretender
			name = barquq_supporters
			save_scope_as = barquq_support
		}
		scope:scope_barquq = {
			change_character_allegiance = scope:barquq_support
		}
	}

	option = {
		name = flavor_mam.54.a
		historical_option = yes
		add_stability = stability_severe_penalty
		set_new_ruler = scope:scope_barquq
		scope:target_ruler = {
			kill_character = {
				target = scope:target_ruler
				reason = execution
			}
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_severe_bonus
		}
		hidden_effect = { destroy_rebel = scope:barquq_support }
	}

	option = {
		name = flavor_mam.54.b
		add_stability = stability_ultimate_penalty
		scope:barquq_support = {
			add_rebel_progress = 0.3
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate
			value = estate_satisfaction_severe_penalty
		}
		custom_tooltip = {
			text = flavor_mam.54.b.tt
			every_owned_location = {
				limit = { region = region:egypt_region }
				every_pop = {
					limit = {
						owner = root
						pop_type = pop_type:slaves
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
					change_pop_allegiance = scope:barquq_support
				}
			}
		}
	}
}

flavor_mam.55 = { #The Great Naval Reform
	type = country_event
	fire_only_once = yes
	title = flavor_mam.55.title
	desc = flavor_mam.55.desc
	image = "gfx/interface/illustrations/government/throne_rooms/throne_room_syrian.dds"

	historical_info = flavor_mam.55.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1505.1.1
		to = 1520.1.1
		monthly_chance = 10
	}

	trigger = {
		ruler ?= { mil > 50 }
		at_war = no
		has_variable = mam_enable_exploration_events
	}

	immediate = {
		location:cairo = {
			create_dynasty_from_location = el_emam_dynasty
		}
		create_character = {
			first_name = name_ala.name_al_din
			dynasty = dynasty:el_emam_dynasty
			estate = estate_type:nobles_estate
			adm = 67
			dip = 32
			mil = 82
			birth_date = 1471.4.8
			culture = culture:lower_egyptian_culture
			religion = religion:sunni
			birth_location = location:cairo
			save_scope_as = target_character
			script = mam_alaa
		}
	}

	option = {
		name = flavor_mam.55.a
		historical_option = yes
        scope:target_character = {
            move_country = root
		}
		change_gold_effect = { scale = -6 }
		add_navy_tradition = navy_tradition_severe_bonus
		change_societal_value = { type = quality_vs_quantity value = societal_value_move_to_left }
		change_societal_value = { type = land_vs_naval value = societal_value_move_to_right }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_move_to_right }
	}

	option = {
		name = flavor_mam.55.b
        scope:target_character = {
            move_country = root
		}
		change_gold_effect = { scale = -3 }
		add_navy_tradition = navy_tradition_mild_bonus
		change_societal_value = { type = quality_vs_quantity value = societal_value_minor_move_to_left }
		change_societal_value = { type = land_vs_naval value = societal_value_minor_move_to_right }
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
	}

	option = {
		name = flavor_mam.55.c
		add_prestige = prestige_mild_penalty
		hidden_effect = {
   			kill_character_silently = scope:target_character
  		}
	}
}

flavor_mam.56 = { #Administrative Reform
	type = country_event
	title = flavor_mam.56.title
	desc = flavor_mam.56.desc

	fire_only_once = yes

	historical_info = flavor_mam.56.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1380.1.1
		to = 1450.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = regular
		10 = interior
	}

	trigger = {
		"culture_percentage_in_country(culture:bedouin_culture)" > 0
		culture != culture:bedouin_culture
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.56.a
		historical_option = yes
		add_stability = stability_mild_bonus
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_left
		}
		custom_tooltip = {
			text = flavor_mam.56.a.tt
			every_province = {
				every_location_in_province = {
					every_pop = {
						limit = {
							owner = root
							culture = culture:bedouin_culture
						}
						add_pop_satisfaction = pop_satisfaction_severe_penalty
					}
				}
			}
		}
	}

	option = {
		name = flavor_mam.56.b
		add_stability = stability_mild_penalty
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_move_to_right
		}
	}
}

flavor_mam.57 = { #Bedouin Tribal Wars in a Location
	type = country_event
	title = flavor_mam.57.title
	desc = flavor_mam.57.desc

	trigger = {
		tag = MAM
		"culture_percentage_in_country(culture:bedouin_culture)" > 0
		culture != culture:bedouin_culture
		NOT = {
			has_variable = mam_had_bedouin_war
		}
	}

	immediate = {
		set_variable = { name = mam_had_bedouin_war days = 9125 }
		random_owned_location = {
			limit = {
				local_cultural_unity < 1
				any_pop = {
					culture = culture:bedouin_culture
				}
				controller = root
			}
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mam.57.a
		scope:target_location = {
			change_prosperity = prosperity_extreme_penalty
			every_pop = {
				limit = {
					NOT = { culture = culture:bedouin_culture }
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.1
				}
			}
		}
	}

	option = {
		name = flavor_mam.57.b
		scope:target_location = {
			every_pop = {
				limit = {
					culture = culture:bedouin_culture
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.2
				}
			}
		}
	}
}

#Kamal Al-Damiri
flavor_mam.58 = {
	type = country_event
	title = flavor_mam.58.title
	desc = flavor_mam.58.desc

	fire_only_once = yes

	historical_info = flavor_mam.58.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1380.1.1
		to = 1400.1.1
		monthly_chance = 10
	}

	illustration_tags = {
		10 = happy
		10 = interior
	}

	trigger = {
		has_ruler = yes
		is_during_bankruptcy = no
		owns = location:cairo
	}

	immediate = {
		create_character = {
			estate = estate_type:clergy_estate
			first_name = name_kamal.name_muhammad
			last_name = Al_Damiri
			birth_date = 1341.2.9
			birth_location = location:cairo
			artist = writer
			artist_skill = 0.85
			adm = { 60 90 }
			dip = { 60 90 }
			mil = { 20 30 }
			script = al_damiri_script
			save_scope_as = target_character
			create_in_limbo = yes
		}
		random_neighbor_country = {
			save_scope_as = target_country
		}
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_mam.58.a
		historical_option = yes
		change_gold_effect = { scale = -3 }
		scope:target_character = { move_country = root }
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_right
		}
		culture = {
			add_cultural_tradition = cultural_tradition_weak_bonus
			add_cultural_influence = cultural_influence_weak_bonus
		}
	}

	option = {
		name = flavor_mam.58.b
		add_prestige = prestige_weak_penalty
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_left
		}
		if = {
			limit = {
				exists = scope:target_country
			}
			scope:target_character = {
				move_country = scope:target_country
			}
		}
		else = {
			hidden_effect = {
				kill_character_silently = scope:target_character
			}
		}
	}
}

#Ibn Ilyas
flavor_mam.59 = {
	type = country_event
	title = flavor_mam.59.title
	desc = flavor_mam.59.desc
	image = "gfx/interface/illustrations/institutions/legalism.dds"

	fire_only_once = yes

	historical_info = flavor_mam.59.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1480.1.1
		to = 1500.1.1
		monthly_chance = 10
	}

	trigger = {
		is_during_bankruptcy = no
		owns = location:cairo
	}

	immediate = {
		create_character = {
			estate = estate_type:clergy_estate
			first_name = name_muhammad
			last_name = Ibn_Ilyas
			birth_date = 1448.2.4
			birth_location = location:cairo
			artist = writer
			artist_skill = 0.9
			adm = { 60 90 }
			dip = { 60 90 }
			mil = { 20 30 }
			script = ibn_ilyas_script
			save_scope_as = target_character
			create_in_limbo = yes
		}
		random_neighbor_country = {
			save_scope_as = target_country
		}
	}

	option = {
		name = flavor_mam.59.a
		historical_option = yes
		change_gold_effect = { scale = -3 }
		scope:target_character = {
			move_country = root
			add_trait = trait:prominent
		}
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_right
		}
	}

	option = {
		name = flavor_mam.59.b
		add_prestige = prestige_weak_penalty
		change_societal_value = {
			type = traditionalist_vs_innovative
			value = societal_value_move_to_left
		}
		hidden_effect = {
			kill_character_silently = scope:target_character
		}
	}
}

#Custodian of the Holy Cities
flavor_mam.60 = {
	type = country_event
	title = flavor_mam.60.title
	desc = flavor_mam.60.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1836.1.1
		monthly_chance = 10
	}

	illustration_tags = { 
		10 = happy
		10 = exterior
	} 

	trigger = {
		has_ruler = yes
		owns = location:mecca
		owns = location:medina
		owns = location:jerusalem
	}

	immediate = {
		ruler = {
			save_scope_as = target_ruler
		}
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_mam.60.a
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_right }
		add_prestige = prestige_severe_bonus
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
	}
}

#Discovery of the Rosetta Stone
flavor_mam.61 = {
	type = country_event
	title = flavor_mam.61.title
	desc = flavor_mam.61.desc

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1700.1.1
		to = 1836.1.1
		monthly_chance = 1
	}

	illustration_tags = {
		10 = happy
		10 = interior
	}

	trigger = {
		owns = location:rashid
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_mam.61.a
		change_gold_effect = { scale = -6 }
		custom_tooltip = flavor_mam.61.tt
		trigger_event_silently = { id = flavor_mam.62  days = 5475 }
	}

	option = {
		name = flavor_mam.61.b
		add_prestige = prestige_weak_penalty
	}
}

#Deciphering the Rosetta Stone
flavor_mam.62 = {
	type = country_event
	title = flavor_mam.62.title
	desc = flavor_mam.62.desc

	fire_only_once = yes

	historical_info = flavor_mam.62.historical_info

	option = {
		name = flavor_mam.62.a
		historical_option = yes
		add_research_progress = research_progress_extreme_bonus
		culture = {
			add_cultural_tradition = cultural_tradition_extreme_bonus
			add_cultural_influence = cultural_influence_extreme_bonus
		}
	}
}

#Deciphering the Rosetta Stone
flavor_mam.63 = {
	type = country_event
	title = flavor_mam.63.title
	desc = flavor_mam.63.desc

	historical_info = flavor_mor.16.historical_info

	option = {
		name = flavor_mam.63.a
		historical_option = yes
		custom_tooltip = ibn_khaldun_hit_the_road_tt
		culture = {
			add_cultural_tradition = cultural_tradition_weak_bonus
			add_cultural_influence = cultural_influence_weak_bonus
		}
	}
}

#Mamluk Succession
#Commented out due to not being needed - it clashes with the Mamluk succession law
#flavor_mam.64 = {
#	type = country_event
#	title = flavor_mam.64.title
#	desc = flavor_mam.64.desc
#
#	trigger = {
#		has_reform = government_reform:mamluk_government
#		succession_law = heir_selection:dynastic_elective_succession
#	}
#
#	immediate = {
#		ordered_accepted_culture = {
#			order_by = {
#				value = "root.culture_population_in_country(prev)"
#			}
#			max = 1
#			save_scope_as = target_culture
#		}
#		ordered_accepted_culture = {
#			order_by = {
#				value = "root.culture_population_in_country(prev)"
#			}
#			max = 2
#			save_scope_as = target_culture2
#		}
#		ordered_accepted_culture = {
#			order_by = {
#				value = "root.culture_population_in_country(prev)"
#			}
#			max = 3
#			save_scope_as = target_culture3
#		}
#		culture = {
#			save_scope_as = target_culture4
#		}
#		if = {
#			limit = {
#				any_character = {
#					has_dynasty = yes
#					culture = scope:target_culture
#				}
#			}
#
#			ordered_character = {
#				order_by = total_abilities
#				limit = {
#					has_dynasty = yes
#					culture = scope:target_culture
#				}
#				max = 1
#				save_scope_as = first_ruler
#			}
#		}
#		else = {
#			random_owned_location = {
#				limit = {
#					any_pop = {
#						culture = scope:target_culture
#					}
#				}
#				create_dynasty_from_location = random
#
#				last_dynasty_in_location ?= {
#					save_scope_as = first_dynasty
#				}
#				save_scope_as = first_location
#			}
#			create_character = {
#				culture = scope:target_culture
#				religion = root.religion
#				min_age = 25
#				adm = {
#					20
#					70
#				}
#				dip = {
#					20
#					70
#				}
#				mil = {
#					20
#					70
#				}
#				birth_location = scope:first_location
#				estate = estate_type:nobles_estate
#				dynasty = scope:first_dynasty
#				save_scope_as = first_ruler
#			}
#		}
#		if = {
#			limit = {
#				any_character = {
#					has_dynasty = yes
#					culture = scope:target_culture2
#				}
#			}
#
#			ordered_character = {
#				order_by = total_abilities
#				limit = {
#					has_dynasty = yes
#					culture = scope:target_culture2
#				}
#				max = 1
#				save_scope_as = second_ruler
#			}
#		}
#		else = {
#			random_owned_location = {
#				limit = {
#					any_pop = {
#						culture = scope:target_culture2
#					}
#				}
#				create_dynasty_from_location = random
#
#				last_dynasty_in_location ?= {
#					save_scope_as = first_dynasty
#				}
#				save_scope_as = first_location
#			}
#			create_character = {
#				culture = scope:target_culture2
#				religion = root.religion
#				min_age = 25
#				adm = {
#					20
#					70
#				}
#				dip = {
#					20
#					70
#				}
#				mil = {
#					20
#					70
#				}
#				birth_location = scope:first_location
#				estate = estate_type:nobles_estate
#				dynasty = scope:first_dynasty
#				save_scope_as = second_ruler
#			}
#		}
#		if = {
#			limit = {
#				any_character = {
#					has_dynasty = yes
#					culture = scope:target_culture3
#				}
#			}
#
#			ordered_character = {
#				order_by = total_abilities
#				limit = {
#					has_dynasty = yes
#					culture = scope:target_culture3
#				}
#				max = 1
#				save_scope_as = third_ruler
#			}
#		}
#		else = {
#			random_owned_location = {
#				limit = {
#					any_pop = {
#						culture = scope:target_culture3
#					}
#				}
#				create_dynasty_from_location = random
#
#				last_dynasty_in_location ?= {
#					save_scope_as = first_dynasty
#				}
#				save_scope_as = first_location
#			}
#			create_character = {
#				culture = scope:target_culture2
#				religion = root.religion
#				min_age = 25
#				adm = {
#					20
#					70
#				}
#				dip = {
#					20
#					70
#				}
#				mil = {
#					20
#					70
#				}
#				birth_location = scope:first_location
#				estate = estate_type:nobles_estate
#				dynasty = scope:first_dynasty
#				save_scope_as = third_ruler
#			}
#		}
#		if = {
#			limit = {
#				any_character = {
#					has_dynasty = yes
#					culture = scope:target_culture4
#				}
#			}
#
#			ordered_character = {
#				order_by = total_abilities
#				limit = {
#					has_dynasty = yes
#					culture = scope:target_culture4
#				}
#				max = 1
#				save_scope_as = fourth_ruler
#			}
#		}
#		else = {
#			random_owned_location = {
#				limit = {
#					any_pop = {
#						culture = scope:target_culture4
#					}
#				}
#				create_dynasty_from_location = random
#
#				last_dynasty_in_location ?= {
#					save_scope_as = first_dynasty
#				}
#				save_scope_as = first_location
#			}
#			create_character = {
#				culture = scope:target_culture4
#				religion = root.religion
#				min_age = 25
#				adm = {
#					20
#					70
#				}
#				dip = {
#					20
#					70
#				}
#				mil = {
#					20
#					70
#				}
#				birth_location = scope:first_location
#				estate = estate_type:nobles_estate
#				dynasty = scope:first_dynasty
#				save_scope_as = fourth_ruler
#			}
#		}
#	}
#
#	option = {
#		name = flavor_mam.64.a
#		set_new_ruler = scope:first_ruler
#		scope:target_culture = {
#			add_cultural_tradition = cultural_tradition_mild_bonus
#		}
#	}
#
#	option = {
#		name = flavor_mam.64.b
#		set_new_ruler = scope:second_ruler
#		scope:target_culture2 = {
#			add_cultural_tradition = cultural_tradition_mild_bonus
#		}
#	}
#
#	option = {
#		name = flavor_mam.64.c
#		set_new_ruler = scope:third_ruler
#		scope:target_culture3 = {
#			add_cultural_tradition = cultural_tradition_mild_bonus
#		}
#	}
#
#	option = {
#		name = flavor_mam.64.d
#		set_new_ruler = scope:fourth_ruler
#		scope:target_culture4 = {
#			add_cultural_tradition = cultural_tradition_mild_bonus
#		}
#		add_stability = stability_mild_bonus
#	}
#}

flavor_mam.65 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.65.title
	desc = flavor_mam.65.desc

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		has_reform = government_reform:mamluk_government
		any_pop = {
			pop_type = pop_type:soldiers
			culture != root.culture
		}
	}

	immediate = {
		random_owned_location = {
			limit = {
				any_pop = {
					pop_type = pop_type:soldiers
					culture != root.culture
				}
			}
			save_scope_as = target_location
		}
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}

	option = {
		name = flavor_mam.65.a
		custom_tooltip = {
			text = mam_all_pop_not_of_primary_culture_lose_satisfaction_tt
			scope:target_location = {
				every_pop = {
					limit = {
						pop_type = pop_type:soldiers
						culture != root.culture
					}
					add_pop_satisfaction = pop_satisfaction_extreme_penalty
				}
			}
		}
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_weak_bonus
		}
	}

	option = {
		name = flavor_mam.65.b
		scope:target_location = {
			change_control = control_mild_penalty
		}
		add_gold = {
			value = monthly_income_total
			min = 10
			max = 400
			multiply = -0.5
		}
	}
}

flavor_mam.66 = {
	type = country_event
	title = flavor_mam.66.title
	desc = flavor_mam.66.desc
	image = "gfx/interface/icons/trade_goods/illustrations/_default.dds"


	trigger = {
		has_reform = government_reform:mamluk_government
		any_core_location = {
			integration_level = core
			OR = {
				market ?= {
					is_produced_in_market = goods:paper
				}
				market ?= {
					is_produced_in_market = goods:cloth
				}
				raw_material ?= goods:sugar
				raw_material ?= goods:cotton
				raw_material ?= goods:silk
				raw_material ?= goods:gems
				raw_material ?= goods:coffee
			}
		}
	}

	immediate = {
		hidden_effect = {
			random_owned_location = {
				limit = {
					integration_level = core
					OR = {
						market = {
							is_produced_in_market = goods:paper
						}
						market = {
							is_produced_in_market = goods:cloth
						}
						raw_material ?= goods:sugar
						raw_material ?= goods:cotton
						raw_material ?= goods:silk
						raw_material ?= goods:gems
						raw_material ?= goods:coffee
					}
				}
				save_scope_as = target_location
			}
		}
	}

	option = {
		name = flavor_mam.66.a
		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_penalty
		}
		change_gold_effect = { scale = 0.5	}
		scope:target_location.market = {
			add_temporary_demand = {
				type = demand:tarh
				months = 24
				scale_with_pop = 0.003
			}
		}
	}

	option = {
		name = flavor_mam.66.b
		add_estate_satisfaction = {
			type = estate_type:burghers_estate
			value = estate_satisfaction_mild_bonus
		}
		scope:target_location.market = {
			add_temporary_demand = {
				type = demand:lack_of_demand_for_fine_goods
				months = 24
				scale_with_pop = 0.003
			}
		}
		change_gold_effect = { scale = -0.5	}
	}
}

flavor_mam.67 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.67.title
	desc = flavor_mam.67.desc

	trigger = {
		exists = capital
		has_reform = government_reform:mamluk_government
		legitimacy <= 60
		stability <= 0
		any_core_location = {
			integration_level = core
			area = root.capital.area
			is_capital = no
		}
	}

	immediate = {
		hidden_effect = {
			random_core_location = {
				limit = {
					integration_level = core
					area = root.capital.area
					is_capital = no
				}
				save_scope_as = target_location
				area = {
					save_scope_as = target_area
				}
			}
		}
		create_character = {
			culture = root.culture
			religion = root.religion
			min_age = 30
			adm = {
				50
				70
			}
			dip = {
				40
				60
			}
			mil = {
				60
				80
			}
			save_scope_as = target_character
		}

		create_rebel = {
			category = pretender
			name = mamluk_pretender
			save_scope_as = mamluk_pretender
		}
	}

	option = {
		name = flavor_mam.67.a
		add_legitimacy = legitimacy_mild_penalty
		scope:target_character = {
			change_character_allegiance = scope:mamluk_pretender
		}
		custom_tooltip = {
			text = mam_every_location_in_area_minus_capital_joins_rebellion_tt
			scope:target_area = {
				every_location_in_area = {
					limit = {
						owner ?= root
						is_capital = no
					}
					every_pop = {
						limit = {
							owner ?= root
						}
						add_pop_satisfaction = pop_satisfaction_extreme_penalty
						change_pop_allegiance = scope:mamluk_pretender
					}
				}
			}
		}
	}
}

flavor_mam.68 = {
	type = country_event
	title = flavor_mam.68.title
	desc = flavor_mam.68.desc

	trigger = {

		has_reform = government_reform:mamluk_government
	}

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mam.68.a
		add_stability = stability_mild_penalty
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_mam.68.b
		add_legitimacy = legitimacy_mild_penalty
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
	}

	option = {
		name = flavor_mam.68.c
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_penalty
		}
	}
}

flavor_mam.69 = {
	type = country_event
	title = flavor_mam.69.title
	desc = flavor_mam.69.desc
	image = "gfx/interface/illustrations/government/throne_rooms/throne_room_syrian.dds"

	trigger = {
		has_reform = government_reform:mamluk_government
		legitimacy <= 40
		capital ?= {
			controller ?= root
		}
		has_heir = yes
	}

	immediate = {
		create_character = {
			culture = root.culture
			religion = root.religion
			min_age = 30
			adm = {
				50
				70
			}
			dip = {
				40
				60
			}
			mil = {
				60
				80
			}
			save_scope_as = target_character
		}
		ruler_or_heir_if_regent ?= {
			save_scope_as = target_character2
		}
	}

	option = {
		name = flavor_mam.69.a
		add_legitimacy = legitimacy_mild_bonus
		add_stability = stability_extreme_penalty
		scope:target_character = {
			imprison_character_effect = {
				years = -1
			}
		}
	}

	option = {
		name = flavor_mam.69.b
		add_stability = stability_extreme_penalty
		kill_character = scope:target_character2
	}
}

flavor_mam.70 = {
	type = country_event
	title = flavor_mam.70.title
	desc = flavor_mam.70.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		NOT = { has_variable = mam_ruler_invested_in_cairo }
		location:cairo = {
			is_capital_of = {
				target = root
			}
		}
	}

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
		capital ?= {
			save_scope_as = target_location
		}
	}

	option = {
		name = flavor_mam.70.a
		scope:target_location.market = {
			add_merchant_power = {
				country = root
				key = bolstered_capital_trade
				months = 120
				power = merchant_power_mild_bonus
			}
		}
		add_gold = {
			value = monthly_income_total
			min = 10
			max = 1000
			multiply = -1
		}
	}

	option = {
		name = flavor_mam.70.b
		scope:target_location = {
			change_development = development_mild_bonus
		}
		add_gold = {
			value = monthly_income_total
			min = 10
			max = 1000
			multiply = -1
		}
	}

	option = {
		name = flavor_mam.70.c
		add_estate_satisfaction = {
			type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_tiny_move_to_right }
		add_gold = {
			value = monthly_income_total
			min = 10
			max = 1000
			multiply = -1
		}
	}

	option = {
		name = flavor_mam.70.d
		add_legitimacy = legitimacy_mild_bonus
		add_prestige = prestige_mild_bonus
		add_gold = {
			value = monthly_income_total
			min = 10
			max = 1000
			multiply = -1
		}
	}

	option = {
		name = flavor_mam.70.e
		add_legitimacy = legitimacy_mild_penalty
	}

	after = {
		set_variable = mam_ruler_invested_in_cairo
	}
}

flavor_mam.71 = {
	type = country_event
	title = flavor_mam.71.title
	desc = flavor_mam.71.desc

	trigger = {
		religion.group = religion_group:muslim
		any_character = {
			count > 2
			is_ruler = no
			is_regent = no
			is_heir = no
			culture ?= culture:bedouin_culture
		}
		any_character = {
			count > 3
			is_ruler = no
			is_regent = no
			is_heir = no
			culture ?= {
				NOT = {
					this = root.culture
				}
			}
		}
		any_character = {
			count > 2
			is_ruler = no
			is_regent = no
			is_heir = no
			culture ?= root.culture
		}
		OR = {
			NOT = { exists = var:mamluk_amir_al_hajj }
			var:mamluk_amir_al_hajj ?= {
				is_alive = no
			}
		}
		has_reform = government_reform:mamluk_government
	}

	immediate = {
		ordered_character ?= {
			order_by = total_abilities
			max = 1
			limit = {
				culture = culture:bedouin_culture
			}
			save_scope_as = bedouin_candidate
		}
		ordered_character ?= {
			order_by = mil
			max = 1
			limit = {
				this != scope:bedouin_candidate
				culture != root.culture
			}
			save_scope_as = mil_candidate
		}
		ordered_character ?= {
			order_by = dip
			max = 1
			limit = {
				this != scope:bedouin_candidate
				this != scope:mil_candidate
				culture != root.culture
			}
			save_scope_as = dip_candidate
		}
		ordered_character ?= {
			order_by = adm
			max = 1
			limit = {
				this != scope:bedouin_candidate
				this != scope:mil_candidate
				this != scope:dip_candidate
				culture != root.culture
			}
			save_scope_as = adm_candidate
		}
		ordered_character ?= {
			order_by = total_abilities
			max = 1
			limit = {
				this != scope:bedouin_candidate
				this != scope:mil_candidate
				this != scope:dip_candidate
				this != scope:adm_candidate
				culture = root.culture
			}
			save_scope_as = mamluk_candidate
		}
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mam.71.a
		trigger = {
			exists = scope:bedouin_candidate
		}
		set_variable = {
			name = mamluk_amir_al_hajj
			value = scope:bedouin_candidate
		}
		culture:bedouin_culture = {
			add_cultural_influence = {
				value = cultural_influence_mild_bonus
				add = {
					value = scope:bedouin_candidate.total_abilities
					divide = 30
				}
			}
		}
	}

	option = {
		name = flavor_mam.71.b
		trigger = {
			exists = scope:mil_candidate
		}
		set_variable = {
			name = mamluk_amir_al_hajj
			value = scope:mil_candidate
		}
		add_army_tradition = {
			value = army_tradition_mild_bonus
			add = {
				value = scope:mil_candidate.mil
				divide = 10
			}
		}
	}

	option = {
		name = flavor_mam.71.c
		trigger = {
			exists = scope:dip_candidate
		}
		set_variable = {
			name = mamluk_amir_al_hajj
			value = scope:dip_candidate
		}
		add_diplomats = {
			value = diplomats_mild_bonus
			add = {
				value  = scope:dip_candidate.dip
				divide = 50
			}
		}
	}

	option = {
		name = flavor_mam.71.d
		trigger = {
			exists = scope:adm_candidate
		}
		set_variable = {
			name = mamluk_amir_al_hajj
			value = scope:dip_candidate
		}
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_move_to_right }
	}

	option = {
		name = flavor_mam.71.e
		trigger = {
			exists = scope:mamluk_candidate
		}
		set_variable = {
			name = mamluk_amir_al_hajj
			value = scope:mamluk_candidate
		}
		culture = {
			add_cultural_influence = {
				value = cultural_influence_mild_bonus
				add = {
					value = scope:mamluk_candidate.total_abilities
					divide = 30
				}
			}
		}
	}
}

flavor_mam.72 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.72.title
	desc = flavor_mam.72.desc

	trigger = {
		has_reform = government_reform:mamluk_government
		any_core_location = {
			NOT = {
				has_location_modifier = awlad_al_nas_commander
			}
			NOT = {
				has_location_modifier = mamluk_commander
			}
			any_neighbor_location = {
				has_owner = yes
				is_border = yes
				owner != root
			}
		}
		any_character = {
			has_trait = mamluk
		}
	}

	immediate = {
		random_owned_location = {
			limit = {
				integration_level = core
				NOT = {
					has_location_modifier = awlad_al_nas_commander
				}
				NOT = {
					has_location_modifier = mamluk_commander
				}
				any_neighbor_location = {
					has_owner = yes
					owner != root
				}
			}
			save_scope_as = target_location
		}
		ordered_character = {
			order_by = total_abilities
			limit = {
				has_trait = mamluk
			}
			max = 1
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mam.72.a
		add_legitimacy = legitimacy_weak_penalty
		scope:target_location = {
			add_location_modifier = { modifier = awlad_al_nas_commander months = 120 mode = add }
		}
		add_estate_satisfaction = {
			type = scope:target_character.estate_type
			value = estate_satisfaction_weak_penalty
		}
	}

	option = {
		name = flavor_mam.72.b
		add_legitimacy = legitimacy_weak_bonus
		scope:target_location = {
			add_location_modifier = { modifier = mamluk_commander months = 120 mode = add }
		}
		add_estate_satisfaction = {
			type = scope:target_character.estate_type
			value = estate_satisfaction_weak_bonus
		}
	}
}

flavor_mam.73 = {
	type = country_event
	title = flavor_mam.73.title
	desc = flavor_mam.73.desc

	trigger = {
		has_ruler = yes
		has_reform = government_reform:mamluk_government
		NOT = {
			ruler ?= { has_character_modifier = loyal_mamluks_in_high_positions }
		}
		NOT = {
			has_country_modifier = trusting_old_guard
		}
	}

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mam.73.a
		add_stability = stability_mild_bonus
		ruler ?= { add_character_modifier = { modifier = loyal_mamluks_in_high_positions months = 120 mode = add } }
	}

	option = {
		name = flavor_mam.73.b
		add_stability = stability_mild_penalty
		add_country_modifier = { modifier = trusting_old_guard months = 120 mode = add }
	}
}

flavor_mam.74 = {
	type = country_event
	title = flavor_mam.74.title
	desc = flavor_mam.74.desc
	trigger = {

		has_reform = government_reform:mamluk_government
		at_war = no
		ruler_or_regent ?= {
			OR = {
				mil >= 65
				has_trait = martial_educator
			}
		}
	}

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}

	option = {
		name = flavor_mam.74.a

		add_army_tradition = {
			value = army_tradition_weak_bonus
			add = {
				value = scope:target_character.mil
				divide = 20
			}
		}
	}

	option = {
		name = flavor_mam.74.b
		add_gold = {
			value = monthly_income_total
			min = 10
			multiply = -2
		}
		add_army_tradition = {
			value = army_tradition_weak_bonus
			add = {
				value = scope:target_character.mil
				divide = 10
			}
		}
		add_estate_satisfaction = {
			type = estate_type:nobles_estate
			value = estate_satisfaction_mild_bonus
		}
	}
}

#Good outcome
flavor_mam.75 = {
	hide_portraits = yes
	type = country_event
	title = flavor_mam.75.title
	desc = flavor_mam.75.desc
	trigger = {
		religion.group = religion_group:muslim
		has_variable = mamluk_amir_al_hajj
		var:mamluk_amir_al_hajj ?= {
			is_alive = yes
			owner = root
		}
	}
	
	illustration_tags = {
		10 = happy
		10 = exterior
	}

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
		var:mamluk_amir_al_hajj = {
			save_scope_as = target_character2
		}
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.75.a
		add_prestige = prestige_mild_bonus
		add_legitimacy = legitimacy_mild_bonus
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_tiny_move_to_right }
	}
}

#Bad outcome
flavor_mam.76 = { #GRAVEYARD
	hide_portraits = yes
	type = country_event
	title = flavor_mam.76.title
	desc = flavor_mam.76.desc
	trigger = {
		religion.group = religion_group:muslim
		has_variable = mamluk_amir_al_hajj
		var:mamluk_amir_al_hajj ?= {
			is_alive = yes
			owner = root
		}
	}
		
	illustration_tags = {
		10 = angry
		10 = exterior
	}

	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
		var:mamluk_amir_al_hajj = {
			save_scope_as = target_character2
		}
		event_illustration_government_estate_effect = yes
	}

	option = {
		name = flavor_mam.76.a
		add_prestige = prestige_mild_penalty
		change_societal_value = { type = mysticism_vs_jurisprudence value = societal_value_tiny_move_to_left }
	}
}

flavor_mam.77 = {
	type = country_event
	title = flavor_mam.77.title
	desc = flavor_mam.77.desc
	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_wheat.dds"

	fire_only_once = yes

	historical_info = flavor_mam.77.historical_info

	dynamic_historical_event = {
		tag = MAM
		from = 1337.1.1
		to = 1836.1.1
		monthly_chance = 1
	}

	trigger = {
		any_market_present_in_country = { is_produced_in_market = goods:wheat }
		total_effective_building_levels:granary > 0
	}


	option = {
		name = flavor_mam.77.a
		historical_option = yes
		change_gold_effect = { scale = -2 }
		ordered_owned_location = {
			limit = {
				raw_material = goods:wheat
			}
			order_by = population
			max = 3
			add_location_modifier = { modifier = mam_granary_of_the_mediterranean years = 20 mode = add }
		}
	}

	option = {
		name = flavor_mam.77.b
		add_prestige = prestige_mild_penalty
	}
}

flavor_mam.78 = {
	type = country_event
	title = flavor_mam.78.title
	desc = flavor_mam.78.desc

	historical_info = flavor_mam.78.historical_info

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1455.1.1
		to = 1470.1.1
		monthly_chance = 1
	}
	
	illustration_tags = {
		10 = regular
		10 = interior
	}

	trigger = {
		owns = location:cairo
	}

	immediate = {
		create_character = {
			estate = estate_type:clergy_estate
			first_name = name_sun
			last_name = al_Din_al_Sakhawi
			birth_date = 1428.1.1
			birth_location = location:cairo
			artist = writer
			artist_skill = { 0.7 0.85 }
			save_scope_as = target_character
			create_in_limbo = yes
		}
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:nobles_estate }
	}

	option = {
		name = flavor_mam.78.a
		historical_option = yes
		change_gold_effect = { scale = -3 }
		scope:target_character = {
			move_country = root
		}
		add_research_progress = research_progress_mild_bonus
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_move_to_right }
	}

	option = {
		name = flavor_mam.78.b
		add_research_progress = research_progress_mild_penalty
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_move_to_left }
		hidden_effect = {
   			kill_character_silently = scope:target_character
  		}
	}
}

flavor_mam.79 = {
	type = country_event
	title = flavor_mam.79.title
	desc = flavor_mam.79.desc

	historical_info = flavor_mam.79.historical_info

	fire_only_once = yes

	dynamic_historical_event = {
		tag = MAM
		from = 1410.1.1
		to = 1440.1.1
		monthly_chance = 1
	}
	illustration_tags = {
		10 = happy
		10 = interior
	}

	trigger = {
		owns = location:cairo
	}

	immediate = {
		create_character = {
			estate = estate_type:clergy_estate
			first_name = name_ibn_hajar
			last_name = al_Asqalani
			birth_date = 1372.2.18
			birth_location = location:cairo
			artist = writer
			artist_skill = { 0.8 0.95 }
			save_scope_as = target_character
			create_in_limbo = yes
		}
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = {
		name = flavor_mam.79.a
		historical_option = yes
		change_gold_effect = { scale = -3 }
		scope:target_character = {
			move_country = root
		}
		add_research_progress = research_progress_mild_bonus
		change_societal_value = { type = spiritualist_vs_humanist value = societal_value_move_to_left }
	}

	option = {
		name = flavor_mam.79.b
		add_prestige = prestige_mild_penalty
		hidden_effect = {
   			kill_character_silently = scope:target_character
  		}
	}
}

#Mansa Mūsā's Repercussions
flavor_mam.100 = {
	type = country_event
	title = flavor_mam.100.title
	desc = flavor_mam.100.desc

	fire_only_once = yes
	dynamic_historical_event = {
		tag = MAM
		from = 1300.1.1
		to = 1340.1.1
		monthly_chance = 80
	}

	trigger = {
		owns = location:cairo
	}

	immediate = {
		character:mal_musa_keita = {
			save_scope_as = mansa_musa
		}
	}

	#At least the worst is over
	option = {
		name = flavor_mam.100.a
		historical_option = yes
		capital.market = {
			add_temporary_demand = {
				type = demand:mam_mansa_musas_visit
				months = 24
				scale_with_pop = 0.003
			}
			add_goods_supply = {
				goods = goods:goods_gold
				amount = market_goods_ultimate_bonus
			}
			add_goods_supply = {
				goods = goods:gems
				amount = market_goods_severe_gain
			}
			add_goods_supply = {
				goods = goods:salt
				amount = market_goods_mild_gain
			}
		}
		add_inflation = inflation_extreme_penalty
	}
}