namespace = italian_wars

######################################
# The start of the situation events
######################################

italian_wars.1 = {	
	hide_portraits = yes
	type = country_event
	category = situation_event	
	historical_info = italian_wars.1.historical_info
	title = italian_wars.1.title
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {	
					OR = {
						is_leader_of_international_organization = international_organization:foreign_league_france
						is_leader_of_international_organization = international_organization:foreign_league_iberia 
						is_leader_of_international_organization = international_organization:foreign_league_hre
					}
				}
				desc = italian_wars.1.desc.a
			}
			triggered_desc = { 
				trigger = {
					always = yes
				}
				desc = italian_wars.1.desc.b
			}
		}
	}
	
	immediate = {
		ruler_or_regent ?= {
			save_scope_as = target_character
		}

		save_scope_as = target_country
	}

	option = {
		name = italian_wars.1.a

		custom_tooltip = italian_wars_explanation_tooltip1
		custom_tooltip = italian_wars_explanation_tooltip2
		custom_tooltip = italian_wars_explanation_tooltip3
		custom_tooltip = italian_wars_explanation_tooltip4
	}
}

italian_wars.2 = {	
	type = country_event
	category = situation_event	

	title = italian_wars.2.title
	desc = italian_wars.2.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		scope:target_character = { }
	}
	option = {
		name = italian_wars.2.a
		custom_tooltip = iw_we_are_safe_for_now_tt
	}
}

italian_wars.3 = {	#Informative Event for the rest of Italy
	type = country_event
	category = situation_event	
	historical_info = italian_wars.1.historical_info
	title = italian_wars.1.title
	desc = italian_wars.1.desc.b
	
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
		international_organization:italian_league_1.leader_country ?= { 
			ruler_or_regent ?= { save_scope_as = target_character2 }
		}
	}
	
	option = {
		name = italian_wars.1.a
		custom_tooltip = italian_wars_explanation_tooltip1
		custom_tooltip = italian_wars_explanation_tooltip2
		custom_tooltip = italian_wars_explanation_tooltip3
		custom_tooltip = italian_wars_explanation_tooltip4
	}
}

italian_wars.4 = {	
	type = country_event
	category = situation_event	

	title = italian_wars.4.title
	desc = italian_wars.4.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		scope:actor = {
			random_international_organizations_member_of = {
				limit = {
					OR = {
						this = international_organization:italian_league_1
						this = international_organization:italian_league_2
						this = international_organization:italian_league_3
						this = international_organization:foreign_league_france
						this = international_organization:foreign_league_hre
						this = international_organization:foreign_league_iberia
					}
				}
				save_scope_as = target_io
			}
		}
		if = {
			limit = {
				any_international_organizations_member_of = {
					OR = {
						this = international_organization:italian_league_1
						this = international_organization:italian_league_2
						this = international_organization:italian_league_3
						this = international_organization:foreign_league_france
						this = international_organization:foreign_league_hre
						this = international_organization:foreign_league_iberia
					}
				}
			}
			random_international_organizations_member_of = {
				limit = {
					OR = {
						this = international_organization:italian_league_1
						this = international_organization:italian_league_2
						this = international_organization:italian_league_3
						this = international_organization:foreign_league_france
						this = international_organization:foreign_league_hre
						this = international_organization:foreign_league_iberia
					}
				}
				leader_country ?= { save_scope_as = target_country }
			}
		}
	}
	option = {
		name = italian_wars.4.a
		ai_chance = {
			base = 125
			modifier = {
				factor = 1.5
				opinion = {
					target = scope:actor
					value >100
				}
			}
			modifier = {
				factor = 0
				opinion = {
					target = scope:actor
					value <0
				}
			}
		}
		if = {
			limit = {
				international_organization:italian_league_1.leader_country = scope:actor
			}
			international_organization:italian_league_1 = { add_country_to_international_organization = root }
		}
		else_if = {
			limit = {
				international_organization:italian_league_2.leader_country = scope:actor
			}
			international_organization:italian_league_2 = { add_country_to_international_organization = root }
		}
		else_if = {
			limit = {
				international_organization:italian_league_3.leader_country = scope:actor
			}
			international_organization:italian_league_3 = { add_country_to_international_organization = root }
		}
	}

	option = {
		name = italian_wars.4.b

		trigger = {
			NOT = { exists = scope:target_country }
		}
		ai_chance = {
			base = 100
			modifier = {
				factor = 1.5
				opinion = {
					target = scope:actor
					value <100
				}
			}
		}
		add_opinion_mutual_effect  = {
			target = scope:actor
			modifier = opinion_refused_invitation_to_league
		}
	}

	option = {
		name = italian_wars.4.c

		trigger = {
			exists = scope:target_country
		}

		ai_chance = {
			base = 100
			modifier = {
				factor = 1.5
				opinion = {
					target = scope:actor
					value <100
				}
			}
		}
		add_opinion_mutual_effect  = {
			target = scope:actor
			modifier = opinion_refused_invitation_to_league
		}
		add_opinion = {
			target = scope:target_country
			modifier = fought_with_us_modifier
		}
	}
}

italian_wars.5 = {	
	type = country_event
	category = situation_event	

	title = italian_wars.5.title
	desc = italian_wars.5.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		scope:target_character = { }
	}
	option = {
		name = italian_wars.5.a
		
	}
}

italian_wars.7 = {	
	hide_portraits = yes
	type = country_event
	category = situation_event	

	title = italian_wars.7.title
	desc = italian_wars.7.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		random_country_at_war_with = {
			limit = {
				OR = {
					this = international_organization:italian_league_1.leader_country
					this = international_organization:italian_league_2.leader_country
					this = international_organization:italian_league_3.leader_country
				}
			}
			save_scope_as = target_country
		}
		scope:actor = {
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}
	}

	option = {
		name = italian_wars.7.a
		random_current_war = {
			limit = {
				any_defender = {
					this = scope:target_country
				}
				attacker_leader = {
					this = scope:target
				}
			}
			scope:actor = { join_war_as_defender = { war = prev } }
		}
		scope:target_country = {
			trigger_event_non_silently = italian_wars.5
		}
	}

	option = {
		name = italian_wars.7.b
		random_current_war = {
			limit = {
				any_defender = {
					this = scope:target_country
				}
				attacker_leader = {
					this = scope:target
				}
			}
			root = { white_peace = prev }
		}
		scope:target_country = {
			trigger_event_non_silently = italian_wars.2
		}
	}
}

italian_wars.9 = {	
	type = country_event
	category = situation_event	

	title = italian_wars.9.title
	desc = italian_wars.9.desc

	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	
	option = {
		name = italian_wars.9.a
		if = {
			limit = {
				has_variable = iw_received_manpower
			}
			hidden_effect = {
				remove_variable = iw_received_manpower
			}
			show_as_tooltip = {
				add_manpower = {
					value = scope:actor.yearly_manpower
					multiply = 0.5
				}
			}
		}
		else = {
			hidden_effect = {
				remove_variable = iw_received_money
			}
			show_as_tooltip = {
				add_gold = {
					value = scope:actor.monthly_income_total
					multiply = 3
				}
			}
		}
	}
}

italian_wars.10 = {	
	type = country_event
	category = situation_event	

	title = italian_wars.10.title
	desc = italian_wars.10.desc
	
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	option = {
		name = italian_wars.10.a

		ai_chance = {
			factor = 5
		}

		trigger = {
			scope:actor = {
				manpower_percentage >= 0.1
			}
			scope:target = {
				max_manpower >= 0
			}
		}
		add_manpower = {
			value = scope:actor.yearly_manpower
			multiply = -0.5
		}
		scope:target = {
			add_manpower = {
				value = scope:actor.yearly_manpower
				multiply = 0.5
			}
			set_variable = {
				name = iw_received_manpower
				days = 91
			}
		}
	}

	option = {
		name = italian_wars.10.b
		trigger = {
			scope:actor = {
				gold >= {
					value = scope:actor.monthly_income_total
					multiply = 3
				}
			}
		}
		ai_chance = {
			factor = 5
		}
		add_gold = {
			value = scope:actor.monthly_income_total
			multiply = -3
		}
		scope:target = {
			set_variable = {
				name = iw_received_money
				days = 91
			}
			add_gold = {
				value = scope:actor.monthly_income_total
				multiply = 3
			}
		}
	}

	after = {
		scope:target = {
			trigger_event_non_silently = italian_wars.9
		}
	}
}

italian_wars.100 = {	
	hide_portraits = yes
	type = country_event
	category = situation_event	

	title = italian_wars.100.title
	desc = italian_wars.100.desc

	image = "gfx/interface/illustrations/situation/italian_wars.dds"

	immediate = {
		if = {
			limit = { is_member_of_international_organization = international_organization:italian_league_1 }
			international_organization:italian_league_1 = {
				leader_country = {
					save_scope_as = target_country
					ruler_or_regent ?= { save_scope_as = target_character }
				}
			}
		}
		else_if = {
			limit = { is_member_of_international_organization = international_organization:italian_league_2 }
			international_organization:italian_league_2 = {
				leader_country = {
					save_scope_as = target_country
					ruler_or_regent ?= { save_scope_as = target_character }
				}
			}
		} 
		else = {
			international_organization:italian_league_3 = {
				leader_country = {
					save_scope_as = target_country
					ruler_or_regent ?= { save_scope_as = target_character }
				}
			}
		} 
	}
	
	option = {
		name = italian_wars.100.a
		custom_tooltip = iw_gain_5_trust_with_every_member_tt
		hidden_effect = {
			random_international_organizations_member_of = {
				limit = {
					OR = {
						this = international_organization:italian_league_1
						this = international_organization:italian_league_2
						this = international_organization:italian_league_3
					}
				}
				every_international_organization_member = {
					limit = {
						this != root
					}
					add_trust = {
						modifier = iw_victors_of_the_war_trust
						target = root
					}
				}
			}
		}
		if = {
			limit = {
				scope:target_country = root
			}
			add_prestige = prestige_extreme_bonus
			add_country_modifier = { 
				modifier = iw_victory_in_the_italian_wars_modifier
				years = 15
				mode = add_and_extend
			}
		}
	}
}

italian_wars.200 = {	
	hide_portraits = yes
	type = country_event
	category = situation_event	

	title = italian_wars.100.title
	desc = italian_wars.200.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		save_scope_as = target_country
		ruler_or_regent ?= {
			save_scope_as = target_character
		}
	}
	option = {
		name = italian_wars.200.a
		add_prestige = prestige_severe_bonus
		add_stability = stability_mild_bonus
	}
}

italian_wars.300 = {	
	type = country_event
	category = situation_event	

	title = italian_wars.300.title
	desc = italian_wars.300.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		if = {
			limit = { is_member_of_international_organization = international_organization:foreign_league_france }
			international_organization:foreign_league_france = {
				save_scope_as = target_io
				leader_country = {
					save_scope_as = target_country
					ruler_or_regent ?= { save_scope_as = target_character }
				}
			}
		}
		else_if = {
			limit = { is_member_of_international_organization = international_organization:foreign_league_iberia }
			international_organization:foreign_league_iberia = {
				save_scope_as = target_io
				leader_country = {
					save_scope_as = target_country
					ruler_or_regent ?= { save_scope_as = target_character }
				}
			}
		} 
		else = {
			international_organization:foreign_league_hre = {
				save_scope_as = target_io
				leader_country = {
					save_scope_as = target_country
					ruler_or_regent ?= { save_scope_as = target_character }
				}
			}
		} 
	}
	
	option = {
		name = italian_wars.300.a
		if = {
			limit = {
				root != scope:target_country
			}
			add_opinion_mutual_effect = {
				target = scope:target_country
				modifier = fought_with_us_modifier
			}
		}
		if = {
			limit = {
				root = scope:target_country
			}
			add_prestige = prestige_extreme_bonus
			add_country_modifier = { 
				modifier = iw_victory_in_the_italian_wars_modifier
				years = 10
				mode = add_and_extend
			}
		}
		else = { add_prestige = prestige_mild_bonus }
	}
}

italian_wars.400 = {	
	hide_portraits = yes
	type = country_event
	category = situation_event	

	title = italian_wars.400.title
	desc = italian_wars.400.desc
	image = "gfx/interface/illustrations/situation/italian_wars.dds"
	immediate = {
		ruler_or_regent ?= { save_scope_as = target_character }
	}
	option = {
		name = italian_wars.400.a
		custom_tooltip = end_the_italian_wars_stalemate_tt
		if = {
			limit = {
				OR = {
					is_leader_of_international_organization = international_organization:foreign_league_france
					is_leader_of_international_organization = international_organization:foreign_league_iberia 
					is_leader_of_international_organization = international_organization:foreign_league_hre
				}
			}
			add_government_power = government_power_ultimate_penalty
		}
	}
}