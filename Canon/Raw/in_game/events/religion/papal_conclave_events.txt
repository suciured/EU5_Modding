namespace = papal_conclave_events

papal_conclave_events.1 = { #Disagreeing Cardinals
	type = country_event
	title = papal_conclave_events.1.title
	desc = papal_conclave_events.1.desc
	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election
	}

	illustration_tags = {
		10 = angry
		10 = interior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = { #God will know their own
		name = papal_conclave_events.1.a
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_extreme_penalty }
		add_religious_influence = religious_influence_weak_bonus
	}

	option = { #Popular support is important
		name = papal_conclave_events.1.b
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_extreme_penalty }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_bonus }
		add_gold = { value = root.monthly_income_total }
	}

	option = { #We must remain neutral
		name = papal_conclave_events.1.c
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }
	}
}

papal_conclave_events.2 = { #Influencing the Vote
	type = country_event
	title = papal_conclave_events.2.title
	desc = papal_conclave_events.2.desc
	image = "gfx/interface/illustrations/government/throne_rooms/papal_authority.dds"

	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election

		root.religion = {
			any_cardinal_in_religion = {
				location = {
					owner = {
						NOT = { this = root }
						NOT = { is_rival_of = root }
						NOT = { is_enemy_of = root }
						NOT = { is_at_war_with = root }
					}
				}
			}
		}
	}

	immediate = {
		root.religion = {
			random_cardinal_in_religion = {
				limit = {
					location = {
						owner = {
							NOT = { this = root }
							NOT = { is_rival_of = root }
							NOT = { is_enemy_of = root }
							NOT = { is_at_war_with = root }
						}
					}
				}
				owner = { save_scope_as = target_country }
			}
		}
	}


	option = { #Let's give them an incentive
		name = papal_conclave_events.2.a
		change_gold_effect = { scale = -2 }
		custom_tooltip = {
			text = papal_conclave_events.2.tt
			scope:target_country = {
				trigger_event_silently = { id = papal_conclave_events.3 }
			}
		}
		show_as_tooltip = {
			add_prestige = prestige_mild_bonus
			add_stability = stability_mild_bonus
			scope:target_country = {
				add_opinion = { target = c:PAP modifier = accepted_diplomatic_offer }
				reverse_add_opinion = { target = c:PAP modifier = accepted_diplomatic_offer }
			}
		}
	}

	option = { #This is blasphemy!
		name = papal_conclave_events.2.b
		add_prestige = prestige_mild_bonus
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_bonus }
	}

}

papal_conclave_events.3 = { #A Proposal from the Conclave
	type = country_event
	title = papal_conclave_events.3.title
	desc = papal_conclave_events.3.desc
	image = "gfx/interface/illustrations/government/throne_rooms/papal_authority.dds"

	option = { #Accept the proposal
		name = papal_conclave_events.3.a
		add_gold = { value = c:PAP.monthly_income_trade_and_tax multiply = 2 }
		add_opinion = { target = c:PAP modifier = accepted_diplomatic_offer }
		reverse_add_opinion = { target = c:PAP modifier = accepted_diplomatic_offer }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_extreme_penalty }
		c:PAP = {
			trigger_event_silently = { id = papal_conclave_events.4 }
		}
	}

	option = { #We will not interfere in the Holy See
		name = papal_conclave_events.3.b
		reverse_add_opinion = { target = c:PAP modifier = refused_diplomatic_offer }
		add_religious_influence = religious_influence_extreme_penalty
		add_prestige = prestige_mild_bonus
		c:PAP = {
			trigger_event_silently = { id = papal_conclave_events.5 }
		}

	}
}

papal_conclave_events.4 = { #Offer Accepted
	type = country_event
	title = papal_conclave_events.4.title
	desc = papal_conclave_events.4.desc

	illustration_tags = {
		10 = happy
		10 = interior
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = { #May the Lord bless them.
		name = papal_conclave_events.4.a
		add_prestige = prestige_mild_bonus
		add_stability = stability_mild_bonus
	}
}

papal_conclave_events.5 = { #Offer Refused
	type = country_event
	title = papal_conclave_events.5.title
	desc = papal_conclave_events.5.desc

	illustration_tags = {
		10 = angry
		10 = interior
	}

	immediate = {
		event_illustration_government_estate_effect = yes
	}

	option = { #Damned be they to hell.
		name = papal_conclave_events.5.a
		add_prestige = prestige_weak_penalty
		add_casus_belli = { target = scope:target_country type = casus_belli:cb_insulted_us	}
	}
}

papal_conclave_events.6 = { #A Special Mass
	type = country_event
	title = papal_conclave_events.6.title
	desc = papal_conclave_events.6.desc

	illustration_tags = {
		10 = regular
		10 = exterior
	}

	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:clergy_estate }
	}

	option = { #Gloria in Excelsis Deo
		name = papal_conclave_events.6.a
		add_religious_influence = religious_influence_weak_bonus
		custom_tooltip = {
			text = papal_conclave_events.6.tt
			every_owned_location = {
				every_pop = {
					limit = {
						owner = root
						religion = religion:catholic
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_bonus
				}
			}
			capital = {
				every_pop = {
					limit = {
						owner = root
						religion = religion:catholic
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_bonus
				}
			}
		}
		change_gold_effect = { scale = -1 }
	}

	option = { #We have more concerning matters
		name = papal_conclave_events.6.b
		add_stability = stability_weak_bonus
	}
}

papal_conclave_events.7 = { #Disqualification of a Cardinal
	type = country_event
	title = papal_conclave_events.7.title
	desc = papal_conclave_events.7.desc

	illustration_tags = {
		10 = angry
		10 = interior
	}

	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = { #He is clearly not fit to be [ROOT.GetCountry.GetGovernment.GetRulerTitle]
		name = papal_conclave_events.7.a
		add_stability = stability_weak_penalty
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_mild_bonus }
	}

	option = { #To err is human
		name = papal_conclave_events.7.b
		add_prestige = prestige_mild_penalty
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_bonus }
	}
}

papal_conclave_events.8 = { #A Holy Bird
	type = country_event
	title = papal_conclave_events.8.title
	desc = papal_conclave_events.8.desc

	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election
	}

	illustration_tags = {
		10 = happy
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:clergy_estate }
	}

	option = { #A Holy life indeed
		name = papal_conclave_events.8.a
		add_stability = stability_weak_bonus
		change_societal_value = { type = spiritualist_vs_humanist value = societal_value_minor_move_to_left}
	}

	option = { #Sometimes a bird is just a bird
		name = papal_conclave_events.8.b
		change_societal_value = { type = spiritualist_vs_humanist value = societal_value_minor_move_to_right }
		add_prestige = prestige_weak_bonus
	}
}

papal_conclave_events.9 = { #Election Confusion
	type = country_event
	title = papal_conclave_events.9.title
	desc = papal_conclave_events.9.desc
	image = "gfx/interface/illustrations/government/throne_rooms/papal_authority.dds"

	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election
	}

	option = { #Suppress that false news
		name = papal_conclave_events.9.a
		add_stability = stability_mild_penalty
		add_prestige = prestige_weak_bonus
	}

	option = { #God's truth will triumph over the Devil's lies
		name = papal_conclave_events.9.b
		add_estate_satisfaction = { type = estate_type:peasants_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_extreme_bonus }
	}
}

papal_conclave_events.10 = { #The Elected Candidate Refuses
	type = country_event
	title = papal_conclave_events.10.title
	desc = papal_conclave_events.10.desc

	trigger = {
		tag = PAP
		has_regent = yes
		succession_law = heir_selection:papal_election
	}

	illustration_tags = {
		10 = angry
		10 = exterior
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
	}

	option = { #How can one refuse God's calling?
		name = papal_conclave_events.10.a
		change_societal_value = { type = spiritualist_vs_humanist value = societal_value_minor_move_to_left }
		add_prestige = prestige_weak_penalty
	}

	option = { #We can't force him to accept
		name = papal_conclave_events.10.b
		change_societal_value = { type = traditionalist_vs_innovative value = societal_value_minor_move_to_right }
		add_stability = stability_weak_penalty
	}
}

papal_conclave_events.11 = { #Papal Conclave Concluded
	hide_portraits = yes
	type = country_event
	title = papal_conclave_events.11.title
	desc = papal_conclave_events.11.desc
	image = "gfx/interface/illustrations/government/throne_rooms/papal_authority.dds"
	trigger = {
		has_ruler = no
		religion = {
			any_cardinal_in_religion = {
				count >= 3
			}
		}
	}
	immediate = {
		if = {
			limit = { exists = scope:new_leader }
			clear_saved_scope = new_leader
		}
		previous_ruler ?= { save_scope_as = target_ruler }
		religion = {
			random_cardinal_in_religion = {
				location = {
					save_scope_as = first_candidate
				}
			}
			random_cardinal_in_religion = {
				limit = {
					NOT = { this.location = scope:first_candidate }
				}
				location = {
					save_scope_as = second_candidate
				}
			}
			random_cardinal_in_religion = {
				limit = {
					NOT = { this.location = scope:first_candidate }
					NOT = { this.location = scope:second_candidate }
				}
				location = {
					save_scope_as = third_candidate
				}
			}
			remove_religion_modifier = papal_conclave_modifier
		}
	}

	option = {
		name = papal_conclave_events.11.a
		create_character = {
			religion = religion:catholic
			birth_location = scope:first_candidate
			culture = scope:first_candidate.dominant_culture
			min_age = 50
			estate = estate_type:clergy_estate
			prev = {
				set_new_ruler = prev
			}
			add_random_trait_from_category = ruler
			add_random_trait_from_category = ruler
			add_random_trait_from_category = ruler
		}
		if  = {
			limit = {
				NOT = { scope:first_candidate.owner = root }
			}
			scope:first_candidate.owner = {
				add_opinion = { target = root modifier = opinion_cardinal_selected }
			}
		}
	}


	option = {
		name = papal_conclave_events.11.b
		create_character = {
			religion = religion:catholic
			birth_location = scope:second_candidate
			culture = scope:second_candidate.dominant_culture
			min_age = 50
			estate = estate_type:clergy_estate
			prev = {
				set_new_ruler = prev
			}
			add_random_trait_from_category = ruler
			add_random_trait_from_category = ruler
			add_random_trait_from_category = ruler
		}
		if  = {
			limit = {
				NOT = { scope:second_candidate.owner = root }
			}
			scope:second_candidate.owner = {
				add_opinion = { target = root modifier = opinion_cardinal_selected }
			}
		}
	}
	option = {
		name = papal_conclave_events.11.c
		create_character = {
			religion = religion:catholic
			birth_location = scope:third_candidate
			culture = scope:third_candidate.dominant_culture
			min_age = 50
			estate = estate_type:clergy_estate
			prev = {
				set_new_ruler = prev
			}

			add_random_trait_from_category = ruler
			add_random_trait_from_category = ruler
			add_random_trait_from_category = ruler
		}
		if  = {
			limit = {
				NOT = { scope:third_candidate.owner = root }
			}
			scope:third_candidate.owner = {
				add_opinion = { target = root modifier = opinion_cardinal_selected }
			}
		}
	}

}