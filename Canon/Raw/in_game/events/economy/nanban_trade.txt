namespace = nanban_trade

nanban_trade.1 = { #Nanban Bōeki
	type = country_event
	title = nanban_trade.1.title
	desc = nanban_trade.1.desc
		
	fire_only_once = yes
	
	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			NOT = { international_organization_has_policy = policy:sakoku_enabled }
		}
		num_of_ports > 0
		any_market_present_in_country = {
			any_merchant_in_market = {
				capital ?= {
					sub_continent = sub_continent:western_europe
				}
			}
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		random_market_present_in_country = {
			limit = {
				any_merchant_in_market = {
					capital.sub_continent = sub_continent:western_europe
				}
			}
			random_merchant_in_market = {
				limit = {
					capital.sub_continent = sub_continent:western_europe
				}
				save_scope_as = target_nanban
			}
		}
		save_scope_as = target_country
		
		if = {
			limit = {
				is_ai = no
			}
			event_illustration_estate_background_effect = { background = estate_type:burghers_estate }
			scope:target_nanban = {
				event_illustration_estate_foreground_effect = { foreground = estate_type:burghers_estate }
			}
		}

	}

	option = {
		name = nanban_trade.1.a
		add_research_progress = research_progress_severe_bonus
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_left }
		}
	}

	option = {
		name = nanban_trade.1.b
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_right }
		}
		add_stability = stability_mild_bonus
	}

	after = {
		hidden_effect = {
			international_organization:japanese_shogunate = {
				set_variable = nanban_trade
				every_international_organization_member = {
					limit = { this != root }
					trigger_event_silently = nanban_trade.2
				}
			}
			religion:shinto = {
				every_country_in_religion = {
					trigger_event_silently = kirishitan.13
				}
			}
		}
	}
}

nanban_trade.2 = { #Nanban Bōeki (notification)
	type = country_event
	title = nanban_trade.2.title
	desc = nanban_trade.2.desc

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		if = {
			limit = {
				is_ai = no
			}
			event_illustration_estate_background_effect = { background = estate_type:burghers_estate }
			scope:target_nanban = {
				event_illustration_estate_foreground_effect = { foreground = estate_type:burghers_estate }
			}
		}
	}
	
	option = {
		name = nanban_trade.2.a
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_left }
		}
		else = {
			add_prestige = prestige_weak_bonus
		}
		custom_tooltip = enable_kirishitan_monks.tt
	}

	option = {
		name = nanban_trade.2.b
		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_move_to_right }
		}
		else = {
			add_stability = stability_weak_bonus
		}
		custom_tooltip = enable_kirishitan_monks.tt
	}
}

nanban_trade.3 = { #Arrival of European Traders
	type = country_event
	title = nanban_trade.3.title
	desc = nanban_trade.3.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = nanban_trade
			NOT = { international_organization_has_policy = policy:sakoku_enabled }
		}
		num_of_ports > 0
		NOT = { has_country_modifier = nanban_trade_restrictions }
		any_port_in_country = {
			NOT = { has_location_modifier = nanban_port }
		}
	}

	illustration_tags = {
        10 = happy
        10 = exterior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		random_port_in_country = {
			limit = {
				NOT = { has_location_modifier = nanban_port }
			}
			save_scope_as = nanban_traders_here
		}
	}

	option = {
		name = nanban_trade.3.a
		scope:nanban_traders_here = {
			add_location_modifier = { modifier = nanban_port years  = 10 mode = add_and_extend }  
		}
	}
	option = {
		name = nanban_trade.3.b
		change_gold_effect = { scale = 6.00 }
	}
	option = {
		name = nanban_trade.3.c
		add_country_modifier = { modifier = nanban_trade_restrictions years  = 10 mode = add_and_extend }
		every_port_in_country = {
			limit = { has_location_modifier = nanban_port }
			remove_location_modifier = nanban_port
		}
	}
}

nanban_trade.4 = { #Duplicity among European Traders
	type = country_event
	title = nanban_trade.4.title
	desc = nanban_trade.4.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = nanban_trade
			NOT = { international_organization_has_policy = policy:sakoku_enabled }
		}
		num_of_ports > 0
	}

	illustration_tags = {
        10 = angry
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		random_port_in_country = {
			save_scope_as = nanban_traders_here
		}
	}

	option = {
		name = nanban_trade.4.a
		add_prestige = prestige_severe_penalty
		scope:nanban_traders_here = {
			change_development  = development_mild_bonus
			change_control = control_mild_penalty
		}
	}
	option = {
		name = nanban_trade.4.b
		add_prestige = prestige_mild_penalty
		scope:nanban_traders_here = {
			change_development  = development_weak_bonus
			change_control = control_weak_penalty
		}
	}
	option = {
		name = nanban_trade.4.c
		add_prestige = prestige_mild_bonus
		add_legitimacy = legitimacy_mild_bonus
	}
}

nanban_trade.5 = { #Western Knowledge
	type = country_event
	title = nanban_trade.5.title
	desc = nanban_trade.5.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = nanban_trade
			NOT = { international_organization_has_policy = policy:sakoku_enabled }
		}
		num_of_ports > 0
		NOT = { has_country_modifier = rangaku_incident_modifier }
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		random_port_in_country = {
			save_scope_as = nanban_traders_here
		}
	}

	option = {
		name = nanban_trade.5.a
		add_country_modifier = { modifier = rangaku_incident_modifier years = 10 mode = add_and_extend }  
	}
	option = {
		name = nanban_trade.5.b
		add_prestige = prestige_mild_bonus
	}
}

nanban_trade.6 = { #Foreign Influence
	type = country_event
	title = nanban_trade.6.title
	desc = nanban_trade.6.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = nanban_trade
			NOT = { international_organization_has_policy = policy:sakoku_enabled }
		}
		num_of_ports > 0
		NOT = { has_country_modifier = nanban_dependent_on_imports }
		NOT = { has_country_modifier = nanban_production_investments }
	}

	illustration_tags = {
        10 = regular
        10 = interior
    }

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
	}
	
	option = {
		name = nanban_trade.6.a
		change_gold_effect = { scale = 12.00 }
		add_country_modifier = { modifier = nanban_dependent_on_imports years = 10 mode = add_and_extend }  
	}
	option = {
		name = nanban_trade.6.b
		change_gold_effect = { scale = -12.00 }
		add_country_modifier = { modifier = nanban_production_investments years = 10 mode = add_and_extend }  
	}
}

nanban_trade.7 = { #Tanegashima Teppō
	type = country_event
	title = nanban_trade.7.title
	desc = nanban_trade.7.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_firearms.dds"

	fire_only_once = yes

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = nanban_trade
			NOT = { international_organization_has_policy = policy:sakoku_enabled }
		}
		owns = location:kumage_oosumi
	}

	immediate = {
		location:kumage_oosumi = {
			save_scope_as = target_location
		}
	}

	option = {
		name = nanban_trade.7.a
		add_army_tradition = army_tradition_weak_bonus
		add_navy_tradition = navy_tradition_weak_bonus
		international_organization:japanese_shogunate ?= {
			set_variable = firearms_production
			every_international_organization_member = {
				limit = {
					this != root
				}
				trigger_event_silently = nanban_trade.8
			}
		}
	}
}

nanban_trade.8 = { #Tanegashima Teppō (Information)
	type = country_event
	title = nanban_trade.8.title
	desc = nanban_trade.8.desc

	image = "gfx/interface/icons/trade_goods/illustrations/icon_goods_firearms.dds"
	
	option = {
		name = nanban_trade.8.a

		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_tiny_move_to_left }
		}
		else = {
			add_prestige = prestige_weak_bonus
		}
	}

	option = {
		name = nanban_trade.8.b

		if = {
			limit = {
				NOR = {
					current_age = age_1_traditions
					current_age = age_2_renaissance
				}
			}
			change_societal_value = { type = outward_vs_inward value = societal_value_tiny_move_to_right }
		}
		else = {
			add_stability = stability_weak_bonus
		}
	}

}

nanban_trade.9 = { #Access to Firearms
	type = country_event
	title = nanban_trade.9.title
	desc = nanban_trade.9.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = firearms_production
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}
	
	option = {
		name = nanban_trade.9.a
		add_army_tradition = army_tradition_severe_bonus
		change_gold_effect = { scale = -5 }
	}
	option = {
		name = nanban_trade.9.b
		add_army_tradition = army_tradition_weak_bonus
	}
}

nanban_trade.10 = { #Dissemination of Firearms
	type = country_event
	title = nanban_trade.10.title
	desc = nanban_trade.10.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = firearms_production
		}
		NOT = { has_country_modifier = firearm_restrictions }
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}
	
	option = {
		name = nanban_trade.10.a
		if = {
			limit = {
				monthly_manpower > 0
			}
			add_manpower = { value = root.monthly_manpower }
		}
		else = {
			add_prestige = prestige_mild_bonus
		}
	}
	option = {
		name = nanban_trade.10.b
		add_country_modifier = { modifier = firearm_restrictions years = 10 mode = add_and_extend }  
	}
}

nanban_trade.11 = { #Evolution of Arms
	type = country_event
	title = nanban_trade.11.title
	desc = nanban_trade.11.desc

	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = firearms_production
		}
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}
	
	option = {
		name = nanban_trade.11.a
		change_gold_effect = { scale = -5.00 }
		add_army_tradition = army_tradition_weak_bonus
		add_navy_tradition = army_tradition_weak_bonus
	}
	option = {
		name = nanban_trade.11.b
		add_prestige = prestige_mild_bonus
	}
}

nanban_trade.12 = { #A Military Revolution
	type = country_event
	title = nanban_trade.12.title
	desc = nanban_trade.12.desc
	trigger = {
		culture = { has_culture_group = culture_group:japanese_group }
		exists = international_organization:japanese_shogunate
		is_member_of_international_organization = international_organization:japanese_shogunate
		international_organization:japanese_shogunate ?= {
			has_variable = firearms_production
		}
		army_tradition >= 70
	}

	illustration_tags = {
        10 = regular
        10 = exterior
    }

	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:soldiers background = pop_type:soldiers }
	}
	
	option = {
		name = nanban_trade.12.a
		add_prestige = prestige_mild_bonus
		if = {
			limit = { war_exhaustion > 0 }
			add_war_exhaustion = war_exhaustion_mild_bonus
		}
	}
}

