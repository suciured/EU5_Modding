namespace = regencies

regencies.1 = {
	type = country_event	

	title = regencies.1.title
	desc = regencies.1.desc
	
	
	
	trigger = {
		has_regent = yes
		has_heir = no
		NOR = {
			succession_law = heir_selection:veche_selection
			succession_law = heir_selection:guru_election
		}
		regent = {
			OR = {
				NOT = { has_estate = estate_type:clergy_estate }
				religion != religion:catholic
			}
			religion = root.religion
			is_heir = no
		}
		exists = previous_ruler
		trigger_if = {
			limit = { has_policy = sharia_law_policy }
			regent = { is_female = no }
		}
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		regent = { save_scope_as = target_character }
		previous_ruler = { save_scope_as = target_previous_ruler }
	}
	
	option = {
		name = regencies.1.a
		trigger = {
			hidden_trigger = {
				NAND = {
					has_reform = government_reform:japanese_imperial_family
					is_situation_active = situation:nanbokuchou
				}
			}
		}
		if = {
			limit = {
				has_game_rule = change_countries_dynastic_naming
				OR = {
					has_reform = government_reform:japanese_imperial_family
					has_reform = government_reform:japanese_clan
					has_reform = government_reform:shogunate
					has_reform = government_reform:daimyo
				}
				scope:target_previous_ruler = { has_dynasty = yes }
				scope:target_character = {
					OR = { 
						has_dynasty = no
						dynasty != scope:target_previous_ruler.dynasty
					}
				}
			}
			custom_tooltip = regencies.1.a.japanese.tt
			if = {
				limit = { has_reform = government_reform:japanese_imperial_family }
				custom_tooltip = regencies.1.a.japanese_imperial_family.tt
			}
			scope:target_character = { set_variable = new_dynasty }
		}
		make_regent_to_ruler = yes
	}


	option = {
		name = regencies.1.b
		add_stability = stability_mild_penalty
	}

	option = {
		name = regencies.1.c
		trigger = {
			OR = {
				has_reform = government_reform:japanese_imperial_family
				has_reform = government_reform:japanese_clan
				has_reform = government_reform:shogunate
				has_reform = government_reform:daimyo
			}
			scope:target_previous_ruler = { has_dynasty = yes }
			scope:target_character = {
				OR = { 
					has_dynasty = no
					dynasty != scope:target_previous_ruler.dynasty
				}
				#Make sure that the new "parent" is not a descendant of the new "kid"
				NOT = {
					any_descendant = {
						this = scope:target_previous_ruler 
					} 
				}
			}
		}
		if = {
			limit = {
				scope:target_character.religion.group != religion.group
			}
			change_religion = scope:target_character.religion
			change_religion_for_ruler_and_family = { country = ROOT religion = scope:target_character.religion }
		}
		scope:target_previous_ruler = {
			adopt_character = scope:target_character
		}
		set_new_ruler = scope:target_character
	}
}

regencies.2 = {
	type = country_event
	fire_only_once = yes
	title = regencies.2.title
	desc = regencies.2.desc
	trigger = {
		government_type = government_type:monarchy
		stability < 20
		legitimacy < 50
		has_regent = yes
		has_heir = yes
		heir = {
			OR ={
				adm > 33
				mil > 33
				dip > 33
			}
			age_in_years > 5
		}
		NOT = {
			regent = { has_character_modifier = paranoid_regent }
		}
	}
	illustration_tags = {
		10 = exterior
	}
	immediate = {
		event_illustration_estate_background_effect = { background = estate_type:nobles_estate }
	}
	#show_portrait = main character
	option = {
		name = regencies.2.a
		regent = {
			add_character_modifier = { modifier = paranoid_regent months = -1 mode = add_and_extend } 
		}
	}
}

regencies.3 = {
	type = country_event
	fire_only_once = yes
	title = regencies.3.title
	desc = regencies.3.desc
	trigger = {
		has_regent = yes
		government_type = government_type:monarchy
		regent = { has_character_modifier = paranoid_regent }
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	option = {
		name = regencies.3.a
		regent = {
			add_character_modifier = { modifier = investigating_regent months = -1 mode = add_and_extend } 
		}
	}
	option = {
		name = regencies.3.c
		add_legitimacy = legitimacy_weak_penalty
	}
}

regencies.4 = {
	type = country_event
	fire_only_once = yes
	title = regencies.4.title
	desc = regencies.4.desc
	trigger = {
		has_regent = yes
		government_type = government_type:monarchy
		regent = { has_character_modifier = paranoid_regent }
		regent = { has_character_modifier = investigating_regent }
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = { 
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	option = {
		name = regencies.4.a
		remove_from_cabinet = regent
		regent = { add_character_modifier = { modifier = refuses_to_serve_in_cabinet years = -1 mode = add_and_extend }	}
		reset_regency = yes
	}
}

regencies.5 = {
	type = country_event
	title = regencies.5.title
	desc = regencies.5.desc
	trigger = {
		government_type = government_type:monarchy
		has_regent = yes
		regent = {  has_trait = greedy }
	}
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		regent = { save_scope_as = target_character }
	}
	option = {
		name = regencies.5.a
		if = {
			limit = {
				scope:target_character = { in_cabinet = yes }
			}
			remove_from_cabinet = scope:target_character
		}
		if = {
			limit = {
				scope:target_character = {
					NOT = { has_character_modifier = refuses_to_serve_in_cabinet }
				}
			}
			scope:target_character = { add_character_modifier = { modifier = refuses_to_serve_in_cabinet years = -1 mode = add_and_extend }	}
		}
		reset_regency = yes
		add_stability = stability_mild_penalty
	}
	option = {
		name = regencies.5.c
		add_stability = stability_weak_penalty
		add_prestige = prestige_weak_penalty
	}
}

regencies.6 = {
	type = country_event
	title = regencies.6.title
	desc = regencies.6.desc
	trigger = {
		has_heir = yes
		has_regent = yes
		heir = {
			age_in_years < 12
		}
		stability < 20
		OR = {
			regent = { has_trait = cruel }
			regent = { has_trait = zealot }
			regent = { has_trait = sinner }
			regent = { has_trait = malevolent }
			regent = { has_trait = drunkard }
			regent = { has_trait = intricate_web_weaver }
			regent = { has_trait = secretive }
			regent = { has_trait = craven }
			regent = {
				mil < 50
				dip < 50
				adm < 50
			}
		}
		is_regency_extended = no
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:nobles_estate }
	}
	option = {
		name = regencies.6.a
		extend_regency = 10
	}
}

regencies.7 = {
	type = country_event
	title = regencies.7.title
	desc = regencies.7.desc
	trigger = {
		has_regent = yes
		has_heir = yes
		heir = { age_in_years >= 13 }
		stability >= 0
		regent = { 
			dip >= 50
			dip >= 50
			adm >= 50
		}
		OR = {
			regent = { dip >= 70 }
			regent = { mil >= 70 }
			regent = { adm >= 70 }
		}
		heir = {
			adm < 50
			dip < 50
			mil < 50
		}
		is_regency_extended = no
	}
	illustration_tags = {
		10 = regular
		10 = exterior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
	}
	option = {
		name = regencies.7.a
		add_stability = stability_weak_bonus
		extend_regency = 5
	}
	option = {
		name = regencies.7.b
		add_legitimacy = legitimacy_mild_penalty
	}
}