namespace = byzantine_succ_crisis
byzantine_succ_crisis.1 = { #Nobles Demand Compensation
	image = "gfx/interface/illustrations/disaster/byzantine_succession_crisis.dds"
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.1.title
	desc = byzantine_succ_crisis.1.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	trigger = {
		tag = BYZ
		ruler_or_regent ?= {
			has_estate = estate_type:nobles_estate 
		}
		in_civil_war = no
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {	#Yes
		name = byzantine_succ_crisis.1.a

		change_gold_effect = { scale = -3 }
		add_gold_to_estate = {
			estate_type = estate_type:nobles_estate
			value = {
				value = monthly_income_trade_and_tax
				multiply = 3
			}
		}
		add_stability = stability_weak_bonus
		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_mild_bonus
		}
		add_estate_satisfaction = { type = estate_type:peasants_estate 
			value = estate_satisfaction_extreme_penalty
		}
		custom_tooltip = peasants_unhappy_tt
		hidden_effect = {
			every_owned_location = {
				random_pop = {
					limit = {
						owner = root
						pop_type = pop_type:peasants
					}
					add_pop_satisfaction = pop_satisfaction_mild_penalty
				}
			}
		}
	}

	option = {	#No
		name = byzantine_succ_crisis.1.b 

		change_societal_value = {
			type = serfdom_vs_free_subjects
			value = societal_value_large_move_to_right
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_radical_penalty
		}
		add_government_power = government_power_extreme_bonus
		custom_tooltip = byz_every_noble_sides_with_pretender_tt
		hidden_effect = {
			every_owned_location = {
				random_pop = {
					limit = {
						owner = root
						pop_type = pop_type:nobles
					}
					add_pop_satisfaction = pop_satisfaction_severe_penalty
					if = {
						limit = { exists = scope:succession_crisis_pretender_scope }
						change_pop_allegiance = scope:succession_crisis_pretender_scope
					}
				}
			}
		}
	}
}

byzantine_succ_crisis.2 = { #Nobles Refuse to Pay Taxes
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.2.title
	desc = byzantine_succ_crisis.2.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		NOT = { has_variable = byz_nobles_refused_paying_taxes }
		estate_tax_percentage:nobles_estate > 0
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		set_variable = {
			name = byz_nobles_refused_paying_taxes
			value = yes
			years = 10
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {
		name = byzantine_succ_crisis.2.a
		
		historical_option = yes

		add_country_modifier = {
			modifier = byz_relinquish_taxes_for_nobles_modifier
			years = 5
			mode = add_and_extend
		}
	}

	option = {
		name = byzantine_succ_crisis.2.b 

		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_radical_penalty
		}
		add_government_power = government_power_mild_bonus
	}
}

byzantine_succ_crisis.3 = { #Our Nobility Supports the Pretender
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.3.title
	desc = byzantine_succ_crisis.3.desc
	illustration_tags = {
		10 = angry
		10 = exterior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		NOT = { has_variable = byz_nobles_supports_pretender_variable }
		estate_satisfaction:nobles_estate < 0.5	
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		set_variable = {
			name = byz_nobles_supports_pretender_variable
			value = yes
			years = 5
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {
		name = byzantine_succ_crisis.3.a

		var:succession_crisis_pretender_variable ?= {
			add_rebel_progress = {
				value = 0.1
			}
		}
		add_government_power = government_power_mild_penalty
	}

	option = {
		name = byzantine_succ_crisis.3.b 

		trigger = {
			num_possible_estate_privileges:nobles_estate > 0
		}

		"estate(estate_type:nobles_estate)" = {
			random_possible_privilege = {
				root = { grant_estate_privilege = prev }
			}
		}

		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_mild_bonus
		}

		add_government_power = government_power_weak_penalty
	}
}

byzantine_succ_crisis.4 = { #Mariners Guild Rises Up
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.4.title
	desc = byzantine_succ_crisis.4.desc
	illustration_tags = {
		10 = angry
		10 = exterior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		owns = location:thessaloniki
		location:thessaloniki = {
			any_pop = {
				OR = {
					pop_type = pop_type:peasants 
					pop_type = pop_type:burghers
				}	
				OR = {
					AND = {
						exists = root.var:succession_crisis_pretender_variable
						has_rebel = root.var:succession_crisis_pretender_variable
							has_rebel = yes
					}
					pop_satisfaction < 0.4
				}
			}
		}
		NOT = { has_variable = byz_mariners_guild_rose_up }
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		location:thessaloniki = {
			save_scope_as = target_location
		}
		set_variable = byz_mariners_guild_rose_up
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {
		name = byzantine_succ_crisis.4.a

		custom_tooltip = thessaloniki_effect_1_tt
		hidden_effect = {
			location:thessaloniki = {
				change_control = control_ultimate_penalty
				every_pop = {
					limit = {
						owner = root
						OR = {
							pop_type = pop_type:peasants
							pop_type = pop_type:burghers
						}
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_bonus
				}
				every_pop = {
					limit = {
						owner = root
						pop_type = pop_type:nobles
					}
					add_pop_satisfaction = pop_satisfaction_extreme_penalty
				}
			}
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_extreme_penalty
		}
		change_societal_value = {
			type = serfdom_vs_free_subjects
			value = societal_value_minor_move_to_right
		}
		change_societal_value = {
			type = centralization_vs_decentralization
			value = societal_value_large_move_to_right
		}
	}

	option = {
		name = byzantine_succ_crisis.4.b 

		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_extreme_bonus
		}
		custom_tooltip = thessaloniki_effect_2_tt
		hidden_effect = {
			location:thessaloniki = {
				change_control = control_ultimate_penalty
				every_pop = {
					limit = {
						owner = root
						OR = {
							pop_type = pop_type:peasants
							pop_type = pop_type:burghers
						}
					}
					add_pop_satisfaction = pop_satisfaction_extreme_penalty
				}
				random_pop = {
					limit = { pop_type = pop_type:nobles }
					add_pop_satisfaction = pop_satisfaction_ultimate_bonus
				}
			}
		}
		change_societal_value = {
			type = serfdom_vs_free_subjects
			value = societal_value_large_move_to_left
		}
	}
}

byzantine_succ_crisis.5 = { #Commoners Demand Noble Purge
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.5.title
	desc = byzantine_succ_crisis.5.desc
	illustration_tags = {
		10 = angry
		10 = exterior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		any_owned_location = {
			NOT = { has_variable = noble_purge_timer }
			any_pop = {
				pop_type = pop_type:peasants
				pop_satisfaction < 0.4
			}
			any_pop = { pop_type = pop_type:nobles }
		} 
	}
	immediate = {
		event_illustration_poptype_effect = { foreground = pop_type:nobles   background = pop_type:nobles }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		random_owned_location = {
			limit = {
				any_pop = { pop_type = pop_type:nobles }
				any_pop = {
					pop_type = pop_type:peasants
					pop_satisfaction < 0.4
				}
			}
			save_scope_as = target_location
			set_variable = {
				name = noble_purge_timer
				value = yes 
				years = 2
			}
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {
		name = byzantine_succ_crisis.5.a

		scope:target_location = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:nobles
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.5 
				}
				add_pop_satisfaction = pop_satisfaction_radical_penalty
			}
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_extreme_bonus
			}
		}
		add_stability = stability_weak_bonus
		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_radical_penalty
		}
	}

	option = {
		name = byzantine_succ_crisis.5.b 

		add_estate_satisfaction = { type = estate_type:peasants_estate 
			value = estate_satisfaction_radical_penalty
		}
		add_government_power = government_power_weak_bonus
		scope:target_location = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_ultimate_penalty
			}
		}
	}
}

byzantine_succ_crisis.6 = { #General Abandons the Court
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.6.title
	desc = byzantine_succ_crisis.6.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		any_character = {
			NOT = { has_variable = scope_pretender_var }
			NOT = { has_variable = recently_abandoned_var }
			is_ruler = no 
			is_regent = no
			is_general = yes
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		random_character = {
			limit = {
				NOT = { has_variable = scope_pretender_var }
				NOT = { has_variable = recently_abandoned_var }
				is_ruler = no 
				is_regent = no
				is_general = yes
			}
			save_scope_as = target_character2
			set_variable = {
				name = recently_abandoned_var
				value = yes 
				years = 1
			}
		}
		ruler_or_regent ?= { save_scope_as = target_character3 }
	}

	option = {	#Imprison him!
		name = byzantine_succ_crisis.6.a

		add_government_power = government_power_mild_bonus
		if = {
			limit = {
				scope:target_character2 ?= { has_estate = estate_type:clergy_estate }
			}
			add_estate_satisfaction = { type = estate_type:clergy_estate 
				value = estate_satisfaction_severe_penalty
			}
			add_religious_influence_if_valid = { VALUE = religious_influence_mild_penalty }
		}
		else_if = {
			limit = {
				scope:target_character2 ?= { has_estate = estate_type:burghers_estate }
			}
			add_estate_satisfaction = { type = estate_type:burghers_estate 
				value = estate_satisfaction_severe_penalty
			}
			change_societal_value = {
				type = aristocracy_vs_plutocracy
				value = societal_value_minor_move_to_left
			}
		}
		else_if = {
			limit = {
				scope:target_character2 ?= { has_estate = estate_type:peasants_estate }
			}
			add_estate_satisfaction = { type = estate_type:peasants_estate 
				value = estate_satisfaction_severe_penalty
			}
			change_societal_value = {
				type = serfdom_vs_free_subjects
				value = societal_value_minor_move_to_left
			}
		}
		else = {
			add_estate_satisfaction = { type = estate_type:nobles_estate 
				value = estate_satisfaction_severe_penalty
			}
			change_societal_value = {
				type = serfdom_vs_free_subjects
				value = societal_value_minor_move_to_right
			}
		}
	}

	option = {
		name = byzantine_succ_crisis.6.b 

		add_stability = stability_mild_bonus
		if = {
			limit = {
				scope:target_character2 = { has_estate = estate_type:nobles_estate }
			}
			add_gold_to_estate = {
				estate_type = estate_type:nobles_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_gold = {
				value = monthly_income_trade_and_tax
				multiply = 1
			}
			add_estate_satisfaction = { type = estate_type:nobles_estate 
				value = estate_satisfaction_mild_penalty
			}
		}
		else_if = {
			limit = {
				scope:target_character2 = { has_estate = estate_type:clergy_estate }
			}
			add_gold_to_estate = {
				estate_type = estate_type:clergy_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_gold = {
				value = monthly_income_trade_and_tax
			}
			add_estate_satisfaction = { type = estate_type:clergy_estate 
				value = estate_satisfaction_mild_penalty
			}
		}
		else_if = {
			limit = {
				scope:target_character2 = { has_estate = estate_type:burghers_estate }
			}
			add_gold_to_estate = {
				estate_type = estate_type:burghers_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_gold = {
				value = monthly_income_trade_and_tax
			}
			add_estate_satisfaction = { type = estate_type:burghers_estate 
				value = estate_satisfaction_mild_penalty
			}
		}
		else_if = {
			limit = {
				scope:target_character2 = { has_estate = estate_type:peasants_estate }
			}
			add_gold_to_estate = {
				estate_type = estate_type:peasants_estate
				value = {
					value = monthly_income_trade_and_tax
					multiply = -1
				}
			}
			add_gold = {
				value = monthly_income_trade_and_tax
			}
			add_estate_satisfaction = { type = estate_type:peasants_estate 
				value = estate_satisfaction_mild_penalty
			}
		}
	}

	option = {
		name = byzantine_succ_crisis.6.c

		custom_tooltip = byz_character_might_cause_trouble_again_tt
		add_government_power = government_power_weak_penalty
		hidden_effect = { 
			scope:target_character = { remove_variable = recently_abandoned_var }
		}
	}
}

byzantine_succ_crisis.7 = { 
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.7.title
	desc = byzantine_succ_crisis.7.desc
	illustration_tags = {
		10 = regular
		10 = interior
	}
	trigger = {
		in_civil_war = no
		tag = BYZ
		NOT = { has_variable = had_parliament_event_variable }
		is_active_parliament = yes
	}

	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		set_variable = {
			name = had_parliament_event_variable
			value = yes
			years = 5
		}
	}

	option = {
		name = byzantine_succ_crisis.7.a

		custom_tooltip = unlock_new_issues_about_civil_war_tt
		add_country_modifier = {
			modifier = expanded_assembly_powers_modifier
			years = 10
			mode = add_and_extend
			size = {
				value = 1
				multiply = {
					desc = "[crown_power|e]"
					value = "estate_power(estate_type:crown_estate)"
				}
			}
		}
		custom_tooltip = scales_with_crown_power_tt
	}

	option = {
		name = byzantine_succ_crisis.7.b 

		add_government_power = government_power_extreme_bonus
	}
}

byzantine_succ_crisis.8 = { #Church Dissaproves of Pretender 
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.8.title
	desc = byzantine_succ_crisis.8.desc
	illustration_tags = {
		10 = regular
		10 = interior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		estate_satisfaction:clergy_estate >= 0.6
		any_province = {
			any_location_in_province = {
				any_pop = {
					religion = root.religion
					OR = {
						AND = {
							exists = root.var:succession_crisis_pretender_variable
							has_rebel = root.var:succession_crisis_pretender_variable
						}
						pop_satisfaction < 0.4
					}
				}
			}
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:clergy_estate background = estate_type:clergy_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		random_province = {
			limit = {
				any_location_in_province = {
					any_pop = {
						religion = root.religion
						OR = {
							AND = {
								exists = root.var:succession_crisis_pretender_variable
								has_rebel = root.var:succession_crisis_pretender_variable
							}
							pop_satisfaction < 0.4
						}
					}
				}
			}
			save_scope_as = target_province
		}
		ruler_or_regent ?= { save_scope_as = target_character2 }
	}

	option = {
		name = byzantine_succ_crisis.8.a

		var:succession_crisis_pretender_variable ?= {
			add_rebel_progress = -0.05
		}
		add_government_power = {
			value = "root.estate_power(estate_type:clergy_estate)"
			multiply = 100
			min = 5
		}
		custom_tooltip = scales_with_clergy_estate_power_tt
	}

	option = {
		name = byzantine_succ_crisis.8.b 
		
		custom_tooltip = province_pops_gain_satisfaction_tt
		ordered_province = {
			order_by = {
				value = province_satisfaction
				multiply = -1
			}
			max = 4
			check_range_bounds = no
			hidden_effect = {
				every_location_in_province = {
					every_pop = {
						limit = { 
							owner = root
							religion = root.religion
							OR = {
								AND = {
									exists = root.var:succession_crisis_pretender_variable
									has_rebel = root.var:succession_crisis_pretender_variable
								}
								pop_satisfaction < 0.4
							}		
						}
						add_pop_satisfaction = pop_satisfaction_severe_bonus
					}
				}
			}
		}
	}
}

byzantine_succ_crisis.9 = { #The Ravages of Civil War
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.9.title
	desc = byzantine_succ_crisis.9.desc
	illustration_tags = {
		10 = angry
		10 = exterior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		any_province = {
			any_location_in_province = { this != root.capital }
			any_location_in_province = { prosperity < 0.3 }
			NOT = { has_variable = province_asked_for_aid_variable }
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		ordered_province = {
			limit = {
				any_location_in_province = { this != root.capital }
				
				any_location_in_province = { prosperity < 0.3 }
			}
			order_by = {
				value = province_satisfaction
				multiply = -1
			}
			check_range_bounds = no
			max = 1
			save_scope_as = target_province
			set_variable = { 
				name = province_asked_for_aid_variable 
				value = yes 
				years = 2
			}
		}
	}

	option = {
		name = byzantine_succ_crisis.9.a

		change_gold_effect = { scale = -2 }
		scope:target_province = {
			every_location_in_province = { change_prosperity  = prosperity_very_weak_bonus }
		}
	}

	option = {
		name = byzantine_succ_crisis.9.b 

		if = {
			limit = {
				exists = var:succession_crisis_pretender_variable
				NOT = { 
					scope:target_province = {
						any_location_in_province = {
							any_pop = {
								rebel = root.var:succession_crisis_pretender_variable
							}
							count >= 2
						}
					}
				}
			}
			custom_tooltip = pops_in_target_province_join_succession_crisis_pretender_tt
			hidden_effect = {
				scope:target_province = {
					every_location_in_province = {
						every_pop = {
							limit = {
								owner = root
							}
							add_pop_satisfaction = pop_satisfaction_mild_penalty
							if = {
								limit = { exists = scope:succession_crisis_pretender_scope }
								change_pop_allegiance = scope:succession_crisis_pretender_scope
							}
						}
					}
				}
			}
		}
	}
}

byzantine_succ_crisis.10 = { 	#The Legitimization of Usury
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.10.title
	desc = byzantine_succ_crisis.10.desc
	illustration_tags = {
		10 = angry
		10 = exterior
	}
	trigger = {
		tag = BYZ
		in_civil_war = no
		any_owned_location = {
			any_pop = { pop_type = pop_type:nobles }
			any_pop = { pop_type = pop_type:burghers }
			any_pop = { pop_type = pop_type:peasants }
			is_capital = no
			NOT = { has_variable = had_usury_disaster_event_variable }
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:peasants_estate background = estate_type:peasants_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		ordered_owned_location = {
			limit = {
				any_pop = { pop_type = pop_type:nobles }
				any_pop = { pop_type = pop_type:peasants }
				any_pop = { pop_type = pop_type:burghers }
				NOT = { has_variable = had_usury_disaster_event_variable }
				is_capital = no
			}
			order_by = {
				value = local_control
				if = {
					limit = { location_rank = location_rank:city }
					multiply = 5
				}
				if = {
					limit = { location_rank = location_rank:town }
					multiply = 3
				}
				multiply = -1
			}
			max = 1
			check_range_bounds = no 
			save_scope_as = target_location
			set_variable = {
				name = had_usury_disaster_event_variable
				value = yes 
				years = 1
			}
		}
	}

	option = {
		name = byzantine_succ_crisis.10.a

		scope:target_location = {
			every_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_ultimate_penalty
			}
		}
		add_estate_satisfaction = { type = estate_type:nobles_estate 
			value = estate_satisfaction_extreme_bonus
		}
	}

	option = {
		name = byzantine_succ_crisis.10.b 

		scope:target_location = {
			every_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_ultimate_penalty
			}
		}
		change_gold_effect = { scale = 0.75 }
	}

	option = {
		name = byzantine_succ_crisis.10.c

		scope:target_location = {
			every_pop = {
				limit = {
					owner = root
					pop_type = pop_type:peasants
				}
				add_pop_satisfaction = pop_satisfaction_mild_bonus
			}
			every_pop = {
				limit = {
					owner = root
					pop_type = pop_type:nobles
				}
				add_pop_satisfaction = pop_satisfaction_extreme_penalty
			}
		}
		add_gold_to_estate = {
			estate_type = estate_type:nobles_estate
			value = {
				value = monthly_income_trade_and_tax
				multiply = -1.5
			}
		}
	}

	option = {
		name = byzantine_succ_crisis.10.d

		custom_tooltip = nobles_burghers_10_satisfaction_at_the_expense_of_peasants_tt
		hidden_effect = {
			scope:target_location = {
				every_pop = {
					limit = {
						owner = root
						pop_type = pop_type:peasants
					}
					add_pop_satisfaction = pop_satisfaction_ultimate_penalty
				}
				every_pop = {
					limit = {
						owner = root
						OR = {
							pop_type = pop_type:nobles
							pop_type = pop_type:burghers
						}
					}
					add_pop_satisfaction = pop_satisfaction_mild_bonus
				}
			}
		}
		add_gold_to_estate = {
			estate_type = estate_type:nobles_estate
			value = {
				value = monthly_income_trade_and_tax
				multiply = 1
			}
		}
		add_gold_to_estate = {
			estate_type = estate_type:burghers_estate
			value = {
				value = monthly_income_trade_and_tax
				multiply = 1
			}
		}
		change_gold_effect = { scale = 1.25	}
		add_government_power = government_power_weak_penalty
	}
}

byzantine_succ_crisis.11 = { 	#Foreign Merchants Privileges
	hide_portraits = yes
	type = country_event
	fire_only_once = yes
	dynamic_historical_event = {
		tag = BYZ
		from = 1300.1.1
		to = 1400.1.1
		monthly_chance = 10
	}
	title = byzantine_succ_crisis.11.title
	desc = byzantine_succ_crisis.11.desc
	historical_info = byzantine_succ_crisis.11.historical_info
	illustration_tags = {
		10 = regular
		10 = interior
	}
	trigger = {
		any_active_disaster = { disaster_type = disaster_type:byzantine_succession_crisis }
		country_exists = c:VEN
		country_exists = c:GEN
		NOR = {
			c:VEN = { is_subject_of = root }
			c:GEN = { is_subject_of = root }
		}
		in_civil_war = no
		NOR = {
			is_at_war_with = c:GEN
			is_at_war_with = c:VEN
		}
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate }
		save_scope_as = target_country
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
		capital = { save_scope_as = target_location }
	}

	option = {	#Give privileges to Venice 
		name = byzantine_succ_crisis.11.a

		add_estate_satisfaction = { type = estate_type:burghers_estate 
			value = estate_satisfaction_extreme_penalty
		}
		scope:target_location.market = {
			add_merchant_power = {
				country = c:VEN
				key = italian_merchants_favored_key
				months = 120
				power = merchant_power_severe_bonus
			}
		}
		add_country_modifier = {
			modifier = byz_reliance_on_italian_navies
			mode = add_and_extend
			years = 10
		}
		c:VEN = {
			trigger_event_non_silently = byzantine_succ_crisis.12
		}
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = {
				type = mercantilism_vs_free_trade
				value = societal_value_move_to_right
			}
		}
	}

	option = {	#Give privileges to Genoa
		name = byzantine_succ_crisis.11.b 

		add_estate_satisfaction = { type = estate_type:burghers_estate 
			value = estate_satisfaction_extreme_penalty
		}
		scope:target_location.market = {
			add_merchant_power = {
				country = c:GEN
				key = italian_merchants_favored_key
				months = 120
				power = merchant_power_severe_bonus
			}
		}
		add_country_modifier = {
			modifier = byz_reliance_on_italian_navies
			mode = add_and_extend
			years = 10
		}
		c:GEN = {
			trigger_event_non_silently = byzantine_succ_crisis.12
		}
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = {
				type = mercantilism_vs_free_trade
				value = societal_value_move_to_right
			}
		}
	}

	option = {	#Give privileges to both
		name = byzantine_succ_crisis.11.c 

		add_estate_satisfaction = { type = estate_type:burghers_estate 
			value = estate_satisfaction_radical_penalty
		}
		scope:target_location.market = {
			add_merchant_power = {
				country = c:VEN
				key = italian_merchants_favored_key
				months = 120
				power = merchant_power_severe_bonus
			}
		}
		scope:target_location.market = {
			add_merchant_power = {
				country = c:GEN
				key = italian_merchants_favored_key
				months = 120
				power = merchant_power_severe_bonus
			}
		}
		add_country_modifier = {
			modifier = byz_reliance_on_italian_navies
			mode = add_and_extend
			years = 10
			size = 2
		}
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = {
				type = mercantilism_vs_free_trade
				value = societal_value_large_move_to_right
			}
		}
		c:VEN = {
			trigger_event_non_silently = byzantine_succ_crisis.12
		}
		c:GEN = {
			trigger_event_non_silently = byzantine_succ_crisis.12
		}
	}

	option = {	#Deny Privileges
		name = byzantine_succ_crisis.11.d

		add_country_modifier = {
			modifier = byz_mercantile_self_reliance_modifier
			years = 10
			mode = add_and_extend
		}
		add_opinion_mutual_effect = {
			target = c:GEN
			modifier = opinion_denied_special_access
		}
		add_opinion_mutual_effect = {
			target = c:VEN
			modifier = opinion_denied_special_access
		}
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = {
				type = mercantilism_vs_free_trade
				value = societal_value_large_move_to_left
			}
		}
		hidden_effect = {
			c:VEN = {
				trigger_event_non_silently = byzantine_succ_crisis.13
			}
			c:GEN = {
				trigger_event_non_silently = byzantine_succ_crisis.13
			}
		}
	}
}

byzantine_succ_crisis.12 = { 
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.12.title
	desc = byzantine_succ_crisis.12.desc
	illustration_tags = {
		10 = regular
		10 = interior
	}

	immediate = { 
		event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate } 
		c:BYZ = {
			ruler_or_regent ?= {
				save_scope_as = target_character
			}
		}
	}
	option = {
		name = byzantine_succ_crisis.12.a

		show_as_tooltip = {
			scope:target_location.market = {
				add_merchant_power = {
					country = ROOT
					key = italian_merchants_favored_key
					months = 120
					power = merchant_power_severe_bonus
				}
			}
		}
		if = {
			limit = {
				current_age_or_later = { age = age_4_reformation }
			}
			change_societal_value = {
				type = mercantilism_vs_free_trade
				value = societal_value_minor_move_to_left
			}
		}
		change_societal_value = {
			type = aristocracy_vs_plutocracy
			value = societal_value_minor_move_to_right
		}
	}
}

byzantine_succ_crisis.13 = { 
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.13.title
	desc = byzantine_succ_crisis.13.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = { event_illustration_estate_effect = { foreground = estate_type:burghers_estate background = estate_type:burghers_estate } }
	option = {
		name = byzantine_succ_crisis.13.a

		show_as_tooltip = {
			add_opinion_mutual_effect = {
				target = c:BYZ
				modifier = opinion_denied_special_access
			}
		} 
		add_casus_belli = { 
			type = casus_belli:cb_trade_conflict 
			target = c:BYZ
		}
	}
}

byzantine_succ_crisis.14 = { #The Demands of the Ottomans - Ottomans
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.14.title
	desc = byzantine_succ_crisis.14.desc
	illustration_tags = {
		10 = regular
		10 = interior
	}
	trigger = {
		country_exists = c:BYZ
		in_civil_war = no
		NOT = { is_at_war_with = c:BYZ }
		NOT = { is_allied_with = { target = c:BYZ } }
		NOT = { has_truce_with = c:BYZ }
		c:BYZ = { is_subject = no }
		is_subject = no
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:BYZ = {
			if = {
				limit = { exists = var:succession_crisis_pretender_variable }
			}
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
			random_character = {
				limit = {
					has_variable = scope_pretender_var
				}
				save_scope_as = target_character
			}
			capital = { save_scope_as = target_location }
		}
		c:BYZ = { 
			ruler_or_regent ?= { save_scope_as = target_character2 }
			save_scope_as = target_country 
		}
		ruler_or_regent ?= { save_scope_as = target_character3 }
	}

	option = {	#Demand money
		name = byzantine_succ_crisis.14.a

		c:BYZ = {
			trigger_event_non_silently = byzantine_succ_crisis.15
		}
		custom_tooltip = sc_this_may_bring_us_into_conflict_tt
	}

	option = {	#Let sleeping dogs lie
		name = byzantine_succ_crisis.14.b 

		add_prestige = prestige_mild_penalty
		add_government_power = government_power_extreme_penalty
	}
}

byzantine_succ_crisis.15 = { 
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.15.title
	desc = byzantine_succ_crisis.15.desc
	illustration_tags = {
		10 = angry
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		if = {
			limit = { exists = var:succession_crisis_pretender_variable }
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
		}
		random_character = {
			limit = {
				has_variable = scope_pretender_var
			}
			save_scope_as = target_character
		}
	}

	option = {
		name = byzantine_succ_crisis.15.a

		show_as_tooltip = {
			add_truce_with = { target = c:TUR }
		}
		c:TUR = {
			set_variable = byz_paid_variable 
			trigger_event_non_silently = byzantine_succ_crisis.16
		}

		change_gold_effect = { scale = -12	}
		add_government_power = government_power_mild_penalty
	}

	option = {
		name = byzantine_succ_crisis.15.b 

		add_government_power = government_power_mild_bonus
		c:TUR = { trigger_event_non_silently = byzantine_succ_crisis.16 }
	}
}

byzantine_succ_crisis.16 = { 
	hide_portraits = yes
	type = country_event
	category = disaster_event
	title = byzantine_succ_crisis.16.title
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_variable = byz_paid_variable
				}
				desc = byzantine_succ_crisis.16.desc.a
			}
			triggered_desc = {
				desc = byzantine_succ_crisis.16.desc.b
			}
		}
	}
	illustration_tags = {
		10 = regular
		10 = interior
	}
	immediate = {
		event_illustration_estate_effect = { foreground = estate_type:nobles_estate background = estate_type:nobles_estate }
		c:BYZ = {
			if = {
				limit = { exists = var:succession_crisis_pretender_variable }
			}
			var:succession_crisis_pretender_variable ?= {
				save_scope_as = succession_crisis_pretender_scope
			}
			random_character = {
				limit = {
					has_variable = scope_pretender_var
				}
				save_scope_as = target_character
			}
		}
	}

	option = {
		name = byzantine_succ_crisis.16.a

		if = {
			limit = {
				has_variable = byz_paid_variable
			}
			add_gold = {
				value = c:BYZ.monthly_income_trade_and_tax
				multiply = 12
			}
			add_truce_with = { target = c:BYZ }
			remove_variable = byz_paid_variable
		}
		else = {
			add_casus_belli = {	
				target = c:BYZ	
				type = casus_belli:cb_insulted_us 
			}
			add_opinion = { 
				target = c:BYZ 
				modifier = opinion_insulted 
			} 
		}
	}
}