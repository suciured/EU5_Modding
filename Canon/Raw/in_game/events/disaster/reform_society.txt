namespace = reform_society

reform_society.1 = {
	type = country_event
	category = disaster_event
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	title = reform_society.1.title
	desc = reform_society.1.desc

	option = {
		name = reform_society.1.a
		
		add_stability = stability_extreme_penalty
	}
}

reform_society.2 = {
	type = country_event
	category = disaster_event

	title = reform_society.2.title
	desc = reform_society.2.desc
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	immediate = {
		set_variable = reformed_nahuatl_society_variable
	}

	option = {
		name = reform_society.2.a
		
		add_stability = stability_extreme_bonus
		remove_reform = government_reform:altepetl
		add_reform = government_reform:reformed_nahuatl_society

		custom_tooltip = annex_all_altepetls_tt
		hidden_effect = {
			every_subject = {
				limit = { 
					has_reform = government_reform:altepetl
				}
				overlord = {
					annex_country = { country = PREV }
				}
			}
		}
	}
}

reform_society.3 = { #Estates Unhappy with Centralization
	type = country_event
	category = disaster_event
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	title = reform_society.3.title
	desc = reform_society.3.desc

	immediate = {
		capital = { save_scope_as = target_location }
	}

	option = {
		name = reform_society.3.a
		
		change_societal_value = { type = centralization_vs_decentralization	value = societal_value_minor_move_to_left	}
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_mild_penalty }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_mild_penalty }

		add_stability = stability_weak_penalty
	}

	option = {
		name = reform_society.3.b 

		trigger = {
			OR = {
				num_possible_estate_privileges:nobles_estate > 0
				num_possible_estate_privileges:burghers_estate > 0
				num_possible_estate_privileges:clergy_estate > 0
			}
		}
		add_stability = stability_weak_bonus
		if = {
			limit = { 
				"estate_power(estate_type:clergy_estate)" >= 0.25
				num_possible_estate_privileges:clergy_estate > 0
			}
			
			"estate(estate_type:clergy_estate)" = {
				random_possible_privilege = {
					root = { grant_estate_privilege = prev }
				}
			}
		}
		if = {
			limit = { 
				"estate_power(estate_type:nobles_estate)" >= 0.25
				num_possible_estate_privileges:nobles_estate > 0
			}
			"estate(estate_type:nobles_estate)" = {
				random_possible_privilege = {
					root = { grant_estate_privilege = prev }
				}
			}			

		}
		if = {
			limit = { 
				"estate_power(estate_type:burghers_estate)" >= 0.25
				num_possible_estate_privileges:burghers_estate > 0
			}

			"estate(estate_type:burghers_estate)" = {
				random_possible_privilege = {
					root = { grant_estate_privilege = prev }
				}
			}

		}
		if = {
			limit = { 
				"estate_power(estate_type:peasants_estate)" >= 0.25
				num_possible_estate_privileges:peasants_estate > 0

			}

			"estate(estate_type:peasants_estate)" = {
				random_possible_privilege = {
					root = { grant_estate_privilege = prev }
				}
			}
		}
		change_societal_value = { type = centralization_vs_decentralization	value = societal_value_minor_move_to_left	}
	}

	option = {
		name = reform_society.3.a

		trigger = {
			ruler ?= { has_administrative_traits = yes }
		}
		
		change_societal_value = { type = centralization_vs_decentralization	value = societal_value_minor_move_to_left	}
		add_estate_satisfaction = { type = estate_type:nobles_estate value = estate_satisfaction_weak_penalty }
		add_estate_satisfaction = { type = estate_type:clergy_estate value = estate_satisfaction_weak_penalty }
		add_estate_satisfaction = { type = estate_type:burghers_estate value = estate_satisfaction_weak_penalty }
	}
}

reform_society.4 = { #Fire on the Night Sky #First Omen
	type = country_event
	category = disaster_event

	title = reform_society.4.title
	desc = reform_society.4.desc
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	trigger = {
		NOT = { has_variable = fire_on_the_night_sky_variable }
	}
	immediate = {
		capital = {
			save_scope_as = target_location
		}
		set_variable = fire_on_the_night_sky_variable
	}


	option = {
		name = reform_society.4.a
		
		add_doom = doom_weak_penalty
		change_societal_value = { type = centralization_vs_decentralization	value = societal_value_tiny_move_to_left }
	}

	option = {
		name = reform_society.4.b
		
		add_stability = stability_mild_penalty
		change_societal_value = { type = centralization_vs_decentralization	value = societal_value_tiny_move_to_left }
	}

	option = {
		name = reform_society.4.c 

		trigger = {
			capital = {
				any_pop = {
					pop_size > 0.25
					pop_type = pop_type:slaves
				}
			}
		}
		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					multiply = -0.25
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}

		change_societal_value = { type = centralization_vs_decentralization	value = societal_value_tiny_move_to_left }
	}
}

reform_society.5 = { #Destruction at the Capital
	type = country_event
	category = disaster_event

	title = reform_society.5.title
	desc = reform_society.5.desc
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	trigger = {
		NOT = { has_variable = destruction_of_the_capital_variable }
	}

	immediate = {
		capital = {
			save_scope_as = target_location 
		}
		set_variable = destruction_of_the_capital_variable
	}

	option = {
		name = reform_society.5.a
		
		capital = {
			change_prosperity = prosperity_ultimate_penalty
		}
		add_doom = doom_mild_penalty
	}

	option = {
		name = reform_society.5.b
		
		change_gold_effect = { scale = -2 }

		capital = {
			change_prosperity = prosperity_extreme_penalty
		}
		add_doom = doom_weak_penalty
	}

	option = {
		name = reform_society.5.c
		
		trigger = {
			capital = {
				any_pop = {
					pop_size > 0.25
					pop_type = pop_type:slaves
				}
			}
		}
		capital = {
			random_pop = {
				limit = {
					owner = root
					pop_type = pop_type:slaves
				}
				add_pop_size = {
					value = pop_size
					subtract = 0.25
				}
				add_pop_satisfaction = pop_satisfaction_mild_penalty
			}
		}

		capital = {
			change_prosperity = prosperity_extreme_penalty
		}
		add_doom = doom_weak_penalty
	}
}

reform_society.6 = { #Fire on the Daylit Sky
	type = country_event
	category = disaster_event
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	title = reform_society.6.title
	desc = reform_society.6.desc

	trigger = {
		NOT = { has_variable = fire_on_the_daylight_sky_variable }
	}

	immediate = {
		capital = {
			save_scope_as = target_location 
		}
		set_variable = fire_on_the_daylight_sky_variable
	}

	option = {
		name = reform_society.6.a
		
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_minor_move_to_left 
		}
		add_stability = stability_mild_penalty
		add_doom = doom_weak_penalty
	}

	option = {
		name = reform_society.6.b
		
		change_societal_value = { 
			type = traditionalist_vs_innovative 
			value = societal_value_minor_move_to_left 
		}
		add_estate_satisfaction = { type = estate_type:clergy_estate
			value = estate_satisfaction_mild_bonus
		}
		add_doom = doom_weak_penalty
	}

	option = {
		name = reform_society.6.c
		
		trigger = {
			ruler ?= {
				OR = {
					has_trait = free_thinker
					has_trait = pious
					has_trait = scholar
					adm >=80
				}
			}
		}
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_minor_move_to_left
		}
		add_doom = doom_weak_penalty
	}
}

reform_society.7 = { #Cries in the Darkness
	type = country_event
	category = disaster_event
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	title = reform_society.7.title
	desc = reform_society.7.desc

	trigger = {
		NOT = { has_variable = cries_in_the_darkness_variable }
	}

	immediate = {
		capital = {
			save_scope_as = target_location 
		}
		set_variable = cries_in_the_darkness_variable
	}

	option = {
		name = reform_society.7.a
		
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_minor_move_to_left
		}
		add_stability = stability_extreme_penalty
		add_doom = doom_mild_penalty
	}

	option = {
		name = reform_society.7.b
		
		add_doom = doom_weak_penalty
	}

	option = {
		name = reform_society.7.c
		
		trigger = {
			ruler ?= {
				OR = {
					adm >=80 
					has_trait = lawgiver
				}
			}
		}
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_move_to_left
		}
		add_doom = doom_weak_penalty	
	}
}

reform_society.8 = { #Reflection of the Stars
	type = country_event
	category = disaster_event
	image = "gfx/interface/illustrations/disaster/reform_society.dds"
	title = reform_society.8.title
	desc = reform_society.8.desc

	trigger = {
		NOT = { has_variable = reflection_of_the_stars_variable }
	}

	immediate = {
		capital = {
			save_scope_as = target_location 
		}
		set_variable = reflection_of_the_stars_variable
	}

	option = {
		name = reform_society.8.a
		
		add_government_power = government_power_extreme_penalty
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_move_to_left
		}
		if = {
			limit = {
				any_subject = {
					has_reform = government_reform:altepetl
				}
			}
			custom_tooltip = all_subjects_20_ld_tt
			hidden_effect = {
				every_subject = {
					limit = { 
						has_reform = government_reform:altepetl
					}
					add_liberty_desire = liberty_desire_severe_plus
				}
			}
		}
		if = {
			limit = {
				num_locations > 1
			}
			custom_tooltip = every_location_10_control_reduction_tt
			hidden_effect = {
				every_owned_location = {
					change_control = control_mild_penalty
				}
			}
		}
	}

	option = {
		name = reform_society.8.b
		
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_move_to_left
		}
		add_doom = doom_severe_penalty
	}

	option = {
		name = reform_society.8.c
		
		trigger = {
			ruler ?= {
				OR = {
					adm >=80 
					has_trait = lawgiver
				}
			}
		}
		change_societal_value = { 
			type = centralization_vs_decentralization 
			value = societal_value_large_move_to_left
		}
		add_stability = stability_mild_penalty	
	}
}