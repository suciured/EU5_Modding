
template PopulationCultureTooltipChart {
	icon_pie = {
		block "population_culture_tooltip_bg" {}
		blockoverride "PieSize" { size = { 120 120 } }
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetCultures]" }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopCultureItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopCultureItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopCultureItem.GetColor]" }
		blockoverride "Icon" {
           texture = "gfx/interface/icons/location_icons/culture.dds"
            texture_density = 2
            modify_texture = {
                using = overlay_stone_texture
                blend_mode = overlay
                alpha = 1
            }
            modify_texture = {
                using = overlay_window_texture
                blend_mode = overlay
                alpha = 1
            }
            glow = {
                name = "drop_shadow"
                glow_radius = 3
                color = {0.0 0.0 0.0 1.0}
                alpha = 0.3
            }
        }
		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetCultures]" }
		blockoverride "color" { color = "[PopCultureItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopCultureItem.GetName]"}
		blockoverride "rightside_info" {raw_text = "[PopCultureItem.GetPercentage|%2] ([PopCultureItem.GetAbsoluteSize])"}
	}
}

template PopulationReligionTooltipChart {
	icon_pie = {
		block "population_religion_tooltip_bg" {}
		blockoverride "PieSize" { size = { 120 120 } }
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetReligions]" }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopReligionItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopReligionItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopReligionItem.GetColor]" }
		blockoverride "Icon" {
            block "piechart_religion_icon" {
				texture = "gfx/interface/icons/location_icons/main_religion.dds"	
			}
            texture_density = 2
            modify_texture = {
                using = overlay_stone_texture
                blend_mode = overlay
                alpha = 1
            }
            modify_texture = {
                using = overlay_window_texture
                blend_mode = overlay
                alpha = 1
            }
            glow = {
                name = "drop_shadow"
                glow_radius = 3
                color = {0.0 0.0 0.0 1.0}
                alpha = 0.3
            }
        }
		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetReligions]" }
		blockoverride "color" { color = "[PopReligionItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopReligionItem.GetName]"}
		blockoverride "rightside_info" {raw_text = "[PopReligionItem.GetPercentage|%2] ([PopReligionItem.GetAbsoluteSize])"}
	}
}

template PopulationPopTypeTooltipChart {
	icon_pie = {
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetPopTypes]" }
		blockoverride "PieSize" { size = { 120 120 } }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopTypeItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopTypeItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopTypeItem.GetColor]" }
		blockoverride "Icon" {
			texture = "gfx/interface/icons/location_icons/social_class.dds"
				position = { 0 0 }
				size = { 65 65 }
		
				modify_texture = {
					using = overlay_stone_texture
					blend_mode = overlay
					alpha = 0.4
				}
		
				modify_texture = {
					using = overlay_window_texture
					blend_mode = overlay
					alpha = 0.4
				}
		
				glow = {
					name = "drop_shadow"
					glow_radius = 3
					color = {0.0 0.0 0.0 1.0}
					alpha = 0.3
				}
		}
		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetPopTypes]" }
		blockoverride "color" { color = "[PopTypeItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopTypeItem.GetName]"}
		blockoverride "rightside_info" {raw_text = "[PopTypeItem.GetPercentage|%2] ([PopTypeItem.GetAbsoluteSize])"}
	}
}

template Top5Bottom5Tooltip {
	tooltipmeta = {
		texture = "gfx/interface/icons/location_icons/population.dds"
		game_concept = "[population|e]"
	}
	TooltipScrolledStringPairList = {
		layoutpolicy_horizontal = expanding
		textcontext = "[PopsPiechartWidget.GetTop5Locations]"
	}
	TooltipScrolledStringPairList = {
		layoutpolicy_horizontal = expanding
		textcontext = "[PopsPiechartWidget.GetBottom5Locations]"
	}
}

template PopulationTooltipCharts {
	using = PopulationCultureTooltipChart
	using = PopulationReligionTooltipChart
	using = PopulationPopTypeTooltipChart
}

template CountryPopulationCultureTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size
				using = icon_population
			}
		}

		blockoverride "title_text" {
			datacontext = "[Country]"
			text = "COUNTRY_CULTURE_TOOLTIP_HEADER"
		}

		blockoverride "concept_link" {
			text = [culture|E]
		}

		blockoverride "tooltip_content" {
			using = PopulationCultureTooltipChart
		}
	}
}

template CountryPopulationReligionTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size
				using = icon_population
			}
		}

		blockoverride "title_text" {
			datacontext = "[Country]"
			text = "COUNTRY_RELIGION_TOOLTIP_HEADER"
		}

		blockoverride "concept_link" {
			text = [religion|E]
		}

		blockoverride "tooltip_content" {
			using = PopulationReligionTooltipChart
		}
	}
}

template PopulationTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size
				using = icon_population
			}
		}

		blockoverride "title_text" {
			datacontext = "[Country]"
			text = "POPULATION_TOOLTIP_HEADER"
		}

		blockoverride "concept_link" {
			text = [population|E]
		}

		blockoverride "tooltip_content" {
			hbox = {
				layoutpolicy_horizontal = expanding
				visible = "[Not(Country.HasEnoughHistoricalPopulation)]"
				spacing = 10

				vbox = {
					layoutpolicy_vertical = expanding
					spacing = 10
					using = PopulationTooltipCharts
				}

				vbox = {
					layoutpolicy_vertical = expanding
					spacing = 10
					using = Top5Bottom5Tooltip
				}

				expand = {}
			}

			hbox = {
				layoutpolicy_horizontal = expanding
				visible = "[Country.HasEnoughHistoricalPopulation]"
				spacing = 10
				ignoreinvisible = yes

				vbox = {
					using = layoutpolicy_expanding
					spacing = 10
					using = PopulationTooltipCharts
				}

				vbox = {
					using = layoutpolicy_expanding
					spacing = 10
					datacontext = "[Country]"

					using = HistoricalPopulationChart
					blockoverride "caesar_plotline_bg_header" {}
					blockoverride "caesar_plotline_bg_dates" {}

					vbox = {
						using = layoutpolicy_expanding
						spacing = 10
						using = Top5Bottom5Tooltip
					}
				}
			}
		}
	}
}

template HistoricalPopulationChart {
	caesar_plotline = {
		block "historical_population_chart_size" {
			size = { 500 150 }
		}
		
		blockoverride "header" {
			text = "HISTORICAL_POPULATION"
		}
		blockoverride "line_color" {
			color = { .9 .9 .9 1.0 }
		}
		blockoverride "line_plotpoints" {
			plotpoints = "[Country.GetHistoricalPopulation]"
		}
		blockoverride "maxvalue" {
			text = "[Country.GetHistoricalMaxPopulation|2]"
		}
		blockoverride "minvalue" {
			text = "[Country.GetHistoricalMinPopulation|2]"
		}
		blockoverride "startdate" {
			text = "[Country.GetStartDataDate]"
		}
		blockoverride "enddate" {
			text = "[Country.GetEndDataDate]"
		}
		blockoverride "multiitem" {}
		blockoverride "extra_plotlines" {}
		blockoverride "empty_state_visibility" {}
		blockoverride "empty_state_text" {}
	}
}

template LocationPopulationTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon_texture" {
			texture = "gfx/interface/icons/location_icons/social_class.dds"
		}

		blockoverride "title_text" {
			text = "LOCATION_POPULATION_TOOLTIP_HEADER"			
		}

		blockoverride "concept_link" {
			text = [pop_type|E]
		}

		blockoverride "tooltip_content" {
			using = LocationPopulationPopTypeTooltipChart
		}
	}
}

template CountryPopulationTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon_texture" {
			texture = "gfx/interface/icons/location_icons/social_class.dds"
		}

		blockoverride "title_text" {
			text = "COUNTRY_POP_TYPES_TOOLTIP_HEADER"			
		}

		blockoverride "concept_link" {
			text = [pop_type|E]
		}

		blockoverride "tooltip_content" {
			using = PopulationPopTypeTooltipChart
		}
	}
}

template LocationPopulationPopTypeTooltipChart {
	icon_pie = {
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetPopTypes]" }
		blockoverride "PieSize" { size = { 120 120 } }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopTypeItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopTypeItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopTypeItem.GetColor]" }
		blockoverride "Icon" {
			texture = "gfx/interface/icons/location_icons/social_class.dds"
			position = { 0 0 }
		}
		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetPopTypes]" }
		blockoverride "color" { color = "[PopTypeItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopTypeItem.GetName]"}
		blockoverride "middle_info" {text = "[PopTypeItem.GetAbsoluteSize]"}
		blockoverride "rightside_info" {text = "[PopTypeItem.GetPercentage|%2]"}
	}
}

template CountryEstatesPowerTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size
				texture = "gfx/interface/icons/flat_icons/estates/estates.dds"
				texture_density = 2
				icon = {
					size = {70% 70%}
					parentanchor = center
					texture = "gfx/interface/icons/foreign_country/power.dds"
	
					glow = {
						name = "drop_shadow"
						glow_radius = 2
						color = {0.0 0.0 0.0 1.0}
					}
				}
			}
		}
		blockoverride "title_button" {
            hint_button = {
                action_tooltip = {
                    title = "OPEN_HINT"
                    on_action = "[OpenLateralViewWithParams('hints', 'selected_hint = hint_estates')]"
                }
            }
        }

		blockoverride "title_text" {
			text = "COUNTRY_ESTATE_POWER_TOOLTIP_HEADER"			
		}

		blockoverride "concept_link" {
			text = [estate_power|E]
		}

		blockoverride "tooltip_content" {
			using = CountryEstatesPowerTooltipChart
		}
	}
}

template CountryEstatesPowerTooltipChart {
	icon_pie = {
		blockoverride "pie_datamodel" {	
			block "estates_pie_datamodel" {
				datamodel = "[InGameTopbar.GetEstates]" 
			}
		}
		blockoverride "PieSize" { size = { 140 140 } }

		###Slices and Icon
		blockoverride "SliceTooltip" {
			datacontext = "[EstatesItem.GetEstate]"
			tooltipwidget = {
				using = Estate_tooltip
			}
		}
		blockoverride "SliceValue" { value = "[EstatesItem.GetEstate.GetRelativePower]" }
		blockoverride "SliceColor" { color = "[EstatesItem.GetEstate.GetType.GetMapColor]" }
		blockoverride "Icon" {
			position = { 0 0 }
			texture = "gfx/interface/icons/flat_icons/estates/estates.dds"
			texture_density = 2
			icon = {
				size = {70% 70%}
				parentanchor = center
				texture = "gfx/interface/icons/foreign_country/power.dds"

				glow = {
					name = "drop_shadow"
					glow_radius = 2
					color = {0.0 0.0 0.0 1.0}
				}
			}
		}
		blockoverride "datamodel" {	
			block "estates_datamodel" {
				datamodel = "[InGameTopbar.GetEstates]" 
			}
		 }
		blockoverride "color" { color = "[EstatesItem.GetEstate.GetType.GetMapColor]" }
		blockoverride "leftside_info" {text = "[EstatesItem.GetEstate.GetName]"}

		blockoverride "rightside_info" {
			raw_text = "[EstatesItem.GetEstate.GetRelativePower|%2] @power!"
			alwaystransparent = no
			datacontext = "[EstatesItem.GetEstate]"
			tooltipwidget = {
				using = estate_relative_power_tooltip
			}
		}
	}
}

template LocationPoliticsTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size
				texture = "gfx/interface/icons/location_icons/government.dds"
			}
		}

		blockoverride "title_text" {
			text = "LOCATION_POLITICS_TOOLTIP_HEADER"			
		}

		blockoverride "concept_link" {
			text = [estate_power|E]
		}

		blockoverride "tooltip_content" {
			using = LocationPoliticsTooltipChart
		}
	}
}

template LocationPoliticsTooltipChart {
	icon_pie = {
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetPolitics]" }
		blockoverride "PieSize" { size = { 120 120 } }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopPoliticsItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopPoliticsItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopPoliticsItem.GetColor]" }
		blockoverride "Icon" {
			texture = "gfx/interface/icons/location_icons/government.dds"
			position = { 0 0 }
		}
		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetPolitics]" }
		blockoverride "color" { color = "[PopPoliticsItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopPoliticsItem.GetName]"}
		blockoverride "middle_info" {
			text = "[PopPoliticsItem.GetPopulation]"
			tooltip = "[population|e]"
			tagtooltip_enabled = yes
		}
		blockoverride "rightside_info" {
			text = "[PopPoliticsItem.GetPercentage|%2]"
			alwaystransparent = no
			tooltipwidget = {
				ContextualTooltipType = {
					blockoverride "title_icon" {
						icon = {
							using = tooltip_title_icon_size
							texture = "gfx/interface/icons/location_icons/government.dds"
						}
					}
			
					blockoverride "title_text" {
						text = "LOCATION_POLITICS_TOOLTIP_INDIVIDUAL"			
					}
			
					blockoverride "concept_link" {
						text = "[estate_power|E]"
					}
			
					blockoverride "tooltip_content" {
						TooltipTextBlock = {
							blockoverride "text" {
								text = "[PopPoliticsItem.GetTooltip]"
							}
						}
					}
				}
			}
		}
	}
}


template LocationPopulationReligionTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size				
				texture = "[GetReligionIcon(Location.GetDominantReligion.Self)]"
			}
		}
		
		blockoverride "title_text" {
			text = "LOCATION_RELIGION_TOOLTIP_HEADER"
		}

		blockoverride "concept_link" {
			text = [religion|E]
		}


		blockoverride "tooltip_content" {
			using = LocationPopulationReligionTooltipChart
		}
	}
}

template LocationPopulationReligionTooltipChart {
	icon_pie = {
		blockoverride "PieSize" { size = { 120 120 } }
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetReligions]" }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopReligionItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopReligionItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopReligionItem.GetColor]" }
		blockoverride "Icon" {
            texture = "gfx/interface/icons/location_icons/main_religion.dds"
        }
		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetReligions]" }
		blockoverride "color" { color = "[PopReligionItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopReligionItem.GetName]"}
		blockoverride "middle_info" {text = "[PopReligionItem.GetAbsoluteSize]"}
		blockoverride "rightside_info" {text = "[PopReligionItem.GetPercentage|%2]"}
	}
}


template LocationPopulationCultureTooltip {
	ContextualTooltipType = {
		blockoverride "title_icon" {
			icon = {
				using = tooltip_title_icon_size
				texture = "gfx/interface/icons/location_icons/culture.dds"
			}
		}

		blockoverride "title_text" {
			text = "LOCATION_CULTURE_TOOLTIP_HEADER"
		}

		blockoverride "concept_link" {
			text = [culture|E]
		}

		blockoverride "tooltip_content" {
			using = LocationPopulationCultureTooltipChart
		}
	}
}

template LocationPopulationCultureTooltipChart {
	icon_pie = {
		blockoverride "PieSize" { size = { 120 120 } }
		blockoverride "pie_datamodel" {	datamodel = "[PopsPiechartWidget.GetCultures]" }

		###Slices and Icon
		blockoverride "SliceTooltip" { tooltip = "[PopCultureItem.GetName]" }
		blockoverride "SliceValue" { value = "[PopCultureItem.GetPercentage]" }
		blockoverride "SliceColor" { color = "[PopCultureItem.GetColor]" }
		blockoverride "Icon" {
            texture = "gfx/interface/icons/location_icons/culture.dds"
            texture_density = 100
            # using = color_gold
            modify_texture = {
                using = overlay_stone_texture
                blend_mode = overlay
                alpha = 1
            }
            modify_texture = {
                using = overlay_window_texture
                blend_mode = overlay
                alpha = 1
            }
            glow = {
                name = "drop_shadow"
                glow_radius = 3
                color = {0.0 0.0 0.0 1.0}
                alpha = 0.3
            }
        }

		blockoverride "datamodel" {	datamodel = "[PopsPiechartWidget.GetCultures]" }
		blockoverride "color" { color = "[PopCultureItem.GetColor]" }
		blockoverride "leftside_info" {text = "[PopCultureItem.GetName]"}
		blockoverride "middle_info" {text = "[PopCultureItem.GetAbsoluteSize]"}
		blockoverride "rightside_info" {text = "[PopCultureItem.GetPercentage|%2]"}
	}
}
