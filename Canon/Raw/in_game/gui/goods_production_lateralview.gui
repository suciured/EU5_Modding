lateralview = {
	name = "goods_production_lateralview"
	widgetid = "goods_production_lateralview"

	blockoverride "panel_content" {
		window_header_alt = {
			blockoverride "header_text" {
				text = "THE_PRODUCTION_OVERVIEW_TITLE"
			}
			blockoverride "window_header_alt_color_texture"{
				using = color_production_texture
			}
		}

		header_main_tabs = { #TABS
			blockoverride "content" {
				using = production_main_tabs
			}
		}

		widget = {
			using = layoutpolicy_expanding

			vbox = {
				using = bg_main_inner_alt
				using = bg_main_inner_image_alt
				blockoverride "image" {
					texture = "gfx/interface/illustrations/bg/bg_production.dds"
				}
				using = window_main_tabs_margin_alt

				filtered_sorted_list = {
					margin_top = 10
					datacontext = "[GoodsProductionLateralView.GetRawGoodsSortSearch]"
					name = "raw_goods_filtered_list"

					blockoverride "subheader_upper_divider"{
						# MARKET FILTERED
						widget = {
							visible = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
							layoutpolicy_horizontal = expanding
							size = { -1 70 }

							hbox = {
								datacontext = "[GoodsProductionLateralView.GetSelectedMarket]"

								using = bg_market_card
								using = bg_cabinet_card_frame

								market_card = {
									blockoverride "market_card_margins" {
										margin = {5 5}
										margin_right = 0
									}
								}

								market_card_right_buttons = {
									blockoverride "market_filter_buttons" {
										vbox = {
											layoutpolicy_vertical = expanding
											spacing = 3
											
											filter_button_alt = {
												size = { 23 23 }
												blockoverride "filter_button_action" {
													action_tooltip = {
														click_type = left
														click_mode = single
														title = "TOGGLE_MARKET_SELECTION"
														on_action = "[GoodsProductionLateralView.ToggleGoodsProductionSelectMarket(PdxGuiWidget.FindParent('raw_goods_filtered_list').Self)]"
													}

													action_tooltip = {
														click_type = right
														click_mode = single
														title = "SCROLL_CAPITAL_MARKET_FILTER"
														on_action = "[SelectDefaultFocusMarket]"
													}
												}
												tooltipwidget = { BasicFunctionalTooltip = {} }
															
												blockoverride "glow_visible" {
													visible = "[GoodsProductionLateralView.IsGoodsProductionSelectMarketOpened(PdxGuiWidget.FindParent('raw_goods_filtered_list').Self)]"
												}
											}
			
											button = {
												using = market_filter_button
												enabled = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
												blockoverride "functional_tooltip" {
													tooltipwidget = { BasicFunctionalTooltip = {} }
												
													action_tooltip = {
														click_type = left
														click_mode = single
														enabled = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
														title = "REMOVE_MARKET_FILTER"
														on_action = "[GoodsProductionLateralView.RemoveMarketFilter]"
													}
												}
											}
										}
									}
								}
							}
						}

						# MARKET NOT FILTERED
						widget = {
							visible = "[Not(GoodsProductionLateralView.IsMarketFilterEnabled)]"
							layoutpolicy_horizontal = expanding
							size = { -1 50 }
							
							button_regular = {
								layoutpolicy_horizontal = expanding
								size = { 100% 50 }

								action_tooltip = {
									click_type = left
									click_mode = single
									title = "TOGGLE_MARKET_SELECTION"
									on_action = "[GoodsProductionLateralView.ToggleGoodsProductionSelectMarket(PdxGuiWidget.FindParent('raw_goods_filtered_list').Self)]"
								}
								action_tooltip = {
									click_type = right
									click_mode = single
									title = "SCROLL_CAPITAL_MARKET_FILTER"
									on_action = "[SelectDefaultFocusMarket]"
								}

								tooltipwidget = { BasicFunctionalTooltip = {} }

								hbox = {
									layoutpolicy_horizontal = expanding
									layoutpolicy_vertical = expanding
									spacing = 5

									margin_left = 8
									margin_right = 5

									text_single = {
										align = center|nobaseline
										layoutpolicy_horizontal = expanding
										autoresize = no
										fontsize_min = 12
										text = "NOT_FILTERED_BY_MARKET"
									}
								}

								filter_button_alt = {
									size = { 25 25 }
									parentanchor = right|vcenter
									position = {-10 0}
									blockoverride "filter_button_action" {
										action_tooltip = {
											click_type = left
											click_mode = single
											title = "TOGGLE_MARKET_SELECTION"
											on_action = "[GoodsProductionLateralView.ToggleGoodsProductionSelectMarket(PdxGuiWidget.FindParent('raw_goods_filtered_list').Self)]"
										}

										action_tooltip = {
											click_type = right
											click_mode = single
											title = "SCROLL_CAPITAL_MARKET_FILTER"
											on_action = "[SelectDefaultFocusMarket]"
										}
									}
									tooltipwidget = { BasicFunctionalTooltip = {} }
									
									blockoverride "glow_visible" {
										visible = "[GoodsProductionLateralView.IsGoodsProductionSelectMarketOpened(PdxGuiWidget.FindParent('raw_goods_filtered_list').Self)]"
									}
								}
							}
						}
					}

					blockoverride "searchbar_extra_pre_content"{
						widget = {
							layoutpolicy_horizontal = expanding
							size = {-1 37 }

							hbox = {
								margin = { 5 0 }
								margin_bottom = 6
								
								button_regular = {
									using = layoutpolicy_expanding
									tooltipwidget = { BasicFunctionalTooltip = {} }
									action_tooltip = {
										click_type = left
										click_mode = single
										title = "OPEN_RGO_BUILDER"
										on_action = "[ShowExpandRawGoodLocationsViewWithMarketAndFilter(GoodsProductionLateralView.GetSelectedMarket.Self, ' ', '(bool)no')]"
									}
									
									text = "OPEN_RGO_BUILDER"

									icon = {
										size = {23 23}
										parentanchor = left|vcenter
										position = {10 0}
										texture = "gfx/interface/icons/map_modes/raw_material.dds"
										texture_density = 2
										glow = {
											name = "drop_shadow"
											glow_radius = 3
											color = {0.0 0.0 0.0 1.0}
											alpha = 0.3
										}
									}
								}
							}
						}
					}

					blockoverride "scroll_list_is_empty" {
						visible = "[IsDataModelEmpty(GoodsProductionLateralView.GetRawGoodsItems)]"
					}

					blockoverride "scroll_list_is_empty_text" {
						text = "EXPAND_RAW_GOODS_SCROLL_LIST_EMPTY"
					}

					blockoverride "sort_buttons_filtered_list" {
						sort_by_key_button = {
							name = "name"
							using = layoutpolicy_expanding
						}

						sort_by_key_button = {
							visible = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
							name = "goods_balance"
							layoutpolicy_vertical = expanding
							size = { 100 -1 }
						}

						sort_by_key_button = {
							visible = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
							name = "price"
							layoutpolicy_vertical = expanding
							size = { 170 -1 }
						}

						sort_by_key_button = {
							name = "building_profit"
							layoutpolicy_vertical = expanding
							size = { 95 -1 }
						}

						sort_by_key_button = {
							name = "rgo_profit"
							layoutpolicy_vertical = expanding
							size = { 115 -1 }
						}
					}

					blockoverride "scroll_list_layout" {
						fixedgridbox = {
							addcolumn = 100%
							addrow = 40
							datamodel = "[GoodsProductionLateralView.GetRawGoodsItems]"
							item = {
								widget = {
									size = { 100% 40 }
									widget = {
										parentanchor = center
										size = { 98% 35 }
										using = bg_paper_card
										blockoverride "card_color" {
											modify_texture = {
												using = color_paper_texture
											}
											modify_texture = {
												using = overlay_paper_03
												blend_mode = overlay
											}
										}
										

										hbox = {
											margin = { 5 0 }
											spacing = 3
											# GOOD BUTTON
											card_header_button_04 = {
												size = { 35 35 }

												tooltip_enabled = no
												background = {
													texture = "gfx/interface/component_tiles/balance_card_bg.dds"
													modify_texture = {
														using = color_production_texture
														alpha = 0.5
													}
												}
												
												button = {
													size = { 22 22 }
													parentanchor = center
													visible = "[Not(GoodsProductionLateralView.IsMarketFilterEnabled)]"
													texture = "[GetGoodsIcon(GoodItem.GetGoods)]"
													onclick = "[ShowGoods(GoodItem.GetGoods)]"
													datacontext = "[GoodItem.GetGoods]"
													tooltipwidget = { using = Goods_tooltip	}

													icon = {
														size = { 10 10 }
														visible = "[GoodItem.GetGoods.IsFood]"
														parentanchor = bottom|right
														texture = "gfx/interface/icons/location_icons/food.dds"
													}

													sort_by_small_highlight = {
														name = "name"
													}
												}

												button  = {
													size = { 22 22 }
													parentanchor = center
													visible = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
													texture = "[GetGoodsIcon(GoodItem.GetGoods)]"
													datacontext = "[GoodsProductionLateralView.GetSelectedMarket]"
													datacontext = "[GoodItem.GetGoods]"
													datacontext = "[Market.GetMarketEntry(GoodItem.GetGoods)]"
													onmousehierarchyenter = "[PdxGuiWidget.SetHighlightGoods(GoodItem.GetGoods)]"
													tooltipwidget = {
														using = SpecificGoodsMarket_tooltip
													}
												
													action_tooltip = {
														click_type = left
														click_mode = single
														title = "OPEN_GOOD_PANEL"
														on_action = "[ShowGoods(GoodsMarketEntry.GetGoods)]"
													}
												
													sort_by_small_highlight = {
														name = "name"
													}

													icon = {
														size = { 10 10 }
														visible = "[GoodItem.GetGoods.IsFood]"
														parentanchor = bottom|right
														texture = "gfx/interface/icons/location_icons/food.dds"
													}
												}
											}
						
											widget = {
												size = {15 22}
												visible = "[GoodsProductionLateralView.IsMarketFilterEnabled]"
												datacontext = "[GoodsProductionLateralView.GetSelectedMarket]"
												datacontext = "[GoodItem.GetGoods]"
												datacontext = "[Market.GetMarketEntry(GoodItem.GetGoods)]"
						
												progressbar = {
													parentanchor = center
													size = { 5 22 }
													using = progress_bar_green_alt
													min = 0
													max = "[FixedPointToFloat(Market.GetCenterLocation.GetModifierValueFixed('maximum_stockpile_capacity'))]"
													value = "[FixedPointToFloat(GoodsMarketEntry.GetStockpile)]"
													direction = vertical
												}
												
												tooltipwidget = {
													using = GoodsMarketEntry_template
												}
						
												# sort_by_small_highlight = {
												# 	name = "stockpile"
												# }
											}
											
											widget = {
												using = layoutpolicy_expanding

												hbox = {
													margin_right = 6
													margin_left = 4
													visible = "[GoodsProductionLateralView.IsMarketFilterEnabled]"

													# SUPPLY VS DEMAND
													widget = {
														size = { 60 20 }
														datacontext = "[GoodsProductionLateralView.GetSelectedMarket]"
														datacontext = "[Market.GetMarketEntry(GoodItem.GetGoods)]"
														tooltipwidget = {
															using = goods_market_balance_tooltip
														}
														hbox = {
															expand = {}
															hbox = {
																spacing = 3
																text_single = {
																	maximumsize = { 40 20 }
																	align = center|nobaseline
																	using = Font_Size_Small
																	text = "[Subtract_CFixedPoint(GoodsProductionLateralView.GetSelectedMarket.GetSupply(GoodItem.GetGoods), GoodsProductionLateralView.GetSelectedMarket.GetDemand(GoodItem.GetGoods))|+=2]"
																}
								
																icon = {
																	size = { 17 17 }
																	texture = "gfx/interface/icons/flat_icons/trade_market/goods_balance.dds"
																	glow = {
																		name = "drop_shadow"
																		glow_radius = 3
																		color = {0.0 0.0 0.0 1.0}
																		alpha = 0.5
																	}
																}
															}
														}
														sort_by_small_highlight = {
															name = "goods_balance"
														}
													}
													
													# expand = {}

													# PRICE
													widget = {
														size = { 60 20 }
														datacontext = "[GoodsProductionLateralView.GetSelectedMarket]"
														datacontext = "[Market.GetMarketEntry(GoodItem.GetGoods)]"
														tooltipwidget = {
															using = goods_market_price_tooltip
														}
														hbox = {
															expand = {}
															hbox = {
																using = bg_number_container_bckg
																blockoverride "number_container_extra" {
																	alpha = 0.4
																	margin = {4 4}
																}
																spacing = 3
																text_single = {
																	maximumsize = { 40 20 }
																	align = center|nobaseline
																	using = Font_Size_Small
																	text = "[GoodsMarketEntry.GetPrice|2]"
																}
									
																text_single = {
																	maximumsize = { 20 20 }
																	align = center|nobaseline
																	using = Font_Size_Small
																	raw_text = "@[GoodItem.GetGoods.GetPriceDifferenceIconName(GoodsMarketEntry.GetPrice)]!"
																}
															}
														}

														sort_by_small_highlight = {
															name = "price"
														}
													}
												}

												hbox = {
													margin_right = 6
													margin_left = 4
													visible = "[Not(GoodsProductionLateralView.IsMarketFilterEnabled)]"
													layoutpolicy_vertical = expanding

													text_single = {
														maximumsize = { 80 -1 }
														# size = { 40 -1 }
														align = left|nobaseline
														using = Font_Size_Small
														text = "[GoodItem.GetGoods.GetName]"
														sort_by_small_highlight = {
														name = "name"
														}
													}

													expand = {}

													# POP NEEDS
													widget = {
														layoutpolicy_vertical = expanding
														size = { 50 -1 }
														tooltipwidget = {
															ContextualTooltipType = {
																blockoverride "title_text" {
																	text = "POPS_NEEDS"
																}
														
																blockoverride "title_icon" {
																	icon = {
																		size = { 32 32 }
																		texture = "gfx/interface/icons/alerts_icons/pops_wanting_stuff.dds"
																	}
																}
														
																blockoverride "concept_link" {
																	text = "[pop_needs|E]"
																}
														
																blockoverride "tooltip_content" {
																	TooltipTextBlock = {
																		blockoverride "text" {
																			text = "[GoodItem.GetPopsMissingGoods]"
																		}
																	}
																}
															}
														}
														icon = {
															shaderfile = "gfx/FX/pdxgui_default.shader"
															parentanchor = center
															size = {15 15}
															texture = "gfx/interface/icons/alerts_icons/pops_wanting_stuff.dds"
							
															using = bg_banner_button_vertical
															blockoverride "banner_button_shadow_margin" {
																margin = {1 11}
																margin_bottom = 12
																margin_right = 5
															}
															blockoverride "banner_button_margin" {
																margin = {3 11}
																margin_bottom = 8
															}
							
															blockoverride "banner_button_extra" {
																visible = "[Or( GoodItem.ArePopsMissingGoods, GoodItem.AreRebelPopsMissingGoods )]"
															}
															
															blockoverride "banner_button_color" {
																modify_texture = {
																	visible = "[And(GoodItem.ArePopsMissingGoods, Not(GoodItem.AreRebelPopsMissingGoods))]"
																	using = color_yellow_texture
																	alpha = 0.6
																}
																modify_texture = {
																	visible = "[GoodItem.AreRebelPopsMissingGoods]"
																	using = color_dark_red_texture
																}
															}
														}
													}

													# BUILDING & GOV NEEDS
													widget = {
														layoutpolicy_vertical = expanding
														size = { 50 -1 }
														tooltipwidget = {
															ContextualTooltipType = {
																blockoverride "title_text" {
																	text = "BUILDINGS_NEEDS"
																}
														
																blockoverride "title_icon" {
																	icon = {
																		size = { 32 32 }
																		texture = "gfx/interface/icons/flat_icons/parliament_needs.dds"
																	}
																}
														
																blockoverride "concept_link" {
																	text = "[maintenance|E]"
																}
														
																blockoverride "tooltip_content" {
																	TooltipTextBlock = {
																		blockoverride "text" {
																			text = "[GoodItem.GetBuildingsMissingGoods]"
																		}
																	}
																}
															}
														}
														icon = {
															size = {15 15}
															parentanchor = center
															texture = "gfx/interface/icons/flat_icons/parliament_needs.dds"
															
															using = bg_banner_button_vertical
															blockoverride "banner_button_shadow_margin" {
																margin = {1 11}
																margin_bottom = 12
																margin_right = 5
															}
															blockoverride "banner_button_margin" {
																margin = {3 11}
																margin_bottom = 8
															}
							
															blockoverride "banner_button_extra" {
																visible = "[Or(GoodItem.IsBuildingMissingGood, GoodItem.IsGovernmentMissingGood)]"
															}
															
															blockoverride "banner_button_color" {
																modify_texture = {
																	visible = "[And(GoodItem.IsBuildingMissingGood, Not(GoodItem.IsGovernmentMissingGood))]"
																	using = color_yellow_texture
																	alpha = 0.6
																}
																modify_texture = {
																	visible = "[GoodItem.IsGovernmentMissingGood]"
																	using = color_dark_red_texture
																}
															}
														}
													}
												}
											}

											expand = {}

											hbox = {
												spacing = 5
		
												hbox = {
													spacing = 3

													# IMPORT
													button = {
														size = { 28 28 }
														enabled = "[And( GoodsProductionLateralView.IsMarketFilterEnabled, GoodItem.CanImportFromSelectedMarket )]"
														tooltip_enabled = no

														texture = "gfx/interface/buttons/round_button_texture_alt.dds"
														texture_density = 2
								
														modify_texture = {
															using = color_new_gold_texture
															blend_mode = overlay
															alpha = 1
														}
													
														modify_texture = {
															using = overlay_stone_texture
															blend_mode = overlay
															alpha = 1
														}
										
														block "navigational_bg" {
															background = {
																texture = "gfx/interface/buttons/bg_button_light.dds"
																texture_density = 2
																modify_texture = {
																	using = color_intense_brown_texture
																	blend_mode = add
																}
																modify_texture = {
																	using = color_super_dark_brown_texture
																	blend_mode = multiply
																	alpha = 0.6
																}
															}
														}
														
														ui_direction_color_button = {
															size = { 65% 65% }
															parentanchor = center
															enabled = "[And(GoodsProductionLateralView.IsMarketFilterEnabled, GoodItem.CanImportFromSelectedMarket )]"

															tooltipwidget = {
																BasicFunctionalTooltip = {}
															}

															action_tooltip = {
																click_type = left
																click_mode = single
																enabled = "[And( GoodsProductionLateralView.IsMarketFilterEnabled, GoodItem.CanImportFromSelectedMarket )]"
																conditions = "[MakeItFailIf(Not(And(GoodsProductionLateralView.IsMarketFilterEnabled, GoodItem.CanImportFromSelectedMarket )), GoodsProductionLateralView.GetSelectedMarket.GetImportInfo(Player.Self,GoodItem.GetGoods))]"
																title = "[SelectLocalization(And(GoodsProductionLateralView.IsMarketFilterEnabled, GoodItem.CanImportFromSelectedMarket ), 'IMPORT_BUTTON_ACTION_TT', 'CANNOT_EXPORT_BUTTON_ACTION_TT')]"
																on_action = "[SetupImportWithNeedsRight(GoodsProductionLateralView.GetSelectedMarket.Self,GoodItem.GetGoods,'(CFixedPoint)0')]"
															}

															blockoverride "button_texture"  {
																texture = "gfx/interface/icons/flat_icons/trade_market/import.dds"
															}
														}
													}

													# EXPORT
													button = {
														size = { 28 28 }
														enabled = "[GoodItem.CanExportToSelectedMarket]"
														tooltip_enabled = no
														
														texture = "gfx/interface/buttons/round_button_texture_alt.dds"
														texture_density = 2
								
														modify_texture = {
															using = color_new_gold_texture
															blend_mode = overlay
															alpha = 1
														}
													
														modify_texture = {
															using = overlay_stone_texture
															blend_mode = overlay
															alpha = 1
														}
										
														block "navigational_bg" {
															background = {
																texture = "gfx/interface/buttons/bg_button_light.dds"
																texture_density = 2
																modify_texture = {
																	using = color_intense_brown_texture
																	blend_mode = add
																}
																modify_texture = {
																	using = color_super_dark_brown_texture
																	blend_mode = multiply
																	alpha = 0.6
																}
															}
														}
														
														ui_direction_color_button = {
															size = { 65% 65% }
															parentanchor = center
															enabled = "[GoodItem.CanExportToSelectedMarket]"

															tooltipwidget = {
																BasicFunctionalTooltip = {}
															}
															action_tooltip = {
																click_type = left
																click_mode = single
																enabled = "[GoodItem.CanExportToSelectedMarket]"
																conditions = "[MakeItFailIf(Not(GoodItem.CanExportToSelectedMarket), GoodsProductionLateralView.GetSelectedMarket.GetExportInfo(Player.Self,GoodItem.GetGoods))]"
																title = "[SelectLocalization(GoodItem.CanExportToSelectedMarket, 'EXPORT_BUTTON_ACTION_TT', 'CANNOT_EXPORT_BUTTON_ACTION_TT')]"																
																on_action = "[SetupExportWithNeedsRight(GoodsProductionLateralView.GetSelectedMarket.Self,GoodItem.GetGoods,'(CFixedPoint)0')]"
															}

															blockoverride "button_texture"  {
																texture = "gfx/interface/icons/flat_icons/trade_market/export.dds"
															}
														}
													}
												}

												
												# BUILDING GENERATING GOODS
												button_regular = {
													size = { 90 28 }
													enabled = "[GoodItem.CanBuildBuildings]"
													# onclick = "[OpenLateralViewWithFilter('production', GoodItem.GetGoods.GetKey)]"
													tooltipwidget = {
														ContextualTooltipType = {
															blockoverride "title_text" {
																text = "GOODS_EXPAND_BUILDING_TT_HEADER"
															}
													
															blockoverride "title_icon" {
																icon = {
																	using = tooltip_title_icon_size
																	texture = "[GetConceptTexture('building')]"
																}
															}
													
															blockoverride "concept_link" {
																text = "[building|e]"
															}
													
															blockoverride "tooltip_content" {
																TooltipTextBlock = {
																	visible = "[GoodItem.CanBuildBuildings]"
																	blockoverride "text" {
																		text = "GOODS_EXPAND_BUILDING_TT_TEXT"
																	}
																}
																TooltipTextBlock = {
																	visible = "[Not(GoodItem.CanBuildBuildings)]"
																	blockoverride "text" {
																		text = "NO_GOODS_BUILDINGS"
																	}
																}
															}
														}
													}
													action_tooltip = {
														click_type = left
														click_mode = single
														enabled = "[GoodItem.CanBuildBuildings]"
														conditions = "[MakeItFailIfLoc(Not(GoodItem.CanBuildBuildings), 'GOODS_EXPAND_BUILDING_REQUIREMENTS_NOT_MET')]"
														title = "GOODS_EXPAND_BUILDING_TT"
														on_action = "[OpenLateralViewWithFilter('production', GoodItem.GetGoods.GetKey)]"
														on_action = "[OpenLateralViewWithParams('production', 'display = lists')]"
													}
													hbox = {
														margin = {10 0}
														icon = {
															size = {15 15}
															texture = "[GetConceptTexture('building')]"
														}

														expand = {}

														text_single = {
															visible = "[GoodItem.CanBuildBuildings]"
															maximumsize = {55 -1}
															align = nobaseline
															fontsize = 14
															raw_text = "[GoodItem.GetMaxBuildingProfit|+2]@tax_base!"
														}

														text_single = {
															layoutpolicy_horizontal = expanding
															visible = "[Not(GoodItem.CanBuildBuildings)]"
															maximumsize = {55 -1}
															align = center|nobaseline
															fontsize = 14
															raw_text = "-"
														}
													}

													sort_by_small_highlight = {
														name = "building_profit"
													}
												}

												# RAW GOODS BUILDER
												button_regular = {
													size = { 90 28 }
													visible = "[GoodItem.GetGoods.IsRawMaterial]"
													enabled = "[GoodItem.CanExpandRGO]"
													onmousehierarchyenter = "[PdxGuiWidget.SetHighlightOwnGoods(GoodItem.GetGoods)]"

													tooltipwidget = {
														ContextualTooltipType = {
															blockoverride "title_text" {
																text = "GOODS_EXPAND_RGO_TT_HEADER"
															}
													
															blockoverride "title_icon" {
																icon = {
																	using = tooltip_title_icon_size
																	texture = "gfx/interface/icons/map_modes/raw_material.dds"
																}
															}
													
															blockoverride "concept_link" {
																text = [resource_gathering_operations|e]
															}
													
															blockoverride "tooltip_content" {
																TooltipTextBlock = {
																	visible = "[And(GoodItem.AreAllPossibleRGOAtMaxLvl, GoodItem.CanExpandRGO)]"
																	blockoverride "text" {
																		text = "GOODS_EXPAND_RGO_MAX_LVL_MARKET_TT_TEXT"
																	}
																}
																TooltipTextBlock = {
																	visible = "[GoodItem.CanExpandRGO]"
																	blockoverride "text" {
																		text = "GOODS_EXPAND_RGO_TT_TEXT"
																	}
																}
																TooltipTextBlock = {
																	visible = "[Not(GoodItem.CanExpandRGO)]"
																	blockoverride "text" {
																		text = "GOODS_EXPAND_RGO_TEXT_UNAVAILABLE"
																	}
																}
															}
														}
													}
													action_tooltip = {
														click_type = left
														click_mode = single
														enabled = "[GoodItem.CanExpandRGO]"
														title = "GOODS_EXPAND_RGO_TT"
														conditions = "[MakeItFailIfLoc(Not(GoodItem.CanExpandRGO), 'GOODS_EXPAND_BUILDING_REQUIREMENTS_NOT_MET')]"
														on_action = "[ShowExpandRawGoodLocationsViewWithMarketAndGoods(GoodsProductionLateralView.GetSelectedMarket.Self, GoodItem.GetGoods, '(bool)yes')]"
													}

													icon = {
														visible = "[And(GoodItem.AreAllPossibleRGOAtMaxLvl, GreaterThan_CFixedPoint(GoodItem.GetMaxRGOProfit,'(CFixedPoint)0'))]"
														size = { 100% 100% }
														texture = "gfx/interface/buttons/card_header_button_01.dds"
														frame_grid = {4 1}
														frame = 2
														spriteType = Corneredstretched
														texture_density = 2
													}
								
													hbox = {
														margin = {10 0}
														icon = {
															size = {18 18}
															texture = "gfx/interface/icons/map_modes/raw_material.dds"
														}
														text_single = {
															visible = "[GreaterThan_CFixedPoint(GoodItem.GetMaxRGOProfit,'(CFixedPoint)0')]"
															maximumsize = {55 -1}
															align = nobaseline
															fontsize = 14
															raw_text = "[GoodItem.GetMaxRGOProfit|+2] @tax_base!"
														}

														text_single = {
															layoutpolicy_horizontal = expanding
															visible = "[Not(GreaterThan_CFixedPoint(GoodItem.GetMaxRGOProfit,'(CFixedPoint)0'))]"
															maximumsize = {55 -1}
															align = center|nobaseline
															fontsize = 14
															raw_text = "-"
														}
													}

													sort_by_small_highlight = {
														name = "rgo_profit"
													}
												}

												button_regular = {
													size = { 90 28 }
													enabled = no
													visible = "[Not(GoodItem.GetGoods.IsRawMaterial)]"
													tooltip = "[produced_good|e]"
													tagtooltip_enabled = yes
								
													hbox = {
														icon = {
															size = {15 15}
															texture = "gfx/interface/icons/flat_icons/produced_goods.dds"
															glow = {
																name = "drop_shadow"
																glow_radius = 3
																color = {0.0 0.0 0.0 1.0}
																alpha = 0.5
															}
														}
													}

													sort_by_small_highlight = {
														name = "rgo_profit"
													}
												}
												
												# button_regular = {
												# 	size = { 90 28 }
												# 	visible = "[And(Not(GoodsProductionLateralView.IsMarketFilterEnabled), GoodItem.GetGoods.IsRawMaterial)]"
												# 	enabled = "[GoodItem.CanExpandRGO]"
												# 	onmousehierarchyenter = "[PdxGuiWidget.SetHighlightOwnGoods(GoodItem.GetGoods)]"

												# 	tooltipwidget = {
												# 		ContextualTooltipType = {
												# 			blockoverride "title_text" {
												# 				text = "GOODS_EXPAND_RGO_COUNTRY_TT_HEADER"
												# 			}
													
												# 			blockoverride "title_icon" {
												# 				icon = {
												# 					size = { 32 32 }
												# 					texture = "gfx/interface/icons/flat_icons/building_panel/build_button.dds"
												# 				}
												# 			}
													
												# 			blockoverride "concept_link" {
												# 				text = [resource_gathering_operations|e]
												# 			}
													
												# 			blockoverride "tooltip_content" {
												# 				TooltipTextBlock = {
												# 					visible = "[And(GoodItem.AreAllPossibleRGOAtMaxLvl, GoodItem.CanExpandRGO)]"
												# 					blockoverride "text" {
												# 						text = "GOODS_EXPAND_RGO_MAX_LVL_TT_TEXT"
												# 					}
												# 				}
												# 				TooltipTextBlock = {
												# 					visible = "[GoodItem.CanExpandRGO]"
												# 					blockoverride "text" {
												# 						text = "GOODS_EXPAND_RGO_COUNTRY_TT_TEXT"
																		
												# 					}
												# 				}
												# 				TooltipTextBlock = {
												# 					visible = "[Not(GoodItem.CanExpandRGO)]"
												# 					blockoverride "text" {
												# 						text = "GOODS_EXPAND_RGO_COUNTRY_TT_TEXT_UNAVAILABLE"
												# 					}
												# 				}
												# 			}
												# 		}
												# 	}

												# 	action_tooltip = {
												# 		click_type = left
												# 		click_mode = single
												# 		enabled = "[GoodItem.CanExpandRGO]"
												# 		title = "GOODS_EXPAND_RGO_TT"
												# 		conditions = "[MakeItFailIfLoc(Not(GoodItem.CanExpandRGO), 'GOODS_EXPAND_BUILDING_REQUIREMENTS_NOT_MET')]"
												# 		on_action = "[ShowExpandRawGoodLocationsViewWithGoods(GoodItem.GetGoods, '(bool)yes')]"
												# 	}

												# 	icon = {
												# 		visible = "[And(GoodItem.AreAllPossibleRGOAtMaxLvl, GreaterThan_CFixedPoint(GoodItem.GetMaxRGOProfit,'(CFixedPoint)0'))]"
												# 		size = { 100% 100% }
												# 		texture = "gfx/interface/buttons/card_header_button_01.dds"
												# 		frame_grid = {4 1}
												# 		frame = 2
												# 		spriteType = Corneredstretched
												# 		texture_density = 2
												# 	}
								
												# 	hbox = {
												# 		margin = {10 0}
												# 		icon = {
												# 			size = {18 18}
												# 			texture = "gfx/interface/icons/map_modes/raw_material.dds"
												# 		}
												# 		text_single = {
												# 			visible = "[GreaterThan_CFixedPoint(GoodItem.GetMaxRGOProfit,'(CFixedPoint)0')]"
												# 			maximumsize = {55 -1}
												# 			align = nobaseline
												# 			fontsize = 14
												# 			raw_text = "[GoodItem.GetMaxRGOProfit|+2] @gold!"
												# 		}

												# 		text_single = {
												# 			layoutpolicy_horizontal = expanding
												# 			visible = "[Not(GreaterThan_CFixedPoint(GoodItem.GetMaxRGOProfit,'(CFixedPoint)0'))]"
												# 			maximumsize = {55 -1}
												# 			align = center|nobaseline
												# 			fontsize = 14
												# 			raw_text = "-"
												# 		}
												# 	}

												# 	sort_by_small_highlight = {
												# 		name = "rgo_profit"
												# 	}
												# }
											}
										}
									}
								}
							}
						}
					}
				}
			}

			AutomatedSection = {
				datacontext = "[GetAutomatedSystemItem('rgo')]"
				blockoverride "glow_anim_automation_visible" {
					visible = "[AutomatedSystemsItem.IsEnabled]"
				}
			}
		}
	}
}

select_menu_left = {
	datacontext = "[GetQuickVisibleMarkets(Player.Self)]"
	blockoverride "menu_setup" {
		name = "goods_production_select_market"
	}

	blockoverride "close_button" {
		onclick = "[GoodsProductionSelectMarket.OnClose]"
	}

	blockoverride "select_content" {
		select_menu_header = {
			blockoverride "select_menu_header_extra" {
				button_checkbox_visibility = {
					size = { 32 32 }
					tooltipwidget = { 
						LeftClickButtonTooltip = {
							blockoverride "onclick_text" { text = "TOGGLE_INRANGE_MARKETS" }
						}
					}
					checked = "[GoodsProductionSelectMarket.Parent.Vars.Exists( 'inrange_markets')]"
					onclick = "[GoodsProductionSelectMarket.Parent.Vars.Toggle( 'inrange_markets')]"
				}

				text_single = {
					using = Font_Type_Headers
					using = Font_Size_Small
					align = nobaseline
					text = "INRANGE_MARKETS"
				}
			}
		}

		vbox = {
			layoutpolicy_horizontal = expanding
			spacing = 10

			datamodel = "[QuickVisibleMarkets.GetVisibleMarkets]"
			item = {
				widget = {
					size = { 485 70 }
					visible = "[Or3(GreaterThan_CFixedPoint(Market.GetCountryPopulation(Player.Self),'(CFixedPoint)0'), GreaterThan_CFixedPoint(Market.GetTotalMerchantCapacity(Player.Self),'(CFixedPoint)0'), And(GoodsProductionSelectMarket.Parent.Vars.Exists( 'inrange_markets'), IsMarketInRange(Market.Self)))]"
					
					hbox = {
						using = bg_market_card
						using = bg_cabinet_card_frame

						market_card = {
							blockoverride "market_card_title_action"{
								action_tooltip = {
									click_type = left
									click_mode = single
									title = "TOGGLE_MARKET_SELECTION"
									on_action = "[GoodsProductionSelectMarket.Parent.FilterByMarket(Market.Self)]"
								}
			
								action_tooltip = {
									click_type = right
									click_mode = single
			
									cursor = "market_menu"
									title = "CLICK_ACTION_MARKET_CONTEXT_MENU"
									on_action = "[PdxGuiWidget.ToggleContextMenu]"
								}
			
								onmousehierarchyenter = "[PdxGuiWidget.SetHighlightMarket(Market.Self)]"
								ondoubleclick = "[PanToLocation(Market.GetCenterLocation)]"
							}
						}
					}
				}
			}
		}
	}
}
